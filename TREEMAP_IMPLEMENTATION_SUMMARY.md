# íŠ¸ë¦¬ë§µ ë¡œì§ ì „ë©´ ê°œí¸ ì™„ë£Œ âœ…

## ğŸ“‹ êµ¬í˜„ ë‚´ìš©

ë¸Œëœë“œë³„ ë¶„ì„ í™”ë©´ì˜ ì±„ë„ë³„/ì•„ì´í…œë³„ íŠ¸ë¦¬ë§µ ë°ì´í„° ìƒì„± ë¡œì§ì„ ì²˜ìŒë¶€í„° ì¬êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.

## ğŸ¯ ì£¼ìš” ë³€ê²½ì‚¬í•­

### 1. **ë°ì´í„° ì†ŒìŠ¤ ë³€ê²½**
- **ì´ì „**: KE30_ë§¤ì¥,ì•„ì´í…œ ì§‘ê³„ íŒŒì¼
- **ì´í›„**: ìŠ¤ë…¸ìš°í”Œë ˆì´í¬ ì§ì ‘ ì¿¼ë¦¬ â†’ ì „ì²˜ë¦¬ â†’ JSON ìƒì„±

### 2. **í• ì¸ìœ¨ ê³„ì‚° ë°©ì‹ í†µì¼**
- **Python**: `(TAG - ì‹¤íŒë§¤ì•¡) / TAG Ã— 100`
- **HTML**: JSON ë°ì´í„° ê·¸ëŒ€ë¡œ ì‚¬ìš© (ì¬ê³„ì‚° ì œê±°)
- **ê²°ê³¼**: Python â†” ëŒ€ì‹œë³´ë“œ 100% ì¼ì¹˜ ë³´ì¥

### 3. **ì‹œì¦Œ ë¡œì§ êµ¬í˜„**
```
SSì‹œì¦Œ: 3ì›”~8ì›”
FWì‹œì¦Œ: 9ì›”~ë‚´ë…„ 2ì›”

ë¶„ë¥˜:
- ë‹¹ì‹œì¦Œì˜ë¥˜: í˜„ì¬ ì‹œì¦Œê³¼ ë™ì¼
- ê³¼ì‹œì¦Œì˜ë¥˜: í˜„ì¬ ì‹œì¦Œ ì´ì „
- ì°¨ì‹œì¦Œì˜ë¥˜: í˜„ì¬ ì‹œì¦Œ ì´ˆê³¼
```

### 4. **YOY ê³„ì‚° ì¶”ê°€**
- ì „ë…„ ë™ì£¼ì°¨ ë°ì´í„°ì™€ ë¹„êµ
- ëª¨ë“  ë ˆë²¨(ì „ì²´/ì±„ë„/ì•„ì´í…œ/ì†Œë¶„ë¥˜)ì—ì„œ YOY ì œê³µ

## ğŸ“‚ ìƒì„±ëœ íŒŒì¼

### Python ìŠ¤í¬ë¦½íŠ¸ (scripts/)
1. **download_treemap_rawdata.py** - ìŠ¤ë…¸ìš°í”Œë ˆì´í¬ ë°ì´í„° ë‹¤ìš´ë¡œë“œ
2. **preprocess_treemap_data.py** - ì±„ë„/ì•„ì´í…œ ë§¤í•‘, ì‹œì¦Œ ë¶„ë¥˜
3. **create_treemap_data_v2.py** - íŠ¸ë¦¬ë§µ JSON ìƒì„± (ìˆ˜ì •ë¨)
4. **download_previous_year_treemap.py** - ì „ë…„ ë°ì´í„° ë‹¤ìš´ë¡œë“œ
5. **run_treemap_pipeline.py** - ì „ì²´ íŒŒì´í”„ë¼ì¸ í†µí•© ì‹¤í–‰

### ë¬¸ì„œ
6. **scripts/TREEMAP_README.md** - ìƒì„¸ ê°€ì´ë“œ
7. **TREEMAP_IMPLEMENTATION_SUMMARY.md** - ì´ ë¬¸ì„œ

### HTML
8. **public/Dashboard.html** (ìˆ˜ì •ë¨) - JSON ë°ì´í„° ì§ì ‘ ì‚¬ìš©

## ğŸš€ ì‚¬ìš© ë°©ë²•

### ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
```bash
cd scripts

# 1. ì „ë…„ ë°ì´í„° ë‹¤ìš´ë¡œë“œ (YOY ê³„ì‚°ìš©, ìµœì´ˆ 1íšŒ)
python download_previous_year_treemap.py 20251215

# 2. ë‹¹ë…„ ë°ì´í„° ìƒì„±
python run_treemap_pipeline.py 20251215
```

### ì‹¤í–‰ ê²°ê³¼
```
raw/202512/
  â”œâ”€â”€ treemap_raw_20251215.csv              # ì›ë³¸ ë°ì´í„°
  â”œâ”€â”€ treemap_preprocessed_20251215.csv     # ì „ì²˜ë¦¬ ì™„ë£Œ
  â””â”€â”€ previous_year/
      â”œâ”€â”€ treemap_raw_prev_20251215.csv
      â””â”€â”€ treemap_preprocessed_prev_20251215.csv

public/data/20251215/
  â””â”€â”€ treemap.json                          # ìµœì¢… JSON
```

## ğŸ“Š ë°ì´í„° êµ¬ì¡°

### ìµœì¢… ì¶œë ¥ (treemap.json)
```json
{
  "channelTreemapData": {
    "total": {
      "tag": 16519229600,
      "sales": 15250904284,
      "discountRate": 7.7,
      "yoy": 7.0
    },
    "channels": {
      "RF": {
        "tag": 1160330300,
        "sales": 989587770,
        "share": 6,
        "discountRate": 14.7,
        "yoy": 14.8,
        "itemCategories": {
          "Headwear": {
            "tag": 466021000,
            "sales": 391506250,
            "share": 40,
            "discountRate": 16.0,
            "yoy": 18.9,
            "subCategories": {
              "ë¹„ë‹ˆ": {
                "tag": 179172000,
                "sales": 166926420,
                "share": 43,
                "discountRate": 6.8
              }
            }
          }
        }
      }
    },
    "byBrand": {
      "MLB": {
        "channel": { ... },
        "item": { ... }
      }
    }
  },
  "itemTreemapData": {
    "items": {
      "Headwear": {
        "tag": 6063130000,
        "sales": 5878580749,
        "share": 39,
        "discountRate": 3.0,     â† ì •í™•í•œ 3.0%!
        "yoy": 28.5,
        "channels": {
          "RF": { ... },
          "ëŒ€ë¦¬ì ": { ... },
          "ë©´ì„¸ì ": { ... }
        }
      }
    }
  }
}
```

## âœ… ê²€ì¦

### MLB Headwear í• ì¸ìœ¨ ê³„ì‚°
```
TAGë§¤ì¶œ:     6,063,130,000ì›
ì‹¤íŒë§¤ì¶œ:    5,878,580,749ì›
í• ì¸ìœ¨:      (6,063,130,000 - 5,878,580,749) / 6,063,130,000 Ã— 100
           = 3.04% â‰ˆ 3.0% âœ…
```

**ì±„ë„ë³„ ìƒì„¸:**
| ì±„ë„ | TAGë§¤ì¶œ | ì‹¤íŒë§¤ì¶œ | í• ì¸ìœ¨ |
|------|---------|----------|--------|
| RF | 466,021,000 | 391,506,250 | 16.0% |
| ê¸°íƒ€ | 2,090,000 | 1,105,300 | 47.1% |
| ëŒ€ë¦¬ì  | 519,127,000 | 506,031,380 | 2.5% |
| ë©´ì„¸ì  | 2,719,046,000 | 2,719,039,650 | 0.0% â† ì´ì œ í¬í•¨! |
| ë°±í™”ì  | 816,234,000 | 769,675,850 | 5.7% |
| ìì‚¬ëª° | 276,762,000 | 236,539,969 | 14.5% |
| ì œíœ´ëª° | 604,874,000 | 604,605,120 | 0.0% |
| ì§ì˜ëª° | 81,993,000 | 79,835,150 | 2.6% |
| ì§ì˜ì (ê°€ë‘) | 576,983,000 | 570,242,080 | 1.2% |

## ğŸ”„ ë°ì´í„° íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ìŠ¤ë…¸ìš°í”Œë ˆì´í¬ ì¿¼ë¦¬                      â”‚
â”‚     - dw_copa_d í…Œì´ë¸”                      â”‚
â”‚     - ë™ì£¼ì°¨ ê¸°ì¤€ (ì›”ìš”ì¼~í•´ë‹¹ì¼)            â”‚
â”‚     - ë¸Œëœë“œì½”ë“œ, ì‹œì¦Œ, ì±„ë„, ì•„ì´í…œ ë“±      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. ì „ì²˜ë¦¬ (preprocess_treemap_data.py)     â”‚
â”‚     âœ“ ì±„ë„ëª… ë§¤í•‘ (RF íŒì • í¬í•¨)            â”‚
â”‚     âœ“ ì•„ì´í…œ ë§ˆìŠ¤í„° ì¡°ì¸                    â”‚
â”‚     âœ“ ì•„ì´í…œ_ì¤‘ë¶„ë¥˜ ìƒì„±                    â”‚
â”‚       - ì˜ë¥˜: ì‹œì¦Œ ë¡œì§ (ë‹¹/ê³¼/ì°¨)          â”‚
â”‚       - ACC: ë§ˆìŠ¤í„° ì´ë¦„                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. íŠ¸ë¦¬ë§µ JSON ìƒì„±                        â”‚
â”‚     (create_treemap_data_v2.py)             â”‚
â”‚     âœ“ ì±„ë„ë³„/ì•„ì´í…œë³„ ì§‘ê³„                  â”‚
â”‚     âœ“ í• ì¸ìœ¨ ê³„ì‚°                           â”‚
â”‚     âœ“ YOY ê³„ì‚° (ì „ë…„ ë¹„êµ)                  â”‚
â”‚     âœ“ ë¹„ì¤‘ ê³„ì‚°                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Dashboard.html                          â”‚
â”‚     âœ“ JSON ë°ì´í„° ë¡œë“œ                      â”‚
â”‚     âœ“ ê·¸ëŒ€ë¡œ ì‚¬ìš© (ì¬ê³„ì‚° ì—†ìŒ)             â”‚
â”‚     âœ“ íŠ¸ë¦¬ë§µ ì°¨íŠ¸ ë Œë”ë§                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ HTML ìˆ˜ì •ì‚¬í•­

### ì´ì „ (ì˜ëª»ëœ ë°©ì‹)
```javascript
// HTMLì—ì„œ ì¬ê³„ì‚°
const itemAggregated = {};
channels.forEach(channel => {
  itemAggregated[itemName].tag += channel.tag;
  itemAggregated[itemName].sales += channel.sales;
});
const discountRate = (tag - sales) / tag * 100;  // ì¬ê³„ì‚°!
```

### ì´í›„ (ì˜¬ë°”ë¥¸ ë°©ì‹)
```javascript
// JSON ë°ì´í„° ê·¸ëŒ€ë¡œ ì‚¬ìš©
const items = brandData?.item?.items || {};
Object.keys(items).forEach(itemName => {
  itemMetrics[brandCode][itemName] = {
    discountRate: (items[itemName]?.discountRate || 0) / 100,  // JSON ê°’ ê·¸ëŒ€ë¡œ
    tag: items[itemName]?.tag || 0,
    sales: items[itemName]?.sales || 0,
    yoy: items[itemName]?.yoy || null
  };
});
```

## ğŸ“Œ í•µì‹¬ ê°œì„ ì‚¬í•­

### 1. **ì •í™•ì„±**
- âœ… Python ê³„ì‚° = HTML í‘œì‹œ (100% ì¼ì¹˜)
- âœ… í• ì¸ìœ¨ 0%ë„ ì˜¬ë°”ë¥´ê²Œ í¬í•¨
- âœ… ì‹œì¦Œ ë¡œì§ ì •í™•íˆ êµ¬í˜„

### 2. **ì™„ì „ì„±**
- âœ… ëª¨ë“  ì±„ë„ ë°ì´í„° í¬í•¨ (ë©´ì„¸ì  0% í¬í•¨)
- âœ… YOY ëª¨ë“  ë ˆë²¨ì—ì„œ ì œê³µ
- âœ… ë¸Œëœë“œë³„ ë°ì´í„° ì™„ë²½ ë¶„ë¦¬

### 3. **ìœ ì§€ë³´ìˆ˜ì„±**
- âœ… ë‹¨ì¼ ì§„ì‹¤ ê³µê¸‰ì› (Pythonë§Œ ê³„ì‚°)
- âœ… HTMLì€ ë‹¨ìˆœ í‘œì‹œë§Œ ë‹´ë‹¹
- âœ… íŒŒì´í”„ë¼ì¸ ìë™í™”

## ğŸ” í…ŒìŠ¤íŠ¸ ë°©ë²•

```bash
# 1. íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
python scripts/run_treemap_pipeline.py 20251215

# 2. í• ì¸ìœ¨ ê²€ì¦
python -c "
import pandas as pd
df = pd.read_csv('raw/202512/treemap_preprocessed_20251215.csv')
mlb = df[df['ë¸Œëœë“œ'] == 'MLB']
hw = mlb[mlb['ì•„ì´í…œ_ì¤‘ë¶„ë¥˜'] == 'Headwear']
tag = hw['TAGë§¤ì¶œ'].sum()
sales = hw['ì‹¤íŒë§¤ì¶œ'].sum()
print(f'Headwear í• ì¸ìœ¨: {(tag-sales)/tag*100:.2f}%')
"

# 3. JSON í™•ì¸
python -c "
import json
with open('public/data/20251215/treemap.json') as f:
    data = json.load(f)
    mlb_hw = data['itemTreemapData']['byBrand']['MLB']['item']['items']['Headwear']
    print(f'JSON í• ì¸ìœ¨: {mlb_hw[\"discountRate\"]}%')
"

# 4. ë¸Œë¼ìš°ì € í™•ì¸
# Dashboard ì—´ê¸° â†’ MLB ì„ íƒ â†’ ì•„ì´í…œë³„ íŠ¸ë¦¬ë§µì—ì„œ ëª¨ì í™•ì¸
```

## ğŸ“ ì£¼ì˜ì‚¬í•­

1. **ë§ˆìŠ¤í„° íŒŒì¼ í•„ìˆ˜**
   - `master/channel_master.csv` (ì±„ë„ëª… ë§¤í•‘)
   - `master/item_master.csv` (ì•„ì´í…œ ì •ë³´)

2. **ì „ë…„ ë°ì´í„°**
   - YOY ê³„ì‚° ìœ„í•´ í•„ìš”
   - ì—†ìœ¼ë©´ YOYëŠ” nullë¡œ í‘œì‹œ

3. **ì‹œì¦Œ ê¸°ì¤€ì¼**
   - ì¢…ë£Œì¼(í•´ë‹¹ì¼)ì„ ê¸°ì¤€ìœ¼ë¡œ ì‹œì¦Œ ë¶„ë¥˜
   - SS(3~8ì›”), FW(9~2ì›”)

## ğŸ‰ ì™„ë£Œ!

ëª¨ë“  ë¡œì§ì´ ì •í™•í•˜ê²Œ êµ¬í˜„ë˜ì—ˆìœ¼ë©°, Pythonì—ì„œ ê³„ì‚°ëœ ê°’ì´ ëŒ€ì‹œë³´ë“œì— ê·¸ëŒ€ë¡œ í‘œì‹œë©ë‹ˆë‹¤.

**ê²°ê³¼:**
- âœ… ëª¨ì í• ì¸ìœ¨: **3.0%** (ì •í™•!)
- âœ… ëª¨ë“  ì•„ì´í…œ í• ì¸ìœ¨ ì •í™•
- âœ… YOY ê³„ì‚° ì™„ë£Œ
- âœ… ì¬ê³„ì‚° ì—†ì´ JSON ì§ì ‘ ì‚¬ìš©






















