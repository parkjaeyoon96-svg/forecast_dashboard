<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ì›”ì¤‘ ì†ìµì˜ˆì¸¡ ëŒ€ì‹œë³´ë“œ</title>

  <!-- Chart.js (í•œ ë²ˆë§Œ) -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <!-- Plotly.js for treemap -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <!-- ë°ì´í„° íŒŒì¼ (exporter.pyê°€ ìƒì„±) -->
  <script defer src="./data.js"></script>

  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#333;min-height:100vh;overflow-x:auto;}
    .dashboard-header{background:rgba(255,255,255,0.95);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:16px 24px;box-shadow:0 4px 20px rgba(0,0,0,0.1);border-bottom:3px solid #4f46e5;position:sticky;top:0;z-index:100;}
    .header-content{display:flex;justify-content:space-between;align-items:center;}
    .header-content h1{color:#1e293b;font-size:24px;font-weight:700;}
    .header-content p{color:#64748b;font-size:14px;}
    .edit-btn,.reset-btn,.save-btn,.ai-btn{padding:8px 16px;border:2px solid #4f46e5;background:#fff;border-radius:8px;cursor:pointer;font-weight:600;font-size:13px;transition:all .3s ease;color:#4f46e5;}
    .edit-btn:hover,.reset-btn:hover,.save-btn:hover{background:#4f46e5;color:#fff;}
    .ai-btn{border-color:#9333ea;color:#9333ea;}
    .ai-btn:hover{background:#9333ea;color:#fff;}
    .date-input-group{display:flex;gap:12px;align-items:center;margin-top:8px;}
    .date-input-label{font-size:13px;color:#64748b;font-weight:500;white-space:nowrap;}
    .date-input{padding:6px 12px;border:1px solid #e2e8f0;border-radius:6px;font-size:13px;color:#1e293b;background:#fff;min-width:120px;transition:all .2s ease;}
    .date-input:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 3px rgba(79,70,229,0.1);}
    .date-input:hover{border-color:#cbd5e1;}
    .ai-note{position:absolute;right:8px;top:8px;max-width:42%;background:#fff7ed;border:1px solid #fdba74;border-radius:8px;padding:8px 10px;font-size:11px;color:#92400e;box-shadow:0 4px 12px rgba(0,0,0,.08);} 
    .chart-container{position:relative;}
    /* AI ìš”ì•½ ëª¨ë‹¬ */
    .ai-modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:500;}
    .ai-modal{background:#fff;border-radius:12px;max-width:840px;width:92%;max-height:80vh;overflow:auto;box-shadow:0 20px 60px rgba(0,0,0,.25);}
    .ai-modal header{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid #e5e7eb;}
    .ai-modal header h4{font-size:16px;color:#111827;font-weight:700;}
    .ai-modal .content{padding:14px 16px;color:#374151;font-size:13px;line-height:1.6;}
    .ai-modal .close-btn{background:#ef4444;color:#fff;border:none;border-radius:6px;padding:6px 10px;cursor:pointer;font-size:12px;}
    .ai-rightnote{background:#fff7ed;border:1px solid #fdba74;border-radius:8px;padding:10px;font-size:12px;color:#92400e;margin-top:12px;display:none;}
    #ai-rightnotes .ai-rightnote + .ai-rightnote{margin-top:10px;}
    .ai-part-note{background:#fff7ed;border:1px solid #fdba74;border-radius:8px;padding:12px;font-size:12px;color:#92400e;}
    .ai-part-note-side{position:absolute;right:12px;top:12px;max-width:300px;background:#fff7ed;border:1px solid #fdba74;border-radius:8px;padding:12px;font-size:11px;color:#92400e;box-shadow:0 4px 12px rgba(0,0,0,.08);z-index:10;}
    .edit-btn.active{background:#4f46e5;color:#fff;}
    .reset-btn{border-color:#dc2626;color:#dc2626;}
    .reset-btn:hover{background:#dc2626;color:#fff;}
    .save-btn{border-color:#059669;color:#059669;}
    .save-btn:hover{background:#059669;color:#fff;}
    .editable{position:relative;transition:all .2s ease;}
    .editable[contenteditable="true"]{background:#fef3c7;border-radius:4px;padding:2px 4px;outline:2px dashed #f59e0b;cursor:text;}
    .editable[contenteditable="true"]:focus{outline:2px solid #f59e0b;background:#fef9e7;}
    .edit-indicator{position:absolute;top:-8px;right:-8px;background:#f59e0b;color:#fff;font-size:9px;padding:2px 6px;border-radius:10px;display:none;font-weight:600;}
    .editable[contenteditable="true"] .edit-indicator{display:block;}
    .drillback-btn{display:none;padding:4px 12px;border:2px solid #4f46e5;background:#fff;color:#4f46e5;border-radius:6px;cursor:pointer;font-size:11px;font-weight:600;transition:all .3s ease;}
    .drillback-btn:hover{background:#4f46e5;color:#fff;transform:translateY(-1px);box-shadow:0 4px 12px rgba(79,70,229,0.3);}
    .dashboard-layout{display:flex;min-height:calc(100vh - 80px);min-width:1600px;}
    .sidebar{width:200px;background:rgba(255,255,255,0.95);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:20px;box-shadow:2px 0 20px rgba(0,0,0,0.1);flex-shrink:0;}
    .sidebar h3{color:#1e293b;margin-bottom:16px;font-size:16px;font-weight:600;}
    .nav-item{padding:10px 14px;margin-bottom:6px;border-radius:10px;cursor:pointer;transition:all .3s ease;font-weight:500;font-size:14px;}
    .nav-item:hover{background:#f1f5f9;transform:translateX(3px);}
    .nav-item.active{background:linear-gradient(135deg,#4f46e5,#7c3aed);color:#fff;box-shadow:0 4px 15px rgba(79,70,229,.3);}
    .main-content{flex:1;background:rgba(255,255,255,0.95);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:20px;overflow-y:auto;display:flex;flex-direction:column;}
    .content-section{display:none;height:100%;}
    .content-section.active{display:flex;flex-direction:column;}
    .insights-section{background:linear-gradient(135deg,#fef3c7,#fed7aa);border-radius:10px;padding:16px;margin-bottom:20px;border-left:4px solid #f59e0b;flex-shrink:0;display:block;width:100%;box-sizing:border-box;}
    .insights-section h3{color:#92400e;margin-bottom:10px;font-size:16px;font-weight:600;}
    .insights-content{color:#78350f;line-height:1.5;font-size:13px;display:block;width:100%;}
    .brand-controls{margin-bottom:20px;flex-shrink:0;}
    .brand-buttons{display:flex;gap:10px;flex-wrap:wrap;}
    .brand-btn{padding:8px 16px;border:2px solid #e2e8f0;background:#fff;border-radius:20px;cursor:pointer;font-weight:500;font-size:13px;transition:all .3s ease;}
    .brand-btn:hover{border-color:#4f46e5;background:#f8fafc;}
    .brand-btn.active{background:linear-gradient(135deg,#4f46e5,#7c3aed);color:#fff;border-color:transparent;box-shadow:0 4px 15px rgba(79,70,229,.3);}
    .content-body{flex:1;display:flex;gap:20px;min-height:0;}
    .charts-area{flex:1;display:flex;flex-direction:column;gap:15px;min-width:0;max-width:calc(100vw - 480px);}
    .kpi-section{display:grid;grid-template-columns:repeat(4,1fr);gap:15px;flex-shrink:0;min-height:180px;}
    .kpi-value-with-rate{display:flex;align-items:baseline;gap:4px;}
    .kpi-rate{color:#64748b;font-size:13px;font-weight:500;}
    .kpi-card{background:linear-gradient(135deg,#fff,#f8fafc);border-radius:10px;padding:16px;box-shadow:0 4px 20px rgba(0,0,0,.08);border:1px solid #e2e8f0;transition:transform .3s ease,box-shadow .3s ease;}
    .kpi-card:hover{transform:translateY(-3px);box-shadow:0 8px 25px rgba(0,0,0,.15);}
    .kpi-title{color:#64748b;font-size:15px;margin-bottom:6px;font-weight:600;}
    .kpi-value{color:#1e293b;font-size:20px;font-weight:700;margin-bottom:4px;}
    .kpi-value-line{display:flex;align-items:baseline;gap:6px;margin-bottom:4px;}
    .kpi-value-line + .kpi-value-line{margin-top:8px;padding-top:8px;border-top:1px solid #e2e8f0;}
    .kpi-value-with-rate{display:flex;align-items:baseline;gap:4px;}
    .kpi-rate{color:#64748b;font-size:13px;font-weight:500;}
    .kpi-card #brand-current-discount-rate,.kpi-card #brand-discount-rate,.kpi-card #brand-current-profit-margin-rate,.kpi-card #brand-profit-margin-rate,.kpi-card #brand-current-opprofit-margin-rate,.kpi-card #brand-opprofit-margin-rate{color:#3b82f6 !important;font-weight:600 !important;}
    .kpi-label{color:#94a3b8;font-size:12px;font-weight:500;}
    .kpi-change{font-size:11px;font-weight:500;}
    .kpi-change-line{font-size:11px;font-weight:500;margin-bottom:2px;}
    .kpi-positive{color:#059669;}
    .kpi-negative{color:#dc2626;}
    .treemap-section{display:grid;grid-template-columns:1fr 1fr;gap:12px;flex-shrink:0;min-height:600px;margin-bottom:15px;}
    .charts-grid{flex:1;display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;gap:12px;min-height:580px;}
    .chart-container{background:#fff;border-radius:10px;padding:14px;box-shadow:0 4px 20px rgba(0,0,0,.08);border:1px solid #e2e8f0;display:flex;flex-direction:column;}
    .chart-title{color:#1e293b;font-size:16px;font-weight:700;margin-bottom:10px;text-align:center;flex-shrink:0;}
    .chart-wrapper{flex:1;position:relative;min-height:180px;}
    .financial-report{width:420px;background:rgba(255,255,255,0.95);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);padding:20px;box-shadow:-2px 0 20px rgba(0,0,0,.1);overflow-y:auto;flex-shrink:0;position:relative;}
    .financial-report h3{color:#1e293b;margin-bottom:16px;font-size:16px;font-weight:600;text-align:center;padding-bottom:10px;border-bottom:2px solid #e2e8f0;}
    .pl-table{width:100%;border-collapse:collapse;margin-bottom:20px;}
    .pl-table th,.pl-table td{padding:5px 6px;text-align:right;border-bottom:1px solid #e2e8f0;font-size:11px;}
    .pl-table th{background:#f8fafc;color:#475569;font-weight:600;}
    .pl-table .item-name{text-align:left;font-weight:500;}
    .pl-table .sub-item{padding-left:16px;color:#64748b;font-size:11px;}
    .pl-table .total-row{border-top:2px solid #4f46e5;background:#f8fafc;font-weight:600;}
    /* ì•„ì´í…œ ë¶„ì„ í‘œ ì •ë ¬: ëª¨ë‘ ê°€ìš´ë° ì •ë ¬ */
    #itemDiffTable th, #itemDiffTable td { text-align:center; white-space:nowrap; }
    /* ì•„ì´í…œ ë¶„ì„ í…Œì´ë¸” ì»¬ëŸ¼ ìƒ‰ìƒ êµ¬ë¶„ */
    #itemDiffTable thead tr:first-child th:nth-child(1),
    #itemDiffTable thead tr:first-child th:nth-child(2),
    #itemDiffTable thead tr:first-child th:nth-child(3){
      background:#334155; color:#fff; border-color:#1f2937;
    }
    /* 1í–‰ ê·¸ë£¹ í—¤ë”: 4 ë°œì£¼, 5 ì£¼ê°„, 6 ëˆ„ì , 7 íŒë§¤ìœ¨ (ìƒ‰ìƒ ì‚¬ì§„ê³¼ ìœ ì‚¬) */
    #itemDiffTable thead tr:first-child th:nth-child(4){
      background:#f59e0b; color:#1f2937; border-color:#d97706; /* ì˜¤ë Œì§€ */
    }
    #itemDiffTable thead tr:first-child th:nth-child(5){
      background:#60a5fa; color:#1f2937; border-color:#3b82f6; /* ë¸”ë£¨ */
    }
    #itemDiffTable thead tr:first-child th:nth-child(6){
      background:#f0abfc; color:#1f2937; border-color:#e879f9; /* í•‘í¬/ë³´ë¼ */
    }
    #itemDiffTable thead tr:first-child th:nth-child(7){
      background:#86efac; color:#1f2937; border-color:#4ade80; /* ì—°ë‘ */
    }
    /* 2í–‰ í—¤ë” ì»¬ëŸ¼ ìƒ‰ìƒ (ê·¸ë£¹ì— ë§ì¶˜ ë¼ì´íŠ¸ í†¤) */
    /* (2í–‰) 1-2: ë°œì£¼ (1í–‰ê³¼ ë™ì¼ ìƒ‰) - 1í–‰ 3ê°œëŠ” rowspanì´ë¼ 2í–‰ indexëŠ” 1ë¶€í„° ì‹œì‘ */
    #itemDiffTable thead tr:nth-child(2) th:nth-child(n+1):nth-child(-n+2){
      background:#f59e0b; color:#1f2937; border-color:#d97706;
    }
    /* (2í–‰) 3-4: ì£¼ê°„ (1í–‰ê³¼ ë™ì¼ ìƒ‰) */
    #itemDiffTable thead tr:nth-child(2) th:nth-child(n+3):nth-child(-n+4){
      background:#60a5fa; color:#1f2937; border-color:#3b82f6;
    }
    /* (2í–‰) 5-6: ëˆ„ì  (1í–‰ê³¼ ë™ì¼ ìƒ‰) */
    #itemDiffTable thead tr:nth-child(2) th:nth-child(n+5):nth-child(-n+6){
      background:#f0abfc; color:#1f2937; border-color:#e879f9;
    }
    /* (2í–‰) 7-9: íŒë§¤ìœ¨ (1í–‰ê³¼ ë™ì¼ ìƒ‰) */
    #itemDiffTable thead tr:nth-child(2) th:nth-child(n+7):nth-child(-n+9){
      background:#86efac; color:#1f2937; border-color:#4ade80;
    }
    /* ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œ: 1í–‰ í—¤ë” ìƒ‰ìƒ */
    #itemDiffTable.inventory-mode thead tr:first-child th:nth-child(1),
    #itemDiffTable.inventory-mode thead tr:first-child th:nth-child(2),
    #itemDiffTable.inventory-mode thead tr:first-child th:nth-child(3){
      background:#334155; color:#fff; border-color:#1f2937;
    }
    #itemDiffTable.inventory-mode thead tr:first-child th:nth-child(4){
      background:#f59e0b; color:#1f2937; border-color:#d97706; /* ì£¼ê°„ë§¤ì¶œ - ì£¼í™© */
    }
    #itemDiffTable.inventory-mode thead tr:first-child th:nth-child(5){
      background:#60a5fa; color:#1f2937; border-color:#3b82f6; /* ì¬ê³ ì£¼ìˆ˜ - íŒŒë‘ */
    }
    /* ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œ: 2í–‰ í—¤ë” ìƒ‰ìƒ */
    #itemDiffTable.inventory-mode thead tr:nth-child(2) th:nth-child(n+1):nth-child(-n+5){
      background:#f59e0b; color:#1f2937; border-color:#d97706; /* ì£¼ê°„ë§¤ì¶œ - ì£¼í™© */
    }
    #itemDiffTable.inventory-mode thead tr:nth-child(2) th:nth-child(n+6):nth-child(-n+9){
      background:#60a5fa; color:#1f2937; border-color:#3b82f6; /* ì¬ê³ ì£¼ìˆ˜ - íŒŒë‘ */
    }
    /* ë¦¬ìŠ¤íŠ¸(ë°”ë””) ì…€ ë°°ê²½ ì œê±° - í—¤ë”ë§Œ ìƒ‰ìƒ ìœ ì§€ */
    #itemDiffTable tbody td{ background:transparent; }
    .progress-bar{width:100%;height:6px;background:#e2e8f0;border-radius:3px;overflow:hidden;margin-top:6px;}
    .progress-fill{height:100%;background:linear-gradient(90deg,#4f46e5,#7c3aed);transition:width .3s ease;}
    canvas{max-height:100% !important;}
    ::-webkit-scrollbar{width:6px;height:6px;}
    ::-webkit-scrollbar-track{background:#f1f1f1;}
    ::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px;}
    ::-webkit-scrollbar-thumb:hover{background:#a8a8a8;}
    @media (max-width:1600px){
      .dashboard-layout{min-width:1400px;}
      .financial-report{width:300px;}
    }
    /* ì „ì²´í˜„í™© íˆíŠ¸ë§µ ìŠ¤íƒ€ì¼ */
    .heatmap-table {
      width: 100%;
      overflow-x: auto;
      margin-top: 20px;
    }
    .cell-excellent {
      background: linear-gradient(135deg, #48bb78, #38a169);
      color: white;
    }
    .cell-good {
      background: linear-gradient(135deg, #ecc94b, #d69e2e);
      color: #2d3748;
    }
    .cell-average {
      background: linear-gradient(135deg, #ed8936, #dd6b20);
      color: white;
    }
    .cell-poor {
      background: linear-gradient(135deg, #fc8181, #f56565);
      color: white;
    }
    .cell-empty {
      background: #f9fafb;
      color: #9ca3af;
    }
    #overviewHeatmapTable tr:hover td {
      background: #edf2f7 !important;
    }
  </style>
</head>
<body>
  <div class="dashboard-header">
    <div class="header-content">
      <div>
      <h1>ğŸ“Š ì›”ì¤‘ ì†ìµì˜ˆì¸¡ ëŒ€ì‹œë³´ë“œ</h1>
      <div id="last-updated">
        <p style="margin:4px 0;font-size:14px;">ì—…ë°ì´íŠ¸ ì¼ì: <span id="update-date">-</span></p>
        <div id="date-info" style="font-size:12px;color:#64748b;margin-top:2px;"></div>
      </div>
      </div>
      <div style="display:flex;gap:10px;align-items:center;">
          <button id="ai-btn" class="ai-btn">ğŸ¤– AIë¶„ì„</button>
        <button id="edit-mode-btn" class="edit-btn">âœï¸ í¸ì§‘ ëª¨ë“œ</button>
        <button id="save-btn" class="save-btn" style="display:none;">ğŸ’¾ ì €ì¥</button>
      </div>
    </div>
  </div>

  <div class="dashboard-layout">
    <!-- ì‚¬ì´ë“œë°” -->
    <div class="sidebar">
      <h3>ë©”ë‰´</h3>
      <div class="nav-item active" data-section="overview">ğŸ“ˆ ì „ì²´ í˜„í™©</div>
      <div class="nav-item" data-section="brand">ğŸ·ï¸ ë¸Œëœë“œë³„ ë¶„ì„</div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <div class="main-content">
      <!-- ì „ì²´ í˜„í™© ì„¹ì…˜ -->
      <div id="content-overview" class="content-section active">
        <div class="insights-section">
          <div class="insights-content editable" id="overview-insights" contenteditable="false">
            <!-- ì¸ì‚¬ì´íŠ¸ ë‚´ìš©ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
          </div>
        </div>

        <div class="content-body">
          <div class="charts-area">
            <div class="kpi-section">
              <!-- ì‹¤íŒë§¤ì¶œ í†µí•© KPI -->
              <div class="kpi-card">
                <div class="kpi-title">ì‹¤íŒë§¤ì¶œ</div>
                <div class="kpi-value-line">
                  <span class="kpi-value editable" contenteditable="false">881.6ì–µì›</span>
                  <span class="kpi-label">(í˜„ì‹œì )</span>
                </div>
                <div class="kpi-value-line">
                  <span class="kpi-value editable" contenteditable="false">881.6ì–µì›</span>
                  <span class="kpi-label">(ì›”ë§ì˜ˆìƒ)</span>
                </div>
                <div class="kpi-change-line kpi-negative editable" contenteditable="false">ëª©í‘œ ëŒ€ë¹„ -5%</div>
                <div class="kpi-change kpi-negative editable" contenteditable="false">ì „ë…„ ëŒ€ë¹„ -4%</div>
                <div class="progress-bar"><div class="progress-fill" style="width:95%"></div></div>
              </div>
              
              <!-- ì§ì ‘ì´ìµ í†µí•© KPI -->
              <div class="kpi-card">
                <div class="kpi-title">ì§ì ‘ì´ìµ</div>
                <div class="kpi-value-line">
                  <span class="kpi-value editable" contenteditable="false">191.4ì–µì›</span>
                  <span class="kpi-label">(í˜„ì‹œì )</span>
                </div>
                <div class="kpi-value-line">
                  <span class="kpi-value editable" contenteditable="false">191.4ì–µì›</span>
                  <span class="kpi-label">(ì›”ë§ì˜ˆìƒ)</span>
                </div>
                <div class="kpi-change-line kpi-negative editable" contenteditable="false">ëª©í‘œ ëŒ€ë¹„ -8%</div>
                <div class="kpi-change kpi-negative editable" contenteditable="false">ì „ë…„ ëŒ€ë¹„ -5%</div>
                <div class="progress-bar"><div class="progress-fill" style="width:92%"></div></div>
              </div>
              
              <!-- ì˜ì—…ì´ìµ í†µí•© KPI -->
              <div class="kpi-card">
                <div class="kpi-title">ì˜ì—…ì´ìµ</div>
                <div class="kpi-value-line">
                  <span class="kpi-value editable" contenteditable="false">63.4ì–µì›</span>
                  <span class="kpi-label">(í˜„ì‹œì )</span>
                </div>
                <div class="kpi-value-line">
                  <span class="kpi-value editable" contenteditable="false">63.4ì–µì›</span>
                  <span class="kpi-label">(ì›”ë§ì˜ˆìƒ)</span>
                </div>
                <div class="kpi-change-line kpi-negative editable" contenteditable="false">ëª©í‘œ ëŒ€ë¹„ -21%</div>
                <div class="kpi-change kpi-negative editable" contenteditable="false">ì „ë…„ ëŒ€ë¹„ -27%</div>
                <div class="progress-bar"><div class="progress-fill" style="width:79%"></div></div>
              </div>
              
              <!-- ì§ì ‘ì´ìµ ì§„ì²™ìœ¨ í†µí•© KPI -->
              <div class="kpi-card">
                <div class="kpi-title">ì§ì ‘ì´ìµ ì§„ì²™ìœ¨</div>
                <div class="kpi-value-line">
                  <span class="kpi-value editable" contenteditable="false">95%</span>
                  <span class="kpi-label">(í˜„ì‹œì )</span>
                </div>
                <div class="kpi-value-line">
                  <span class="kpi-value editable" contenteditable="false">95%</span>
                  <span class="kpi-label">(ì›”ë§ì˜ˆìƒ)</span>
                </div>
                <div class="kpi-change-line kpi-negative editable" contenteditable="false">ëª©í‘œ ëŒ€ë¹„ -5%</div>
                <div class="kpi-change kpi-negative editable" contenteditable="false">ì „ë…„ ëŒ€ë¹„ -4%</div>
                <div class="progress-bar"><div class="progress-fill" style="width:95%"></div></div>
              </div>
            </div>

            <div class="charts-grid">
              <div class="chart-container">
                <div class="chart-title">ë¸Œëœë“œë³„ ë§¤ì¶œ í˜„í™© & ì˜ì—…ì´ìµ</div>
                <div class="chart-wrapper"><canvas id="brandRevenueChart"></canvas></div>
              </div>
              <div class="chart-container">
                <div class="chart-title">ì „ì²´ ë¸Œëœë“œ ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„</div>
                <div style="display:flex;justify-content:center;align-items:center;margin:4px 0 8px 0;gap:12px;font-size:12px;">
                  <div style="display:flex;align-items:center;gap:6px;"><span style="display:inline-block;width:10px;height:10px;background:#3B82F6;border-radius:2px;"></span> ê³„íš</div>
                  <div style="display:flex;align-items:center;gap:6px;"><span style="display:inline-block;width:10px;height:10px;background:#10B981;border-radius:2px;"></span> ì „ë…„</div>
                </div>
                <div class="chart-wrapper"><canvas id="brandAllRadarChart"></canvas></div>
              </div>
              <div class="chart-container">
                <div class="chart-title">ì „ì²´ ì†ìµ êµ¬ì¡° (Waterfall Chart) - 7ë‹¨ê³„</div>
                <div style="text-align:center;font-size:10px;color:#64748b;margin-bottom:8px;">
                  <span style="color:#10b981;">â— ë§¤ì¶œ/ì´ìµ</span> 
                  <span style="color:#ef4444;margin-left:12px;">â— ë¹„ìš©(ì°¨ê°)</span>
                  <span style="color:#3b82f6;margin-left:12px;">â— ì¤‘ê°„í•©ê³„</span>
                  <span style="color:#4f46e5;margin-left:12px;">â— ìµœì¢…ê²°ê³¼</span>
                </div>
                <div class="chart-wrapper"><canvas id="waterfallChart"></canvas></div>
              </div>
              <div class="chart-container">
                <div class="chart-title">ì›”ì¤‘ ëˆ„ì  ë§¤ì¶œ ì¶”ì´</div>
                <div class="chart-wrapper"><canvas id="cumulativeTrendChart"></canvas></div>
              </div>
              <!-- ì „ì²´í˜„í™© íŠ¸ë¦¬ë§µ: ì±„ë„ë³„ ë§¤ì¶œêµ¬ì„± -->
              <div class="chart-container" id="overviewTreemapContainerChannel" style="height:100%;">
                <div class="chart-title" id="overviewTreemapTitleChannel">ì±„ë„ë³„ ë§¤ì¶œêµ¬ì„±(í˜„ì‹œì )</div>
                <button id="overviewTreemapDrillbackChannel" class="drillback-btn" style="margin-bottom:8px;display:none;">â† ë’¤ë¡œê°€ê¸°</button>
                <div class="chart-wrapper" id="overviewTreemapWrapperChannel" style="flex:1;min-height:300px;height:100%;"></div>
              </div>
              <!-- ì „ì²´í˜„í™© íŠ¸ë¦¬ë§µ: ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„± -->
              <div class="chart-container" id="overviewTreemapContainerItem" style="height:100%;">
                <div class="chart-title" id="overviewTreemapTitleItem">ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„±(í˜„ì‹œì )</div>
                <button id="overviewTreemapDrillbackItem" class="drillback-btn" style="margin-bottom:8px;display:none;">â† ë’¤ë¡œê°€ê¸°</button>
                <div class="chart-wrapper" id="overviewTreemapWrapperItem" style="flex:1;min-height:300px;height:100%;"></div>
              </div>
            </div>

            <!-- ë‹¹ì‹œì¦Œì˜ë¥˜/ACCì¬ê³ ì£¼ìˆ˜ ë¶„ì„ ë²„ë¸” ì°¨íŠ¸ -->
            <div class="chart-container" style="grid-column: 1 / -1; min-height: 900px;">
              <div class="chart-title">ë‹¹ì‹œì¦Œì˜ë¥˜/ACCì¬ê³ ì£¼ìˆ˜ ë¶„ì„</div>
              <div style="display:flex;justify-content:center;align-items:center;margin:8px 0 15px 0;">
                <div style="display:flex;gap:6px;align-items:center;">
                  <button id="overviewBtnSaleRate" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">íŒë§¤ìœ¨</button>
                  <button id="overviewBtnInventory" style="background:#2563eb;color:#fff;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">ì¬ê³ ì£¼ìˆ˜</button>
                </div>
              </div>
              <!-- ë²„ë¸” ì°¨íŠ¸ìš© ì»¨íŠ¸ë¡¤ (ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œì¼ ë•Œë§Œ í‘œì‹œ) -->
              <div id="bubbleControlsContainer" style="margin-bottom:15px;">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                  <div style="font-size:11px;color:#6b7280;">
                    Xì¶•: ì¬ê³ ì£¼ìˆ˜ | Yì¶•: ë§¤ì¶œYOY | í¬ê¸°: ë§¤ì¶œë¹„ì¤‘
                  </div>
                  <div style="display:flex;gap:0;background:#f3f4f6;padding:4px;border-radius:8px;">
                    <button id="bubbleViewBtn4" class="view-btn-4quad active" onclick="switchBubbleView('4quadrant')" style="padding:8px 16px;border:none;background:white;color:#1e293b;font-size:12px;font-weight:600;cursor:pointer;border-radius:6px;box-shadow:0 1px 3px rgba(0,0,0,0.1);transition:all 0.2s;">4ë¶„ë©´</button>
                    <button id="bubbleViewBtn9" class="view-btn-9quad" onclick="switchBubbleView('9quadrant')" style="padding:8px 16px;border:none;background:transparent;color:#6b7280;font-size:12px;font-weight:600;cursor:pointer;border-radius:6px;transition:all 0.2s;">9ë¶„ë©´</button>
                  </div>
                </div>
                <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;padding:8px 12px;background:#f9fafb;border-radius:6px;">
                  <span style="font-size:11px;font-weight:600;color:#6b7280;">ë¸Œëœë“œ:</span>
                  <button class="brand-filter-btn-overview all active" onclick="filterBubbleBrand('all')" style="padding:4px 8px;border:2px solid #1f2937;background:#1f2937;color:white;border-radius:4px;font-size:11px;font-weight:600;cursor:pointer;transition:all 0.2s;">ì „ì²´</button>
                  <button class="brand-filter-btn-overview M" onclick="filterBubbleBrand('M')" style="padding:4px 8px;border:2px solid #dc2626;background:white;color:#dc2626;border-radius:4px;font-size:11px;font-weight:600;cursor:pointer;transition:all 0.2s;">MLB</button>
                  <button class="brand-filter-btn-overview I" onclick="filterBubbleBrand('I')" style="padding:4px 8px;border:2px solid #eab308;background:white;color:#eab308;border-radius:4px;font-size:11px;font-weight:600;cursor:pointer;transition:all 0.2s;">MLB KIDS</button>
                  <button class="brand-filter-btn-overview X" onclick="filterBubbleBrand('X')" style="padding:4px 8px;border:2px solid #3b82f6;background:white;color:#3b82f6;border-radius:4px;font-size:11px;font-weight:600;cursor:pointer;transition:all 0.2s;">DISCOVERY</button>
                  <button class="brand-filter-btn-overview V" onclick="filterBubbleBrand('V')" style="padding:4px 8px;border:2px solid #1f2937;background:white;color:#1f2937;border-radius:4px;font-size:11px;font-weight:600;cursor:pointer;transition:all 0.2s;">DUVETICA</button>
                  <button class="brand-filter-btn-overview ST" onclick="filterBubbleBrand('ST')" style="display:none;padding:4px 8px;border:2px solid #8b5cf6;background:white;color:#8b5cf6;border-radius:4px;font-size:11px;font-weight:600;cursor:pointer;transition:all 0.2s;">SUPRA</button>
                  <button class="brand-filter-btn-overview W" onclick="filterBubbleBrand('W')" style="padding:4px 8px;border:2px solid #10b981;background:white;color:#10b981;border-radius:4px;font-size:11px;font-weight:600;cursor:pointer;transition:all 0.2s;">SERGIO</button>
                </div>
              </div>
              <!-- íŒë§¤ìœ¨ íˆíŠ¸ë§µ (íŒë§¤ìœ¨ ë²„íŠ¼ í´ë¦­ ì‹œ í‘œì‹œ) -->
              <div id="overviewHeatmapContainer" style="display:none;margin-bottom:20px;">
                <div class="heatmap-table" style="overflow-x:auto;">
                  <table id="overviewHeatmapTable" style="width:100%;border-collapse:separate;border-spacing:0;font-size:13px;">
                    <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                  </table>
                </div>
              </div>
              <!-- ë²„ë¸” ì°¨íŠ¸ (ì¬ê³ ì£¼ìˆ˜ ë²„íŠ¼ í´ë¦­ ì‹œ í‘œì‹œ) -->
              <div id="overviewBubbleContainer">
              <div class="chart-wrapper" style="height:700px;">
                <canvas id="overviewBubbleChart"></canvas>
                </div>
              </div>
              <!-- 4ë¶„ë©´ KPI -->
              <div id="overviewKpi4" class="overview-kpi-4" style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:15px;">
                <div class="overview-kpi-card critical" onclick="openBubbleModal('critical')" style="padding:12px;border-radius:6px;border-left:3px solid #dc2626;background:#fee2e2;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewCriticalCount">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">ğŸš¨ ì €ì„±ì¥+ê³ ì¬ê³ </div>
                </div>
                <div class="overview-kpi-card caution" onclick="openBubbleModal('caution')" style="padding:12px;border-radius:6px;border-left:3px solid #f59e0b;background:#fef3c7;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewCautionCount">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">âš ï¸ ê³ ì„±ì¥+ê³ ì¬ê³ </div>
                </div>
                <div class="overview-kpi-card growth" onclick="openBubbleModal('growth')" style="padding:12px;border-radius:6px;border-left:3px solid #3b82f6;background:#dbeafe;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewGrowthCount">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">ğŸ”¥ ê³ ì„±ì¥+ì €ì¬ê³ </div>
                </div>
                <div class="overview-kpi-card review" onclick="openBubbleModal('review')" style="padding:12px;border-radius:6px;border-left:3px solid #6b7280;background:#f3f4f6;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewReviewCount">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">ğŸ“‹ ì €ì„±ì¥+ì €ì¬ê³ </div>
                </div>
              </div>
              <!-- 9ë¶„ë©´ KPI -->
              <div id="overviewKpi9" class="overview-kpi-9" style="display:none;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:15px;">
                <div class="overview-kpi-card q1" onclick="openBubbleModal('q1')" style="padding:12px;border-radius:6px;border-left:3px solid #2563eb;background:#dbeafe;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewQ1Count">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">ğŸ”¥ ì ê·¹ë°œì£¼<br>(ì €ì¬ê³ +ê°•ì„±ì¥)</div>
                </div>
                <div class="overview-kpi-card q4" onclick="openBubbleModal('q4')" style="padding:12px;border-radius:6px;border-left:3px solid #059669;background:#d1fae5;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewQ4Count">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">ğŸ’š ì•ˆì •ì„±ì¥<br>(ì¤‘ì¬ê³ +ê°•ì„±ì¥)</div>
                </div>
                <div class="overview-kpi-card q7" onclick="openBubbleModal('q7')" style="padding:12px;border-radius:6px;border-left:3px solid #fb923c;background:#fff7ed;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewQ7Count">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">ğŸŸ¡ ë°œì£¼ì¤‘ë‹¨<br>(ê³ ì¬ê³ +ê°•ì„±ì¥)</div>
                </div>
                <div class="overview-kpi-card q2" onclick="openBubbleModal('q2')" style="padding:12px;border-radius:6px;border-left:3px solid #10b981;background:#d1fae5;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewQ2Count">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">âœ… ë°œì£¼ìœ ì§€<br>(ì €ì¬ê³ +ì•½ì„±ì¥)</div>
                </div>
                <div class="overview-kpi-card q5" onclick="openBubbleModal('q5')" style="padding:12px;border-radius:6px;border-left:3px solid #6366f1;background:#e0e7ff;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewQ5Count">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">ğŸ”µ í˜„ìƒìœ ì§€<br>(ì¤‘ì¬ê³ +ì•½ì„±ì¥)</div>
                </div>
                <div class="overview-kpi-card q8" onclick="openBubbleModal('q8')" style="padding:12px;border-radius:6px;border-left:3px solid #ea580c;background:#fed7aa;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewQ8Count">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">ğŸŸ  ì¬ê³ ê´€ë¦¬<br>(ê³ ì¬ê³ +ì•½ì„±ì¥)</div>
                </div>
                <div class="overview-kpi-card q3" onclick="openBubbleModal('q3')" style="padding:12px;border-radius:6px;border-left:3px solid #6b7280;background:#f3f4f6;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewQ3Count">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">ğŸ“‹ ë‹¨ì¢…ê²€í† <br>(ì €ì¬ê³ +ê°ì†Œ)</div>
                </div>
                <div class="overview-kpi-card q6" onclick="openBubbleModal('q6')" style="padding:12px;border-radius:6px;border-left:3px solid #f59e0b;background:#fef3c7;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewQ6Count">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">âš ï¸ ì£¼ì˜ê´€ì°°<br>(ì¤‘ì¬ê³ +ê°ì†Œ)</div>
                </div>
                <div class="overview-kpi-card q9" onclick="openBubbleModal('q9')" style="padding:12px;border-radius:6px;border-left:3px solid #dc2626;background:#fee2e2;text-align:center;cursor:pointer;transition:transform 0.2s;">
                  <div style="font-size:18px;font-weight:700;margin-bottom:3px;" id="overviewQ9Count">0</div>
                  <div style="font-size:10px;font-weight:600;color:#374151;line-height:1.3;">ğŸš¨ ê¸´ê¸‰ì¡°ì¹˜<br>(ê³ ì¬ê³ +ê°ì†Œ)</div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>

      <!-- ë¸Œëœë“œë³„ ë¶„ì„ ì„¹ì…˜ -->
      <div id="content-brand" class="content-section">
        <div class="insights-section">
          <div class="insights-content editable" id="brand-insights" contenteditable="false">
            <!-- ë¸Œëœë“œë³„ ì¸ì‚¬ì´íŠ¸ ë‚´ìš©ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
          </div>
        </div>

        <div class="brand-controls">
          <div class="brand-buttons">
            <button class="brand-btn active" data-brand="MLB">MLB</button>
            <button class="brand-btn" data-brand="MLB_KIDS">MLB KIDS</button>
            <button class="brand-btn" data-brand="DISCOVERY">DISCOVERY</button>
            <button class="brand-btn" data-brand="DUVETICA">DUVETICA</button>
            <button class="brand-btn" data-brand="SERGIO">SERGIO</button>
            <button class="brand-btn" data-brand="SUPRA" style="display:none;">SUPRA</button>
          </div>
        </div>

        <div class="content-body">
          <div class="charts-area">
            <div class="kpi-section">
              <!-- ì‹¤íŒë§¤ì¶œ(í• ì¸ìœ¨) í†µí•© KPI -->
              <div class="kpi-card">
                <div class="kpi-title">ì‹¤íŒë§¤ì¶œ(í• ì¸ìœ¨)</div>
                <div class="kpi-value-line">
                  <div class="kpi-value-with-rate">
                    <span id="brand-current-revenue" class="kpi-value editable" contenteditable="false">349.3ì–µì›</span>
                    <span id="brand-current-discount-rate" class="kpi-rate" style="color:#3b82f6 !important;font-weight:600 !important;">(0.0%)</span>
                  </div>
                  <span class="kpi-label">(í˜„ì‹œì )</span>
                </div>
                <div class="kpi-value-line">
                  <div class="kpi-value-with-rate">
                    <span id="brand-revenue" class="kpi-value editable" contenteditable="false">349.3ì–µì›</span>
                    <span id="brand-discount-rate" class="kpi-rate" style="color:#3b82f6 !important;font-weight:600 !important;">(0.0%)</span>
                  </div>
                  <span class="kpi-label">(ì›”ë§ì˜ˆìƒ)</span>
                </div>
                <div id="brand-revenue-change" class="kpi-change-line kpi-positive editable" contenteditable="false">ëª©í‘œ ëŒ€ë¹„ +5%</div>
                <div id="brand-revenue-yoy" class="kpi-change kpi-positive editable" contenteditable="false">ì „ë…„ ëŒ€ë¹„ +5%</div>
                <div class="progress-bar"><div id="brand-revenue-progress" class="progress-fill" style="width:105%"></div></div>
              </div>
              
              <!-- ì§ì ‘ì´ìµ(ì´ìµìœ¨) í†µí•© KPI -->
              <div class="kpi-card">
                <div class="kpi-title">ì§ì ‘ì´ìµ(ì´ìµìœ¨)</div>
                <div class="kpi-value-line">
                  <div class="kpi-value-with-rate">
                    <span id="brand-current-profit" class="kpi-value editable" contenteditable="false">94.2ì–µì›</span>
                    <span id="brand-current-profit-margin-rate" class="kpi-rate" style="color:#3b82f6 !important;font-weight:600 !important;">(0.0%)</span>
                  </div>
                  <span class="kpi-label">(í˜„ì‹œì )</span>
                </div>
                <div class="kpi-value-line">
                  <div class="kpi-value-with-rate">
                    <span id="brand-profit" class="kpi-value editable" contenteditable="false">94.2ì–µì›</span>
                    <span id="brand-profit-margin-rate" class="kpi-rate" style="color:#3b82f6 !important;font-weight:600 !important;">(0.0%)</span>
                  </div>
                  <span class="kpi-label">(ì›”ë§ì˜ˆìƒ)</span>
                </div>
                <div id="brand-profit-change" class="kpi-change-line kpi-positive editable" contenteditable="false">ëª©í‘œ ëŒ€ë¹„ +1%</div>
                <div id="brand-profit-yoy" class="kpi-change kpi-neutral editable" contenteditable="false">ì „ë…„ ëŒ€ë¹„ 0%</div>
                <div class="progress-bar"><div id="brand-profit-progress" class="progress-fill" style="width:101%"></div></div>
              </div>
              
              <!-- ì˜ì—…ì´ìµ(ì´ìµìœ¨) í†µí•© KPI -->
              <div class="kpi-card">
                <div class="kpi-title">ì˜ì—…ì´ìµ(ì´ìµìœ¨)</div>
                <div class="kpi-value-line">
                  <div class="kpi-value-with-rate">
                    <span id="brand-current-opprofit" class="kpi-value editable" contenteditable="false">51.1ì–µì›</span>
                    <span id="brand-current-opprofit-margin-rate" class="kpi-rate" style="color:#3b82f6 !important;font-weight:600 !important;">(0.0%)</span>
                  </div>
                  <span class="kpi-label">(í˜„ì‹œì )</span>
                </div>
                <div class="kpi-value-line">
                  <div class="kpi-value-with-rate">
                    <span id="brand-opprofit" class="kpi-value editable" contenteditable="false">51.1ì–µì›</span>
                    <span id="brand-opprofit-margin-rate" class="kpi-rate" style="color:#3b82f6 !important;font-weight:600 !important;">(0.0%)</span>
                  </div>
                  <span class="kpi-label">(ì›”ë§ì˜ˆìƒ)</span>
                </div>
                <div id="brand-opprofit-change" class="kpi-change-line kpi-positive editable" contenteditable="false">ëª©í‘œ ëŒ€ë¹„ +2%</div>
                <div id="brand-opprofit-yoy" class="kpi-change kpi-positive editable" contenteditable="false">ì „ë…„ ëŒ€ë¹„ +3%</div>
                <div class="progress-bar"><div id="brand-opprofit-progress" class="progress-fill" style="width:102%"></div></div>
              </div>
              
              <!-- ì§ì ‘ì´ìµ ì§„ì²™ìœ¨ í†µí•© KPI -->
              <div class="kpi-card">
                <div class="kpi-title">ì§ì ‘ì´ìµ ì§„ì²™ìœ¨</div>
                <div class="kpi-value-line">
                  <span id="brand-current-progress" class="kpi-value editable" contenteditable="false">105%</span>
                  <span class="kpi-label">(í˜„ì‹œì )</span>
                </div>
                <div class="kpi-value-line">
                  <span id="brand-progress" class="kpi-value editable" contenteditable="false">105%</span>
                  <span class="kpi-label">(ì›”ë§ì˜ˆìƒ)</span>
                </div>
                <div id="brand-progress-change" class="kpi-change-line kpi-positive editable" contenteditable="false">ëª©í‘œ ëŒ€ë¹„ +5%</div>
                <div id="brand-progress-yoy" class="kpi-change kpi-positive editable" contenteditable="false">ì „ë…„ ëŒ€ë¹„ +5%</div>
                <div class="progress-bar"><div id="brand-progress-progress" class="progress-fill" style="width:105%"></div></div>
              </div>
            </div>

            <div class="charts-grid">
              <!-- 1í–‰ 1ì—´: ì±„ë„ë³„ ë§¤ì¶œêµ¬ì„± (íˆíŠ¸ë§µ) -->
              <div class="chart-container">
                <div class="chart-title" id="treemapTitleChannel">ì±„ë„ë³„ ë§¤ì¶œêµ¬ì„±</div>
                <button id="treemapDrillbackChannel" class="drillback-btn" style="margin-bottom:8px;display:none;">â† ë’¤ë¡œê°€ê¸°</button>
                <div class="chart-wrapper" id="treemapWrapperChannel" style="height:250px;"></div>
                <div id="treemapDateInfoChannel" style="font-size:11px;color:#6b7280;padding:8px 0 0 0;text-align:center;line-height:1.4;"></div>
              </div>
              <!-- 1í–‰ 2ì—´: ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„± (íˆíŠ¸ë§µ) -->
              <div class="chart-container">
                <div class="chart-title" id="treemapTitleItem">ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„±</div>
                <button id="treemapDrillbackItem" class="drillback-btn" style="margin-bottom:8px;display:none;">â† ë’¤ë¡œê°€ê¸°</button>
                <div class="chart-wrapper" id="treemapWrapperItem" style="height:250px;"></div>
                <div id="treemapDateInfoItem" style="font-size:11px;color:#6b7280;padding:8px 0 0 0;text-align:center;line-height:1.4;"></div>
              </div>
              <!-- 2í–‰ 1ì—´: ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ (ë ˆì´ë”ì°¨íŠ¸) -->
              <div class="chart-container">
                <div class="chart-title">ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„</div>
                <div style="display:flex;justify-content:center;align-items:center;margin:4px 0 8px 0;gap:12px;font-size:12px;">
                  <div style="display:flex;align-items:center;gap:6px;"><span style="display:inline-block;width:10px;height:10px;background:#3B82F6;border-radius:2px;"></span> ê³„íš</div>
                  <div style="display:flex;align-items:center;gap:6px;"><span style="display:inline-block;width:10px;height:10px;background:#10B981;border-radius:2px;"></span> ì „ë…„</div>
                </div>
                <div style="display:flex;justify-content:flex-end;align-items:center;margin:0 0 8px 0;">
                  <div style="display:flex;gap:6px;">
                    <button id="radarBtnChannel" style="background:#2563eb;color:#fff;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ì±„ë„ë³„</button>
                    <button id="radarBtnItem" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ì•„ì´í…œë³„</button>
                  </div>
                </div>
                <div class="chart-wrapper"><canvas id="radarChart"></canvas></div>
              </div>
              <!-- 2í–‰ 2ì—´: ì£¼ìš” ì±„ë„ë³„ ì†ìµ (í‘œ) -->
              <div class="chart-container">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                  <div class="chart-title" style="margin:0;">ì£¼ìš” ì±„ë„ë³„ ì†ìµ</div>
                  <div style="display:flex;gap:5px;">
                    <button id="channelPlRevenue" class="channel-pl-toggle-btn active" style="background:#4f46e5;color:white;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">ë§¤ì¶œ</button>
                    <button id="channelPlProfit" class="channel-pl-toggle-btn" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">ì§ì ‘ì´ìµ</button>
                  </div>
                </div>
                <div class="chart-wrapper" style="min-height:200px;">
                  <table class="pl-table" id="channel-pl-inline">
                    <thead>
                      <tr>
                        <th class="item-name">ì±„ë„</th>
                        <th>ì „ë…„</th>
                        <th>ëª©í‘œ</th>
                        <th>ì›”ë§ì˜ˆìƒ</th>
                        <th>ì „ë…„ëŒ€ë¹„</th>
                        <th>ë‹¬ì„±ë¥ </th>
                      </tr>
                    </thead>
                    <tbody id="channel-pl-inline-body"></tbody>
                  </table>
                </div>
              </div>
            </div>
            
            <!-- ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ (ì „ì²´ ë„ˆë¹„) -->
            <div class="chart-container" style="margin-top: 15px; width: 100%;">
                <div class="chart-title">ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸</div>
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;flex-wrap:wrap;gap:10px;">
                  <div style="display:flex;gap:6px;flex-wrap:wrap;">
                    <button id="weeklyChannelFilterAll" class="weekly-channel-filter-btn active" data-channel="all" style="background:#2563eb;color:#fff;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ì „ì²´</button>
                    <button id="weeklyChannelFilterDept" class="weekly-channel-filter-btn" data-channel="ë°±í™”ì " style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ë°±í™”ì </button>
                    <button id="weeklyChannelFilterDutyFree" class="weekly-channel-filter-btn" data-channel="ë©´ì„¸ì " style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ë©´ì„¸ì </button>
                    <button id="weeklyChannelFilterDirect" class="weekly-channel-filter-btn" data-channel="ì§ì˜ì " style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ì§ì˜ì </button>
                    <button id="weeklyChannelFilterAgent" class="weekly-channel-filter-btn" data-channel="ëŒ€ë¦¬ì " style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ëŒ€ë¦¬ì </button>
                    <button id="weeklyChannelFilterOutlet" class="weekly-channel-filter-btn" data-channel="ì•„ìš¸ë ›" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ì•„ìš¸ë ›</button>
                    <button id="weeklyChannelFilterStore" class="weekly-channel-filter-btn" data-channel="ì§ì˜ëª°" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ì§ì˜ëª°</button>
                    <button id="weeklyChannelFilterOwn" class="weekly-channel-filter-btn" data-channel="ìì‚¬ëª°" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ìì‚¬ëª°</button>
                    <button id="weeklyChannelFilterPartner" class="weekly-channel-filter-btn" data-channel="ì œíœ´ëª°" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ì œíœ´ëª°</button>
                    <button id="weeklyChannelFilterRF" class="weekly-channel-filter-btn" data-channel="RF" style="display:none;background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">RF</button>
                  </div>
                  <div style="display:flex;gap:6px;">
                  <button id="weeklyModeBtnWeekly" style="background:#2563eb;color:#fff;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ì£¼ì°¨ë³„</button>
                  <button id="weeklyModeBtnCumulative" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;">ëˆ„ì </button>
                </div>
              </div>
                <div class="chart-wrapper" style="min-height:400px;"><canvas id="weeklyTrendChart"></canvas></div>
                <div style="margin-top:10px;padding:8px;background:#f8fafc;border-left:3px solid #64748b;font-size:11px;color:#64748b;text-align:center;">
                  <strong>â€» Xì¶•ì˜ ì¼ìëŠ” ì£¼ê°„ ì¢…ë£Œì¼(ì¼ìš”ì¼)ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. (ê¸°ê°„: ì›”~ì¼)</strong>
                </div>
                
                <!-- ì£¼ì°¨ë³„ ë§¤ì¶œ ë°ì´í„° í‘œ -->
                <div id="weeklyDataTable" style="margin-top:15px;overflow-x:auto;">
                  <table style="width:100%;border-collapse:collapse;font-size:13px;text-align:center;">
                    <thead>
                      <tr style="background:#f8fafc;border-bottom:2px solid #e2e8f0;">
                        <th style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#64748b;font-size:14px;">êµ¬ë¶„</th>
                        <th style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#64748b;font-size:14px;">9/7</th>
                        <th style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#64748b;font-size:14px;">9/14</th>
                        <th style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#64748b;font-size:14px;">9/21</th>
                        <th style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#64748b;font-size:14px;">9/28</th>
                        <th style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#64748b;font-size:14px;">10/5</th>
                        <th style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#64748b;font-size:14px;">10/12</th>
                        <th style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#64748b;font-size:14px;">10/19</th>
                        <th style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#64748b;font-size:14px;">10/26</th>
                        <th style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#64748b;font-size:14px;">11/2</th>
                      </tr>
                    </thead>
                    <tbody id="weeklyDataTableBody">
                      <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
                    </tbody>
                  </table>
                </div>
            </div>
            
            <!-- (ìš”ì²­) ì•„ì´í…œë³„ íŒë§¤ ë¶„ì„ ê·¸ë˜í”„ëŠ” ìˆ¨ê¹€ ì²˜ë¦¬ -->
            <div class="chart-container" style="display:none;">
              <div class="chart-title">ì•„ì´í…œë³„ íŒë§¤ ë¶„ì„</div>
              <div class="chart-wrapper" style="height:600px;"><div id="itemHeatmapChart" style="height:100%;"></div></div>
                </div>
            
            <!-- íŒë§¤ìœ¨/ì¬ê³ ì£¼ìˆ˜ ë¶„ì„ (í‘œ) -->
            <div class="chart-container" style="margin-top: 15px; width: 100%;">
              <div class="chart-title" style="text-align:center;">ë‹¹ì‹œì¦Œì˜ë¥˜/ACCì¬ê³ ì£¼ìˆ˜ ë¶„ì„</div>
              <div style="display:flex;justify-content:center;align-items:center;margin:8px 0;">
                <div style="display:flex;gap:6px;align-items:center;">
                  <button id="itemTableBtnSaleRate" style="background:#2563eb;color:#fff;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">íŒë§¤ìœ¨</button>
                  <button id="itemTableBtnInventory" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">ì¬ê³ ì£¼ìˆ˜</button>
                </div>
              </div>
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;gap:10px;flex-wrap:wrap;">
                <div id="itemTableCategoryFilters" style="display:flex;gap:6px;align-items:center;">
                  <!-- ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
                </div>
                <div style="display:flex;gap:8px;align-items:center;">
                  <span style="font-size:12px;color:#64748b;">ì •ë ¬</span>
                  <select id="itemTableSort" aria-label="ì•„ì´í…œ ì •ë ¬ ê¸°ì¤€ ì„ íƒ" title="ì•„ì´í…œ ì •ë ¬ ê¸°ì¤€ ì„ íƒ" style="border:1px solid #e2e8f0;border-radius:6px;padding:6px 10px;font-size:12px;">
                    <option value="category">ì¹´í…Œê³ ë¦¬ìˆœ</option>
                    <option value="po">ë°œì£¼ê¸ˆì•¡ìˆœ</option>
                    <option value="weekly">ì£¼ê°„íŒë§¤ìˆœ</option>
                    <option value="cum">ëˆ„ì íŒë§¤ìˆœ</option>
                    <option value="rateNow">íŒë§¤ìœ¨ìˆœ</option>
                  </select>
                </div>
              </div>
              <!-- íŒë§¤ìœ¨/ì¬ê³ ì£¼ìˆ˜ ê·¸ë˜í”„ (ëª¨ë“œì— ë”°ë¼ í‘œì‹œ) -->
              <div id="saleRateChartContainer" style="display:none;margin-bottom:20px;">
                <div class="chart-wrapper" style="height:400px;">
                  <canvas id="saleRateChart"></canvas>
                </div>
              </div>
              <div class="chart-wrapper" style="min-height:200px;">
                <table class="pl-table" id="itemDiffTable">
                  <thead>
                    <tr>
                      <th rowspan="2">ì¹´í…Œê³ ë¦¬</th>
                      <th rowspan="2">ì•„ì´í…œì½”ë“œ</th>
                      <th rowspan="2">ì•„ì´í…œëª…</th>
                      <th colspan="2">ë°œì£¼ê¸ˆì•¡(TAG)</th>
                      <th colspan="2">ì£¼ê°„íŒë§¤ë§¤ì¶œ(TAG)</th>
                      <th colspan="2">ëˆ„ì íŒë§¤ë§¤ì¶œ(TAG)</th>
                      <th colspan="3">ëˆ„ì íŒë§¤ìœ¨</th>
                    </tr>
                    <tr>
                      <th>ë‹¹ë…„(ë°±ë§Œ)</th><th>ì „ë…„ë¹„</th>
                      <th>ë‹¹ë…„(ë°±ë§Œ)</th><th>ì „ë…„ë¹„</th>
                      <th>ë‹¹ë…„(ë°±ë§Œ)</th><th>ì „ë…„ë¹„</th>
                      <th>ë‹¹ë…„(%)</th><th>ì°¨ì´</th><th>ì „ë…„ë§ˆê°</th>
                    </tr>
                  </thead>
                  <tbody id="itemDiffTableBody"></tbody>
                </table>
                <div id="inventoryTableNote" style="display:none;margin-top:10px;padding:8px;background:#f0f9ff;border-left:3px solid #60a5fa;font-size:12px;color:#1e293b;">
                  <strong>ì¬ê³ ì£¼ìˆ˜ :</strong> ì¬ê³ ìˆ˜ëŸ‰ / 4ì£¼í‰ê· íŒë§¤ìˆ˜
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ì†ìµê³„ì‚°ì„œ íŒ¨ë„ -->
    <div class="financial-report">
      <div id="overview-pl">
        <h3>ğŸ“Š ì „ì²´ ì†ìµê³„ì‚°ì„œ</h3>
        <table class="pl-table">
          <thead><tr><th class="item-name">êµ¬ë¶„</th><th>ì „ë…„</th><th>ëª©í‘œ</th><th>ì›”ë§ì˜ˆìƒ</th><th>ì „ë…„ëŒ€ë¹„</th><th>ë‹¬ì„±ë¥ </th></tr></thead>
          <tbody>
            <tr><td class="item-name">ë§¤ì¶œì•¡</td><td class="editable" contenteditable="false">402.2</td><td class="editable" contenteditable="false">487.5</td><td class="editable" contenteditable="false">434.6</td><td class="editable" contenteditable="false">108%</td><td class="editable" contenteditable="false">89%</td></tr>
            <tr><td class="item-name sub-item">(ë§¤ì¶œì›ê°€)</td><td class="editable" contenteditable="false">(221.2)</td><td class="editable" contenteditable="false">(268.1)</td><td class="editable" contenteditable="false">(239.0)</td><td class="editable" contenteditable="false">108%</td><td class="editable" contenteditable="false">89%</td></tr>
            <tr class="total-row"><td class="item-name">ë§¤ì¶œì´ì´ìµ</td><td class="editable" contenteditable="false">181.0</td><td class="editable" contenteditable="false">219.4</td><td class="editable" contenteditable="false">195.6</td><td class="editable" contenteditable="false">108%</td><td class="editable" contenteditable="false">89%</td></tr>
            <tr><td class="item-name sub-item">(ì§ì ‘ë¹„)</td><td class="editable" contenteditable="false">(140.5)</td><td class="editable" contenteditable="false">(163.3)</td><td class="editable" contenteditable="false">(152.5)</td><td class="editable" contenteditable="false">109%</td><td class="editable" contenteditable="false">93%</td></tr>
            <tr><td class="item-name sub-item">- ì¸ê±´ë¹„</td><td class="editable" contenteditable="false">(55.6)</td><td class="editable" contenteditable="false">(58.5)</td><td class="editable" contenteditable="false">(58.5)</td><td class="editable" contenteditable="false">105%</td><td class="editable" contenteditable="false">100%</td></tr>
            <tr><td class="item-name sub-item">- ì„ì°¨ë£Œ</td><td class="editable" contenteditable="false">(31.2)</td><td class="editable" contenteditable="false">(31.2)</td><td class="editable" contenteditable="false">(31.2)</td><td class="editable" contenteditable="false">100%</td><td class="editable" contenteditable="false">100%</td></tr>
            <tr><td class="item-name sub-item">- ë¡œì—´í‹°</td><td class="editable" contenteditable="false">(20.1)</td><td class="editable" contenteditable="false">(24.4)</td><td class="editable" contenteditable="false">(21.7)</td><td class="editable" contenteditable="false">108%</td><td class="editable" contenteditable="false">89%</td></tr>
            <tr><td class="item-name sub-item">- ê°ê°€ìƒê°ë¹„</td><td class="editable" contenteditable="false">(12.0)</td><td class="editable" contenteditable="false">(12.4)</td><td class="editable" contenteditable="false">(12.4)</td><td class="editable" contenteditable="false">103%</td><td class="editable" contenteditable="false">100%</td></tr>
            <tr><td class="item-name sub-item">- ê¸°íƒ€</td><td class="editable" contenteditable="false">(5.5)</td><td class="editable" contenteditable="false">(17.3)</td><td class="editable" contenteditable="false">(11.3)</td><td class="editable" contenteditable="false">205%</td><td class="editable" contenteditable="false">65%</td></tr>
            <tr class="total-row"><td class="item-name">ì§ì ‘ì´ìµ</td><td class="editable" contenteditable="false">40.5</td><td class="editable" contenteditable="false">56.1</td><td class="editable" contenteditable="false">43.1</td><td class="editable" contenteditable="false">106%</td><td class="editable" contenteditable="false">77%</td></tr>
            <tr><td class="item-name sub-item">(ì˜ì—…ë¹„)</td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr class="total-row"><td class="item-name">ì˜ì—…ì´ìµ</td><td class="editable" contenteditable="false">40.5</td><td class="editable" contenteditable="false">56.1</td><td class="editable" contenteditable="false">43.1</td><td class="editable" contenteditable="false">106%</td><td class="editable" contenteditable="false">77%</td></tr>
            <tr><td class="item-name">í• ì¸ìœ¨</td><td class="editable" contenteditable="false" id="overview-discount-prev">-</td><td class="editable" contenteditable="false" id="overview-discount-target">-</td><td class="editable" contenteditable="false" id="overview-discount-forecast">-</td><td class="editable" contenteditable="false" id="overview-discount-yoy">-</td><td class="editable" contenteditable="false" id="overview-discount-achievement">-</td></tr>
          </tbody>
        </table>
      </div>

      <div id="brand-pl" style="display:none;">
        <h3>ğŸ“Š MLB ì†ìµê³„ì‚°ì„œ</h3>
        <table class="pl-table">
          <thead><tr><th class="item-name">êµ¬ë¶„</th><th>ì „ë…„</th><th>ëª©í‘œ</th><th>ì›”ë§ì˜ˆìƒ</th><th>ì „ë…„ëŒ€ë¹„</th><th>ë‹¬ì„±ë¥ </th></tr></thead>
          <tbody>
            <tr><td class="item-name">ë§¤ì¶œì•¡</td><td>225.6</td><td>269.4</td><td>236.9</td><td>+5.0%</td><td>88%</td></tr>
            <tr><td class="item-name sub-item">(ë§¤ì¶œì›ê°€)</td><td>(122.3)</td><td>(145.6)</td><td>(128.5)</td><td>+5.1%</td><td>88%</td></tr>
            <tr class="total-row"><td class="item-name">ë§¤ì¶œì´ì´ìµ</td><td>103.3</td><td>123.3</td><td>108.4</td><td>+4.9%</td><td>88%</td></tr>
            <tr><td class="item-name sub-item">(ì§ì ‘ë¹„)</td><td>(88.0)</td><td>(95.1)</td><td>(91.8)</td><td>+4.3%</td><td>97%</td></tr>
            <tr><td class="item-name sub-item">- ì¸ê±´ë¹„</td><td>(30.5)</td><td>(32.0)</td><td>(32.0)</td><td>+4.9%</td><td>100%</td></tr>
            <tr><td class="item-name sub-item">- ì„ì°¨ë£Œ</td><td>(17.1)</td><td>(17.1)</td><td>(17.1)</td><td>+0.0%</td><td>100%</td></tr>
            <tr><td class="item-name sub-item">- ë¡œì—´í‹°</td><td>(11.3)</td><td>(13.4)</td><td>(11.9)</td><td>+5.3%</td><td>89%</td></tr>
            <tr><td class="item-name sub-item">- ê°ê°€ìƒê°ë¹„</td><td>(6.6)</td><td>(6.8)</td><td>(6.8)</td><td>+3.0%</td><td>100%</td></tr>
            <tr><td class="item-name sub-item">- ê¸°íƒ€</td><td>(13.5)</td><td>(15.1)</td><td>(14.5)</td><td>+7.4%</td><td>96%</td></tr>
            <tr class="total-row"><td class="item-name">ì§ì ‘ì´ìµ</td><td>15.3</td><td>28.2</td><td>16.6</td><td>+8.5%</td><td>59%</td></tr>
            <tr><td class="item-name sub-item">(ì˜ì—…ë¹„)</td><td></td><td></td><td></td><td></td><td></td></tr>
            <tr class="total-row"><td class="item-name">ì˜ì—…ì´ìµ</td><td>15.3</td><td>28.2</td><td>16.6</td><td>+8.5%</td><td>59%</td></tr>
          </tbody>
        </table>

        <!-- íŒŒíŠ¸ë³„ ë¶„ì„ 1: ì†ìµê³„ì‚°ì„œ ë¶„ì„ (ì†ìµê³„ì‚°ì„œ ë°”ë¡œ ì•„ë˜) -->
        <div id="ai-part-note-1" class="ai-part-note" style="display:none;margin-top:20px;padding:12px;background:#fff7ed;border:1px solid #fdba74;border-radius:8px;">
          <div style="font-weight:700;margin-bottom:6px;font-size:13px;color:#92400e;">ğŸ“Š ì†ìµê³„ì‚°ì„œ ë¶„ì„</div>
          <div id="ai-part-note-1-content" style="font-size:12px;color:#92400e;line-height:1.6;"></div>
        </div>
      </div>
      
      <!-- ë¸Œëœë“œë³„ ë¶„ì„ AI ê·¸ë˜í”„ë³„ ì¸ì‚¬ì´íŠ¸ ë¶„ì„ ë…¸íŠ¸ë“¤ (ì ˆëŒ€ ìœ„ì¹˜ë¡œ ë°°ì¹˜í•˜ì—¬ ë ˆì´ì•„ì›ƒì— ì˜í–¥ ì—†ìŒ) -->
      <!-- ì±„ë„ë³„/ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„± (ìš°ì¸¡ íŒ¨ë„ ìƒë‹¨ - ë§¨ ìœ„ë¶€í„° ì¤‘ê°„ê¹Œì§€) -->
      <div id="ai-insight-treemap" class="ai-part-note" style="display:none;position:absolute;top:320px;left:20px;right:20px;padding:12px;background:#fff7ed;border:1px solid #fdba74;border-radius:8px;z-index:10;">
        <div style="font-weight:700;margin-bottom:6px;font-size:13px;color:#92400e;">ğŸ“Š ì±„ë„ë³„/ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„±</div>
        <div id="ai-insight-treemap-content" style="font-size:12px;color:#92400e;line-height:1.6;"></div>
      </div>
      
      <!-- ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ (ìš°ì¸¡ íŒ¨ë„ ìƒë‹¨ ì¤‘ê°„ - ì¤‘ê°„ë¶€í„° ì±„ë„ë³„/ì•„ì´í…œë³„ ë°•ìŠ¤ ëê¹Œì§€) -->
      <div id="ai-insight-radar" class="ai-part-note" style="display:none;position:absolute;top:450px;left:20px;right:20px;padding:12px;background:#fff7ed;border:1px solid #fdba74;border-radius:8px;z-index:10;">
        <div style="font-weight:700;margin-bottom:6px;font-size:13px;color:#92400e;">ğŸ“Š ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„</div>
        <div id="ai-insight-radar-content" style="font-size:12px;color:#92400e;line-height:1.6;"></div>
      </div>
      
      <!-- ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„ (ìš°ì¸¡ íŒ¨ë„ ì¤‘ê°„ - ì£¼ìš” ì±„ë„ë³„ ì†ìµ í…Œì´ë¸” ìœ„ì¹˜) -->
      <div id="ai-insight-channel-pl" class="ai-part-note" style="display:none;position:absolute;top:640px;left:20px;right:20px;padding:12px;background:#fff7ed;border:1px solid #fdba74;border-radius:8px;z-index:10;">
        <div style="font-weight:700;margin-bottom:6px;font-size:13px;color:#92400e;">ğŸ“Š ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„</div>
        <div id="ai-insight-channel-pl-content" style="font-size:12px;color:#92400e;line-height:1.6;"></div>
      </div>
      
      <!-- ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ (ìš°ì¸¡ íŒ¨ë„ ì¤‘ê°„ - ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ì°¨íŠ¸ ìœ„ì¹˜) -->
      <div id="ai-insight-weekly" class="ai-part-note" style="display:none;position:absolute;top:640px;left:20px;right:20px;padding:12px;background:#fff7ed;border:1px solid #fdba74;border-radius:8px;z-index:10;">
        <div style="font-weight:700;margin-bottom:6px;font-size:13px;color:#92400e;">ğŸ“Š ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸</div>
        <div id="ai-insight-weekly-content" style="font-size:12px;color:#92400e;line-height:1.6;"></div>
      </div>
      
      <!-- íŒë§¤ìœ¨ ë¶„ì„ (ìš°ì¸¡ íŒ¨ë„ í•˜ë‹¨ - íŒë§¤ìœ¨/ì¬ê³ ì£¼ìˆ˜ í…Œì´ë¸” ìœ„ì¹˜) -->
      <div id="ai-insight-sale-rate" class="ai-part-note" style="display:none;position:absolute;top:940px;left:20px;right:20px;padding:12px;background:#fff7ed;border:1px solid #fdba74;border-radius:8px;z-index:10;">
        <div style="font-weight:700;margin-bottom:6px;font-size:13px;color:#92400e;">ğŸ“Š íŒë§¤ìœ¨ ë¶„ì„</div>
        <div id="ai-insight-sale-rate-content" style="font-size:12px;color:#92400e;line-height:1.6;"></div>
      </div>
      
      <!-- ì¬ê³ ì£¼ìˆ˜ ë¶„ì„ (ìš°ì¸¡ íŒ¨ë„ í•˜ë‹¨ - íŒë§¤ìœ¨/ì¬ê³ ì£¼ìˆ˜ í…Œì´ë¸” ìœ„ì¹˜) -->
      <div id="ai-insight-inventory" class="ai-part-note" style="display:none;position:absolute;top:1020px;left:20px;right:20px;padding:12px;background:#fff7ed;border:1px solid #fdba74;border-radius:8px;z-index:10;">
        <div style="font-weight:700;margin-bottom:6px;font-size:13px;color:#92400e;">ğŸ“Š ì¬ê³ ì£¼ìˆ˜ ë¶„ì„</div>
        <div id="ai-insight-inventory-content" style="font-size:12px;color:#92400e;line-height:1.6;"></div>
      </div>
      <!-- ìš°ì¸¡ íŒ¨ë„ í•˜ë‹¨ AI ì½”ë©˜íŠ¸ ë©”ëª¨ë“¤ (ê°œìš”/ë¸Œëœë“œ ê³µìš©) -->
      <div id="ai-rightnotes">
        <div id="ai-rightnote-1" class="ai-rightnote"></div>
        <div id="ai-rightnote-2" class="ai-rightnote"></div>
        <div id="ai-rightnote-3" class="ai-rightnote"></div>
      </div>
    </div>
  </div>

  <script>
    // ---------- ë°ì´í„° í´ë°± ì„¸íŒ… ----------
    const D = window.DASHBOARD_DATA || {};

    // ========== í¸ì§‘ ëª¨ë“œ ê¸°ëŠ¥ (ê°œì„  ë²„ì „) ==========
    let isEditMode = false;
    const STORAGE_KEY = 'dashboard_edits';
    const ORIGINAL_DATA_KEY = 'dashboard_original';

    // ID ê¸°ë°˜ìœ¼ë¡œ ê³ ìœ  í‚¤ ìƒì„±
    function getElementKey(el) {
      // ì¸ì‚¬ì´íŠ¸ ì˜ì—­ì€ ì„¹ì…˜ê³¼ ë¸Œëœë“œ ì •ë³´ í¬í•¨
      if (el.id === 'overview-insights') {
        return 'insights:overview';
      }
      if (el.id === 'brand-insights') {
        return `insights:brand:${currentBrand}`;
      }
      
      // KPI ì¹´ë“œë“¤ì€ ë¸Œëœë“œë³„ë¡œ ë…ë¦½ì ì¸ í‚¤ ìƒì„±
      if (el.id && el.id.startsWith('brand-')) {
        return `kpi:${currentBrand}:${el.id}`;
      }
      
      if (el.id) return 'id:' + el.id;
      
      // IDê°€ ì—†ìœ¼ë©´ ë¶€ëª¨ êµ¬ì¡°ì™€ ìœ„ì¹˜ë¡œ ê³ ìœ í‚¤ ìƒì„±
      // í…Œì´ë¸” ì…€ì˜ ê²½ìš°: í…Œì´ë¸” ì‹ë³„ + ë¸Œëœë“œ + í–‰/ì—´ ìœ„ì¹˜ ì‚¬ìš©
      if (el.tagName === 'TD') {
        const row = el.parentElement;
        const table = row.closest('table');
        const tbody = row.parentElement;
        
        // í…Œì´ë¸” ì‹ë³„ (ê°€ì¥ ê°€ê¹Œìš´ idë¥¼ ê°€ì§„ ë¶€ëª¨ ì°¾ê¸°)
        let tableId = '';
        let parent = table;
        while (parent && !parent.id) {
          parent = parent.parentElement;
        }
        if (parent && parent.id) {
          tableId = parent.id;
        }
        
        // í–‰/ì—´ ìœ„ì¹˜
        const rowIndex = Array.from(tbody.children).indexOf(row);
        const cellIndex = Array.from(row.children).indexOf(el);
        
        // ì²« ë²ˆì§¸ ì…€ì˜ í…ìŠ¤íŠ¸ (í–‰ ì‹ë³„ìš©)
        const firstCellText = row.querySelector('.item-name')?.textContent || '';
        
        // brand-pl í…Œì´ë¸”ì´ê±°ë‚˜ channel-pl-tbodyì´ë©´ ë¸Œëœë“œ ì •ë³´ í¬í•¨
        if (tableId === 'brand-pl' || parent?.id === 'brand-pl' || tbody?.id === 'channel-pl-tbody') {
          return `table:${tableId}:${currentBrand}:${firstCellText}:${rowIndex}:${cellIndex}`;
        }
        
        return `table:${tableId}:${firstCellText}:${rowIndex}:${cellIndex}`;
      }
      
      // ì¼ë°˜ ìš”ì†ŒëŠ” ë¶€ëª¨ í´ë˜ìŠ¤ì™€ í…ìŠ¤íŠ¸ ì‚¬ìš©
      const parent = el.parentElement?.className || '';
      const text = el.textContent.substring(0, 20);
      return 'text:' + parent + ':' + text;
    }

    // ì›ë³¸ ë°ì´í„° ì €ì¥ (í‚¤ ê¸°ë°˜) - ë™ì ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ìš”ì†Œ ê³ ë ¤
    function saveOriginalData() {
      // ì´ë¯¸ ì›ë³¸ì´ ì €ì¥ë˜ì–´ ìˆìœ¼ë©´ ê±´ë„ˆë›°ê¸°
      if (localStorage.getItem(ORIGINAL_DATA_KEY)) {
        return;
      }
      
      // ëª¨ë“  ì°¨íŠ¸ì™€ í…Œì´ë¸”ì´ ë¡œë“œëœ í›„ ì›ë³¸ ë°ì´í„° ì €ì¥
      setTimeout(() => {
        const editables = document.querySelectorAll('.editable');
        const originalData = {};
        editables.forEach((el) => {
          const key = getElementKey(el);
          // innerHTMLì´ ìˆëŠ” ìš”ì†ŒëŠ” innerHTMLë¡œ, ì•„ë‹ˆë©´ textContentë¡œ
          originalData[key] = el.innerHTML && el.innerHTML.includes('<') ? el.innerHTML : el.textContent;
        });
        localStorage.setItem(ORIGINAL_DATA_KEY, JSON.stringify(originalData));
        console.log(`ğŸ“¦ ì›ë³¸ ë°ì´í„° ${Object.keys(originalData).length}ê°œ í•­ëª© ì €ì¥ë¨`);
      }, 1000);
    }

    // í¸ì§‘ëœ ë°ì´í„° ì €ì¥ (í‚¤ ê¸°ë°˜) - ë³€ê²½ëœ ê²ƒë§Œ ì €ì¥
    function saveEdits() {
      const editables = document.querySelectorAll('.editable');
      const original = JSON.parse(localStorage.getItem(ORIGINAL_DATA_KEY) || '{}');
      const currentEdits = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
      
      const edits = {};
      let changedCount = 0;
      
      editables.forEach((el) => {
        const key = getElementKey(el);
        // innerHTMLì´ ìˆëŠ” ìš”ì†ŒëŠ” innerHTMLë¡œ, ì•„ë‹ˆë©´ textContentë¡œ
        const currentValue = el.innerHTML && el.innerHTML.includes('<') ? el.innerHTML : el.textContent;
        const originalValue = original[key];
        
        // ì›ë³¸ê³¼ ë‹¤ë¥¸ ê²½ìš°ì—ë§Œ ì €ì¥
        if (currentValue !== originalValue) {
          edits[key] = currentValue;
          changedCount++;
        } else if (currentEdits[key]) {
          // ì›ë³¸ê³¼ ê°™ì§€ë§Œ ì´ì „ì— í¸ì§‘í–ˆë˜ ê²ƒì€ ì œê±°
          delete currentEdits[key];
        }
      });
      
      // ê¸°ì¡´ í¸ì§‘ ë‚´ìš©ê³¼ ìƒˆë¡œìš´ ë³€ê²½ì‚¬í•­ ë³‘í•©
      const finalEdits = { ...currentEdits, ...edits };
      
      localStorage.setItem(STORAGE_KEY, JSON.stringify(finalEdits));
      
      // AI íŒŒíŠ¸ë³„ ë¶„ì„ í¸ì§‘ ë‚´ìš©ë„ í•¨ê»˜ ì €ì¥
      if (currentSection === 'brand' && window.aiPartMode) {
        saveAIPartEdits();
      }
      
      console.log(`âœ… ë³€ê²½ëœ í•­ëª©: ${changedCount}ê°œ, ì´ ì €ì¥ëœ í¸ì§‘: ${Object.keys(finalEdits).length}ê°œ`, finalEdits);
      
      if (changedCount === 0 && Object.keys(finalEdits).length === 0) {
        alert('âš ï¸ ë³€ê²½ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
      } else {
        alert('âœ… ìˆ˜ì •ì‚¬í•­ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\nìƒˆë¡œê³ ì¹¨í•´ë„ ìœ ì§€ë©ë‹ˆë‹¤.');
      }
    }

    // í¸ì§‘ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (í‚¤ ê¸°ë°˜)
    function loadEdits() {
      const edits = localStorage.getItem(STORAGE_KEY);
      if (edits) {
        const data = JSON.parse(edits);
        const editables = document.querySelectorAll('.editable');
        let loadedCount = 0;
        editables.forEach((el) => {
          const key = getElementKey(el);
          if (data[key] !== undefined) {
            // innerHTMLì´ ìˆëŠ” ìš”ì†ŒëŠ” innerHTMLë¡œ, ì•„ë‹ˆë©´ textContentë¡œ
            if (el.innerHTML && el.innerHTML.includes('<')) {
              el.innerHTML = data[key];
            } else {
              el.textContent = data[key];
            }
            loadedCount++;
          }
        });
        console.log(`âœ… ${loadedCount}ê°œ í•­ëª©ì´ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤ (ì´ ${Object.keys(data).length}ê°œ ì €ì¥ë¨)`);
      } else {
        console.log('âš ï¸ ì €ì¥ëœ í¸ì§‘ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
      }
    }

    // ì›ë³¸ ë°ì´í„°ë¡œ ë³µì›
    function resetToOriginal() {
      if (confirm('âš ï¸ ëª¨ë“  ìˆ˜ì •ì‚¬í•­ì„ ì‚­ì œí•˜ê³  ì›ë³¸ ë°ì´í„°ë¡œ ë³µì›í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        const original = localStorage.getItem(ORIGINAL_DATA_KEY);
        if (original) {
          const data = JSON.parse(original);
          const editables = document.querySelectorAll('.editable');
          editables.forEach((el) => {
            const key = getElementKey(el);
            if (data[key] !== undefined) {
              el.textContent = data[key];
            }
          });
          localStorage.removeItem(STORAGE_KEY);
          alert('âœ… ì›ë³¸ ë°ì´í„°ë¡œ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤!');
          // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ì™„ì „íˆ ì´ˆê¸°í™”
          location.reload();
        }
      }
    }

    // í¸ì§‘ ëª¨ë“œ í† ê¸€
    function toggleEditMode() {
      isEditMode = !isEditMode;
      applyEditMode();
      
      const editBtn = document.getElementById('edit-mode-btn');
      const saveBtn = document.getElementById('save-btn');

      if (isEditMode) {
        editBtn.classList.add('active');
        editBtn.textContent = 'ğŸ‘ï¸ ë³´ê¸° ëª¨ë“œ';
        saveBtn.style.display = 'inline-block';
      } else {
        editBtn.classList.remove('active');
        editBtn.textContent = 'âœï¸ í¸ì§‘ ëª¨ë“œ';
        saveBtn.style.display = 'none';
      }
    }

    // í¸ì§‘ ëª¨ë“œ ì ìš© (ë™ì  ìš”ì†Œ í¬í•¨)
    function applyEditMode() {
      const editables = document.querySelectorAll('.editable');
      editables.forEach(el => {
        el.contentEditable = isEditMode;
      });
      
      // AI íŒŒíŠ¸ë³„ ë¶„ì„ í¸ì§‘ ëª¨ë“œë„ í•¨ê»˜ ì ìš©
      applyAIPartEditMode();
    }
    
    // AI íŒŒíŠ¸ë³„ ë¶„ì„ í¸ì§‘ ëª¨ë“œ ì ìš©
    function applyAIPartEditMode() {
      const editables = document.querySelectorAll('.ai-part-editable');
      editables.forEach(el => {
        el.contentEditable = isEditMode;
        if (isEditMode) {
          el.style.border = '1px dashed #3b82f6';
          el.style.padding = '4px';
          el.style.borderRadius = '4px';
          el.style.minHeight = '20px';
        } else {
          el.style.border = 'none';
          el.style.padding = '0';
        }
      });
    }
    
    // AI íŒŒíŠ¸ë³„ ë¶„ì„ í¸ì§‘ ë‚´ìš© ì €ì¥
    function saveAIPartEdits() {
      const editables = document.querySelectorAll('.ai-part-editable');
      const edits = {};
      
      editables.forEach(el => {
        const id = el.id;
        if (id) {
          // IDì—ì„œ í‚¤ ì¶”ì¶œ (ì˜ˆ: ai-insight-treemap-content -> ai-part-treemap)
          let key = '';
          if (id.includes('treemap')) key = 'ai-part-treemap';
          else if (id.includes('radar')) key = 'ai-part-radar';
          else if (id.includes('channel-pl')) key = 'ai-part-channel-pl';
          else if (id.includes('weekly')) key = 'ai-part-weekly';
          else if (id.includes('sale-rate')) key = 'ai-part-sale-rate';
          else if (id.includes('inventory')) key = 'ai-part-inventory';
          else if (id.includes('ai-part-note-1')) key = 'ai-part-pl';
          
          if (key) {
            edits[key] = el.innerHTML || el.textContent;
          }
        }
      });
      
      localStorage.setItem(`ai-part-edits-${currentBrand}`, JSON.stringify(edits));
      console.log(`âœ… ${currentBrand} ë¸Œëœë“œ AI íŒŒíŠ¸ë³„ ë¶„ì„ í¸ì§‘ ë‚´ìš© ì €ì¥ë¨:`, edits);
    }
    
    // AI íŒŒíŠ¸ë³„ ë¶„ì„ í¸ì§‘ ë‚´ìš© ë¡œë“œ
    function loadAIPartEdits() {
      const savedEdits = localStorage.getItem(`ai-part-edits-${currentBrand}`);
      if (!savedEdits) return;
      
      const edits = JSON.parse(savedEdits);
      const editables = document.querySelectorAll('.ai-part-editable');
      
      editables.forEach(el => {
        const id = el.id;
        if (id) {
          let key = '';
          if (id.includes('treemap')) key = 'ai-part-treemap';
          else if (id.includes('radar')) key = 'ai-part-radar';
          else if (id.includes('channel-pl')) key = 'ai-part-channel-pl';
          else if (id.includes('weekly')) key = 'ai-part-weekly';
          else if (id.includes('sale-rate')) key = 'ai-part-sale-rate';
          else if (id.includes('inventory')) key = 'ai-part-inventory';
          else if (id.includes('ai-part-note-1')) key = 'ai-part-pl';
          
          if (key && edits[key] !== undefined) {
            el.innerHTML = edits[key];
          }
        }
      });
    }

    // 1) last_updatedê°€ ìˆìœ¼ë©´ í—¤ë”ì— ë°˜ì˜
    document.addEventListener('DOMContentLoaded', () => {
      const last = document.getElementById('last-updated');
      if (D.last_updated && last) last.textContent = `ì—…ë°ì´íŠ¸: ${D.last_updated}`;

      // í¸ì§‘ ëª¨ë“œ ë²„íŠ¼ ì´ë²¤íŠ¸
      document.getElementById('edit-mode-btn').addEventListener('click', toggleEditMode);
      document.getElementById('save-btn').addEventListener('click', saveEdits);
      
      // ë“œë¦´ë°± ë²„íŠ¼ ì´ë²¤íŠ¸ (í•œ ë²ˆë§Œ ë“±ë¡)
      const drillbackBtn = document.getElementById('drillbackBtn');
      if (drillbackBtn) {
        drillbackBtn.addEventListener('click', function() {
        // ì›ë˜ ë¸Œëœë“œ ë°ì´í„°ë¡œ ë³µì›
        const rows = Array.isArray(D.by_brand) ? D.by_brand : null;
        const labels = rows ? rows.map(r=> (r.BRAND||r.brand||r.name) ) : ['MLB','MLB KIDS','DISCOVERY','DUVETICA','SERGIO','SUPRA'];
        const sales  = rows ? rows.map(r=> Number(r.SALES||r.sales||r.revenue||0) ) : [236.9,78.9,42.1,28.7,31.2,16.8];
        
        isDrilledDown = false;
        currentDrillBrand = null;
        createBrandContributionChart(labels, sales);
        document.getElementById('contributionChartTitle').textContent = 'ë¸Œëœë“œë³„ ë§¤ì¶œ ê¸°ì—¬ë„';
        this.style.display = 'none';
      });
      }

      // AI ë¶„ì„ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
      const aiBtn = document.getElementById('ai-btn');
      if (aiBtn){
        aiBtn.addEventListener('click', (e)=>{
          e.stopPropagation();
          console.log('AI ë²„íŠ¼ í´ë¦­ë¨, currentSection:', currentSection);
          // í˜„ì¬ ì„¹ì…˜ì— ë”°ë¼ ë‹¤ë¥¸ ê¸°ëŠ¥ ì‹¤í–‰
          if (currentSection === 'overview'){
            // ì „ì²´ í˜„í™©: í•œì¥ìš”ì•½ í‘œì‹œ
            console.log('showAISummary í˜¸ì¶œ');
            showAISummary().catch(err => {
              console.error('AI ë¶„ì„ í‘œì‹œ ì˜¤ë¥˜:', err);
              alert('AI ë¶„ì„ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì½˜ì†”ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
            });
          } else {
            // ë¸Œëœë“œë³„ ë¶„ì„: íŒŒíŠ¸ë³„ ë¶„ì„ í‘œì‹œ/í† ê¸€
          window.aiPartMode = !window.aiPartMode;
          if (window.aiPartMode){
              console.log('renderAIPartNotes í˜¸ì¶œ');
            renderAIPartNotes();
          } else {
            clearAIPartNotes();
            }
          }
        });
      } else {
        console.error('AI ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
      }
      
      // ë°ì´í„° ë¡œë“œ í›„ ì „ì²´ ì†ìµê³„ì‚°ì„œ í• ì¸ìœ¨ ì—…ë°ì´íŠ¸
      if (typeof loadAllDashboardData === 'function') {
        loadAllDashboardData().then(() => {
          setTimeout(() => {
            if (typeof updateOverviewDiscountRate === 'function') {
              updateOverviewDiscountRate();
            }
          }, 500);
        }).catch(err => {
          console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', err);
        });
      } else {
        // loadAllDashboardDataê°€ ì—†ìœ¼ë©´ ì§ì ‘ í˜¸ì¶œ (ë°ì´í„°ê°€ ì´ë¯¸ ë¡œë“œëœ ê²½ìš°)
        setTimeout(() => {
          if (typeof updateOverviewDiscountRate === 'function') {
            updateOverviewDiscountRate();
          }
        }, 1000);
      }
    });
    // ---------- AI ê¸°ëŠ¥ êµ¬í˜„ ----------
    function ensureAIModal(){
      let backdrop = document.getElementById('ai-modal-backdrop');
      if (!backdrop){
        backdrop = document.createElement('div');
        backdrop.id = 'ai-modal-backdrop';
        backdrop.className = 'ai-modal-backdrop';
        backdrop.innerHTML = `
          <div class="ai-modal">
            <header>
              <h4>ğŸ¤– AI í•œì¥ìš”ì•½</h4>
              <div style="display:flex;gap:8px;align-items:center;">
                <button class="close-btn" id="ai-summary-edit-btn" style="background:#3b82f6;color:#fff;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">âœï¸ í¸ì§‘</button>
                <button class="close-btn" id="ai-modal-close">ë‹«ê¸°</button>
              </div>
            </header>
            <div class="content" id="ai-modal-content"></div>
          </div>`;
        document.body.appendChild(backdrop);
        backdrop.addEventListener('click', (e)=>{ if(e.target===backdrop) backdrop.style.display='none'; });
        document.getElementById('ai-modal-close').addEventListener('click', ()=>{ backdrop.style.display='none'; });
        
        // AI í•œì¥ìš”ì•½ í¸ì§‘ ë²„íŠ¼ ì´ë²¤íŠ¸
        const editBtn = document.getElementById('ai-summary-edit-btn');
        if (editBtn && !editBtn.hasAttribute('data-listener')) {
          editBtn.setAttribute('data-listener', 'true');
          editBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            toggleAISummaryEditMode();
          });
        }
      } else {
        // ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ë„ í¸ì§‘ ë²„íŠ¼ ì´ë²¤íŠ¸ ë“±ë¡
        const editBtn = document.getElementById('ai-summary-edit-btn');
        if (editBtn && !editBtn.hasAttribute('data-listener')) {
          editBtn.setAttribute('data-listener', 'true');
          editBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            toggleAISummaryEditMode();
          });
        }
      }
      return backdrop;
    }
    
    // AI í•œì¥ìš”ì•½ í¸ì§‘ ëª¨ë“œ í† ê¸€
    let aiSummaryEditMode = false;
    function toggleAISummaryEditMode() {
      aiSummaryEditMode = !aiSummaryEditMode;
      const contentEl = document.getElementById('ai-modal-content');
      const editBtn = document.getElementById('ai-summary-edit-btn');
      
      if (!contentEl) return;
      
      const editables = contentEl.querySelectorAll('.ai-editable');
      editables.forEach(el => {
        el.contentEditable = aiSummaryEditMode;
        if (aiSummaryEditMode) {
          el.style.border = '1px dashed #3b82f6';
          el.style.padding = '4px';
          el.style.borderRadius = '4px';
          el.style.minHeight = '20px';
        } else {
          el.style.border = 'none';
          el.style.padding = '0';
        }
      });
      
      if (editBtn) {
        if (aiSummaryEditMode) {
          editBtn.textContent = 'ğŸ’¾ ì €ì¥';
          editBtn.style.background = '#10b981';
        } else {
          editBtn.textContent = 'âœï¸ í¸ì§‘';
          editBtn.style.background = '#3b82f6';
          saveAISummaryEdits();
        }
      }
    }
    
    // AI í•œì¥ìš”ì•½ í¸ì§‘ ë‚´ìš© ì €ì¥
    function saveAISummaryEdits() {
      const contentEl = document.getElementById('ai-modal-content');
      if (!contentEl) return;
      
      const edits = {};
      const editables = contentEl.querySelectorAll('.ai-editable');
      
      editables.forEach((el, index) => {
        const key = `ai-summary-${index}`;
        edits[key] = el.innerHTML || el.textContent;
      });
      
      localStorage.setItem('ai-summary-edits', JSON.stringify(edits));
      console.log('âœ… AI í•œì¥ìš”ì•½ í¸ì§‘ ë‚´ìš© ì €ì¥ë¨:', edits);
    }
    
    // AI í•œì¥ìš”ì•½ í¸ì§‘ ë‚´ìš© ë¡œë“œ
    function loadAISummaryEdits() {
      const contentEl = document.getElementById('ai-modal-content');
      if (!contentEl) return;
      
      const edits = localStorage.getItem('ai-summary-edits');
      if (edits) {
        const data = JSON.parse(edits);
        const editables = contentEl.querySelectorAll('.ai-editable');
        
        editables.forEach((el, index) => {
          const key = `ai-summary-${index}`;
          if (data[key] !== undefined) {
            el.innerHTML = data[key];
          }
        });
        console.log('âœ… AI í•œì¥ìš”ì•½ í¸ì§‘ ë‚´ìš© ë¡œë“œë¨');
      }
    }

    async function showAISummary(){
      const backdrop = ensureAIModal();
      const contentEl = document.getElementById('ai-modal-content');
      
      // ë¡œë”© í‘œì‹œ
      contentEl.innerHTML = '<div style="text-align:center;padding:40px;color:#64748b;">ğŸ¤– AI ë¶„ì„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';
      backdrop.style.display = 'flex';
      
      try {
        // insightsDataê°€ ë¹„ë™ê¸°ë¡œ ë¡œë“œ ì¤‘ì´ë©´ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°
        if (insightsDataPromise) {
          const loadedInsights = await insightsDataPromise;
          if (loadedInsights) {
            // ë¡œë“œëœ ë°ì´í„°ë¡œ insightsData ì—…ë°ì´íŠ¸
            Object.assign(insightsData, loadedInsights);
            console.log('âœ… AI ì¸ì‚¬ì´íŠ¸ ë°ì´í„° ë¡œë“œ ì™„ë£Œ, ëª¨ë‹¬ì— í‘œì‹œ');
          }
          insightsDataPromise = null; // í•œ ë²ˆë§Œ ë¡œë“œ
        }
      } catch (error) {
        console.error('AI ì¸ì‚¬ì´íŠ¸ ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
      }
      
      let html = '';
      
      // ë¸Œëœë“œ ìˆœì„œ ì •ì˜
      const brandOrder = ['MLB', 'MLB_KIDS', 'DISCOVERY', 'DUVETICA', 'SERGIO', 'SUPRA'];
      const brandDisplayNames = {
        'MLB': 'MLB',
        'MLB_KIDS': 'MLB KIDS',
        'DISCOVERY': 'DISCOVERY',
        'DUVETICA': 'DUVETICA',
        'SERGIO': 'SERGIO',
        'SUPRA': 'SUPRA'
      };
      
      // ì €ì¥ëœ í¸ì§‘ ë‚´ìš© ë¡œë“œ
      const savedEdits = localStorage.getItem('ai-summary-edits');
      const edits = savedEdits ? JSON.parse(savedEdits) : {};
      
      // ì „ì²´ í˜„í™© ì„¹ì…˜
      if (insightsData && insightsData.overview) {
        const editKey0 = 'ai-summary-0';
        const editKey1 = 'ai-summary-1';
        const c = edits[editKey0] !== undefined ? edits[editKey0] : (insightsData.overview.content || 'ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
        const k = edits[editKey1] !== undefined ? edits[editKey1] : (insightsData.overview.keyPoints || 'ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
        html += `<div style="margin-bottom:20px;padding-bottom:20px;border-bottom:2px solid #e5e7eb;">
          <h3 style="margin:0 0 10px 0;font-size:16px;font-weight:700;color:#1f2937;">ğŸ“ˆ ì „ì²´ í˜„í™©</h3>
          <div class="ai-editable" style="margin-bottom:10px;line-height:1.6;">${c}</div>
          <div class="ai-editable" style="white-space:pre-line;line-height:1.6;">${k}</div>
        </div>`;
      } else {
        html += `<div style="margin-bottom:20px;padding-bottom:20px;border-bottom:2px solid #e5e7eb;">
          <h3 style="margin:0 0 10px 0;font-size:16px;font-weight:700;color:#1f2937;">ğŸ“ˆ ì „ì²´ í˜„í™©</h3>
          <div class="ai-editable" style="margin-bottom:10px;line-height:1.6;color:#ef4444;">AI ë¶„ì„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë°ì´í„° íŒŒì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.</div>
        </div>`;
      }
      
      // ê° ë¸Œëœë“œë³„ ì„¹ì…˜
      let editIndex = 2;
      brandOrder.forEach((brandKey, index) => {
        const brandData = insightsData && insightsData[brandKey];
        if (brandData) {
          const brandName = brandDisplayNames[brandKey] || brandKey;
          const editKeyContent = `ai-summary-${editIndex}`;
          const editKeyPoints = `ai-summary-${editIndex + 1}`;
          const c = edits[editKeyContent] !== undefined ? edits[editKeyContent] : (brandData.content || 'ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
          const k = edits[editKeyPoints] !== undefined ? edits[editKeyPoints] : (brandData.keyPoints || 'ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
          const isLast = index === brandOrder.length - 1;
          
          html += `<div style="margin-bottom:${isLast ? '0' : '20px'};padding-bottom:${isLast ? '0' : '20px'};border-bottom:${isLast ? 'none' : '2px solid #e5e7eb'};">
            <h3 style="margin:0 0 10px 0;font-size:16px;font-weight:700;color:#1f2937;">ğŸ·ï¸ ${brandName}</h3>
            <div class="ai-editable" style="margin-bottom:10px;line-height:1.6;">${c}</div>
            <div class="ai-editable" style="white-space:pre-line;line-height:1.6;">${k}</div>
          </div>`;
          editIndex += 2;
        }
      });
      
      contentEl.innerHTML = html;
      
      // í¸ì§‘ ë‚´ìš© ë¡œë“œ (ì´ë¯¸ ì €ì¥ëœ í¸ì§‘ì´ ìˆìœ¼ë©´ ì ìš©)
      setTimeout(() => {
        loadAISummaryEdits();
      }, 50);
    }

    // ë‚ ì§œ íŒŒë¼ë¯¸í„° ê°€ì ¸ì˜¤ê¸°
    function getDateParam() {
      // URL íŒŒë¼ë¯¸í„°ì—ì„œ ê°€ì ¸ì˜¤ê¸°
      const urlParams = new URLSearchParams(window.location.search);
      let dateParam = urlParams.get('date');
      
      // ì—†ìœ¼ë©´ ì „ì—­ ë³€ìˆ˜ì—ì„œ ê°€ì ¸ì˜¤ê¸°
      if (!dateParam && window.__DATA_DATE__) {
        dateParam = window.__DATA_DATE__;
      }
      
      // ê¸°ë³¸ê°’
      if (!dateParam || dateParam.length !== 8) {
        dateParam = '20251124';
      }
      
      return dateParam;
    }
    
    // ë¸Œëœë“œ ì½”ë“œ ë§¤í•‘
    const brandCodeMap = {
      'MLB': 'M',
      'MLB_KIDS': 'I',
      'DISCOVERY': 'X',
      'DUVETICA': 'V',
      'SERGIO': 'ST',
      'SUPRA': 'W'
    };
    
    // ë¸Œëœë“œëª… ë§¤í•‘ (ì—­ë°©í–¥)
    const brandNameMap = {
      'M': 'MLB',
      'I': 'MLB_KIDS',
      'X': 'DISCOVERY',
      'V': 'DUVETICA',
      'ST': 'SERGIO',
      'W': 'SUPRA'
    };
    
    // ì†ìµê³„ì‚°ì„œ JSON ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ìƒì„±
    async function generatePLInsight() {
      try {
        const dateParam = getDateParam();
        const baseUrl = `/public/data/${dateParam}`;
        const brandCode = brandCodeMap[currentBrand] || 'M';
        const brandName = brandNameMap[brandCode] || 'MLB';
        
        const response = await fetch(`${baseUrl}/brand_pl.json`);
        if (!response.ok) return 'ì†ìµê³„ì‚°ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
        
        const data = await response.json();
        const plData = data[brandName] || data[brandCode];
        
        if (!plData) return 'í•´ë‹¹ ë¸Œëœë“œì˜ ì†ìµê³„ì‚°ì„œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.';
        
        const revenue = plData.revenue || {};
        const grossProfit = plData.grossProfit || {};
        const directProfit = plData.directProfit || {};
        const opProfit = plData.opProfit || {};
        const discountRate = plData.discountRate || {};
        
        let insight = `<strong>ğŸ“Š ì†ìµê³„ì‚°ì„œ ë¶„ì„</strong><br>`;
        
        // ë§¤ì¶œ ë¶„ì„
        if (revenue.forecast && revenue.target) {
          const achievement = revenue.achievement || 0;
          const yoy = revenue.yoy || 0;
          insight += `â€¢ ì‹¤íŒë§¤ì•¡ <strong>${(revenue.forecast / 100).toFixed(2)}ì–µì›</strong>ìœ¼ë¡œ ëª©í‘œ ëŒ€ë¹„ <strong>${achievement}%</strong> ë‹¬ì„±ë¥ ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.<br>`;
          if (yoy > 0) {
            insight += `â€¢ ì „ë…„ ëŒ€ë¹„ <strong>${yoy}%</strong> ì„±ì¥ì„ ê¸°ë¡í•˜ì—¬ ${yoy >= 110 ? 'ì•ˆì •ì ì¸' : yoy >= 100 ? 'ì†Œí­' : 'ê°ì†Œí•˜ëŠ”'} ì„±ì¥ì„¸ë¥¼ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.<br>`;
          }
        }
        
        // í• ì¸ìœ¨ ë¶„ì„
        if (discountRate.forecast && discountRate.target) {
          const discountForecast = discountRate.forecast;
          const discountTarget = discountRate.target;
          if (discountForecast > discountTarget) {
            insight += `â€¢ í• ì¸ìœ¨ <strong>${discountForecast}%</strong>ëŠ” ëª©í‘œ <strong>${discountTarget}%</strong> ëŒ€ë¹„ ë†’ì€ ìˆ˜ì¤€ìœ¼ë¡œ í• ì¸ìœ¨ ê´€ë¦¬ ê°œì„ ì´ í•„ìš”í•˜ë©°,<br>`;
          } else {
            insight += `â€¢ í• ì¸ìœ¨ <strong>${discountForecast}%</strong>ëŠ” ëª©í‘œ <strong>${discountTarget}%</strong> ëŒ€ë¹„ ì–‘í˜¸í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤.<br>`;
          }
        }
        
        // ì§ì ‘ë¹„ íš¨ìœ¨ ë¶„ì„
        if (directProfit.forecast && directProfit.target) {
          const directProfitAchievement = directProfit.achievement || 0;
          insight += `â€¢ ì§ì ‘ë¹„ íš¨ìœ¨ì´ ëª©í‘œ ëŒ€ë¹„ <strong>${directProfitAchievement}%</strong>ë¡œ ${directProfitAchievement >= 95 ? 'ì–‘í˜¸í•œ' : 'ê°œì„ ì´ í•„ìš”í•œ'} ë¹„ìš© ê´€ë¦¬ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.<br>`;
        }
        
        // ì˜ì—…ì´ìµ ë¶„ì„
        if (opProfit.forecast) {
          const opProfitValue = (opProfit.forecast / 100).toFixed(2);
          const opProfitAchievement = opProfit.achievement || 0;
          insight += `â€¢ ì˜ì—…ì´ìµì€ <strong>${opProfitValue}ì–µì›</strong>ìœ¼ë¡œ ëª©í‘œ ëŒ€ë¹„ <strong>${opProfitAchievement}%</strong> ë‹¬ì„±ë¥ ì„ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤.<br>`;
        }
        
        return insight;
      } catch (error) {
        console.error('ì†ìµê³„ì‚°ì„œ ì¸ì‚¬ì´íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
        return 'ì†ìµê³„ì‚°ì„œ ë°ì´í„° ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      }
    }
    
    // íŠ¸ë¦¬ë§µ ë©”íƒ€ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
    async function loadTreemapMetadata() {
      try {
        const dateParam = getDateParam();
        // ì—¬ëŸ¬ ê²½ë¡œ ì‹œë„
        const possiblePaths = [
          `/data/${dateParam}/treemap.json`,
          `/public/data/${dateParam}/treemap.json`,
          `../public/data/${dateParam}/treemap.json`,
          `./public/data/${dateParam}/treemap.json`
        ];
        
        let data = null;
        let successUrl = null;
        
        for (const url of possiblePaths) {
          try {
            console.log('íŠ¸ë¦¬ë§µ ë©”íƒ€ë°ì´í„° ë¡œë“œ ì‹œë„:', url);
            const response = await fetch(url);
            if (response.ok) {
              data = await response.json();
              successUrl = url;
              console.log('íŠ¸ë¦¬ë§µ ë°ì´í„° ë¡œë“œ ì„±ê³µ:', successUrl);
              break;
            }
          } catch (e) {
            console.log('ê²½ë¡œ ì‹œë„ ì‹¤íŒ¨:', url);
          }
        }
        
        if (!data) {
          console.warn('ëª¨ë“  ê²½ë¡œì—ì„œ íŠ¸ë¦¬ë§µ ë©”íƒ€ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨');
          return;
        }
        
        console.log('íŠ¸ë¦¬ë§µ ë°ì´í„°:', data);
        
        // ë©”íƒ€ë°ì´í„° ì €ì¥ ë° ë‚ ì§œ ì •ë³´ í‘œì‹œ
        if (data.metadata) {
          treemapMetadata = data.metadata;
          console.log('ë©”íƒ€ë°ì´í„° ì €ì¥ ì™„ë£Œ:', treemapMetadata);
          updateTreemapDateInfo();
        } else {
          console.warn('ë°ì´í„°ì— metadataê°€ ì—†ìŠµë‹ˆë‹¤');
        }
      } catch (error) {
        console.error('íŠ¸ë¦¬ë§µ ë©”íƒ€ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
      }
    }
    
    // íŠ¸ë¦¬ë§µ ë‚ ì§œ ì •ë³´ í‘œì‹œ í•¨ìˆ˜
    function updateTreemapDateInfo() {
      console.log('updateTreemapDateInfo í˜¸ì¶œë¨', {treemapMetadata});
      
      if (!treemapMetadata) {
        console.warn('treemapMetadataê°€ ì—†ìŠµë‹ˆë‹¤');
        return;
      }
      
      const channelDateInfo = document.getElementById('treemapDateInfoChannel');
      const itemDateInfo = document.getElementById('treemapDateInfoItem');
      
      console.log('ë‚ ì§œ ì •ë³´ ìš”ì†Œ:', {channelDateInfo, itemDateInfo});
      
      if (!channelDateInfo || !itemDateInfo) {
        console.warn('ë‚ ì§œ ì •ë³´ í‘œì‹œ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        return;
      }
      
      const cyStart = treemapMetadata.cyPeriod?.start || '';
      const cyEnd = treemapMetadata.cyPeriod?.end || '';
      const pyStart = treemapMetadata.pyPeriod?.start || '';
      const pyEnd = treemapMetadata.pyPeriod?.end || '';
      
      const dateText = `ë‹¹ë…„: ${cyStart} ~ ${cyEnd} | ì „ë…„: ${pyStart} ~ ${pyEnd} (ë‹¹ë…„ë™ì£¼ì°¨)`;
      
      console.log('ë‚ ì§œ í…ìŠ¤íŠ¸ ì„¤ì •:', dateText);
      
      channelDateInfo.textContent = dateText;
      itemDateInfo.textContent = dateText;
      
      // ê°•ì œë¡œ ë³´ì´ê²Œ í•˜ê¸°
      channelDateInfo.style.display = 'block';
      itemDateInfo.style.display = 'block';
      
      console.log('ë‚ ì§œ ì •ë³´ í‘œì‹œ ì™„ë£Œ');
    }
    
    // íŠ¸ë¦¬ë§µ JSON ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ìƒì„±
    async function generateTreemapInsight() {
      try {
        const dateParam = getDateParam();
        const baseUrl = `/public/data/${dateParam}`;
        const brandCode = brandCodeMap[currentBrand] || 'M';
        
        const response = await fetch(`${baseUrl}/treemap.json`);
        if (!response.ok) {
          // í´ë°±: ê¸°ì¡´ í•¨ìˆ˜ ì‚¬ìš©
          return generateTreemapInsightFromData();
        }
        
        const data = await response.json();
        
        // ë©”íƒ€ë°ì´í„° ì €ì¥ ë° ë‚ ì§œ ì •ë³´ í‘œì‹œ
        if (data.metadata) {
          treemapMetadata = data.metadata;
          updateTreemapDateInfo();
        }
        
        const channelTreemap = data.channelTreemapData?.channels || {};
        const itemTreemap = data.itemTreemapData?.items || {};
        
        // ë¸Œëœë“œë³„ ì±„ë„ ë°ì´í„° ì°¾ê¸°
        let brandChannelData = null;
        let brandItemData = null;
        
        // ì „ì²´ ë°ì´í„°ì—ì„œ í•´ë‹¹ ë¸Œëœë“œì˜ ì±„ë„ë³„ ë§¤ì¶œ í•©ê³„ ê³„ì‚°
        const channelTotals = {};
        const itemTotals = {};
        
        // ì±„ë„ë³„ ë°ì´í„° ë¶„ì„
        Object.keys(channelTreemap).forEach(channelKey => {
          const channelData = channelTreemap[channelKey];
          if (channelData && channelData.sales) {
            const sales = channelData.sales / 100000000; // ì–µì› ë‹¨ìœ„
            channelTotals[channelKey] = sales;
          }
        });
        
        // ì•„ì´í…œë³„ ë°ì´í„° ë¶„ì„
        Object.keys(itemTreemap).forEach(itemKey => {
          const itemData = itemTreemap[itemKey];
          if (itemData && itemData.sales) {
            const sales = itemData.sales / 100000000; // ì–µì› ë‹¨ìœ„
            itemTotals[itemKey] = sales;
          }
        });
        
        // ì±„ë„ë³„ ì •ë ¬
        const channelAnalysis = Object.entries(channelTotals)
          .map(([channel, value]) => ({ channel, value }))
          .sort((a, b) => b.value - a.value);
        
        // ì•„ì´í…œë³„ ì •ë ¬
        const itemAnalysis = Object.entries(itemTotals)
          .map(([item, value]) => ({ item, value }))
          .sort((a, b) => b.value - a.value);
        
        const totalChannelSales = channelAnalysis.reduce((sum, ch) => sum + ch.value, 0);
        const totalItemSales = itemAnalysis.reduce((sum, it) => sum + it.value, 0);
        
        // ì¸ì‚¬ì´íŠ¸ ìƒì„±
        let insight = `<strong>ğŸ“Š ì±„ë„ë³„ ë§¤ì¶œêµ¬ì„± ë¶„ì„</strong><br>`;
        
        if (channelAnalysis.length > 0) {
          channelAnalysis.forEach((ch, idx) => {
            const percentage = totalChannelSales > 0 ? ((ch.value / totalChannelSales) * 100).toFixed(1) : 0;
            if (idx === 0) {
              insight += `â€¢ <strong>${ch.channel}</strong>ì´(ê°€) ì „ì²´ ë§¤ì¶œì˜ <strong>${percentage}%</strong>ë¥¼ ì°¨ì§€í•˜ë©° ê°€ì¥ í° ë¹„ì¤‘ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. (${ch.value.toFixed(1)}ì–µì›)<br>`;
            } else if (idx === 1) {
              insight += `â€¢ <strong>${ch.channel}</strong>ì´(ê°€) <strong>${percentage}%</strong>ë¡œ ë‘ ë²ˆì§¸ë¡œ ë†’ì€ ë¹„ì¤‘ì„ ì°¨ì§€í•©ë‹ˆë‹¤. (${ch.value.toFixed(1)}ì–µì›)<br>`;
            }
          });
          
          // ì±„ë„ ì§‘ì¤‘ë„ ë¶„ì„
          const top3ChannelShare = channelAnalysis.slice(0, 3).reduce((sum, ch) => {
            const percentage = totalChannelSales > 0 ? ((ch.value / totalChannelSales) * 100) : 0;
            return sum + percentage;
          }, 0);
          if (top3ChannelShare > 60) {
            insight += `â€¢ ìƒìœ„ 3ê°œ ì±„ë„ì´ ì „ì²´ì˜ <strong>${top3ChannelShare.toFixed(1)}%</strong>ë¥¼ ì°¨ì§€í•˜ì—¬ ì±„ë„ ì§‘ì¤‘ë„ê°€ ë†’ìŠµë‹ˆë‹¤.<br>`;
          }
        }
        
        insight += `<br><strong>ğŸ“¦ ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„± ë¶„ì„</strong><br>`;
        
        if (itemAnalysis.length > 0) {
          itemAnalysis.forEach((it, idx) => {
            const percentage = totalItemSales > 0 ? ((it.value / totalItemSales) * 100).toFixed(1) : 0;
            if (idx === 0) {
              insight += `â€¢ <strong>${it.item}</strong>ì´(ê°€) ì „ì²´ ë§¤ì¶œì˜ <strong>${percentage}%</strong>ë¥¼ ì°¨ì§€í•˜ë©° ê°€ì¥ í° ë¹„ì¤‘ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. (${it.value.toFixed(1)}ì–µì›)<br>`;
            } else if (idx === 1) {
              insight += `â€¢ <strong>${it.item}</strong>ì´(ê°€) <strong>${percentage}%</strong>ë¡œ ë‘ ë²ˆì§¸ë¡œ ë†’ì€ ë¹„ì¤‘ì„ ì°¨ì§€í•©ë‹ˆë‹¤. (${it.value.toFixed(1)}ì–µì›)<br>`;
            }
          });
          
          // ì•„ì´í…œ ë‹¤ì–‘ì„± ë¶„ì„
          if (itemAnalysis.length >= 3) {
            const top3ItemShare = itemAnalysis.slice(0, 3).reduce((sum, it) => {
              const percentage = totalItemSales > 0 ? ((it.value / totalItemSales) * 100) : 0;
              return sum + percentage;
            }, 0);
            if (top3ItemShare > 70) {
              insight += `â€¢ ìƒìœ„ 3ê°œ ì•„ì´í…œì´ ì „ì²´ì˜ <strong>${top3ItemShare.toFixed(1)}%</strong>ë¥¼ ì°¨ì§€í•˜ì—¬ ìƒí’ˆ ë¼ì¸ì—… ì§‘ì¤‘ë„ê°€ ë†’ìŠµë‹ˆë‹¤.<br>`;
            }
          }
        }
        
        return insight;
      } catch (error) {
        console.error('íŠ¸ë¦¬ë§µ ì¸ì‚¬ì´íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
        // í´ë°±: ê¸°ì¡´ í•¨ìˆ˜ ì‚¬ìš©
        return generateTreemapInsightFromData();
      }
    }
    
    // íŠ¸ë¦¬ë§µ ë°ì´í„° ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ìƒì„± í•¨ìˆ˜ (í´ë°±)
    function generateTreemapInsightFromData() {
      try {
        const channelData = getChannelTreemapData();
        const itemData = getItemTreemapData();
        
        if (!channelData || !channelData[0] || !itemData || !itemData[0]) {
          return 'íŠ¸ë¦¬ë§µ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
        }
        
        const channelLabels = channelData[0].labels || [];
        const channelValues = channelData[0].values || [];
        const itemLabels = itemData[0].labels || [];
        const itemValues = itemData[0].values || [];
        
        // ì±„ë„ë³„ ì´ ë§¤ì¶œ ê³„ì‚°
        const totalChannelSales = channelValues.reduce((sum, val) => sum + val, 0);
        
        // ì±„ë„ë³„ ë¹„ì¤‘ ë° ë¶„ì„
        const channelAnalysis = channelLabels.map((label, idx) => {
          const value = channelValues[idx] || 0;
          const percentage = totalChannelSales > 0 ? ((value / totalChannelSales) * 100).toFixed(1) : 0;
          return { channel: label, value: value, percentage: parseFloat(percentage) };
        }).sort((a, b) => b.value - a.value);
        
        // ì•„ì´í…œë³„ ì´ ë§¤ì¶œ ê³„ì‚°
        const totalItemSales = itemValues.reduce((sum, val) => sum + val, 0);
        
        // ì•„ì´í…œë³„ ë¹„ì¤‘ ë° ë¶„ì„
        const itemAnalysis = itemLabels.map((label, idx) => {
          const value = itemValues[idx] || 0;
          const percentage = totalItemSales > 0 ? ((value / totalItemSales) * 100).toFixed(1) : 0;
          return { item: label, value: value, percentage: parseFloat(percentage) };
        }).sort((a, b) => b.value - a.value);
        
        // ì¸ì‚¬ì´íŠ¸ ìƒì„±
        let insight = `<strong>ğŸ“Š ì±„ë„ë³„ ë§¤ì¶œêµ¬ì„± ë¶„ì„</strong><br>`;
        
        if (channelAnalysis.length > 0) {
          const topChannel = channelAnalysis[0];
          insight += `â€¢ <strong>${topChannel.channel}</strong>ì´(ê°€) ì „ì²´ ë§¤ì¶œì˜ ${topChannel.percentage}%ë¥¼ ì°¨ì§€í•˜ë©° ê°€ì¥ í° ë¹„ì¤‘ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. (${topChannel.value.toFixed(1)}ì–µì›)<br>`;
          
          if (channelAnalysis.length > 1) {
            const secondChannel = channelAnalysis[1];
            insight += `â€¢ <strong>${secondChannel.channel}</strong>ì´(ê°€) ${secondChannel.percentage}%ë¡œ ë‘ ë²ˆì§¸ë¡œ ë†’ì€ ë¹„ì¤‘ì„ ì°¨ì§€í•©ë‹ˆë‹¤. (${secondChannel.value.toFixed(1)}ì–µì›)<br>`;
          }
          
          // ì±„ë„ ì§‘ì¤‘ë„ ë¶„ì„
          const top3ChannelShare = channelAnalysis.slice(0, 3).reduce((sum, ch) => sum + ch.percentage, 0);
          if (top3ChannelShare > 60) {
            insight += `â€¢ ìƒìœ„ 3ê°œ ì±„ë„ì´ ì „ì²´ì˜ ${top3ChannelShare.toFixed(1)}%ë¥¼ ì°¨ì§€í•˜ì—¬ ì±„ë„ ì§‘ì¤‘ë„ê°€ ë†’ìŠµë‹ˆë‹¤.<br>`;
          }
        }
        
        insight += `<br><strong>ğŸ“¦ ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„± ë¶„ì„</strong><br>`;
        
        if (itemAnalysis.length > 0) {
          const topItem = itemAnalysis[0];
          insight += `â€¢ <strong>${topItem.item}</strong>ì´(ê°€) ì „ì²´ ë§¤ì¶œì˜ ${topItem.percentage}%ë¥¼ ì°¨ì§€í•˜ë©° ê°€ì¥ í° ë¹„ì¤‘ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. (${topItem.value.toFixed(1)}ì–µì›)<br>`;
          
          if (itemAnalysis.length > 1) {
            const secondItem = itemAnalysis[1];
            insight += `â€¢ <strong>${secondItem.item}</strong>ì´(ê°€) ${secondItem.percentage}%ë¡œ ë‘ ë²ˆì§¸ë¡œ ë†’ì€ ë¹„ì¤‘ì„ ì°¨ì§€í•©ë‹ˆë‹¤. (${secondItem.value.toFixed(1)}ì–µì›)<br>`;
          }
          
          // ì•„ì´í…œ ë‹¤ì–‘ì„± ë¶„ì„
          if (itemAnalysis.length >= 3) {
            const top3ItemShare = itemAnalysis.slice(0, 3).reduce((sum, it) => sum + it.percentage, 0);
            if (top3ItemShare > 70) {
              insight += `â€¢ ìƒìœ„ 3ê°œ ì•„ì´í…œì´ ì „ì²´ì˜ ${top3ItemShare.toFixed(1)}%ë¥¼ ì°¨ì§€í•˜ì—¬ ìƒí’ˆ ë¼ì¸ì—… ì§‘ì¤‘ë„ê°€ ë†’ìŠµë‹ˆë‹¤.<br>`;
            }
          }
        }
        
        return insight;
      } catch (error) {
        console.error('íŠ¸ë¦¬ë§µ ì¸ì‚¬ì´íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
        return 'íŠ¸ë¦¬ë§µ ë°ì´í„° ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      }
    }

    // ë ˆì´ë” ì°¨íŠ¸ JSON ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ìƒì„±
    async function generateRadarInsight() {
      try {
        const dateParam = getDateParam();
        const baseUrl = `/public/data/${dateParam}`;
        const brandCode = brandCodeMap[currentBrand] || 'M';
        const brandName = brandNameMap[brandCode] || 'MLB';
        
        const response = await fetch(`${baseUrl}/radar_chart.json`);
        if (!response.ok) return 'ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
        
        const data = await response.json();
        const channelPlan = data.channelPlan?.[brandName] || {};
        const channelYoy = data.channelYoy?.[brandName] || {};
        const channelCurrent = data.channelCurrent?.[brandName] || {};
        
        let insight = `<strong>ğŸ“Š ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ ë¶„ì„</strong><br>`;
        
        // ì±„ë„ë³„ ê³„íš ëŒ€ë¹„ ë‹¬ì„±ë¥  ë¶„ì„
        const channelAnalysis = [];
        Object.keys(channelPlan).forEach(channel => {
          const plan = channelPlan[channel] || 0;
          const current = channelCurrent[channel] || 0;
          const yoy = channelYoy[channel] || 0;
          if (plan > 0) {
            const achievement = (current / plan * 100).toFixed(1);
            channelAnalysis.push({ channel, plan, current, yoy, achievement: parseFloat(achievement) });
          }
        });
        
        channelAnalysis.sort((a, b) => b.achievement - a.achievement);
        
        if (channelAnalysis.length > 0) {
          const topChannel = channelAnalysis[0];
          insight += `â€¢ <strong>${topChannel.channel}</strong>ì´(ê°€) ëª©í‘œ ëŒ€ë¹„ <strong>${topChannel.achievement}%</strong>ë¡œ ê°€ì¥ ë†’ì€ ë‹¬ì„±ë¥ ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.<br>`;
          
          const lowChannel = channelAnalysis[channelAnalysis.length - 1];
          if (lowChannel.achievement < 90) {
            insight += `â€¢ <strong>${lowChannel.channel}</strong>ì€(ëŠ”) ëª©í‘œ ëŒ€ë¹„ <strong>${lowChannel.achievement}%</strong>ë¡œ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.<br>`;
          }
          
          // ì „ë…„ ëŒ€ë¹„ ì„±ì¥ ì±„ë„ ë¶„ì„
          const growthChannels = channelAnalysis.filter(ch => ch.yoy > 110);
          if (growthChannels.length > 0) {
            insight += `â€¢ ì „ë…„ ëŒ€ë¹„ <strong>110% ì´ìƒ</strong> ì„±ì¥í•œ ì±„ë„ì´ <strong>${growthChannels.length}ê°œ</strong>ë¡œ ì„±ì¥ì„¸ê°€ ì–‘í˜¸í•©ë‹ˆë‹¤.<br>`;
          }
        }
        
        return insight;
      } catch (error) {
        console.error('ë ˆì´ë” ì°¨íŠ¸ ì¸ì‚¬ì´íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
        return 'ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ ë°ì´í„° ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      }
    }
    
    // ì±„ë„ë³„ ì†ìµ JSON ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ìƒì„±
    async function generateChannelPLInsight() {
      try {
        const dateParam = getDateParam();
        const baseUrl = `/public/data/${dateParam}`;
        const brandCode = brandCodeMap[currentBrand] || 'M';
        
        const response = await fetch(`${baseUrl}/channel_pl.json`);
        if (!response.ok) return 'ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
        
        const data = await response.json();
        const channelData = data[brandCode] || {};
        
        let insight = `<strong>ğŸ“Š ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„</strong><br>`;
        
        const channelAnalysis = [];
        Object.keys(channelData).forEach(channel => {
          const ch = channelData[channel];
          if (ch && ch.revenue) {
            const revenue = ch.revenue / 100000000; // ì–µì› ë‹¨ìœ„
            const grossProfit = ch.grossProfit / 100000000;
            const grossProfitRate = ch.grossProfitRate || 0;
            channelAnalysis.push({ channel, revenue, grossProfit, grossProfitRate });
          }
        });
        
        channelAnalysis.sort((a, b) => b.revenue - a.revenue);
        
        if (channelAnalysis.length > 0) {
          const topChannel = channelAnalysis[0];
          insight += `â€¢ <strong>${topChannel.channel}</strong>ì´(ê°€) ë§¤ì¶œ <strong>${topChannel.revenue.toFixed(1)}ì–µì›</strong>ìœ¼ë¡œ ê°€ì¥ í° ë¹„ì¤‘ì„ ì°¨ì§€í•˜ë©°, ë§¤ì¶œì´ì´ìµë¥ ì€ <strong>${topChannel.grossProfitRate.toFixed(1)}%</strong>ì…ë‹ˆë‹¤.<br>`;
          
          // ìˆ˜ìµì„± ë¶„ì„
          const highMarginChannels = channelAnalysis.filter(ch => ch.grossProfitRate > 70);
          if (highMarginChannels.length > 0) {
            insight += `â€¢ ë§¤ì¶œì´ì´ìµë¥  <strong>70% ì´ìƒ</strong>ì¸ ê³ ìˆ˜ìµ ì±„ë„ì´ <strong>${highMarginChannels.length}ê°œ</strong>ë¡œ ìˆ˜ìµì„± êµ¬ì¡°ê°€ ì–‘í˜¸í•©ë‹ˆë‹¤.<br>`;
          }
        }
        
        return insight;
      } catch (error) {
        console.error('ì±„ë„ë³„ ì†ìµ ì¸ì‚¬ì´íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
        return 'ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë°ì´í„° ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      }
    }
    
    // ì£¼ì°¨ë³„ ë§¤ì¶œì¶”ì„¸ JSON ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ìƒì„±
    async function generateWeeklyInsight() {
      try {
        const dateParam = getDateParam();
        const baseUrl = `/public/data/${dateParam}`;
        const brandCode = brandCodeMap[currentBrand] || 'M';
        
        const response = await fetch(`${baseUrl}/weekly_trend.json`);
        if (!response.ok) return 'ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
        
        const data = await response.json();
        const weeklyData = data.weeklySalesTrend?.[brandCode] || {};
        
        let insight = `<strong>ğŸ“Š ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ë¶„ì„</strong><br>`;
        
        // ì „ì²´ ì±„ë„ í•©ê³„ ê³„ì‚°
        let totalCurrent = [];
        let totalPrevious = [];
        
        Object.keys(weeklyData).forEach(channel => {
          const channelData = weeklyData[channel];
          if (channelData.current && channelData.previous) {
            channelData.current.forEach((week, idx) => {
              if (!totalCurrent[idx]) totalCurrent[idx] = 0;
              totalCurrent[idx] += week.value || 0;
            });
            channelData.previous.forEach((week, idx) => {
              if (!totalPrevious[idx]) totalPrevious[idx] = 0;
              totalPrevious[idx] += week.value || 0;
            });
          }
        });
        
        if (totalCurrent.length > 0) {
          const currentTotal = totalCurrent.reduce((sum, val) => sum + val, 0) / 100000000;
          const previousTotal = totalPrevious.reduce((sum, val) => sum + val, 0) / 100000000;
          const yoy = previousTotal > 0 ? ((currentTotal / previousTotal - 1) * 100).toFixed(1) : 0;
          
          insight += `â€¢ í˜„ì¬ê¹Œì§€ ëˆ„ì  ë§¤ì¶œì€ <strong>${currentTotal.toFixed(1)}ì–µì›</strong>ìœ¼ë¡œ ì „ë…„ ëŒ€ë¹„ <strong>${yoy > 0 ? '+' : ''}${yoy}%</strong> ${yoy > 0 ? 'ì„±ì¥' : 'ê°ì†Œ'}í–ˆìŠµë‹ˆë‹¤.<br>`;
          
          // ìµœê·¼ ì£¼ì°¨ ì¶”ì„¸ ë¶„ì„
          if (totalCurrent.length >= 3) {
            const recent3Weeks = totalCurrent.slice(-3);
            const avgRecent = recent3Weeks.reduce((sum, val) => sum + val, 0) / 3 / 100000000;
            const earlier3Weeks = totalCurrent.slice(0, 3);
            const avgEarlier = earlier3Weeks.reduce((sum, val) => sum + val, 0) / 3 / 100000000;
            
            if (avgRecent > avgEarlier * 1.1) {
              insight += `â€¢ ìµœê·¼ 3ì£¼ í‰ê·  ë§¤ì¶œì´ ì´ˆê¸° 3ì£¼ ëŒ€ë¹„ <strong>${((avgRecent / avgEarlier - 1) * 100).toFixed(1)}%</strong> ì¦ê°€í•˜ì—¬ ìƒìŠ¹ ì¶”ì„¸ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.<br>`;
            } else if (avgRecent < avgEarlier * 0.9) {
              insight += `â€¢ ìµœê·¼ 3ì£¼ í‰ê·  ë§¤ì¶œì´ ì´ˆê¸° 3ì£¼ ëŒ€ë¹„ <strong>${((1 - avgRecent / avgEarlier) * 100).toFixed(1)}%</strong> ê°ì†Œí•˜ì—¬ í•˜ë½ ì¶”ì„¸ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.<br>`;
            }
          }
        }
        
        return insight;
      } catch (error) {
        console.error('ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ì¸ì‚¬ì´íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
        return 'ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ë°ì´í„° ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      }
    }
    
    // ì¬ê³ ì£¼ìˆ˜ JSON ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ìƒì„±
    async function generateInventoryInsight() {
      try {
        const dateParam = getDateParam();
        const baseUrl = `/public/data/${dateParam}`;
        const brandCode = brandCodeMap[currentBrand] || 'M';
        
        const response = await fetch(`${baseUrl}/stock_analysis.json`);
        if (!response.ok) return 'ì¬ê³ ì£¼ìˆ˜ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
        
        const data = await response.json();
        const stockData = data.clothingBrandStatus?.[brandCode] || [];
        
        let insight = `<strong>ğŸ“Š ì¬ê³ ì£¼ìˆ˜ ë¶„ì„</strong><br>`;
        
        if (stockData.length > 0) {
          // ì¬ê³ ì£¼ìˆ˜ ë†’ì€ ìƒí’ˆ ë¶„ì„
          const highStockItems = stockData.filter(item => item.stockWeeks > 40);
          if (highStockItems.length > 0) {
            insight += `â€¢ ì¬ê³ ì£¼ìˆ˜ <strong>40ì£¼ ì´ìƒ</strong>ì¸ ìƒí’ˆì´ <strong>${highStockItems.length}ê°œ</strong>ë¡œ ì¬ê³  ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.<br>`;
          }
          
          // ì „ë…„ ëŒ€ë¹„ ì¬ê³  ì¦ê°€ ìƒí’ˆ
          const increasedStockItems = stockData.filter(item => item.stockWeeksDiff > 10);
          if (increasedStockItems.length > 0) {
            insight += `â€¢ ì „ë…„ ëŒ€ë¹„ ì¬ê³ ì£¼ìˆ˜ê°€ <strong>10ì£¼ ì´ìƒ</strong> ì¦ê°€í•œ ìƒí’ˆì´ <strong>${increasedStockItems.length}ê°œ</strong>ì…ë‹ˆë‹¤.<br>`;
          }
          
          // íŒë§¤ìœ¨ ë‚®ì€ ìƒí’ˆ
          const lowSalesRateItems = stockData.filter(item => item.cumSalesRate < 0.3);
          if (lowSalesRateItems.length > 0) {
            insight += `â€¢ ëˆ„ì  íŒë§¤ìœ¨ <strong>30% ë¯¸ë§Œ</strong>ì¸ ìƒí’ˆì´ <strong>${lowSalesRateItems.length}ê°œ</strong>ë¡œ íŒë§¤ ì „ëµ ì¬ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.<br>`;
          }
        }
        
        return insight;
      } catch (error) {
        console.error('ì¬ê³ ì£¼ìˆ˜ ì¸ì‚¬ì´íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
        return 'ì¬ê³ ì£¼ìˆ˜ ë°ì´í„° ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      }
    }
    
    // íŒë§¤ìœ¨ JSON ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ìƒì„±
    async function generateSaleRateInsight() {
      try {
        const dateParam = getDateParam();
        const baseUrl = `/public/data/${dateParam}`;
        const brandCode = brandCodeMap[currentBrand] || 'M';
        
        const response = await fetch(`${baseUrl}/stock_analysis.json`);
        if (!response.ok) return 'íŒë§¤ìœ¨ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
        
        const data = await response.json();
        const stockData = data.clothingBrandStatus?.[brandCode] || [];
        
        let insight = `<strong>ğŸ“Š íŒë§¤ìœ¨ ë¶„ì„</strong><br>`;
        
        if (stockData.length > 0) {
          // í‰ê·  íŒë§¤ìœ¨ ê³„ì‚°
          const avgSalesRate = stockData.reduce((sum, item) => sum + (item.cumSalesRate || 0), 0) / stockData.length;
          insight += `â€¢ í‰ê·  ëˆ„ì  íŒë§¤ìœ¨ì€ <strong>${(avgSalesRate * 100).toFixed(1)}%</strong>ì…ë‹ˆë‹¤.<br>`;
          
          // íŒë§¤ìœ¨ ë†’ì€ ìƒí’ˆ
          const highSalesRateItems = stockData.filter(item => item.cumSalesRate > 0.6);
          if (highSalesRateItems.length > 0) {
            insight += `â€¢ ëˆ„ì  íŒë§¤ìœ¨ <strong>60% ì´ìƒ</strong>ì¸ ìƒí’ˆì´ <strong>${highSalesRateItems.length}ê°œ</strong>ë¡œ íŒë§¤ ì„±ê³¼ê°€ ìš°ìˆ˜í•©ë‹ˆë‹¤.<br>`;
          }
          
          // íŒë§¤ìœ¨ ë‚®ì€ ìƒí’ˆ
          const lowSalesRateItems = stockData.filter(item => item.cumSalesRate < 0.3);
          if (lowSalesRateItems.length > 0) {
            insight += `â€¢ ëˆ„ì  íŒë§¤ìœ¨ <strong>30% ë¯¸ë§Œ</strong>ì¸ ìƒí’ˆì´ <strong>${lowSalesRateItems.length}ê°œ</strong>ë¡œ íŒë§¤ ì „ëµ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.<br>`;
          }
          
          // ì „ë…„ ëŒ€ë¹„ íŒë§¤ìœ¨ ë³€í™”
          const improvedItems = stockData.filter(item => item.cumSalesRateDiff > 0.05);
          if (improvedItems.length > 0) {
            insight += `â€¢ ì „ë…„ ëŒ€ë¹„ íŒë§¤ìœ¨ì´ <strong>5%p ì´ìƒ</strong> ê°œì„ ëœ ìƒí’ˆì´ <strong>${improvedItems.length}ê°œ</strong>ì…ë‹ˆë‹¤.<br>`;
          }
        }
        
        return insight;
      } catch (error) {
        console.error('íŒë§¤ìœ¨ ì¸ì‚¬ì´íŠ¸ ìƒì„± ì˜¤ë¥˜:', error);
        return 'íŒë§¤ìœ¨ ë°ì´í„° ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
      }
    }

    async function renderAIPartNotes(){
      // ëª¨ë“  íŒŒíŠ¸ë³„ ë¶„ì„ ë…¸íŠ¸ ì œê±°
      clearAIPartNotes();

      // AI ì¸ì‚¬ì´íŠ¸ ë°ì´í„°ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìœ¼ë©´ ë¡œë“œ ì‹œë„
      if (insightsDataPromise) {
        try {
          const loadedInsights = await insightsDataPromise;
          if (loadedInsights) {
            // ë¡œë“œëœ ë°ì´í„°ë¡œ insightsData ì—…ë°ì´íŠ¸
            Object.assign(insightsData, loadedInsights);
            console.log('âœ… AI ì¸ì‚¬ì´íŠ¸ ë°ì´í„° ì ìš© ì™„ë£Œ');
          }
          insightsDataPromise = null; // í•œ ë²ˆë§Œ ë¡œë“œ
        } catch (error) {
          console.error('AI ì¸ì‚¬ì´íŠ¸ ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
        }
      }

      // ë¸Œëœë“œë³„ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      const brandData = insightsData[currentBrand] || insightsData.MLB;
      
      // ê° ì˜ì—­ë³„ JSON íŒŒì¼ ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ìƒì„± (ë¹„ë™ê¸°)
      const [plInsight, treemapInsight, radarInsight, channelPLInsight, weeklyInsight, inventoryInsight, saleRateInsight] = await Promise.all([
        generatePLInsight(),
        generateTreemapInsight(),
        generateRadarInsight(),
        generateChannelPLInsight(),
        generateWeeklyInsight(),
        generateInventoryInsight(),
        generateSaleRateInsight()
      ]);
      
      // ê° ê·¸ë˜í”„ë³„ ì¸ì‚¬ì´íŠ¸ ë¶„ì„ ë°ì´í„° êµ¬ì¡°
      const insights = {
        treemap: { // ì±„ë„ë³„/ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„±
          content: brandData?.treemapInsight || treemapInsight || 'ì±„ë„ë³„/ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„± ë¶„ì„ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.'
        },
        radar: { // ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„
          content: brandData?.radarInsight || radarInsight || 'ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ ë¶„ì„ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.'
        },
        channelPl: { // ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„
          content: brandData?.channelPlInsight || channelPLInsight || 'ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.'
        },
        weekly: { // ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸
          content: brandData?.weeklyInsight || weeklyInsight || 'ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ë¶„ì„ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.'
        },
        saleRate: { // íŒë§¤ìœ¨ ë¶„ì„
          content: brandData?.saleRateInsight || saleRateInsight || 'íŒë§¤ìœ¨ ë¶„ì„ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.'
        },
        inventory: { // ì¬ê³ ì£¼ìˆ˜ ë¶„ì„
          content: brandData?.inventoryInsight || inventoryInsight || 'ì¬ê³ ì£¼ìˆ˜ ë¶„ì„ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.'
        },
        pl: { // ì†ìµê³„ì‚°ì„œ ë¶„ì„
          content: brandData?.part1 || plInsight || 'ì†ìµê³„ì‚°ì„œ ë¶„ì„ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.'
        }
      };

      // ì €ì¥ëœ í¸ì§‘ ë‚´ìš© ë¡œë“œ
      const savedEdits = localStorage.getItem(`ai-part-edits-${currentBrand}`);
      const edits = savedEdits ? JSON.parse(savedEdits) : {};
      
      // ì†ìµê³„ì‚°ì„œ ë¶„ì„ ë…¸íŠ¸ ë Œë”ë§ (brand-pl ë‚´ë¶€)
      const note1 = document.getElementById('ai-part-note-1');
      const note1Content = document.getElementById('ai-part-note-1-content');
      if (note1 && note1Content) {
        const editKey = 'ai-part-pl';
        const content = edits[editKey] !== undefined ? edits[editKey] : insights.pl.content;
        note1Content.innerHTML = content;
        note1Content.className = 'ai-part-editable';
        note1.style.display = 'block';
      }

      // ê° ê·¸ë˜í”„ë³„ ì¸ì‚¬ì´íŠ¸ ë¶„ì„ ë…¸íŠ¸ ë Œë”ë§
      // ì±„ë„ë³„/ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„± ë¶„ì„
      const treemapNote = document.getElementById('ai-insight-treemap');
      const treemapContent = document.getElementById('ai-insight-treemap-content');
      if (treemapNote && treemapContent) {
        const editKey = 'ai-part-treemap';
        const content = edits[editKey] !== undefined ? edits[editKey] : insights.treemap.content;
        treemapContent.innerHTML = content;
        treemapContent.className = 'ai-part-editable';
        treemapNote.style.display = 'block';
      }

      // ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ ë¶„ì„
      const radarNote = document.getElementById('ai-insight-radar');
      const radarContent = document.getElementById('ai-insight-radar-content');
      if (radarNote && radarContent) {
        const editKey = 'ai-part-radar';
        const content = edits[editKey] !== undefined ? edits[editKey] : insights.radar.content;
        radarContent.innerHTML = content;
        radarContent.className = 'ai-part-editable';
        radarNote.style.display = 'block';
      }

      // ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„
      const channelPlNote = document.getElementById('ai-insight-channel-pl');
      const channelPlContent = document.getElementById('ai-insight-channel-pl-content');
      if (channelPlNote && channelPlContent) {
        const editKey = 'ai-part-channel-pl';
        const content = edits[editKey] !== undefined ? edits[editKey] : insights.channelPl.content;
        channelPlContent.innerHTML = content;
        channelPlContent.className = 'ai-part-editable';
        channelPlNote.style.display = 'block';
      }

      // ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ë¶„ì„
      const weeklyNote = document.getElementById('ai-insight-weekly');
      const weeklyContent = document.getElementById('ai-insight-weekly-content');
      if (weeklyNote && weeklyContent) {
        const editKey = 'ai-part-weekly';
        const content = edits[editKey] !== undefined ? edits[editKey] : insights.weekly.content;
        weeklyContent.innerHTML = content;
        weeklyContent.className = 'ai-part-editable';
        weeklyNote.style.display = 'block';
      }

      // íŒë§¤ìœ¨ ë¶„ì„
      const saleRateNote = document.getElementById('ai-insight-sale-rate');
      const saleRateContent = document.getElementById('ai-insight-sale-rate-content');
      if (saleRateNote && saleRateContent) {
        const editKey = 'ai-part-sale-rate';
        const content = edits[editKey] !== undefined ? edits[editKey] : insights.saleRate.content;
        saleRateContent.innerHTML = content;
        saleRateContent.className = 'ai-part-editable';
        saleRateNote.style.display = 'block';
      }

      // ì¬ê³ ì£¼ìˆ˜ ë¶„ì„
      const inventoryNote = document.getElementById('ai-insight-inventory');
      const inventoryContent = document.getElementById('ai-insight-inventory-content');
      if (inventoryNote && inventoryContent) {
        const editKey = 'ai-part-inventory';
        const content = edits[editKey] !== undefined ? edits[editKey] : insights.inventory.content;
        inventoryContent.innerHTML = content;
        inventoryContent.className = 'ai-part-editable';
        inventoryNote.style.display = 'block';
      }
      
      // í¸ì§‘ ëª¨ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ í¸ì§‘ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
      setTimeout(() => {
        applyAIPartEditMode();
        loadAIPartEdits();
      }, 50);
      
      // ë©”ëª¨ ìœ„ì¹˜ ë™ì  ì¡°ì • (ì‹¤ì œ ìš”ì†Œ ìœ„ì¹˜ ì¸¡ì •í•˜ì—¬ ìë™ ì¡°ì •)
      adjustNotePositions();
    }
    
    // ë©”ëª¨ ìœ„ì¹˜ ì¡°ì • í•¨ìˆ˜ (ì‹¤ì œ ìš”ì†Œ ìœ„ì¹˜ë¥¼ ì¸¡ì •í•˜ì—¬ ìë™ìœ¼ë¡œ ì¡°ì •)
    function adjustNotePositions(){
      const financialReport = document.querySelector('.financial-report');
      const mainContent = document.querySelector('.main-content');
      
      if (!financialReport || !mainContent) return;
      
      // ìš°ì¸¡ íŒ¨ë„ê³¼ ì¤‘ì•™ ì»¨í…ì¸ ì˜ ìƒë‹¨ ìœ„ì¹˜ ì°¨ì´ ê³„ì‚°
      const financialReportRect = financialReport.getBoundingClientRect();
      const financialReportScrollTop = financialReport.scrollTop || 0;
      
      // ê° ê·¸ë˜í”„/í‘œ ìš”ì†Œ ì°¾ê¸° ë° ìœ„ì¹˜ ì¸¡ì •
      const elements = {
        'ai-insight-treemap': document.querySelector('#treemapWrapperChannel')?.closest('.chart-container') || document.querySelector('#content-brand .charts-grid .chart-container:first-child'),
        'ai-insight-radar': document.querySelector('#radarChart')?.closest('.chart-container'),
        'ai-insight-channel-pl': document.querySelector('#channel-pl-inline')?.closest('.chart-container'),
        'ai-insight-weekly': document.querySelector('#weeklyTrendChart')?.closest('.chart-container'),
        'ai-insight-sale-rate': document.querySelector('#itemDiffTable')?.closest('.chart-container'),
        'ai-insight-inventory': document.querySelector('#itemDiffTable')?.closest('.chart-container')
      };
      
      // ê° ë©”ëª¨ì˜ ì´ˆê¸° ìœ„ì¹˜ë¥¼ í•´ë‹¹ ì°¨íŠ¸/í…Œì´ë¸” ìš”ì†Œ ì•„ë˜ì— ë°°ì¹˜
      Object.entries(elements).forEach(([noteId, element]) => {
        const note = document.getElementById(noteId);
        if (note && element && note.style.display !== 'none') {
          // ì¤‘ì•™ ì»¨í…ì¸ ì˜ ê·¸ë˜í”„ ìš”ì†Œ ìœ„ì¹˜ (viewport ê¸°ì¤€)
          const elementRect = element.getBoundingClientRect();
          // ìš°ì¸¡ íŒ¨ë„ ë‚´ë¶€ì˜ ìƒëŒ€ì  ìœ„ì¹˜ ê³„ì‚°
          const relativeTop = elementRect.top - financialReportRect.top + financialReportScrollTop;
          
          // ì°¨íŠ¸/í…Œì´ë¸” ìš”ì†Œì˜ ë†’ì´ë¥¼ ê³ ë ¤í•˜ì—¬ ê·¸ ì•„ë˜ì— ë°°ì¹˜
          const elementHeight = elementRect.height || 0;
          note.style.top = Math.max(0, relativeTop + elementHeight + 10) + 'px'; // 10px ê°„ê²©
        }
      });
      
      // ë©”ëª¨ë“¤ì´ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ìˆœì°¨ì ìœ¼ë¡œ ì¬ë°°ì¹˜
      setTimeout(() => {
        const noteOrder = [
          'ai-insight-treemap',
          'ai-insight-radar',
          'ai-insight-channel-pl',
          'ai-insight-weekly',
          'ai-insight-sale-rate',
          'ai-insight-inventory'
        ];
        
        let currentTop = 0;
        const spacing = 15; // ë©”ëª¨ ê°„ ê°„ê²©
        
        noteOrder.forEach((noteId, index) => {
          const note = document.getElementById(noteId);
          if (note && note.style.display !== 'none') {
            // ì²« ë²ˆì§¸ ë©”ëª¨ëŠ” ì´ˆê¸° ìœ„ì¹˜ ìœ ì§€
            if (index === 0) {
              const noteRect = note.getBoundingClientRect();
              currentTop = noteRect.top - financialReportRect.top + financialReportScrollTop;
            } else {
              // ì´ì „ ë©”ëª¨ì˜ ë†’ì´ë¥¼ ê³ ë ¤í•˜ì—¬ ë°°ì¹˜
              const prevNote = document.getElementById(noteOrder[index - 1]);
              if (prevNote && prevNote.style.display !== 'none') {
                const prevNoteRect = prevNote.getBoundingClientRect();
                const prevNoteRelativeTop = prevNoteRect.top - financialReportRect.top + financialReportScrollTop;
                currentTop = prevNoteRelativeTop + prevNoteRect.height + spacing;
              }
            }
            
            note.style.top = currentTop + 'px';
          }
        });
      }, 100);
      
      // í´ë°±: ìš”ì†Œë¥¼ ì°¾ì§€ ëª»í•œ ê²½ìš° ê¸°ë³¸ê°’ ì‚¬ìš© (ìˆœì°¨ì ìœ¼ë¡œ ë°°ì¹˜)
      setTimeout(() => {
        const fallbackPositions = {
          'ai-insight-treemap': 320,
          'ai-insight-radar': 450,
          'ai-insight-channel-pl': 640,
          'ai-insight-weekly': 640,
          'ai-insight-sale-rate': 940,
          'ai-insight-inventory': 1020
        };
        
        // ìš”ì†Œë¥¼ ì°¾ì§€ ëª»í•œ ë©”ëª¨ë“¤ì— ëŒ€í•´ fallback ìœ„ì¹˜ ì‚¬ìš©
        Object.entries(elements).forEach(([noteId, element]) => {
          const note = document.getElementById(noteId);
          if (note && !element && note.style.display !== 'none') {
            const fallbackTop = fallbackPositions[noteId] || 320;
            note.style.top = fallbackTop + 'px';
          }
        });
      }, 150);
    }

    function clearAIPartNotes(){
      // ì¹´ë“œì˜ ë©”ëª¨ì§€ ì œê±°
      document.querySelectorAll('.ai-note').forEach(n=> n.remove());
      // ìš°ì¸¡ í•˜ë‹¨ ë©”ëª¨ 3ê°œ ìˆ¨ê¹€
      ['ai-rightnote-1','ai-rightnote-2','ai-rightnote-3'].forEach(id=>{
        const el = document.getElementById(id); if(el){ el.style.display='none'; el.innerHTML=''; }
      });
      // ì†ìµê³„ì‚°ì„œ ë¶„ì„ ë…¸íŠ¸ ìˆ¨ê¹€ (brand-pl ë‚´ë¶€)
      const note1 = document.getElementById('ai-part-note-1');
      if (note1) {
        note1.style.display = 'none';
      }
      // ì†ìµê³„ì‚°ì„œ ë¶„ì„ ë…¸íŠ¸ ë‚´ìš© ì´ˆê¸°í™”
      const note1Content = document.getElementById('ai-part-note-1-content');
      if (note1Content) {
        note1Content.innerHTML = '';
      }

      // ê° ê·¸ë˜í”„ë³„ ì¸ì‚¬ì´íŠ¸ ë¶„ì„ ë…¸íŠ¸ ìˆ¨ê¹€
      ['ai-insight-treemap','ai-insight-radar','ai-insight-channel-pl','ai-insight-weekly','ai-insight-sale-rate','ai-insight-inventory'].forEach(id=>{
        const el = document.getElementById(id);
        if (el) {
          el.style.display = 'none';
        }
      });
      
      // ê° ê·¸ë˜í”„ë³„ ì¸ì‚¬ì´íŠ¸ ë¶„ì„ ë…¸íŠ¸ ë‚´ìš© ì´ˆê¸°í™”
      ['ai-insight-treemap-content','ai-insight-radar-content','ai-insight-channel-pl-content','ai-insight-weekly-content','ai-insight-sale-rate-content','ai-insight-inventory-content'].forEach(id=>{
        const el = document.getElementById(id);
        if (el) {
          el.innerHTML = '';
        }
      });
    }

    // 2) brandData / insightsData: data.jsê°€ ì œê³µí•˜ë©´ ëŒ€ì²´, ì—†ìœ¼ë©´ ê¸°ì¡´ í•˜ë“œì½”ë”© ì‚¬ìš©
    let brandData = (D.brandData) ? D.brandData : {
      MLB:{current:{revenue:{value:349.3,target:331.3,achievement:105,yoy:4.5},profit:{value:94.2,target:93.1,achievement:101,yoy:0},margin:{value:27.0,target:28.1,change:-1.1,yoy:-1.2},progress:{value:105,target:100,achievement:105,yoy:4.5}},revenue:{target:331.3,forecast:349.3,achievement:105,yoy:105},profit:{target:93.1,forecast:94.2,achievement:101,yoy:100},margin:{target:28.1,forecast:27.0,change:-1.1},channels:{ë°±í™”ì :{target:70.70,forecast:82.62,achievement:117},ë©´ì„¸ì :{target:110.00,forecast:110.20,achievement:100},ì§ì˜ê°€ë‘:{target:29.92,forecast:28.55,achievement:95},ì§ì˜ëª°:{target:4.75,forecast:5.75,achievement:121},ì˜¨ë¼ì¸ìì‚¬:{target:11.46,forecast:9.78,achievement:85},ì˜¨ë¼ì¸ì œíœ´:{target:20.22,forecast:18.68,achievement:92},ëŒ€ë¦¬ì :{target:50.20,forecast:63.32,achievement:126},ì‚¬ì…:{target:34.05,forecast:30.39,achievement:89}}},
      MLB_KIDS:{current:{revenue:{value:79.5,target:89.0,achievement:89,yoy:-7.8},profit:{value:8.1,target:5.8,achievement:139,yoy:-25.0},margin:{value:10.2,target:6.6,change:3.6,yoy:-2.2},progress:{value:89,target:100,achievement:89,yoy:-7.8}},revenue:{target:89.0,forecast:79.5,achievement:89,yoy:92},profit:{target:5.8,forecast:8.1,achievement:139,yoy:75},margin:{target:6.6,forecast:10.2,change:3.6},channels:{ë°±í™”ì :{target:32.61,forecast:30.82,achievement:95},ë©´ì„¸ì :{target:8.11,forecast:7.18,achievement:88},ì§ì˜ê°€ë‘:{target:1.60,forecast:1.22,achievement:76},ì§ì˜ëª°:{target:3.80,forecast:3.42,achievement:90},ì˜¨ë¼ì¸ìì‚¬:{target:3.31,forecast:3.36,achievement:101},ì˜¨ë¼ì¸ì œíœ´:{target:8.69,forecast:10.02,achievement:115},ëŒ€ë¦¬ì :{target:7.82,forecast:8.98,achievement:115},ì‚¬ì…:{target:23.07,forecast:14.49,achievement:63}}},
      DISCOVERY:{current:{revenue:{value:403.2,target:459.0,achievement:88,yoy:-13.1},profit:{value:89.7,target:107.5,achievement:83,yoy:-16.9},margin:{value:22.2,target:23.4,change:-1.2,yoy:-1.0},progress:{value:88,target:100,achievement:88,yoy:-13.1}},revenue:{target:459.0,forecast:403.2,achievement:88,yoy:87},profit:{target:107.5,forecast:89.7,achievement:83,yoy:83},margin:{target:23.4,forecast:22.2,change:-1.2},channels:{ë°±í™”ì :{target:113.15,forecast:90.99,achievement:80},ë©´ì„¸ì :{target:13.00,forecast:12.38,achievement:95},ì§ì˜ê°€ë‘:{target:4.45,forecast:3.46,achievement:78},ì§ì˜ëª°:{target:13.54,forecast:8.88,achievement:66},ì˜¨ë¼ì¸ìì‚¬:{target:15.14,forecast:14.85,achievement:98},ì˜¨ë¼ì¸ì œíœ´:{target:40.99,forecast:39.27,achievement:96},ëŒ€ë¦¬ì :{target:130.92,forecast:123.54,achievement:94},ì•„ìš¸ë ›:{target:111.32,forecast:102.50,achievement:92},íŒ©í† ë¦¬ì•„ìš¸ë ›:{target:7.49,forecast:4.32,achievement:58},ì‚¬ì…:{target:9.00,forecast:3.02,achievement:34}}},
      DUVETICA:{current:{revenue:{value:38.7,target:32.5,achievement:119,yoy:108.9},profit:{value:10.6,target:7.1,achievement:148,yoy:-87.3},margin:{value:27.3,target:21.9,change:5.4,yoy:-52.7},progress:{value:119,target:100,achievement:119,yoy:108.9}},revenue:{target:32.5,forecast:38.7,achievement:119,yoy:209},profit:{target:7.1,forecast:10.6,achievement:148,yoy:-87},margin:{target:21.9,forecast:27.3,change:5.4},channels:{ë°±í™”ì :{target:11.90,forecast:13.32,achievement:112},ì§ì˜ëª°:{target:1.40,forecast:1.74,achievement:124},ì˜¨ë¼ì¸ìì‚¬:{target:2.38,forecast:2.14,achievement:90},ì˜¨ë¼ì¸ì œíœ´:{target:6.42,forecast:11.97,achievement:186},ì•„ìš¸ë ›:{target:10.10,forecast:9.50,achievement:94}}},
      SERGIO:{current:{revenue:{value:8.4,target:13.5,achievement:63,yoy:-18.0},profit:{value:0.05,target:0.3,achievement:14,yoy:-96.6},margin:{value:0.6,target:2.4,change:-1.8,yoy:-13.9},progress:{value:63,target:100,achievement:63,yoy:-18.0}},revenue:{target:13.5,forecast:8.4,achievement:63,yoy:82},profit:{target:0.3,forecast:0.05,achievement:14,yoy:3},margin:{target:2.4,forecast:0.6,change:-1.8},channels:{ë°±í™”ì :{target:0.16,forecast:0.16,achievement:98},ë©´ì„¸ì :{target:1.20,forecast:0.76,achievement:64},ì§ì˜ëª°:{target:3.20,forecast:1.59,achievement:50},ì˜¨ë¼ì¸ìì‚¬:{target:3.90,forecast:2.31,achievement:59},ì˜¨ë¼ì¸ì œíœ´:{target:3.90,forecast:2.69,achievement:69},ì•„ìš¸ë ›:{target:1.10,forecast:0.91,achievement:83}}},
      SUPRA:{current:{revenue:{value:2.5,target:4.0,achievement:63,yoy:-22.5},profit:{value:-1.3,target:-0.5,achievement:-68,yoy:-14.9},margin:{value:-52.0,target:-12.3,change:-39.7,yoy:6.7},progress:{value:63,target:100,achievement:63,yoy:-22.5}},revenue:{target:4.0,forecast:2.5,achievement:63,yoy:77},profit:{target:-0.5,forecast:-1.3,achievement:-68,yoy:85},margin:{target:-12.3,forecast:-52.0,change:-39.7},channels:{ì˜¨ë¼ì¸ìì‚¬:{target:0.72,forecast:1.04,achievement:145},ì˜¨ë¼ì¸ì œíœ´:{target:1.08,forecast:1.46,achievement:136}}}
    };

    // AI ì¸ì‚¬ì´íŠ¸ ë°ì´í„° ë¡œë“œ (JSON íŒŒì¼ì—ì„œ)
    async function loadAIInsightsData() {
      try {
        const dateParam = getDateParam();
        const baseUrl = `/public/data/${dateParam}/ai_insights`;
        const response = await fetch(`${baseUrl}/insights_data_${dateParam}.json`);
        
        if (response.ok) {
          const data = await response.json();
          console.log('âœ… AI ì¸ì‚¬ì´íŠ¸ ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', data);
          return data;
        } else {
          console.log('â„¹ï¸ AI ì¸ì‚¬ì´íŠ¸ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.');
          return null;
        }
      } catch (error) {
        console.log('â„¹ï¸ AI ì¸ì‚¬ì´íŠ¸ ë¡œë“œ ì‹¤íŒ¨. ê¸°ë³¸ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:', error);
        return null;
      }
    }
    
    // AI ì¸ì‚¬ì´íŠ¸ ë°ì´í„° ì´ˆê¸°í™” (ë¹„ë™ê¸°)
    let insightsDataPromise = loadAIInsightsData();
    
    let insightsData = (D.insightsData) ? D.insightsData : {
      overview:{content:"10ì›” 31ì¼ ê¸°ì¤€ ì „ì²´ ë¸Œëœë“œ í†µí•© ì‹¤íŒë§¤ì•¡ì€ 881.6ì–µì›ìœ¼ë¡œ ëª©í‘œ(929.3ì–µì›) ëŒ€ë¹„ 95% ë‹¬ì„±, ì „ë…„(916.6ì–µì›) ëŒ€ë¹„ 96%ë¥¼ ê¸°ë¡í•˜ë©° ëª©í‘œì— ë‹¤ì†Œ ë¯¸ë‹¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. MLBê°€ ì „ì²´ ë§¤ì¶œì˜ 39.6%ë¥¼ ì°¨ì§€í•˜ë©° 105% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ ë†’ì€ ì„±ê³¼ë¥¼ ë³´ì´ê³  ìˆìœ¼ë‚˜, DISCOVERY(-12%), MLB KIDS(-11%), SUPRA(-37%)ê°€ ë¶€ì§„í•˜ë©° ì „ì²´ ì‹¤ì ì„ í•˜íšŒí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì˜ì—…ì´ìµì€ 47.3ì–µì›ìœ¼ë¡œ ì „ë…„(50.4ì–µì›) ëŒ€ë¹„ 94% ìˆ˜ì¤€ì…ë‹ˆë‹¤.",keyPoints:"â€¢ ì´ ì‹¤íŒë§¤ì•¡: 881.6ì–µì› (ëª©í‘œ ëŒ€ë¹„ 95%, ì „ë…„ ëŒ€ë¹„ 96%) â€¢ ì˜ì—…ì´ìµ: 47.3ì–µì› (ëª©í‘œ ëŒ€ë¹„ 102%, ì „ë…„ ëŒ€ë¹„ 94%) â€¢ MLB: 349.3ì–µì›ìœ¼ë¡œ 105% ë‹¬ì„±, ìœ ì¼í•œ ëª©í‘œ ì´ˆê³¼ ë¸Œëœë“œ â€¢ DUVETICA: 209% ì„±ì¥ìœ¼ë¡œ ê¸‰ì„±ì¥ì„¸ (ì „ë…„ 18.5ì–µâ†’38.7ì–µ) â€¢ ë¶€ì§„ ë¸Œëœë“œ: DISCOVERY(-13%), MLB KIDS(-11%), SUPRA(-37%) ê°œì„  ì‹œê¸‰"},
      MLB:{
        content:"MLBëŠ” 349.3ì–µì›ì˜ ì‹¤íŒë§¤ì•¡ìœ¼ë¡œ ëª©í‘œ(331.3ì–µì›) ëŒ€ë¹„ 105%, ì „ë…„(334.2ì–µì›) ëŒ€ë¹„ 105%ë¥¼ ë‹¬ì„±í•˜ë©° ìœ ì¼í•˜ê²Œ ëª©í‘œë¥¼ ì´ˆê³¼í•œ ë¸Œëœë“œì…ë‹ˆë‹¤. ëŒ€ë¦¬ì (126% ë‹¬ì„±)ê³¼ ë°±í™”ì (117% ë‹¬ì„±)ì´ ê²¬ì¸í–ˆìœ¼ë©°, ë©´ì„¸ì ì€ ì „ë…„ ëŒ€ë¹„ -4%ë¡œ ì¸ë°”ìš´ë“œ ë¶€ì§„ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì§ì ‘ì´ìµì€ 94.2ì–µì›ìœ¼ë¡œ ì „ë…„ê³¼ ë™ì¼í•˜ë©° ì§ì ‘ì´ìµë¥  27.0%ë¥¼ ìœ ì§€í•˜ê³  ìˆìœ¼ë‚˜, ì‚¬ì… ì±„ë„(-11%)ê³¼ ìì‚¬ëª°(-21%)ì˜ ë¶€ì§„ì´ ê°œì„  ê³¼ì œì…ë‹ˆë‹¤.",
        keyPoints:"â€¢ ì‹¤íŒë§¤ì•¡: 349.3ì–µì› (ëª©í‘œ 105%, ì „ë…„ 105%) - ì „ì²´ ë¸Œëœë“œ ì¤‘ ìœ ì¼í•œ ëª©í‘œ ì´ˆê³¼ ë‹¬ì„± â€¢ ëŒ€ë¦¬ì : 63.3ì–µì› (126% ë‹¬ì„±) / ë°±í™”ì : 82.6ì–µì› (117% ë‹¬ì„±) ê²¬ì¸ â€¢ ë©´ì„¸ì : 110.2ì–µì› (100% ë‹¬ì„±, ì „ë…„ ëŒ€ë¹„ -4%) ì¸ë°”ìš´ë“œ íšŒë³µ ì§€ì—° â€¢ ë¶€ì§„ ì±„ë„: ì‚¬ì… 89%, ìì‚¬ëª° 85% - ì˜¨ë¼ì¸ ë° ìœ í†µ ì „ëµ ì ê²€ í•„ìš”",
        treemapInsight:"MLB ë¸Œëœë“œì˜ ì±„ë„ë³„/ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„±í‘œë¥¼ ë¶„ì„í•œ ê²°ê³¼, ì§ì˜ê°€ë‘ ì±„ë„ì´ ì „ì²´ ë§¤ì¶œì˜ 11.8%ë¥¼ ì°¨ì§€í•˜ë©° 104% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ ìš°ìˆ˜í•œ ì„±ê³¼ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ë°˜ë©´ ì˜¨ë¼ì¸ ìì‚¬ëª°ì€ 4.1%ì˜ ë‚®ì€ ë¹„ì¤‘ê³¼ 74% ë‹¬ì„±ë¥ ë¡œ ë””ì§€í„¸ ì „í™˜ ì „ëµì´ ì‹œê¸‰í•©ë‹ˆë‹¤. ì•„ì´í…œë³„ë¡œëŠ” ACC ìƒí’ˆêµ°ì´ 36.8ì–µì›ìœ¼ë¡œ ê°€ì¥ í° ë¹„ì¤‘ì„ ì°¨ì§€í•˜ë‚˜ 84% ë‹¬ì„±ë¥ ì— ë¨¸ë¬¼ëŸ¬ ìƒí’ˆ ì „ëµ ì¬ì ê²€ì´ í•„ìš”í•©ë‹ˆë‹¤.",
        radarInsight:"MLBì˜ ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ ê·¸ë˜í”„ë¥¼ ë³´ë©´ ëª©í‘œ ëŒ€ë¹„ 88% ë‹¬ì„±ë¥ ë¡œ ëª©í‘œì— ë‹¤ì†Œ ë¯¸ë‹¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì „ë…„ ëŒ€ë¹„ 5.0% ì„±ì¥ì„ ê¸°ë¡í–ˆìœ¼ë‚˜ ëª©í‘œì¹˜(269.4ì–µì›) ëŒ€ë¹„ 32.5ì–µì› ë¶€ì¡±í•©ë‹ˆë‹¤. íŠ¹íˆ ë©´ì„¸ì  ì±„ë„ì—ì„œ ì „ë…„ ëŒ€ë¹„ ì„±ì¥ì„¸ê°€ ë‘”í™”ë˜ì–´ ì¸ë°”ìš´ë“œ ê´€ê´‘ íšŒë³µ ì§€ì—°ì˜ ì˜í–¥ì„ ë°›ê³  ìˆìŠµë‹ˆë‹¤. í•˜ë°˜ê¸° ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•´ ì˜¨ë¼ì¸ ì±„ë„ ê°•í™”ì™€ ACC ìƒí’ˆêµ° ì¬ê³  íšŒì „ìœ¨ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.",
        channelPlInsight:"ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„ ê²°ê³¼, ì§ì˜ê°€ë‘ì ì´ 27.4ì–µì›ì˜ ì˜ˆìƒ ë§¤ì¶œê³¼ 104% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ ìš°ìˆ˜í•œ ìˆ˜ìµì„±ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ë°˜ë©´ ì˜¨ë¼ì¸ ìì‚¬ëª°ì€ 7.5ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 74% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ ë‚®ì€ ì„±ê³¼ë¥¼ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤. ë©´ì„¸ì ë„ 64.0ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 89% ë‹¬ì„±ë¥ ë¡œ ëª©í‘œì— ë¯¸ë‹¬í•˜ê³  ìˆì–´ ì±„ë„ë³„ ì°¨ë³„í™”ëœ ë§ˆì¼€íŒ… ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤.",
        weeklyInsight:"ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ê·¸ë˜í”„ë¥¼ ë³´ë©´ 8ì›” 1ì£¼ì°¨ ëŒ€ë¹„ 3ì£¼ì°¨ê¹Œì§€ ê¾¸ì¤€í•œ ì„±ì¥ì„¸ë¥¼ ë³´ì´ê³  ìˆìœ¼ë‚˜, ëª©í‘œ ëŒ€ë¹„ ì•½ 12% ë¶€ì¡±í•œ ìƒí™©ì…ë‹ˆë‹¤. ì£¼ì°¨ë³„ íŒë§¤ íŒ¨í„´ì„ ë¶„ì„í•œ ê²°ê³¼, ì§ì˜ê°€ë‘ ì±„ë„ì€ ì£¼ë§ ë§¤ì¶œì´ ë†’ê²Œ ë‚˜íƒ€ë‚˜ ì˜¤í”„ë¼ì¸ ì§‘ì¤‘ ë§ˆì¼€íŒ…ì´ íš¨ê³¼ì ì…ë‹ˆë‹¤. ì˜¨ë¼ì¸ ì±„ë„ì€ ì£¼ì¤‘ ë§¤ì¶œì´ ë” ë†’ì•„ ë””ì§€í„¸ í”„ë¡œëª¨ì…˜ ê°•í™”ê°€ í•„ìš”í•©ë‹ˆë‹¤.",
        saleRateInsight:"MLB ë¸Œëœë“œì˜ íŒë§¤ìœ¨ ë¶„ì„ ê²°ê³¼, ëˆ„ì  íŒë§¤ìœ¨ì€ í‰ê·  45.2%ë¡œ ì „ë…„ ë™ê¸° ëŒ€ë¹„ 2.1%p ìƒìŠ¹í–ˆìŠµë‹ˆë‹¤. Outer ì¹´í…Œê³ ë¦¬ëŠ” 52.3%ì˜ ë†’ì€ íŒë§¤ìœ¨ì„ ë³´ì´ë©° íšŒì „ì´ ì–‘í˜¸í•˜ë‚˜, Inner ì¹´í…Œê³ ë¦¬ëŠ” 38.7%ë¡œ ì¬ê³  ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. íŠ¹íˆ ACC ìƒí’ˆêµ°ì˜ íŒë§¤ìœ¨ì´ 35.2%ë¡œ ë‚®ì•„ í”„ë¡œëª¨ì…˜ ì „ëµ ìˆ˜ë¦½ì´ ì‹œê¸‰í•©ë‹ˆë‹¤.",
        inventoryInsight:"ì¬ê³ ì£¼ìˆ˜ ë¶„ì„ ê²°ê³¼, MLBëŠ” í˜„ì¬ ê¸°ì¤€ ì¬ê³  ì£¼ìˆ˜ê°€ ëª©í‘œì¹˜ ëŒ€ë¹„ 8.2% ë†’ì€ ìˆ˜ì¤€ì…ë‹ˆë‹¤. Outer ì¹´í…Œê³ ë¦¬ëŠ” ì¬ê³  íšŒì „ì´ ì–‘í˜¸í•˜ì—¬ ì¶”ê°€ ë°œì£¼ë¥¼ ê³ ë ¤í•  ìˆ˜ ìˆìœ¼ë‚˜, Inner ì¹´í…Œê³ ë¦¬ëŠ” ì¬ê³  ë¶€ë‹´ì´ ì»¤ ì¡°ê¸° ì†Œì§„ ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤. ACC ìƒí’ˆêµ°ì€ ì¬ê³ ì£¼ìˆ˜ê°€ ë†’ì•„ í”„ë¡œëª¨ì…˜ì„ í†µí•œ ì¬ê³  ì†Œì§„ì— ì§‘ì¤‘í•´ì•¼ í•©ë‹ˆë‹¤."
      },
      MLB_KIDS:{
        content:"MLB KIDSëŠ” 79.5ì–µì›ì˜ ì‹¤íŒë§¤ì•¡ìœ¼ë¡œ ëª©í‘œ(89.0ì–µì›) ëŒ€ë¹„ 89%, ì „ë…„(86.2ì–µì›) ëŒ€ë¹„ 92%ë¥¼ ê¸°ë¡í•˜ë©° ëª©í‘œì™€ ì „ë…„ ëª¨ë‘ ë¯¸ë‹¬í•˜ëŠ” ë¶€ì§„í•œ ì‹¤ì ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì œíœ´ëª°(115% ë‹¬ì„±)ê³¼ ëŒ€ë¦¬ì (115% ë‹¬ì„±)ì€ ì–‘í˜¸í•˜ë‚˜, ì‚¬ì… ì±„ë„ì´ 63% ë‹¬ì„±ì— ê·¸ì¹˜ë©° ì „ì²´ ì‹¤ì ì„ í•˜íšŒí–ˆìŠµë‹ˆë‹¤. ì§ì ‘ì´ìµì€ 8.1ì–µì›ìœ¼ë¡œ ì „ë…„(10.8ì–µì›) ëŒ€ë¹„ 75% ìˆ˜ì¤€ì´ë©°, ì§ì ‘ì´ìµë¥  10.2%ë¡œ ì „ë…„(12.5%) ëŒ€ë¹„ 2.3%p í•˜ë½í–ˆìŠµë‹ˆë‹¤.",
        keyPoints:"â€¢ ì‹¤íŒë§¤ì•¡: 79.5ì–µì› (ëª©í‘œ 89%, ì „ë…„ 92%) - ëª©í‘œì™€ ì „ë…„ ëª¨ë‘ ë¯¸ë‹¬ â€¢ ì–‘í˜¸ ì±„ë„: ì œíœ´ëª° 115%, ëŒ€ë¦¬ì  115%, ë°±í™”ì  95% â€¢ ë¶€ì§„ ì±„ë„: ì‚¬ì… 63% (ì „ë…„ ëŒ€ë¹„ -41%) - ìœ í†µ ì „ëµ ì „ë©´ ì¬ê²€í†  í•„ìš” â€¢ ì§ì ‘ì´ìµë¥ : 10.2% (ì „ë…„ ëŒ€ë¹„ -2.3%p) - ìˆ˜ìµì„± ì•…í™” ê°œì„  ì‹œê¸‰",
        treemapInsight:"MLB KIDSì˜ ì±„ë„ë³„/ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„±í‘œ ë¶„ì„ ê²°ê³¼, ë°±í™”ì  ì±„ë„ì´ ì „ì²´ ë§¤ì¶œì˜ 17.1%ë¥¼ ì°¨ì§€í•˜ë©° 93% ë‹¬ì„±ë¥ ë¡œ ì•ˆì •ì ì¸ ì„±ê³¼ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì˜¨ë¼ì¸ ì±„ë„ì€ 15.1% ë¹„ì¤‘ìœ¼ë¡œ í‚¤ì¦ˆ ì œí’ˆì˜ ì˜¨ë¼ì¸ êµ¬ë§¤ ë¹„ì¤‘ì´ ì§€ì†ì ìœ¼ë¡œ ì¦ê°€í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì•„ì´í…œë³„ë¡œëŠ” ì˜ë¥˜ê°€ ì „ì²´ì˜ 58%ë¥¼ ì°¨ì§€í•˜ë©° í‚¤ì¦ˆ ì˜ë¥˜ ì‹œì¥ì—ì„œì˜ ê°•í•œ í¬ì§€ì…˜ì„ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
        radarInsight:"MLB KIDSì˜ ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ ê·¸ë˜í”„ë¥¼ ë³´ë©´ ëª©í‘œ ëŒ€ë¹„ 93% ë‹¬ì„±ë¥ ë¡œ ì•ˆì •ì ì¸ ì„±ì¥ì„¸ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì „ë…„ ëŒ€ë¹„ 112% ì„±ì¥ì„ ê¸°ë¡í•˜ì—¬ í‚¤ì¦ˆ ì‹œì¥ì˜ ì„±ì¥ ì ì¬ë ¥ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. íŠ¹íˆ ë©´ì„¸ì  ì±„ë„ì—ì„œ ì „ë…„ ëŒ€ë¹„ ë†’ì€ ì„±ì¥ì„¸ë¥¼ ë³´ì´ë©° ì¸ë°”ìš´ë“œ ê´€ê´‘ê°ë“¤ì˜ í‚¤ì¦ˆ ì œí’ˆ êµ¬ë§¤ ì¦ê°€ ì¶”ì„¸ë¥¼ ë°˜ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
        channelPlInsight:"ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„ ê²°ê³¼, ëª¨ë“  ì±„ë„ì—ì„œ 90% ì´ìƒì˜ ì•ˆì •ì ì¸ ë‹¬ì„±ë¥ ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ë°±í™”ì  ì±„ë„ì€ 13.5ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 93% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ í° ë¹„ì¤‘ì„ ì°¨ì§€í•˜ë©°, ì˜¨ë¼ì¸ ì±„ë„ì€ 11.9ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 93% ë‹¬ì„±ë¥ ì„ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤. í‚¤ì¦ˆ ì‹œì¥ì˜ ì„±ì¥ê³¼ í•¨ê»˜ ëª¨ë“  ì±„ë„ì—ì„œ ê· í˜•ì¡íŒ ì„±ì¥ì„ ì´ë£¨ê³  ìˆìŠµë‹ˆë‹¤.",
        weeklyInsight:"ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ê·¸ë˜í”„ë¥¼ ë³´ë©´ 8ì›” ì „ì²´ ê¸°ê°„ì— ê±¸ì³ ì•ˆì •ì ì¸ ì„±ì¥ ê³¡ì„ ì„ ê·¸ë¦¬ê³  ìˆìŠµë‹ˆë‹¤. ì£¼ì°¨ë³„ ë³€ë™í­ì´ ì‘ì•„ ì˜ˆì¸¡ ê°€ëŠ¥í•œ ë§¤ì¶œ íŒ¨í„´ì„ ë³´ì´ë©°, ì´ëŠ” í‚¤ì¦ˆ ì œí’ˆì˜ ì¼ê´€ëœ ìˆ˜ìš”ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. íŠ¹íˆ 2-3ì£¼ì°¨ì— ë§¤ì¶œì´ ì§‘ì¤‘ë˜ëŠ” íŒ¨í„´ì„ ë³´ì—¬ ì´ ì‹œê¸° í”„ë¡œëª¨ì…˜ ê°•í™”ê°€ íš¨ê³¼ì ì…ë‹ˆë‹¤.",
        saleRateInsight:"MLB KIDSì˜ íŒë§¤ìœ¨ ë¶„ì„ ê²°ê³¼, ëˆ„ì  íŒë§¤ìœ¨ì€ í‰ê·  58.7%ë¡œ ì „ë…„ ë™ê¸° ëŒ€ë¹„ 4.3%p ìƒìŠ¹í–ˆìŠµë‹ˆë‹¤. í‚¤ì¦ˆ ì˜ë¥˜ ì¹´í…Œê³ ë¦¬ëŠ” 62.1%ì˜ ë†’ì€ íŒë§¤ìœ¨ì„ ë³´ì´ë©° íšŒì „ì´ ë§¤ìš° ì–‘í˜¸í•©ë‹ˆë‹¤. ì•¡ì„¸ì„œë¦¬ ì¹´í…Œê³ ë¦¬ë„ 55.3%ì˜ íŒë§¤ìœ¨ì„ ê¸°ë¡í•˜ì—¬ ì „ì²´ì ìœ¼ë¡œ ê±´ê°•í•œ ì¬ê³  íšŒì „ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.",
        inventoryInsight:"ì¬ê³ ì£¼ìˆ˜ ë¶„ì„ ê²°ê³¼, MLB KIDSëŠ” í˜„ì¬ ê¸°ì¤€ ì¬ê³  ì£¼ìˆ˜ê°€ ëª©í‘œì¹˜ ëŒ€ë¹„ ì ì • ìˆ˜ì¤€ì…ë‹ˆë‹¤. í‚¤ì¦ˆ ì˜ë¥˜ëŠ” ì¬ê³  íšŒì „ì´ ë§¤ìš° ì–‘í˜¸í•˜ì—¬ ì¶”ê°€ ë°œì£¼ë¥¼ ê³ ë ¤í•  ìˆ˜ ìˆìœ¼ë©°, ì•¡ì„¸ì„œë¦¬ ì¹´í…Œê³ ë¦¬ë„ ì•ˆì •ì ì¸ ì¬ê³  ìˆ˜ì¤€ì„ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì „ë°˜ì ìœ¼ë¡œ ì¬ê³  ê´€ë¦¬ê°€ ì–‘í˜¸í•˜ì—¬ ì¶”ê°€ ì„±ì¥ ì—¬ë ¥ì´ ìˆìŠµë‹ˆë‹¤."
      },
      DISCOVERY:{
        content:"DISCOVERYëŠ” 403.2ì–µì›ì˜ ì‹¤íŒë§¤ì•¡ìœ¼ë¡œ ëª©í‘œ(459.0ì–µì›) ëŒ€ë¹„ 88%, ì „ë…„(464.2ì–µì›) ëŒ€ë¹„ 87%ë¥¼ ê¸°ë¡í•˜ë©° 12-13% í•˜íšŒí•˜ëŠ” ë¶€ì§„í•œ ì‹¤ì ì…ë‹ˆë‹¤. ëª¨ë“  ì±„ë„ì—ì„œ ëª©í‘œ ë¯¸ë‹¬ ì¤‘ì´ë©° íŠ¹íˆ ì‚¬ì…(34% ë‹¬ì„±)ê³¼ íŒ©í† ë¦¬ì•„ìš¸ë ›(58% ë‹¬ì„±)ì´ ê·¹ì‹¬í•œ ë¶€ì§„ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì§ì ‘ì´ìµì€ 89.7ì–µì›ìœ¼ë¡œ ì „ë…„(108.0ì–µì›) ëŒ€ë¹„ 83% ìˆ˜ì¤€ì´ë©°, ì§ì ‘ì´ìµë¥  22.2%ë¡œ ì „ë…„ ëŒ€ë¹„ 0.9%p í•˜ë½í–ˆìŠµë‹ˆë‹¤.",
        keyPoints:"â€¢ ì‹¤íŒë§¤ì•¡: 403.2ì–µì› (ëª©í‘œ 88%, ì „ë…„ 87%) - ìµœëŒ€ ë¹„ì¤‘ ë¸Œëœë“œì„ì—ë„ ë¶€ì§„ â€¢ ê·¹ë¶€ì§„ ì±„ë„: ì‚¬ì… 34%, íŒ©í† ë¦¬ì•„ìš¸ë › 58% - ì¦‰ê° êµ¬ì¡°ì¡°ì • í•„ìš” â€¢ ì „ ì±„ë„ ëª©í‘œ ë¯¸ë‹¬: ë°±í™”ì  80%, ëŒ€ë¦¬ì  94%, ì•„ìš¸ë › 92% ë“± ì „ë°˜ì  ë¶€ì§„ â€¢ ì§ì ‘ì´ìµë¥ : 22.2% ìœ ì§€ - ë§ˆì§„ì€ ì–‘í˜¸í•˜ë‚˜ ë§¤ì¶œ íšŒë³µì´ ìµœìš°ì„  ê³¼ì œ",
        treemapInsight:"DISCOVERYì˜ ì±„ë„ë³„/ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„±í‘œ ë¶„ì„ ê²°ê³¼, ë©´ì„¸ì  ì±„ë„ì´ ì „ì²´ ë§¤ì¶œì˜ 30.2%ë¥¼ ì°¨ì§€í•˜ë©° 92% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ í° ë¹„ì¤‘ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì•„ì›ƒë„ì–´ ì œí’ˆì˜ íŠ¹ì„±ìƒ ë©´ì„¸ì ì—ì„œì˜ êµ¬ë§¤ê°€ í™œë°œí•©ë‹ˆë‹¤. ì˜¨ë¼ì¸ ì±„ë„ì€ 21.4% ë¹„ì¤‘ìœ¼ë¡œ ì˜¨ë¼ì¸ í™•ëŒ€ ì—¬ë ¥ì´ ìˆìœ¼ë‚˜ í˜„ì¬ 92% ë‹¬ì„±ë¥ ì— ë¨¸ë¬¼ëŸ¬ ìˆìŠµë‹ˆë‹¤. ì•„ì´í…œë³„ë¡œëŠ” ì•„ì›ƒë„ì–´ ì˜ë¥˜ê°€ 65%ì˜ ë¹„ì¤‘ì„ ì°¨ì§€í•©ë‹ˆë‹¤.",
        radarInsight:"DISCOVERYì˜ ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ ê·¸ë˜í”„ë¥¼ ë³´ë©´ ëª©í‘œ ëŒ€ë¹„ 92% ë‹¬ì„±ë¥ ë¡œ ì–‘í˜¸í•œ ì„±ê³¼ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì „ë…„ ëŒ€ë¹„ 98%ë¥¼ ê¸°ë¡í•˜ì—¬ ì•„ì›ƒë„ì–´ ì‹œì¥ì˜ ì„±ì¥ì„¸ë¥¼ ë°˜ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ ë©´ì„¸ì  ì±„ë„ì—ì„œ ì „ë…„ ëŒ€ë¹„ ë†’ì€ ì„±ì¥ì„ ë³´ì´ë©° ì¸ë°”ìš´ë“œ ê´€ê´‘ê°ë“¤ì˜ ì•„ì›ƒë„ì–´ ì œí’ˆ êµ¬ë§¤ ì¦ê°€ë¥¼ í™•ì¸í–ˆìŠµë‹ˆë‹¤.",
        channelPlInsight:"ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„ ê²°ê³¼, ë©´ì„¸ì  ì±„ë„ì´ 12.7ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 92% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ í° ë¹„ì¤‘ì„ ì°¨ì§€í•©ë‹ˆë‹¤. ë°±í™”ì  ì±„ë„ì€ 9.4ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 92% ë‹¬ì„±ë¥ ì„ ê¸°ë¡í–ˆìœ¼ë©°, ì˜¨ë¼ì¸ ì±„ë„ì€ 9.0ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 92% ë‹¬ì„±ë¥ ì„ ë³´ì˜€ìŠµë‹ˆë‹¤. ëª¨ë“  ì±„ë„ì—ì„œ ê· í˜•ì¡íŒ 90%ëŒ€ ë‹¬ì„±ë¥ ì„ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
        weeklyInsight:"ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ê·¸ë˜í”„ë¥¼ ë³´ë©´ 8ì›” ì „ì²´ ê¸°ê°„ì— ê±¸ì³ ê¾¸ì¤€í•œ ì„±ì¥ì„¸ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì£¼ì°¨ë³„ ë³€ë™í­ì´ ë¹„êµì  ì•ˆì •ì ì´ë©°, íŠ¹íˆ ì¤‘ìˆœ ì´í›„ ë§¤ì¶œì´ ìƒìŠ¹í•˜ëŠ” íŒ¨í„´ì„ ë³´ì—¬ í•˜ë°˜ê¸° ì‹œì¦Œì„±ì„ ë°˜ì˜í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì•„ì›ƒë„ì–´ ì œí’ˆì˜ íŠ¹ì„±ìƒ ì£¼ë§ ë§¤ì¶œì´ ë†’ê²Œ ë‚˜íƒ€ë‚˜ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤.",
        saleRateInsight:"DISCOVERYì˜ íŒë§¤ìœ¨ ë¶„ì„ ê²°ê³¼, ëˆ„ì  íŒë§¤ìœ¨ì€ í‰ê·  51.3%ë¡œ ì „ë…„ ë™ê¸° ëŒ€ë¹„ 1.2%p ìƒìŠ¹í–ˆìŠµë‹ˆë‹¤. ì•„ì›ƒë„ì–´ ì˜ë¥˜ ì¹´í…Œê³ ë¦¬ëŠ” 54.8%ì˜ íŒë§¤ìœ¨ì„ ë³´ì´ë©° íšŒì „ì´ ì–‘í˜¸í•˜ë©°, ì•¡ì„¸ì„œë¦¬ ì¹´í…Œê³ ë¦¬ëŠ” 46.2%ì˜ íŒë§¤ìœ¨ì„ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤. ê³„ì ˆì„± ìƒí’ˆ íŠ¹ì„±ìƒ í•˜ë°˜ê¸° íŒë§¤ìœ¨ ê°œì„ ì´ ê¸°ëŒ€ë©ë‹ˆë‹¤.",
        inventoryInsight:"ì¬ê³ ì£¼ìˆ˜ ë¶„ì„ ê²°ê³¼, DISCOVERYëŠ” í˜„ì¬ ê¸°ì¤€ ì¬ê³  ì£¼ìˆ˜ê°€ ëª©í‘œì¹˜ ëŒ€ë¹„ ì ì • ìˆ˜ì¤€ì…ë‹ˆë‹¤. ì•„ì›ƒë„ì–´ ì˜ë¥˜ëŠ” ì¬ê³  íšŒì „ì´ ì–‘í˜¸í•˜ì—¬ ì‹œì¦Œ ì¤€ë¹„ê°€ ì˜ ë˜ì–´ ìˆìœ¼ë©°, ì•¡ì„¸ì„œë¦¬ ì¹´í…Œê³ ë¦¬ë„ ì•ˆì •ì ì¸ ì¬ê³  ìˆ˜ì¤€ì„ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê³„ì ˆì„± íŠ¹ì„±ì„ ê³ ë ¤í•œ ì¬ê³  ê´€ë¦¬ê°€ íš¨ê³¼ì ìœ¼ë¡œ ì´ë£¨ì–´ì§€ê³  ìˆìŠµë‹ˆë‹¤."
      },
      DUVETICA:{
        content:"DUVETICAëŠ” 38.7ì–µì›ì˜ ì‹¤íŒë§¤ì•¡ìœ¼ë¡œ ëª©í‘œ(32.5ì–µì›) ëŒ€ë¹„ 119%, ì „ë…„(18.5ì–µì›) ëŒ€ë¹„ 209%ë¥¼ ë‹¬ì„±í•˜ë©° í­ë°œì ì¸ ì„±ì¥ì„¸ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì œíœ´ëª°(186% ë‹¬ì„±)ì´ 11.97ì–µì›ìœ¼ë¡œ ê¸‰ì„±ì¥í–ˆìœ¼ë©° ë°±í™”ì (112% ë‹¬ì„±)ë„ 13.32ì–µì›ìœ¼ë¡œ ê²¬ì¡°í•©ë‹ˆë‹¤. ì§ì ‘ì´ìµì€ 10.6ì–µì›ìœ¼ë¡œ ì „ë…„(-12.1ì–µì›) ëŒ€ë¹„ í‘ì ì „í™˜ì— ì„±ê³µí–ˆìœ¼ë©° ì§ì ‘ì´ìµë¥  27.3%ë¥¼ ë‹¬ì„±í•˜ì—¬ í”„ë¦¬ë¯¸ì—„ ë¸Œëœë“œë¡œì„œì˜ ì…ì§€ë¥¼ í™•ê³ íˆ í–ˆìŠµë‹ˆë‹¤.",
        keyPoints:"â€¢ ì‹¤íŒë§¤ì•¡: 38.7ì–µì› (ëª©í‘œ 119%, ì „ë…„ 209%) - ì „ ë¸Œëœë“œ ì¤‘ ìµœê³  ì„±ì¥ë¥  â€¢ ì œíœ´ëª°: 11.97ì–µì› (186% ë‹¬ì„±, ì „ë…„ ëŒ€ë¹„ +394%) í­ë°œì  ì„±ì¥ â€¢ ë°±í™”ì : 13.32ì–µì› (112% ë‹¬ì„±, ì „ë…„ ëŒ€ë¹„ +186%) ê²¬ì¡° â€¢ ì§ì ‘ì´ìµ: 10.6ì–µì› í‘ì ì „í™˜ ì„±ê³µ (ì „ë…„ -12.1ì–µì›), ì§ì ‘ì´ìµë¥  27.3%",
        treemapInsight:"DUVETICAì˜ ì±„ë„ë³„/ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„±í‘œ ë¶„ì„ ê²°ê³¼, ë°±í™”ì  ì±„ë„ì´ ì „ì²´ ë§¤ì¶œì˜ 36.6%ë¥¼ ì°¨ì§€í•˜ë©° 89% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ í° ë¹„ì¤‘ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. í”„ë¦¬ë¯¸ì—„ í¬ì§€ì…”ë‹ íŠ¹ì„±ìƒ ë°±í™”ì ì—ì„œì˜ êµ¬ë§¤ê°€ ì¤‘ì‹¬ì…ë‹ˆë‹¤. ë©´ì„¸ì  ì±„ë„ì€ 31.7% ë¹„ì¤‘ì— 89% ë‹¬ì„±ë¥ ì„ ë³´ì˜€ìœ¼ë©°, ì˜¨ë¼ì¸ ì±„ë„ì€ 25.4% ë¹„ì¤‘ìœ¼ë¡œ í”„ë¦¬ë¯¸ì—„ ë¸Œëœë“œë¡œì„œ ì˜¨ë¼ì¸ í™•ëŒ€ ì—¬ë ¥ì´ ìˆìŠµë‹ˆë‹¤.",
        radarInsight:"DUVETICAì˜ ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ ê·¸ë˜í”„ë¥¼ ë³´ë©´ ëª©í‘œ ëŒ€ë¹„ 89% ë‹¬ì„±ë¥ ë¡œ ëª©í‘œì— ë‹¤ì†Œ ë¯¸ë‹¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì „ë…„ ëŒ€ë¹„ 85%ë¥¼ ê¸°ë¡í•˜ì—¬ ê³„ì ˆì„± ìƒí’ˆ íŠ¹ì„±ìƒ í•˜ë°˜ê¸° ì§‘ì¤‘ ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤. í”„ë¦¬ë¯¸ì—„ ë¸Œëœë“œë¡œì„œ ì´ìµë¥ ì€ 13.6%ë¥¼ ìœ ì§€í•˜ê³  ìˆìœ¼ë‚˜ ë§¤ì¶œ ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•œ ë§ˆì¼€íŒ… ê°•í™”ê°€ ì‹œê¸‰í•©ë‹ˆë‹¤.",
        channelPlInsight:"ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„ ê²°ê³¼, ë°±í™”ì  ì±„ë„ì´ 10.5ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 89% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ í° ë¹„ì¤‘ì„ ì°¨ì§€í•©ë‹ˆë‹¤. ë©´ì„¸ì  ì±„ë„ì€ 9.1ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 89% ë‹¬ì„±ë¥ ì„ ê¸°ë¡í–ˆìœ¼ë©°, ì˜¨ë¼ì¸ ì±„ë„ì€ 7.3ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 89% ë‹¬ì„±ë¥ ì„ ë³´ì˜€ìŠµë‹ˆë‹¤. ëª¨ë“  ì±„ë„ì—ì„œ ì¼ê´€ëœ 89% ë‹¬ì„±ë¥ ì„ ë³´ì´ë‚˜ ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•œ ì¶”ê°€ ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.",
        weeklyInsight:"ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ê·¸ë˜í”„ë¥¼ ë³´ë©´ 8ì›” ì´ˆë°˜ ëŒ€ë¹„ ì¤‘í›„ë°˜ ë§¤ì¶œì´ ìƒìŠ¹í•˜ëŠ” íŒ¨í„´ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. í”„ë¦¬ë¯¸ì—„ ë‹¤ìš´ ì œí’ˆì˜ íŠ¹ì„±ìƒ í•˜ë°˜ê¸° ì‹œì¦Œ ë³¸ê²©í™”ì™€ í•¨ê»˜ ë§¤ì¶œì´ ì¦ê°€í•˜ëŠ” ì¶”ì„¸ì…ë‹ˆë‹¤. íŠ¹íˆ 3-4ì£¼ì°¨ì— ë§¤ì¶œì´ ì§‘ì¤‘ë˜ëŠ” íŒ¨í„´ì„ ë³´ì—¬ ì´ ì‹œê¸° í”„ë¡œëª¨ì…˜ ì§‘ì¤‘ì´ íš¨ê³¼ì ì…ë‹ˆë‹¤.",
        saleRateInsight:"DUVETICAì˜ íŒë§¤ìœ¨ ë¶„ì„ ê²°ê³¼, ëˆ„ì  íŒë§¤ìœ¨ì€ í‰ê·  43.8%ë¡œ ì „ë…„ ë™ê¸° ëŒ€ë¹„ 1.5%p í•˜ë½í–ˆìŠµë‹ˆë‹¤. í”„ë¦¬ë¯¸ì—„ ë‹¤ìš´ ì œí’ˆì˜ íŠ¹ì„±ìƒ í•˜ë°˜ê¸° ë³¸ê²© ì‹œì¦Œ ì „ê¹Œì§€ëŠ” íŒë§¤ìœ¨ì´ ë‚®ì€ í¸ì´ë©°, Outer ì¹´í…Œê³ ë¦¬ëŠ” 48.2%ì˜ íŒë§¤ìœ¨ì„ ë³´ì˜€ìŠµë‹ˆë‹¤. í•˜ë°˜ê¸° ì‹œì¦Œ ë³¸ê²©í™”ì™€ í•¨ê»˜ íŒë§¤ìœ¨ ê°œì„ ì´ ê¸°ëŒ€ë©ë‹ˆë‹¤.",
        inventoryInsight:"ì¬ê³ ì£¼ìˆ˜ ë¶„ì„ ê²°ê³¼, DUVETICAëŠ” í˜„ì¬ ê¸°ì¤€ ì¬ê³  ì£¼ìˆ˜ê°€ ëª©í‘œì¹˜ ëŒ€ë¹„ 12.3% ë†’ì€ ìˆ˜ì¤€ì…ë‹ˆë‹¤. í”„ë¦¬ë¯¸ì—„ ë‹¤ìš´ ì œí’ˆì˜ íŠ¹ì„±ìƒ ì‹œì¦Œ ì „ ì¬ê³  ì¤€ë¹„ê°€ ì´ë£¨ì–´ì¡Œìœ¼ë‚˜, í•˜ë°˜ê¸° ì‹œì¦Œ ë³¸ê²©í™” ì „ê¹Œì§€ ì¬ê³  ë¶€ë‹´ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹œì¦Œ ì‹œì‘ê³¼ í•¨ê»˜ ì¬ê³  íšŒì „ì´ ê°€ì†í™”ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤."
      },
      SERGIO:{
        content:"SERGIOëŠ” 8.4ì–µì›ì˜ ì‹¤íŒë§¤ì•¡ìœ¼ë¡œ ëª©í‘œ(13.5ì–µì›) ëŒ€ë¹„ 63%, ì „ë…„(10.3ì–µì›) ëŒ€ë¹„ 82%ë¥¼ ê¸°ë¡í•˜ë©° ë§¤ìš° ë¶€ì§„í•œ ì‹¤ì ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì œíœ´ëª°(69% ë‹¬ì„±)ì„ ì œì™¸í•œ ëª¨ë“  ì±„ë„ì´ ê·¹ë¶€ì§„í•˜ë©° íŠ¹íˆ ë°±í™”ì (98% ë‹¬ì„±ì´ì§€ë§Œ ì ˆëŒ€ì•¡ 0.16ì–µì›)ê³¼ ì§ì˜ëª°(50% ë‹¬ì„±)ì´ ì‹¬ê°í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤. ì§ì ‘ì´ìµì€ 0.05ì–µì›ìœ¼ë¡œ ì „ë…„(1.5ì–µì›) ëŒ€ë¹„ 3% ìˆ˜ì¤€ì— ê·¸ì¹˜ë©° ì˜ì—…ì´ìµì€ -8.5ì–µì›ì˜ ì ìë¥¼ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤.",
        keyPoints:"â€¢ ì‹¤íŒë§¤ì•¡: 8.4ì–µì› (ëª©í‘œ 63%, ì „ë…„ 82%) - ë§¤ìš° ë¶€ì§„, ë¸Œëœë“œ ì¡´í ê²€í†  ìˆ˜ì¤€ â€¢ ê·¹ë¶€ì§„ ì±„ë„: ë°±í™”ì  98% (ì ˆëŒ€ì•¡ 0.16ì–µ), ì§ì˜ëª° 50%, ìì‚¬ëª° 59% â€¢ ì˜ì—…ì´ìµ: -8.5ì–µì› ì ì (ì „ë…„ -7.2ì–µì›) - ì ì í­ í™•ëŒ€ â€¢ ì§ì ‘ì´ìµ: 0.05ì–µì› (ì „ë…„ ëŒ€ë¹„ -97%) - ë¸Œëœë“œ ìˆ˜ìµì„± ì‹¬ê°",
        treemapInsight:"SERGIOì˜ ì±„ë„ë³„/ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„±í‘œ ë¶„ì„ ê²°ê³¼, ë©´ì„¸ì  ì±„ë„ì´ ì „ì²´ ë§¤ì¶œì˜ 38.1%ë¥¼ ì°¨ì§€í•˜ë©° 108% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ ìš°ìˆ˜í•œ ì„±ê³¼ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ë°±í™”ì  ì±„ë„ë„ 29.2% ë¹„ì¤‘ì— 108% ë‹¬ì„±ë¥ ì„ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤. í”„ë¦¬ë¯¸ì—„ ìŠˆì¦ˆ ë¸Œëœë“œë¡œì„œ ëª¨ë“  ì±„ë„ì—ì„œ ëª©í‘œë¥¼ ì´ˆê³¼ ë‹¬ì„±í•˜ê³  ìˆìœ¼ë©°, ì•„ì´í…œë³„ë¡œëŠ” í´ë˜ì‹ ìŠˆì¦ˆ ë¼ì¸ì´ 68%ì˜ ë¹„ì¤‘ì„ ì°¨ì§€í•©ë‹ˆë‹¤.",
        radarInsight:"SERGIOì˜ ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ ê·¸ë˜í”„ë¥¼ ë³´ë©´ ëª©í‘œ ëŒ€ë¹„ 108% ë‹¬ì„±ë¥ ë¡œ ì „ ë¸Œëœë“œ ì¤‘ ìµœê³  ì„±ê³¼ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì „ë…„ ëŒ€ë¹„ 125% ì„±ì¥ì„ ê¸°ë¡í•˜ì—¬ ì§€ì†ì ì¸ ê³ ì„±ì¥ ëª¨ë©˜í…€ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. íŠ¹íˆ ë©´ì„¸ì  ì±„ë„ì—ì„œ ì „ë…„ ëŒ€ë¹„ 142% ì„±ì¥ì„ ë³´ì´ë©° í”„ë¦¬ë¯¸ì—„ ë¸Œëœë“œë¡œì„œì˜ ê°•í•œ í¬ì§€ì…˜ì„ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.",
        channelPlInsight:"ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„ ê²°ê³¼, ëª¨ë“  ì±„ë„ì—ì„œ 107-108%ì˜ ìš°ìˆ˜í•œ ë‹¬ì„±ë¥ ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ë©´ì„¸ì  ì±„ë„ì€ 11.9ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 108% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ í° ë¹„ì¤‘ì„ ì°¨ì§€í•˜ë©°, ë°±í™”ì  ì±„ë„ì€ 9.1ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 108% ë‹¬ì„±ë¥ ì„ ê¸°ë¡í–ˆìŠµë‹ˆë‹¤. ì˜¨ë¼ì¸ ì±„ë„ë„ 6.8ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 108% ë‹¬ì„±ë¥ ì„ ë³´ì´ë©° ì „ ì±„ë„ì—ì„œ ê· í˜•ì¡íŒ ì„±ì¥ì„ ì´ë£¨ê³  ìˆìŠµë‹ˆë‹¤.",
        weeklyInsight:"ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ê·¸ë˜í”„ë¥¼ ë³´ë©´ 8ì›” ì „ì²´ ê¸°ê°„ì— ê±¸ì³ ëª©í‘œë¥¼ ìƒíšŒí•˜ëŠ” ê°•í•œ ì„±ì¥ì„¸ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì£¼ì°¨ë³„ ë³€ë™í­ì´ ì•ˆì •ì ì´ë©° ì§€ì†ì ì¸ ì„±ì¥ ê³¡ì„ ì„ ê·¸ë¦¬ê³  ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ ì¤‘ìˆœ ì´í›„ ë§¤ì¶œì´ ë”ìš± ê°€ì†í™”ë˜ëŠ” íŒ¨í„´ì„ ë³´ì—¬ ë¸Œëœë“œ ì¸ì§€ë„ ì œê³ ì™€ ë§ˆì¼€íŒ… íš¨ê³¼ê°€ ì§€ì†ë˜ê³  ìˆìŒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.",
        saleRateInsight:"SERGIOì˜ íŒë§¤ìœ¨ ë¶„ì„ ê²°ê³¼, ëˆ„ì  íŒë§¤ìœ¨ì€ í‰ê·  62.4%ë¡œ ì „ë…„ ë™ê¸° ëŒ€ë¹„ 5.8%p ìƒìŠ¹í–ˆìŠµë‹ˆë‹¤. í´ë˜ì‹ ìŠˆì¦ˆ ë¼ì¸ì€ 68.3%ì˜ ë§¤ìš° ë†’ì€ íŒë§¤ìœ¨ì„ ë³´ì´ë©° íšŒì „ì´ ë§¤ìš° ì–‘í˜¸í•©ë‹ˆë‹¤. ì•¡ì„¸ì„œë¦¬ ì¹´í…Œê³ ë¦¬ë„ 55.7%ì˜ ë†’ì€ íŒë§¤ìœ¨ì„ ê¸°ë¡í•˜ì—¬ ì „ì²´ì ìœ¼ë¡œ ìš°ìˆ˜í•œ ì¬ê³  íšŒì „ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤.",
        inventoryInsight:"ì¬ê³ ì£¼ìˆ˜ ë¶„ì„ ê²°ê³¼, SERGIOëŠ” í˜„ì¬ ê¸°ì¤€ ì¬ê³  ì£¼ìˆ˜ê°€ ëª©í‘œì¹˜ ëŒ€ë¹„ ì ì • ìˆ˜ì¤€ì´ë©° ì˜¤íˆë ¤ ë¶€ì¡±í•  ìˆ˜ ìˆëŠ” ìƒí™©ì…ë‹ˆë‹¤. í´ë˜ì‹ ìŠˆì¦ˆ ë¼ì¸ì€ ì¬ê³  íšŒì „ì´ ë§¤ìš° ìš°ìˆ˜í•˜ì—¬ ì¶”ê°€ ë°œì£¼ê°€ í•„ìš”í•œ ìƒí™©ì´ë©°, ì•¡ì„¸ì„œë¦¬ ì¹´í…Œê³ ë¦¬ë„ ì–‘í˜¸í•œ ì¬ê³  íšŒì „ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì „ë°˜ì ìœ¼ë¡œ ì„±ì¥ì— ë”°ë¥¸ ì¬ê³  í™•ëŒ€ê°€ ê³ ë ¤ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
      },
      SUPRA:{
        content:"SUPRAëŠ” 2.5ì–µì›ì˜ ì‹¤íŒë§¤ì•¡ìœ¼ë¡œ ëª©í‘œ(4.0ì–µì›) ëŒ€ë¹„ 63%, ì „ë…„(3.2ì–µì›) ëŒ€ë¹„ 77%ë¥¼ ê¸°ë¡í•˜ë©° ìµœì†Œ ê·œëª¨ ë¸Œëœë“œë¡œì„œ ë§¤ìš° ë¶€ì§„í•œ ì‹¤ì ì…ë‹ˆë‹¤. ìì‚¬ëª°(145% ë‹¬ì„±)ê³¼ ì œíœ´ëª°(136% ë‹¬ì„±)ì€ ì„ ì „í–ˆìœ¼ë‚˜ ì ˆëŒ€ì•¡ì´ ê°ê° 1.0ì–µì›, 1.5ì–µì›ì— ë¶ˆê³¼í•´ ì˜ë¯¸ê°€ ì œí•œì ì…ë‹ˆë‹¤. ì˜ì—…ì´ìµì€ -3.2ì–µì›ì˜ ì ìë¡œ ì „ë…„(-9.0ì–µì›) ëŒ€ë¹„ ê°œì„ ë˜ì—ˆìœ¼ë‚˜ ì—¬ì „íˆ ìˆ˜ìµì„±ì´ ë¶€ì¬í•˜ë©° ë¸Œëœë“œ ì¡´í ê²€í† ê°€ í•„ìš”í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤.",
        keyPoints:"â€¢ ì‹¤íŒë§¤ì•¡: 2.5ì–µì› (ëª©í‘œ 63%, ì „ë…„ 77%) - ì „ ë¸Œëœë“œ ì¤‘ ìµœì†Œ ê·œëª¨ â€¢ ìì‚¬ëª° 145%, ì œíœ´ëª° 136% ì„ ì „ - í•˜ì§€ë§Œ ì ˆëŒ€ì•¡ 2.5ì–µì›ìœ¼ë¡œ ì˜ë¯¸ ì œí•œ â€¢ ì˜ì—…ì´ìµ: -3.2ì–µì› ì ì (ì „ë…„ -9.0ì–µì›) - ê°œì„ ë˜ì—ˆìœ¼ë‚˜ ì—¬ì „íˆ ë¶€ì‹¤ â€¢ ì§ì ‘ì´ìµ: -1.3ì–µì› ì ì - ë¸Œëœë“œ ì¡´í ê²€í†  ì‹œê¸‰",
        treemapInsight:"SUPRAì˜ ì±„ë„ë³„/ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„±í‘œ ë¶„ì„ ê²°ê³¼, ë©´ì„¸ì  ì±„ë„ì´ ì „ì²´ ë§¤ì¶œì˜ 32.1%ë¥¼ ì°¨ì§€í•˜ë©° 92% ë‹¬ì„±ë¥ ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì˜¨ë¼ì¸ ì±„ë„ì€ 27.3% ë¹„ì¤‘ì— 93% ë‹¬ì„±ë¥ ë¡œ ìŠ¤íŠ¸ë¦¿ íŒ¨ì…˜ íŠ¹ì„±ìƒ ì˜¨ë¼ì¸ êµ¬ë§¤ ë¹„ì¤‘ì´ ë†’ìŠµë‹ˆë‹¤. ë°±í™”ì  ì±„ë„ì€ 29.2% ë¹„ì¤‘ì— 93% ë‹¬ì„±ë¥ ì„ ê¸°ë¡í–ˆìœ¼ë©°, ì•„ì´í…œë³„ë¡œëŠ” ìŠ¤ë‹ˆì»¤ì¦ˆê°€ 72%ì˜ ë¹„ì¤‘ì„ ì°¨ì§€í•©ë‹ˆë‹¤.",
        radarInsight:"SUPRAì˜ ë§¤ì¶œ ê³„íš/ì „ë…„ë¹„ ê·¸ë˜í”„ë¥¼ ë³´ë©´ ëª©í‘œ ëŒ€ë¹„ 92% ë‹¬ì„±ë¥ ë¡œ ëª©í‘œì— ë‹¤ì†Œ ë¯¸ë‹¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì „ë…„ ëŒ€ë¹„ 88%ë¥¼ ê¸°ë¡í•˜ì—¬ ìŠ¤íŠ¸ë¦¿ íŒ¨ì…˜ ì‹œì¥ì˜ ê²½ìŸì´ ì¹˜ì—´í•´ì§„ ìƒí™©ì…ë‹ˆë‹¤. íŠ¹íˆ ì´ìµë¥ ì´ 10.7%ë¡œ ëª©í‘œ ëŒ€ë¹„ -1.3%p ë‚®ì•„ ìˆ˜ìµì„± ê°œì„ ì´ í•„ìš”í•œ ìƒí™©ì…ë‹ˆë‹¤.",
        channelPlInsight:"ì£¼ìš” ì±„ë„ë³„ ì†ìµ ë¶„ì„ ê²°ê³¼, ë©´ì„¸ì  ì±„ë„ì´ 9.9ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 92% ë‹¬ì„±ë¥ ë¡œ ê°€ì¥ í° ë¹„ì¤‘ì„ ì°¨ì§€í•©ë‹ˆë‹¤. ë°±í™”ì  ì±„ë„ì€ 8.7ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 93% ë‹¬ì„±ë¥ ì„ ê¸°ë¡í–ˆìœ¼ë©°, ì˜¨ë¼ì¸ ì±„ë„ì€ 8.7ì–µì› ì˜ˆìƒ ë§¤ì¶œì— 93% ë‹¬ì„±ë¥ ì„ ë³´ì˜€ìŠµë‹ˆë‹¤. ëª¨ë“  ì±„ë„ì—ì„œ 90%ëŒ€ ë‹¬ì„±ë¥ ì„ ìœ ì§€í•˜ê³  ìˆìœ¼ë‚˜ ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•œ ì¶”ê°€ ë…¸ë ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.",
        weeklyInsight:"ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ê·¸ë˜í”„ë¥¼ ë³´ë©´ 8ì›” ì „ì²´ ê¸°ê°„ì— ê±¸ì³ ë¹„êµì  ì•ˆì •ì ì¸ ë§¤ì¶œ íŒ¨í„´ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì£¼ì°¨ë³„ ë³€ë™í­ì´ ì‘ì•„ ì˜ˆì¸¡ ê°€ëŠ¥í•œ ë§¤ì¶œ íŒ¨í„´ì„ ë³´ì´ë©°, íŠ¹íˆ ì£¼ì¤‘ ë§¤ì¶œì´ ë†’ê²Œ ë‚˜íƒ€ë‚˜ëŠ” ê²½í–¥ì´ ìˆìŠµë‹ˆë‹¤. ìŠ¤íŠ¸ë¦¿ íŒ¨ì…˜ íŠ¹ì„±ìƒ ì£¼ë§ë³´ë‹¤ ì£¼ì¤‘ ì˜¨ë¼ì¸ êµ¬ë§¤ê°€ í™œë°œí•©ë‹ˆë‹¤.",
        saleRateInsight:"SUPRAì˜ íŒë§¤ìœ¨ ë¶„ì„ ê²°ê³¼, ëˆ„ì  íŒë§¤ìœ¨ì€ í‰ê·  48.9%ë¡œ ì „ë…„ ë™ê¸° ëŒ€ë¹„ 0.8%p í•˜ë½í–ˆìŠµë‹ˆë‹¤. ìŠ¤ë‹ˆì»¤ì¦ˆ ì¹´í…Œê³ ë¦¬ëŠ” 52.3%ì˜ íŒë§¤ìœ¨ì„ ë³´ì´ë©° íšŒì „ì´ ì–‘í˜¸í•˜ë‚˜, ì˜ë¥˜ ì¹´í…Œê³ ë¦¬ëŠ” 43.2%ë¡œ ì¬ê³  ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤. íŠ¹íˆ ì‹ ì œí’ˆ ë¼ì¸ì˜ íŒë§¤ìœ¨ì´ ë‚®ì•„ ë§ˆì¼€íŒ… ì „ëµ ìˆ˜ë¦½ì´ ì‹œê¸‰í•©ë‹ˆë‹¤.",
        inventoryInsight:"ì¬ê³ ì£¼ìˆ˜ ë¶„ì„ ê²°ê³¼, SUPRAëŠ” í˜„ì¬ ê¸°ì¤€ ì¬ê³  ì£¼ìˆ˜ê°€ ëª©í‘œì¹˜ ëŒ€ë¹„ 9.5% ë†’ì€ ìˆ˜ì¤€ì…ë‹ˆë‹¤. ìŠ¤ë‹ˆì»¤ì¦ˆëŠ” ì¬ê³  íšŒì „ì´ ì–‘í˜¸í•˜ì—¬ ì¶”ê°€ ë°œì£¼ë¥¼ ê³ ë ¤í•  ìˆ˜ ìˆìœ¼ë‚˜, ì˜ë¥˜ ì¹´í…Œê³ ë¦¬ëŠ” ì¬ê³  ë¶€ë‹´ì´ ìˆì–´ ì¡°ê¸° ì†Œì§„ ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤. ì‹ ì œí’ˆ ë¼ì¸ì˜ ì¬ê³  íšŒì „ ê°œì„ ì„ ìœ„í•œ í”„ë¡œëª¨ì…˜ ì „ëµ ìˆ˜ë¦½ì´ í•„ìš”í•©ë‹ˆë‹¤."
      }
    };

    // ë¸Œëœë“œë³„ ì†ìµê³„ì‚°ì„œ ë°ì´í„°
    let brandPLData = {
      MLB: {
        revenue: { prev: 334.19, target: 331.30, forecast: 349.30, yoy: 4.5, achievement: 105 },
        cog: { prev: 179.7, target: 178.2, forecast: 187.9, yoy: 4.6, achievement: 105 },
        grossProfit: { prev: 154.5, target: 153.1, forecast: 161.4, yoy: 4.5, achievement: 105 },
        directCost: { prev: 104.5, target: 106.1, forecast: 108.2, yoy: 3.5, achievement: 102 },
        directProfit: { prev: 94.19, target: 93.11, forecast: 94.19, yoy: 0.0, achievement: 101 },
        opProfit: { prev: 49.52, target: 50.04, forecast: 51.12, yoy: 3.2, achievement: 102 }
      },
      MLB_KIDS: {
        revenue: { prev: 86.20, target: 89.01, forecast: 79.48, yoy: -7.8, achievement: 89 },
        cog: { prev: 46.3, target: 47.8, forecast: 42.7, yoy: -7.8, achievement: 89 },
        grossProfit: { prev: 39.9, target: 41.2, forecast: 36.8, yoy: -7.8, achievement: 89 },
        directCost: { prev: 29.1, target: 35.4, forecast: 28.7, yoy: -1.4, achievement: 81 },
        directProfit: { prev: 10.80, target: 5.84, forecast: 8.10, yoy: -25.0, achievement: 139 },
        opProfit: { prev: -1.98, target: -6.77, forecast: -4.51, yoy: 127.8, achievement: 133 }
      },
      DISCOVERY: {
        revenue: { prev: 464.18, target: 459.00, forecast: 403.21, yoy: -13.1, achievement: 88 },
        cog: { prev: 249.5, target: 246.8, forecast: 216.7, yoy: -13.2, achievement: 88 },
        grossProfit: { prev: 214.7, target: 212.2, forecast: 186.5, yoy: -13.1, achievement: 88 },
        directCost: { prev: 106.9, target: 104.7, forecast: 96.8, yoy: -9.4, achievement: 92 },
        directProfit: { prev: 107.99, target: 107.54, forecast: 89.71, yoy: -16.9, achievement: 83 },
        opProfit: { prev: 47.56, target: 44.57, forecast: 26.74, yoy: -43.8, achievement: 60 }
      },
      DUVETICA: {
        revenue: { prev: 18.51, target: 32.50, forecast: 38.67, yoy: 108.9, achievement: 119 },
        cog: { prev: 10.0, target: 17.5, forecast: 20.8, yoy: 108.0, achievement: 119 },
        grossProfit: { prev: 8.5, target: 15.0, forecast: 17.9, yoy: 110.6, achievement: 119 },
        directCost: { prev: 20.6, target: 22.1, forecast: 16.8, yoy: -18.4, achievement: 76 },
        directProfit: { prev: -12.11, target: 7.12, forecast: 10.57, yoy: -187.3, achievement: 148 },
        opProfit: { prev: -19.20, target: -1.58, forecast: 1.86, yoy: -109.7, achievement: 318 }
      },
      SERGIO: {
        revenue: { prev: 10.28, target: 13.46, forecast: 8.43, yoy: -18.0, achievement: 63 },
        cog: { prev: 5.5, target: 7.2, forecast: 4.5, yoy: -18.2, achievement: 63 },
        grossProfit: { prev: 4.8, target: 6.2, forecast: 3.9, yoy: -18.8, achievement: 63 },
        directCost: { prev: 3.3, target: 6.2, forecast: 3.9, yoy: 18.2, achievement: 63 },
        directProfit: { prev: 1.49, target: 0.32, forecast: 0.05, yoy: -96.6, achievement: 14 },
        opProfit: { prev: -7.23, target: -8.26, forecast: -8.54, yoy: 18.1, achievement: 97 }
      },
      SUPRA: {
        revenue: { prev: 3.24, target: 4.00, forecast: 2.51, yoy: -22.5, achievement: 63 },
        cog: { prev: 1.7, target: 2.1, forecast: 1.3, yoy: -23.5, achievement: 62 },
        grossProfit: { prev: 1.5, target: 1.9, forecast: 1.2, yoy: -20.0, achievement: 63 },
        directCost: { prev: 3.1, target: 2.4, forecast: 2.5, yoy: -19.4, achievement: 104 },
        directProfit: { prev: -1.54, target: -0.49, forecast: -1.31, yoy: -14.9, achievement: -68 },
        opProfit: { prev: -9.00, target: -2.41, forecast: -3.23, yoy: -64.1, achievement: 66 }
      }
    };

    // ============ ë¸Œëœë“œ ë§ˆìŠ¤í„° ë°ì´í„° ============
    const BRAND_MASTER = {
      M: 'MLB',
      I: 'MLB KIDS',
      X: 'DISCOVERY',
      V: 'DUVETICA',
      W: 'SUPRA',
      ST: 'SERGIO'
    };
    
    // ë¸Œëœë“œ ì½”ë“œ ì—­ë§¤í•‘ (ì´ë¦„ -> ì½”ë“œ)
    const BRAND_CODE_MAP = {
      'MLB': 'M',
      'MLB KIDS': 'I',
      'DISCOVERY': 'X',
      'DUVETICA': 'V',
      'SUPRA': 'W',
      'SERGIO': 'ST'
    };

    let currentBrand = 'MLB';
    let currentSection = 'overview';
    let charts = {};
    let isDrilledDown = false;
    let currentDrillBrand = null;
    // í™”ë©´ë§Œ ë¨¼ì € êµ¬ì„±: trueì´ë©´ ë ˆì´ë” ì°¨íŠ¸ëŠ” ì •ì  ë°ì´í„°ë¡œ í‘œì‹œí•˜ì§€ë§Œ, í† ê¸€ì€ ë™ì‘ì‹œí‚´
    window.uiStaticMode = true;
    window.radarChartType = 'channel';
    
    // realData ì „ì—­ ë³€ìˆ˜ ì„ ì–¸ (ë‚˜ì¤‘ì— ì´ˆê¸°í™”ë¨)
    let realData = null;

    // -------- ë„¤ë¹„ê²Œì´ì…˜ --------
    document.querySelectorAll('.nav-item').forEach(item=>{
      item.addEventListener('click', function(){
        document.querySelectorAll('.nav-item').forEach(nav=>nav.classList.remove('active'));
        this.classList.add('active');

        const section = this.dataset.section;
        currentSection = section;
        console.log('ë„¤ë¹„ê²Œì´ì…˜ í´ë¦­:', {section, currentSection});
        document.querySelectorAll('.content-section').forEach(sec=>sec.classList.remove('active'));
        document.getElementById(`content-${section}`).classList.add('active');

        // ì„¹ì…˜ ë³€ê²½ ì‹œ íŒŒíŠ¸ë³„ ë¶„ì„ ëª¨ë“œ ë¹„í™œì„±í™”
        if (window.aiPartMode) {
          window.aiPartMode = false;
          clearAIPartNotes();
        }
        
        // ë¸Œëœë“œë³„ ë¶„ì„ íƒ­ìœ¼ë¡œ ì „í™˜ ì‹œ íŠ¸ë¦¬ë§µ ë©”íƒ€ë°ì´í„° ë¡œë“œ ë° ë‚ ì§œ ì •ë³´ í‘œì‹œ
        if (section === 'brand') {
          setTimeout(() => {
            if (!treemapMetadata) {
              loadTreemapMetadata();
            } else {
              updateTreemapDateInfo();
            }
          }, 300);
        }

        if(section==='overview'){
          document.getElementById('overview-pl').style.display='block';
          document.getElementById('brand-pl').style.display='none';
        }else{
          document.getElementById('overview-pl').style.display='none';
          document.getElementById('brand-pl').style.display='block';
        }

        setTimeout(()=>{ 
          section==='overview' ? initOverviewCharts() : updateBrandView(); 
          renderInsights();
          // í¸ì§‘ ë‚´ìš© í•­ìƒ ë‹¤ì‹œ ì ìš©
          setTimeout(() => {
            loadEdits();
            if(isEditMode) applyEditMode();
            if (window.aiPartMode) { renderAIPartNotes(); }
            // ì„¹ì…˜ ì „í™˜ í›„ Plotly íŠ¸ë¦¬ë§µì´ ìˆ¨ê¹€â†’í‘œì‹œë¡œ ë°”ë€Œë©´ì„œ ì˜ì—­ ê³„ì‚°ì´ 0ì´ ë˜ëŠ” ê²½ìš° ë³´ì •
            if(section==='brand'){
              try{
                const t = document.getElementById('treemapWrapper');
                if(t){
                  if(window.Plotly && window.Plotly.Plots && typeof window.Plotly.Plots.resize==='function'){
                    window.Plotly.Plots.resize(t);
                  } else if(typeof initTreemap==='function'){
                    initTreemap();
                  }
                }
              }catch(e){ console.warn('treemap resize on section switch failed', e); }
            }
          }, 200);
        },100);
      });
    });

    // -------- ë¸Œëœë“œ ë²„íŠ¼ --------
    document.querySelectorAll('.brand-btn').forEach(btn=>{
      btn.addEventListener('click', function(){
        document.querySelectorAll('.brand-btn').forEach(b=>b.classList.remove('active'));
        this.classList.add('active');
        currentBrand = this.dataset.brand;
        console.log('ë¸Œëœë“œ ë²„íŠ¼ í´ë¦­:', currentBrand);
        
        // ì¦‰ì‹œ ì¸ì‚¬ì´íŠ¸ ë Œë”ë§
        renderInsights();
        
        // ë¸Œëœë“œ ë·° ì—…ë°ì´íŠ¸
        updateBrandView();
        
        // ë¸Œëœë“œë³„ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
        if(currentSection === 'brand'){
          updateBrandCharts();
          // ë¸Œëœë“œë³„ íŒë§¤ìœ¨ í…Œì´ë¸”ë„ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
          if(typeof renderItemDiffTable === 'function'){
            renderItemDiffTable();
          }
        }
        
        // ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ì°¨íŠ¸ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
        updateWeeklyTrendChart();
        
        // í•­ìƒ í¸ì§‘ ë‚´ìš© ë‹¤ì‹œ ì ìš© (ë¸Œëœë“œ ì „í™˜ í›„)
        setTimeout(() => {
          loadEdits();
          if(isEditMode) applyEditMode();
          if (window.aiPartMode) { renderAIPartNotes(); }
        }, 200);
      });
    });

    // -------- ì±„ë„ë³„ ì†ìµ ë²„íŠ¼ (ë§¤ì¶œ / ì§ì ‘ì´ìµ) --------
    document.querySelectorAll('.channel-pl-toggle-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„±í™”
        document.querySelectorAll('.channel-pl-toggle-btn').forEach(b => {
          b.style.background = '#e5e7eb';
          b.style.color = '#374151';
        });
        
        // í˜„ì¬ ë²„íŠ¼ í™œì„±í™”
        this.style.background = '#4f46e5';
        this.style.color = 'white';
        
        // ëª¨ë“œ ë³€ê²½
        if (this.id === 'channelPlRevenue') {
          channelPlMode = 'revenue';
        } else if (this.id === 'channelPlProfit') {
          channelPlMode = 'profit';
        }
        
        // í…Œì´ë¸” ì—…ë°ì´íŠ¸
        updateBrandChannels();
      });
    });

    // -------- ì¸ì‚¬ì´íŠ¸ ë Œë”ë§ --------
    function renderInsights(){
      const overviewInsights = document.getElementById('overview-insights');
      const brandInsights = document.getElementById('brand-insights');

      console.log('renderInsights í˜¸ì¶œ:', {currentSection, currentBrand});

      if(currentSection==='overview'){
        const content = (insightsData.overview?.content)||'';
        const keyPoints = (insightsData.overview?.keyPoints)||'';
        overviewInsights.innerHTML = `
          <div style="margin-bottom: 20px;">
            <div style="font-size: 16px; font-weight: 600; color: #92400e; margin-bottom: 10px;">ğŸ“‹ ì£¼ìš”ë‚´ìš©</div>
            <div style="margin-left: 10px; color: #78350f; line-height: 1.5;">
              ${content}
            </div>
          </div>
          <div>
            <div style="font-size: 16px; font-weight: 600; color: #92400e; margin-bottom: 10px;">ğŸ’¡ í•µì‹¬ì¸ì‚¬ì´íŠ¸</div>
            <div style="margin-left: 10px; color: #78350f; line-height: 1.5;">
              ${keyPoints}
            </div>
          </div>
        `;
      }else{
        const bi = insightsData[currentBrand] || insightsData.MLB;
        const content = bi.content||'';
        const keyPoints = bi.keyPoints||'';
        console.log('ë¸Œëœë“œ ì¸ì‚¬ì´íŠ¸ ë°ì´í„°:', {currentBrand, bi, content, keyPoints});
        brandInsights.innerHTML = `
          <div style="margin-bottom: 20px;">
            <div style="font-size: 16px; font-weight: 600; color: #92400e; margin-bottom: 10px;">ğŸ“‹ ì£¼ìš”ë‚´ìš©</div>
            <div style="margin-left: 10px; color: #78350f; line-height: 1.5;">
              ${content}
            </div>
          </div>
          <div>
            <div style="font-size: 16px; font-weight: 600; color: #92400e; margin-bottom: 10px;">ğŸ’¡ í•µì‹¬ì¸ì‚¬ì´íŠ¸</div>
            <div style="margin-left: 10px; color: #78350f; line-height: 1.5;">
              ${keyPoints}
            </div>
          </div>
        `;
      }
      
      // ë Œë”ë§ í›„ í¸ì§‘ ë‚´ìš© ë‹¤ì‹œ ì ìš©
      setTimeout(() => {
        loadEdits();
      }, 50);
    }

    // -------- ë¸Œëœë“œë³„ ì°¨íŠ¸ ì—…ë°ì´íŠ¸ --------
    function updateBrandCharts() {
      console.log('ë¸Œëœë“œë³„ ì°¨íŠ¸ ì—…ë°ì´íŠ¸:', currentBrand);
      
      // ì±„ë„ë³„ íŠ¸ë¦¬ë§µ ì—…ë°ì´íŠ¸
      updateChannelTreemap();
      
      // ì•„ì´í…œë³„ íŠ¸ë¦¬ë§µ ì—…ë°ì´íŠ¸
      updateItemTreemap();
      
      // ë ˆì´ë” ì°¨íŠ¸ ë°ì´í„° ì—…ë°ì´íŠ¸
      if (charts.radar) {
        const type = window.radarChartType || 'channel';
        const radarData = (type === 'channel') ? getChannelRadarData(currentBrand) : getItemRadarData(currentBrand);
        charts.radar.data.labels = radarData.labels;
        charts.radar.data.datasets[0].data = radarData.plan;
        charts.radar.data.datasets[1].data = radarData.yoy;
        charts.radar.update();
      }
      
      // íˆíŠ¸ë§µ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
      if (charts.heatmap) {
        updateHeatmapChart();
      }
      
      // ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
      if (charts.weeklyTrend || charts.weeklyTrendChart) {
        updateWeeklyTrendChart();
      }
      
      // ì£¼ìš” ì±„ë„ë³„ ì†ìµ í…Œì´ë¸” ì—…ë°ì´íŠ¸
      updateBrandChannels();
      
      // ë¸Œëœë“œë³„ ì•„ì´í…œ íŒë§¤ìœ¨ í…Œì´ë¸” ì—…ë°ì´íŠ¸
      if(typeof renderItemDiffTable === 'function'){
        renderItemDiffTable();
      }
    }

    // -------- ë¸Œëœë“œ ë·° ì—…ë°ì´íŠ¸ --------
    function updateBrandView(){
      const data = brandData[currentBrand];
      console.log('updateBrandView í˜¸ì¶œ:', {currentBrand, data});
      if(!data) return;

      // í• ì¸ìœ¨/ì´ìµìœ¨ íŒŒë€ìƒ‰ ìŠ¤íƒ€ì¼ ì ìš© í•¨ìˆ˜
      const applyBlueStyle = (id) => {
        const el = document.getElementById(id);
        if(el) {
          el.style.setProperty('color', '#3b82f6', 'important');
          el.style.setProperty('font-weight', '600', 'important');
        }
      };

      // ì§ì ‘ DOM ì—…ë°ì´íŠ¸ (localStorage ë¬´ì‹œ)
      const setTextDirect = (id, text) => {
        const el = document.getElementById(id);
        if(el) el.textContent = text;
      };
      const setDeltaDirect = (id, val, isPctPt=false) => {
        const el = document.getElementById(id);
        if(!el) return;
        const sign = val>=0?'+':'';
        el.textContent = `ëª©í‘œ ëŒ€ë¹„ ${sign}${val.toFixed(1)}${isPctPt?'%p':'%'}`;
        el.className = 'kpi-change-line editable ' + (val>=0?'kpi-positive':'kpi-negative');
      };
      const setYoYDirect = (id, val, isPctPt=false) => {
        const el = document.getElementById(id);
        if(!el) return;
        const sign = val>=0?'+':'';
        el.textContent = `ì „ë…„ ëŒ€ë¹„ ${sign}${val.toFixed(1)}${isPctPt?'%p':'%'}`;
        el.className = 'kpi-change editable ' + (val>=0?'kpi-positive':val===0?'kpi-neutral':'kpi-negative');
      };

      // ì‹¤íŒë§¤ì¶œ(í• ì¸ìœ¨) í†µí•© KPI (í˜„ì‹œì  + ì›”ë§ì˜ˆìƒ)
      const revenueCurrent = parseFloat(data.current.revenue.value) || 0;
      const revenueForecast = parseFloat(data.revenue.forecast) || 0;
      setTextDirect('brand-current-revenue', `${revenueCurrent.toFixed(1)}ì–µì›`);
      setTextDirect('brand-revenue', `${revenueForecast.toFixed(1)}ì–µì›`);
      // í• ì¸ìœ¨ ê³„ì‚° (ë°ì´í„°ì—ì„œ ê°€ì ¸ì˜¤ê±°ë‚˜ ê³„ì‚°)
      const discountRateCurrent = data.current.revenue.discountRate || 0;
      const discountRateForecast = data.revenue.discountRate || 0;
      const discountRateCurrentEl = document.getElementById('brand-current-discount-rate');
      const discountRateEl = document.getElementById('brand-discount-rate');
      if(discountRateCurrentEl) {
        discountRateCurrentEl.textContent = `(${discountRateCurrent.toFixed(1)}%)`;
        applyBlueStyle('brand-current-discount-rate');
      }
      if(discountRateEl) {
        discountRateEl.textContent = `(${discountRateForecast.toFixed(1)}%)`;
        applyBlueStyle('brand-discount-rate');
      }
      setDeltaDirect('brand-revenue-change', data.revenue.achievement - 100);
      const yoyValue = data.revenue.yoy >= 100 ? data.revenue.yoy - 100 : data.revenue.yoy;
      setYoYDirect('brand-revenue-yoy', yoyValue);
      // ì§„ì²™ìœ¨ë°” ì—…ë°ì´íŠ¸
      const revenueProgressBar = document.getElementById('brand-revenue-progress');
      if (revenueProgressBar) {
        revenueProgressBar.style.width = `${data.revenue.achievement}%`;
      }

      // ì§ì ‘ì´ìµ(ì´ìµìœ¨) í†µí•© KPI (í˜„ì‹œì  + ì›”ë§ì˜ˆìƒ)
      const profitCurrent = parseFloat(data.current.profit.value) || 0;
      // ì§ì ‘ì´ìµ ì›”ë§ì˜ˆìƒì€ ì§ì ‘ì´ìµìœ¨ê³¼ ì‹¤íŒë§¤ì¶œë¡œ ê³„ì‚°í•˜ê±°ë‚˜ ë°ì´í„°ì—ì„œ ê°€ì ¸ì˜¤ê¸°
      const profitForecast = data.current.profit.value; // ì¼ë‹¨ í˜„ì‹œì  ê°’ ì‚¬ìš© (ë‚˜ì¤‘ì— ë°ì´í„°ë¡œ êµì²´)
      const profitForecastValue = parseFloat(profitForecast) || 0;
      setTextDirect('brand-current-profit', `${profitCurrent.toFixed(1)}ì–µì›`);
      setTextDirect('brand-profit', `${profitForecastValue.toFixed(1)}ì–µì›`);
      // ì§ì ‘ì´ìµìœ¨ ê³„ì‚°
      const profitMarginRateCurrent = revenueCurrent > 0 ? (profitCurrent / revenueCurrent * 100) : 0;
      const profitMarginRateForecast = revenueForecast > 0 ? (profitForecastValue / revenueForecast * 100) : 0;
      const profitMarginRateCurrentEl = document.getElementById('brand-current-profit-margin-rate');
      const profitMarginRateEl = document.getElementById('brand-profit-margin-rate');
      if(profitMarginRateCurrentEl) {
        profitMarginRateCurrentEl.textContent = `(${profitMarginRateCurrent.toFixed(1)}%)`;
        applyBlueStyle('brand-current-profit-margin-rate');
      }
      if(profitMarginRateEl) {
        profitMarginRateEl.textContent = `(${profitMarginRateForecast.toFixed(1)}%)`;
        applyBlueStyle('brand-profit-margin-rate');
      }
      setDeltaDirect('brand-profit-change', data.current.profit.achievement ? data.current.profit.achievement - 100 : 0);
      setYoYDirect('brand-profit-yoy', data.current.profit.yoy);
      // ì§„ì²™ìœ¨ë°” ì—…ë°ì´íŠ¸
      const profitProgressBar = document.getElementById('brand-profit-progress');
      if (profitProgressBar && data.current.profit.achievement) {
        profitProgressBar.style.width = `${data.current.profit.achievement}%`;
      }

      // ì˜ì—…ì´ìµ(ì´ìµìœ¨) í†µí•© KPI (í˜„ì‹œì  + ì›”ë§ì˜ˆìƒ)
      const plData = brandPLData[currentBrand];
      if (plData && plData.opProfit) {
        // í˜„ì‹œì  (ì›”ë§ì˜ˆìƒê³¼ ë™ì¼í•˜ê²Œ í‘œì‹œí•˜ê±°ë‚˜ ë³„ë„ ë°ì´í„° ì‚¬ìš©)
        const opProfitCurrent = plData.opProfit.forecast; // ì¼ë‹¨ ì›”ë§ì˜ˆìƒ ê°’ ì‚¬ìš©
        const opProfitCurrentValue = parseFloat(opProfitCurrent) || 0;
        const opProfitForecastValue = parseFloat(plData.opProfit.forecast) || 0;
        setTextDirect('brand-current-opprofit', `${opProfitCurrentValue.toFixed(1)}ì–µì›`);
        setTextDirect('brand-opprofit', `${opProfitForecastValue.toFixed(1)}ì–µì›`);
        // ì˜ì—…ì´ìµìœ¨ ê³„ì‚°
        const opProfitMarginRateCurrent = revenueCurrent > 0 ? (opProfitCurrentValue / revenueCurrent * 100) : 0;
        const opProfitMarginRateForecast = revenueForecast > 0 ? (opProfitForecastValue / revenueForecast * 100) : 0;
        const opProfitMarginRateCurrentEl = document.getElementById('brand-current-opprofit-margin-rate');
        const opProfitMarginRateEl = document.getElementById('brand-opprofit-margin-rate');
        if(opProfitMarginRateCurrentEl) {
          opProfitMarginRateCurrentEl.textContent = `(${opProfitMarginRateCurrent.toFixed(1)}%)`;
          applyBlueStyle('brand-current-opprofit-margin-rate');
        }
        if(opProfitMarginRateEl) {
          opProfitMarginRateEl.textContent = `(${opProfitMarginRateForecast.toFixed(1)}%)`;
          applyBlueStyle('brand-opprofit-margin-rate');
        }
        setDeltaDirect('brand-opprofit-change', plData.opProfit.achievement - 100);
        setYoYDirect('brand-opprofit-yoy', plData.opProfit.yoy);
        // ì§„ì²™ìœ¨ë°” ì—…ë°ì´íŠ¸
        const opprofitProgressBar = document.getElementById('brand-opprofit-progress');
        if (opprofitProgressBar) {
          opprofitProgressBar.style.width = `${plData.opProfit.achievement}%`;
        }
      }

      // ì§„ì²™ìœ¨ í†µí•© KPI (í˜„ì‹œì  + ì›”ë§ì˜ˆìƒ)
      setTextDirect('brand-current-progress', `${data.current.progress.value}%`);
      // ì›”ë§ì˜ˆìƒ ì§„ì²™ìœ¨ì€ ëª©í‘œë‹¬ì„±ìœ¨ ì‚¬ìš©
      setTextDirect('brand-progress', `${data.revenue.achievement}%`);
      setDeltaDirect('brand-progress-change', data.revenue.achievement - 100);
      setYoYDirect('brand-progress-yoy', yoyValue);
      // ì§„ì²™ìœ¨ë°” ì—…ë°ì´íŠ¸
      const progressProgressBar = document.getElementById('brand-progress-progress');
      if (progressProgressBar) {
        progressProgressBar.style.width = `${data.revenue.achievement}%`;
      }

      // ëª¨ë“  í• ì¸ìœ¨/ì´ìµìœ¨ ìš”ì†Œì— íŒŒë€ìƒ‰ ìŠ¤íƒ€ì¼ ê°•ì œ ì ìš©
      setTimeout(() => {
        applyBlueStyle('brand-current-discount-rate');
        applyBlueStyle('brand-discount-rate');
        applyBlueStyle('brand-current-profit-margin-rate');
        applyBlueStyle('brand-profit-margin-rate');
        applyBlueStyle('brand-current-opprofit-margin-rate');
        applyBlueStyle('brand-opprofit-margin-rate');
      }, 0);

      // ë¸Œëœë“œë³„ ì†ìµê³„ì‚°ì„œ ì—…ë°ì´íŠ¸
      updateBrandPL();
      
      // RF ì±„ë„ ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€ (MLB ë¸Œëœë“œë§Œ í‘œì‹œ)
      const rfBtn = document.getElementById('weeklyChannelFilterRF');
      if (rfBtn) {
        rfBtn.style.display = (currentBrand === 'MLB') ? 'block' : 'none';
      }

      setTimeout(()=>{ initBrandCharts(); initRadarToggle(); updateTreemapDateInfo(); },100);
    }

    // ì „ì²´ ì†ìµê³„ì‚°ì„œ í• ì¸ìœ¨ ì—…ë°ì´íŠ¸
    function updateOverviewDiscountRate() {
      if (!window.overviewPL) return;
      
      const plData = window.overviewPL;
      
      // í• ì¸ìœ¨ ê³„ì‚°: (1 - revenue / tagRevenue) * 100
      let discountPrev = '-';
      let discountTarget = '-';
      let discountForecast = '-';
      
      if (plData.tagRevenue && plData.tagRevenue.prev && plData.revenue && plData.revenue.prev) {
        if (plData.tagRevenue.prev > 0) {
          discountPrev = ((1 - plData.revenue.prev / plData.tagRevenue.prev) * 100).toFixed(1);
        }
      }
      
      if (plData.tagRevenue && plData.tagRevenue.target && plData.revenue && plData.revenue.target) {
        if (plData.tagRevenue.target > 0) {
          discountTarget = ((1 - plData.revenue.target / plData.tagRevenue.target) * 100).toFixed(1);
        }
      }
      
      if (plData.tagRevenue && plData.tagRevenue.forecast && plData.revenue && plData.revenue.forecast) {
        if (plData.tagRevenue.forecast > 0) {
          discountForecast = ((1 - plData.revenue.forecast / plData.tagRevenue.forecast) * 100).toFixed(1);
        }
      }
      
      // í• ì¸ìœ¨ ê°’ ì—…ë°ì´íŠ¸
      const prevEl = document.getElementById('overview-discount-prev');
      const targetEl = document.getElementById('overview-discount-target');
      const forecastEl = document.getElementById('overview-discount-forecast');
      
      if (prevEl) prevEl.textContent = discountPrev !== '-' ? `${discountPrev}%` : '-';
      if (targetEl) targetEl.textContent = discountTarget !== '-' ? `${discountTarget}%` : '-';
      if (forecastEl) forecastEl.textContent = discountForecast !== '-' ? `${discountForecast}%` : '-';
      
      // ì „ë…„ëŒ€ë¹„ ê³„ì‚°: ë‹¹ë…„í• ì¸ìœ¨ - ì „ë…„í• ì¸ìœ¨
      if (discountForecast !== '-' && discountPrev !== '-') {
        const yoy = parseFloat(discountForecast) - parseFloat(discountPrev);
        const yoyEl = document.getElementById('overview-discount-yoy');
        if (yoyEl) {
          const sign = yoy >= 0 ? '+' : '';
          yoyEl.textContent = `${sign}${yoy.toFixed(1)}%p`;
        }
      }
      
      // ë‹¬ì„±ë¥  ê³„ì‚°: ë‹¹ë…„í• ì¸ìœ¨ - ê³„íší• ì¸ìœ¨
      if (discountForecast !== '-' && discountTarget !== '-') {
        const achievement = parseFloat(discountForecast) - parseFloat(discountTarget);
        const achievementEl = document.getElementById('overview-discount-achievement');
        if (achievementEl) {
          const sign = achievement >= 0 ? '+' : '';
          achievementEl.textContent = `${sign}${achievement.toFixed(1)}%p`;
        }
      }
    }

    // ë¸Œëœë“œë³„ ì†ìµê³„ì‚°ì„œ ì—…ë°ì´íŠ¸
    function updateBrandPL() {
      const plData = brandPLData[currentBrand];
      if (!plData) return;

      // ì†ìµê³„ì‚°ì„œ ì œëª© ì—…ë°ì´íŠ¸
      const plTitle = document.querySelector('#brand-pl h3');
      if (plTitle) {
        plTitle.textContent = `ğŸ“Š ${currentBrand} ì†ìµê³„ì‚°ì„œ`;
      }

      // ì†ìµê³„ì‚°ì„œ í…Œì´ë¸” ì—…ë°ì´íŠ¸
      const tableBody = document.querySelector('#brand-pl .pl-table tbody');
      if (tableBody) {
        // YOY ê³„ì‚°: (ì›”ë§ì˜ˆìƒ / ì „ë…„) * 100
        const revenueYoy = Math.round((plData.revenue.forecast / plData.revenue.prev) * 100);
        const cogYoy = Math.round((plData.cog.forecast / plData.cog.prev) * 100);
        const grossProfitYoy = Math.round((plData.grossProfit.forecast / plData.grossProfit.prev) * 100);
        const directCostYoy = Math.round((plData.directCost.forecast / plData.directCost.prev) * 100);
        const directProfitYoy = Math.round((plData.directProfit.forecast / plData.directProfit.prev) * 100);
        const opProfitYoy = Math.round((plData.opProfit.forecast / plData.opProfit.prev) * 100);
        
        tableBody.innerHTML = `
          <tr><td class="item-name">ë§¤ì¶œì•¡</td><td class="editable" contenteditable="false">${plData.revenue.prev}</td><td class="editable" contenteditable="false">${plData.revenue.target}</td><td class="editable" contenteditable="false">${plData.revenue.forecast}</td><td class="editable" contenteditable="false">${revenueYoy}%</td><td class="editable" contenteditable="false">${plData.revenue.achievement}%</td></tr>
          <tr><td class="item-name sub-item">(ë§¤ì¶œì›ê°€)</td><td class="editable" contenteditable="false">(${plData.cog.prev})</td><td class="editable" contenteditable="false">(${plData.cog.target})</td><td class="editable" contenteditable="false">(${plData.cog.forecast})</td><td class="editable" contenteditable="false">${cogYoy}%</td><td class="editable" contenteditable="false">${plData.cog.achievement}%</td></tr>
          <tr class="total-row"><td class="item-name">ë§¤ì¶œì´ì´ìµ</td><td class="editable" contenteditable="false">${plData.grossProfit.prev}</td><td class="editable" contenteditable="false">${plData.grossProfit.target}</td><td class="editable" contenteditable="false">${plData.grossProfit.forecast}</td><td class="editable" contenteditable="false">${grossProfitYoy}%</td><td class="editable" contenteditable="false">${plData.grossProfit.achievement}%</td></tr>
          <tr><td class="item-name sub-item">(ì§ì ‘ë¹„)</td><td class="editable" contenteditable="false">(${plData.directCost.prev})</td><td class="editable" contenteditable="false">(${plData.directCost.target})</td><td class="editable" contenteditable="false">(${plData.directCost.forecast})</td><td class="editable" contenteditable="false">${directCostYoy}%</td><td class="editable" contenteditable="false">${plData.directCost.achievement}%</td></tr>
          <tr><td class="item-name sub-item">- ì¸ê±´ë¹„</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.prev * 0.35)})</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.target * 0.35)})</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.forecast * 0.35)})</td><td class="editable" contenteditable="false">${Math.round((Math.round(plData.directCost.forecast * 0.35) / Math.round(plData.directCost.prev * 0.35)) * 100)}%</td><td class="editable" contenteditable="false">100%</td></tr>
          <tr><td class="item-name sub-item">- ì„ì°¨ë£Œ</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.prev * 0.19)})</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.target * 0.19)})</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.forecast * 0.19)})</td><td class="editable" contenteditable="false">100%</td><td class="editable" contenteditable="false">100%</td></tr>
          <tr><td class="item-name sub-item">- ë¡œì—´í‹°</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.prev * 0.13)})</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.target * 0.13)})</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.forecast * 0.13)})</td><td class="editable" contenteditable="false">${Math.round((Math.round(plData.directCost.forecast * 0.13) / Math.round(plData.directCost.prev * 0.13)) * 100)}%</td><td class="editable" contenteditable="false">${plData.directCost.achievement}%</td></tr>
          <tr><td class="item-name sub-item">- ê°ê°€ìƒê°ë¹„</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.prev * 0.08)})</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.target * 0.08)})</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.forecast * 0.08)})</td><td class="editable" contenteditable="false">${Math.round((Math.round(plData.directCost.forecast * 0.08) / Math.round(plData.directCost.prev * 0.08)) * 100)}%</td><td class="editable" contenteditable="false">100%</td></tr>
          <tr><td class="item-name sub-item">- ê¸°íƒ€</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.prev * 0.25)})</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.target * 0.25)})</td><td class="editable" contenteditable="false">(${Math.round(plData.directCost.forecast * 0.25)})</td><td class="editable" contenteditable="false">${Math.round((Math.round(plData.directCost.forecast * 0.25) / Math.round(plData.directCost.prev * 0.25)) * 100)}%</td><td class="editable" contenteditable="false">${Math.round(plData.directCost.achievement * 0.95)}%</td></tr>
          <tr class="total-row"><td class="item-name">ì§ì ‘ì´ìµ</td><td class="editable" contenteditable="false">${plData.directProfit.prev}</td><td class="editable" contenteditable="false">${plData.directProfit.target}</td><td class="editable" contenteditable="false">${plData.directProfit.forecast}</td><td class="editable" contenteditable="false">${directProfitYoy}%</td><td class="editable" contenteditable="false">${plData.directProfit.achievement}%</td></tr>
          <tr><td class="item-name sub-item">(ì˜ì—…ë¹„)</td><td></td><td></td><td></td><td></td><td></td></tr>
          <tr class="total-row"><td class="item-name">ì˜ì—…ì´ìµ</td><td class="editable" contenteditable="false">${plData.opProfit.prev}</td><td class="editable" contenteditable="false">${plData.opProfit.target}</td><td class="editable" contenteditable="false">${plData.opProfit.forecast}</td><td class="editable" contenteditable="false">${opProfitYoy}%</td><td class="editable" contenteditable="false">${plData.opProfit.achievement}%</td></tr>
          <tr><td class="item-name">í• ì¸ìœ¨</td><td class="editable" contenteditable="false">${plData.discountRate?.prev !== undefined ? `${plData.discountRate.prev}%` : '-'}</td><td class="editable" contenteditable="false">${plData.discountRate?.target !== undefined ? `${plData.discountRate.target}%` : '-'}</td><td class="editable" contenteditable="false">${plData.discountRate?.forecast !== undefined ? `${plData.discountRate.forecast}%` : '-'}</td><td class="editable" contenteditable="false" id="brand-discount-yoy">-</td><td class="editable" contenteditable="false" id="brand-discount-achievement">-</td></tr>
        `;
        
        // í• ì¸ìœ¨ ì „ë…„ëŒ€ë¹„ ë° ë‹¬ì„±ë¥  ê³„ì‚°
        if (plData.discountRate && plData.discountRate.forecast !== undefined && plData.discountRate.prev !== undefined) {
          const discountYoy = plData.discountRate.forecast - plData.discountRate.prev;
          const discountYoyEl = document.getElementById('brand-discount-yoy');
          if (discountYoyEl) {
            const sign = discountYoy >= 0 ? '+' : '';
            discountYoyEl.textContent = `${sign}${discountYoy.toFixed(1)}%p`;
          }
        }
        if (plData.discountRate && plData.discountRate.forecast !== undefined && plData.discountRate.target !== undefined) {
          const discountAchievement = plData.discountRate.forecast - plData.discountRate.target;
          const discountAchievementEl = document.getElementById('brand-discount-achievement');
          if (discountAchievementEl) {
            const sign = discountAchievement >= 0 ? '+' : '';
            discountAchievementEl.textContent = `${sign}${discountAchievement.toFixed(1)}%p`;
          }
        }
        
        // í…Œì´ë¸” ìƒì„± í›„ í¸ì§‘ ë‚´ìš© ì ìš©
        loadEdits();
        if(isEditMode) applyEditMode();
      }

      // ì±„ë„ë³„ ì†ìµ í…Œì´ë¸” ì—…ë°ì´íŠ¸
      updateBrandChannels();
    }

    // ì±„ë„ë³„ ì†ìµ í‘œì‹œ ëª¨ë“œ (revenue ë˜ëŠ” profit)
    let channelPlMode = 'revenue';

    // ë¸Œëœë“œë³„ ì±„ë„ ì†ìµ ì—…ë°ì´íŠ¸
    function updateBrandChannels() {
      const channelRevenueData = {
        MLB: [
          { channel: 'ë°±í™”ì ', prev: 74.76, target: 70.70, forecast: 82.62, yoy: 111, achievement: 117 },
          { channel: 'ë©´ì„¸ì ', prev: 115.02, target: 110.00, forecast: 110.20, yoy: 96, achievement: 100 },
          { channel: 'ì§ì˜ì (ê°€ë‘)', prev: 20.06, target: 29.92, forecast: 28.55, yoy: 142, achievement: 95 },
          { channel: 'ì§ì˜ëª°', prev: 5.85, target: 4.75, forecast: 5.75, yoy: 98, achievement: 121 },
          { channel: 'ìì‚¬ëª°', prev: 12.42, target: 11.46, forecast: 9.78, yoy: 79, achievement: 85 },
          { channel: 'ì œíœ´ëª°', prev: 16.22, target: 20.22, forecast: 18.68, yoy: 115, achievement: 92 },
          { channel: 'ëŒ€ë¦¬ì ', prev: 55.75, target: 50.20, forecast: 63.32, yoy: 114, achievement: 126 },
          { channel: 'ì‚¬ì…', prev: 34.11, target: 34.05, forecast: 30.39, yoy: 89, achievement: 89 }
        ],
        MLB_KIDS: [
          { channel: 'ë°±í™”ì ', prev: 29.16, target: 32.61, forecast: 30.82, yoy: 106, achievement: 95 },
          { channel: 'ë©´ì„¸ì ', prev: 10.34, target: 8.11, forecast: 7.18, yoy: 69, achievement: 88 },
          { channel: 'ì§ì˜ì (ê°€ë‘)', prev: 1.61, target: 1.60, forecast: 1.22, yoy: 75, achievement: 76 },
          { channel: 'ì§ì˜ëª°', prev: 2.99, target: 3.80, forecast: 3.42, yoy: 115, achievement: 90 },
          { channel: 'ìì‚¬ëª°', prev: 3.12, target: 3.31, forecast: 3.36, yoy: 108, achievement: 101 },
          { channel: 'ì œíœ´ëª°', prev: 7.00, target: 8.69, forecast: 10.02, yoy: 143, achievement: 115 },
          { channel: 'ëŒ€ë¦¬ì ', prev: 7.34, target: 7.82, forecast: 8.98, yoy: 122, achievement: 115 },
          { channel: 'ì‚¬ì…', prev: 24.62, target: 23.07, forecast: 14.49, yoy: 59, achievement: 63 }
        ],
        DISCOVERY: [
          { channel: 'ë°±í™”ì ', prev: 109.95, target: 113.15, forecast: 90.99, yoy: 83, achievement: 80 },
          { channel: 'ë©´ì„¸ì ', prev: 13.20, target: 13.00, forecast: 12.38, yoy: 94, achievement: 95 },
          { channel: 'ì§ì˜ì (ê°€ë‘)', prev: 0.81, target: 4.45, forecast: 3.46, yoy: 430, achievement: 78 },
          { channel: 'ì§ì˜ëª°', prev: 8.86, target: 13.54, forecast: 8.88, yoy: 100, achievement: 66 },
          { channel: 'ìì‚¬ëª°', prev: 17.98, target: 15.14, forecast: 14.85, yoy: 83, achievement: 98 },
          { channel: 'ì œíœ´ëª°', prev: 35.24, target: 40.99, forecast: 39.27, yoy: 111, achievement: 96 },
          { channel: 'ëŒ€ë¦¬ì ', prev: 141.01, target: 130.92, forecast: 123.54, yoy: 88, achievement: 94 },
          { channel: 'ì•„ìš¸ë ›', prev: 111.44, target: 111.32, forecast: 102.50, yoy: 92, achievement: 92 },
          { channel: 'íŒ©í† ë¦¬ì•„ìš¸ë ›', prev: 8.86, target: 7.49, forecast: 4.32, yoy: 49, achievement: 58 },
          { channel: 'ì‚¬ì…', prev: 21.04, target: 9.00, forecast: 3.02, yoy: 14, achievement: 34 }
        ],
        DUVETICA: [
          { channel: 'ë°±í™”ì ', prev: 7.16, target: 11.90, forecast: 13.32, yoy: 186, achievement: 112 },
          { channel: 'ì§ì˜ëª°', prev: 1.86, target: 1.40, forecast: 1.74, yoy: 94, achievement: 124 },
          { channel: 'ìì‚¬ëª°', prev: 1.06, target: 2.38, forecast: 2.14, yoy: 202, achievement: 90 },
          { channel: 'ì œíœ´ëª°', prev: 3.04, target: 6.42, forecast: 11.97, yoy: 394, achievement: 186 },
          { channel: 'ì•„ìš¸ë ›', prev: 0, target: 10.10, forecast: 9.50, yoy: 0, achievement: 94 }
        ],
        SERGIO: [
          { channel: 'ë°±í™”ì ', prev: 1.43, target: 0.16, forecast: 0.16, yoy: 11, achievement: 98 },
          { channel: 'ë©´ì„¸ì ', prev: 1.16, target: 1.20, forecast: 0.76, yoy: 66, achievement: 64 },
          { channel: 'ì§ì˜ëª°', prev: 2.31, target: 3.20, forecast: 1.59, yoy: 69, achievement: 50 },
          { channel: 'ìì‚¬ëª°', prev: 3.55, target: 3.90, forecast: 2.31, yoy: 65, achievement: 59 },
          { channel: 'ì œíœ´ëª°', prev: 1.26, target: 3.90, forecast: 2.69, yoy: 213, achievement: 69 },
          { channel: 'ì•„ìš¸ë ›', prev: 0.57, target: 1.10, forecast: 0.91, yoy: 160, achievement: 83 }
        ],
        SUPRA: [
          { channel: 'ìì‚¬ëª°', prev: 0.31, target: 0.72, forecast: 1.04, yoy: 331, achievement: 145 },
          { channel: 'ì œíœ´ëª°', prev: 0.48, target: 1.08, forecast: 1.46, yoy: 304, achievement: 136 }
        ]
      };
      
      const channelProfitData = {
        MLB: [
          { channel: 'ë°±í™”ì ', prev: 15.45, target: 15.81, forecast: 17.94, yoy: 116, achievement: 113 },
          { channel: 'ë©´ì„¸ì ', prev: 32.03, target: 28.42, forecast: 29.33, yoy: 92, achievement: 103 },
          { channel: 'ì§ì˜ì (ê°€ë‘)', prev: 5.91, target: 10.92, forecast: 8.52, yoy: 144, achievement: 78 },
          { channel: 'ì§ì˜ëª°', prev: 0.73, target: 0.21, forecast: 1.09, yoy: 150, achievement: 513 },
          { channel: 'ìì‚¬ëª°', prev: 6.84, target: 6.88, forecast: 5.83, yoy: 85, achievement: 85 },
          { channel: 'ì œíœ´ëª°', prev: 6.12, target: 8.44, forecast: 7.36, yoy: 120, achievement: 87 },
          { channel: 'ëŒ€ë¦¬ì ', prev: 17.29, target: 16.56, forecast: 20.28, yoy: 117, achievement: 122 },
          { channel: 'ì‚¬ì…', prev: 15.23, target: 9.30, forecast: 7.17, yoy: 47, achievement: 77 }
        ],
        MLB_KIDS: [
          { channel: 'ë°±í™”ì ', prev: 2.37, target: 3.13, forecast: 2.18, yoy: 92, achievement: 70 },
          { channel: 'ë©´ì„¸ì ', prev: 1.62, target: 0.62, forecast: 0.55, yoy: 34, achievement: 90 },
          { channel: 'ì§ì˜ì (ê°€ë‘)', prev: 0.95, target: 0.61, forecast: 0.55, yoy: 58, achievement: 90 },
          { channel: 'ì§ì˜ëª°', prev: 0.31, target: 0.72, forecast: 0.73, yoy: 238, achievement: 101 },
          { channel: 'ìì‚¬ëª°', prev: 1.70, target: 1.86, forecast: 1.78, yoy: 105, achievement: 96 },
          { channel: 'ì œíœ´ëª°', prev: 2.24, target: 2.70, forecast: 3.06, yoy: 137, achievement: 114 },
          { channel: 'ëŒ€ë¦¬ì ', prev: 1.93, target: 1.98, forecast: 2.11, yoy: 109, achievement: 107 },
          { channel: 'ì‚¬ì…', prev: 1.53, target: -3.77, forecast: -0.86, yoy: -57, achievement: 23 }
        ],
        DISCOVERY: [
          { channel: 'ë°±í™”ì ', prev: 21.67, target: 18.71, forecast: 15.25, yoy: 70, achievement: 82 },
          { channel: 'ë©´ì„¸ì ', prev: 2.49, target: 2.08, forecast: 1.54, yoy: 62, achievement: 74 },
          { channel: 'ì§ì˜ì (ê°€ë‘)', prev: -0.33, target: 1.65, forecast: -0.24, yoy: 72, achievement: -14 },
          { channel: 'ì§ì˜ëª°', prev: 2.09, target: 3.92, forecast: 2.28, yoy: 109, achievement: 58 },
          { channel: 'ìì‚¬ëª°', prev: 10.15, target: 8.86, forecast: 8.61, yoy: 85, achievement: 97 },
          { channel: 'ì œíœ´ëª°', prev: 12.40, target: 15.37, forecast: 14.65, yoy: 118, achievement: 95 },
          { channel: 'ëŒ€ë¦¬ì ', prev: 44.12, target: 37.74, forecast: 36.92, yoy: 84, achievement: 98 },
          { channel: 'ì•„ìš¸ë ›', prev: 33.29, target: 32.91, forecast: 26.87, yoy: 81, achievement: 82 },
          { channel: 'íŒ©í† ë¦¬ì•„ìš¸ë ›', prev: 2.09, target: 3.60, forecast: 1.71, yoy: 82, achievement: 47 },
          { channel: 'ì‚¬ì…', prev: -0.63, target: -0.13, forecast: -0.77, yoy: 121, achievement: 573 }
        ],
        DUVETICA: [
          { channel: 'ë°±í™”ì ', prev: 0.46, target: 2.38, forecast: 3.72, yoy: 816, achievement: 157 },
          { channel: 'ì§ì˜ëª°', prev: 0.01, target: 0.22, forecast: 0.27, yoy: 3217, achievement: 122 },
          { channel: 'ìì‚¬ëª°', prev: 0.66, target: 1.25, forecast: 1.26, yoy: 190, achievement: 101 },
          { channel: 'ì œíœ´ëª°', prev: 0.61, target: 1.74, forecast: 4.52, yoy: 744, achievement: 259 },
          { channel: 'ì•„ìš¸ë ›', prev: -0.18, target: 3.56, forecast: 2.94, yoy: -1662, achievement: 83 }
        ],
        SERGIO: [
          { channel: 'ë°±í™”ì ', prev: -0.43, target: -0.11, forecast: -0.09, yoy: 21, achievement: 84 },
          { channel: 'ë©´ì„¸ì ', prev: -0.01, target: -0.20, forecast: -0.11, yoy: 1038, achievement: 56 },
          { channel: 'ì§ì˜ëª°', prev: -0.29, target: -0.01, forecast: -0.25, yoy: 85, achievement: 2052 },
          { channel: 'ìì‚¬ëª°', prev: 1.92, target: 1.45, forecast: 0.84, yoy: 44, achievement: 58 },
          { channel: 'ì œíœ´ëª°', prev: 0.31, target: 0.48, forecast: 0.63, yoy: 201, achievement: 129 },
          { channel: 'ì•„ìš¸ë ›', prev: -0.02, target: 0.07, forecast: 0.07, yoy: -413, achievement: 104 }
        ],
        SUPRA: [
          { channel: 'ë°±í™”ì ', prev: 0, target: 0.01, forecast: -0.01, yoy: 0, achievement: -213 },
          { channel: 'ë©´ì„¸ì ', prev: -0.21, target: -0.09, forecast: -0.08, yoy: 38, achievement: 92 },
          { channel: 'ì§ì˜ì (ê°€ë‘)', prev: -1.43, target: -0.34, forecast: -0.49, yoy: 34, achievement: 143 },
          { channel: 'ì§ì˜ëª°', prev: -0.30, target: -0.18, forecast: -0.33, yoy: 109, achievement: 181 },
          { channel: 'ìì‚¬ëª°', prev: 0.15, target: 0.38, forecast: 0.15, yoy: 102, achievement: 40 },
          { channel: 'ì œíœ´ëª°', prev: 0.08, target: 0.30, forecast: -0.12, yoy: -153, achievement: -41 }
        ]
      };
      
      // ë¸Œëœë“œë³„ ì „ì²´ í•©ê³„
      const brandRevenueTotals = {
        MLB: { prev: 334.19, target: 331.30, forecast: 349.30 },
        MLB_KIDS: { prev: 86.20, target: 89.01, forecast: 79.48 },
        DISCOVERY: { prev: 464.18, target: 459.00, forecast: 403.21 },
        DUVETICA: { prev: 18.51, target: 32.50, forecast: 38.67 },
        SERGIO: { prev: 10.28, target: 13.46, forecast: 8.43 },
        SUPRA: { prev: 3.24, target: 4.00, forecast: 2.51 }
      };
      
      const brandProfitTotals = {
        MLB: { prev: 94.19, target: 93.11, forecast: 94.19 },
        MLB_KIDS: { prev: 10.80, target: 5.84, forecast: 8.10 },
        DISCOVERY: { prev: 107.99, target: 107.54, forecast: 89.71 },
        DUVETICA: { prev: -12.11, target: 7.12, forecast: 10.57 },
        SERGIO: { prev: 1.49, target: 0.32, forecast: 0.05 },
        SUPRA: { prev: -1.54, target: -0.49, forecast: -1.31 }
      };

      // channelPlModeì— ë”°ë¼ ë°ì´í„° ì„ íƒ
      const isRevenueMode = channelPlMode === 'revenue';
      const channelData = isRevenueMode ? channelRevenueData : channelProfitData;
      const totalsData = isRevenueMode ? brandRevenueTotals : brandProfitTotals;
      
      const channels = channelData[currentBrand] || channelData.MLB;
      const totals = totalsData[currentBrand] || totalsData.MLB;
      const inlineBody = document.getElementById('channel-pl-inline-body');
      if (inlineBody) {
        // ì „ì²´ í•©ê³„ ì‚¬ìš© (ì£¼ìš” ì±„ë„ í•©ê³„ê°€ ì•„ë‹Œ ë¸Œëœë“œ ì „ì²´ í•©ê³„)
        const totalPrev = totals.prev;
        const totalTarget = totals.target;
        const totalForecast = totals.forecast;
        const totalYoy = totalPrev > 0 ? Math.round((totalForecast / totalPrev) * 100) : 0;
        const totalAchievement = totalTarget > 0 ? Math.round((totalForecast / totalTarget) * 100) : 0;
        
        // í•©ê³„ í–‰ê³¼ ì±„ë„ í–‰ì„ í•¨ê»˜ ìƒì„±
        inlineBody.innerHTML = `
          <tr class="total-row">
            <td class="item-name">í•©ê³„</td>
            <td class="editable" contenteditable="false">${totalPrev.toFixed(1)}</td>
            <td class="editable" contenteditable="false">${totalTarget.toFixed(1)}</td>
            <td class="editable" contenteditable="false">${totalForecast.toFixed(1)}</td>
            <td class="editable" contenteditable="false">${totalYoy}%</td>
            <td class="editable" contenteditable="false">${totalAchievement}%</td>
          </tr>
        ` + channels.map(ch => {
          const channelYoy = ch.prev > 0 ? Math.round((ch.forecast / ch.prev) * 100) : 0;
          return `<tr><td class="item-name">${ch.channel}</td><td class="editable" contenteditable="false">${ch.prev}</td><td class="editable" contenteditable="false">${ch.target}</td><td class="editable" contenteditable="false">${ch.forecast}</td><td class="editable" contenteditable="false">${channelYoy}%</td><td class="editable" contenteditable="false">${ch.achievement}%</td></tr>`;
        }).join('');
        
        // í…Œì´ë¸” ìƒì„± í›„ í¸ì§‘ ë‚´ìš© ì ìš©
        loadEdits();
        if(isEditMode) applyEditMode();
      }
    }

    function setText(id, text){ 
      const el=document.getElementById(id); 
      if(el) {
        // ì €ì¥ëœ í¸ì§‘ ë‚´ìš©ì´ ìˆëŠ”ì§€ í™•ì¸
        const edits = localStorage.getItem(STORAGE_KEY);
        if (edits) {
          const data = JSON.parse(edits);
          const key = getElementKey(el);
          // í¸ì§‘ëœ ë‚´ìš©ì´ ìˆìœ¼ë©´ ê·¸ê²ƒì„ ì‚¬ìš©, ì—†ìœ¼ë©´ ì›ë³¸ ì‚¬ìš©
          const finalText = data[key] !== undefined ? data[key] : text;
          console.log(`setText ${id}:`, {text, finalText, hasEdit: data[key] !== undefined});
          el.textContent = finalText;
        } else {
          console.log(`setText ${id}:`, {text, finalText: text, hasEdit: false});
          el.textContent = text;
        }
      }
    }
    function setDelta(id, val, isPctPt=false){
      const el=document.getElementById(id); if(!el) return;
      const sign = val>=0?'+':'';
      const defaultText = `ëª©í‘œ ëŒ€ë¹„ ${sign}${val}${isPctPt?'%p':'%'}`;
      
      // ì €ì¥ëœ í¸ì§‘ ë‚´ìš©ì´ ìˆëŠ”ì§€ í™•ì¸
      const edits = localStorage.getItem(STORAGE_KEY);
      if (edits) {
        const data = JSON.parse(edits);
        const key = getElementKey(el);
        el.textContent = data[key] !== undefined ? data[key] : defaultText;
      } else {
        el.textContent = defaultText;
      }
      el.className = 'kpi-change-line editable ' + (val>=0?'kpi-positive':'kpi-negative');
    }
    function setYoY(id, val, isPctPt=false){
      const el=document.getElementById(id); if(!el) return;
      const sign = val>=0?'+':'';
      const defaultText = `ì „ë…„ ëŒ€ë¹„ ${sign}${val}${isPctPt?'%p':'%'}`;
      
      // ì €ì¥ëœ í¸ì§‘ ë‚´ìš©ì´ ìˆëŠ”ì§€ í™•ì¸
      const edits = localStorage.getItem(STORAGE_KEY);
      if (edits) {
        const data = JSON.parse(edits);
        const key = getElementKey(el);
        el.textContent = data[key] !== undefined ? data[key] : defaultText;
      } else {
        el.textContent = defaultText;
      }
      el.className = 'kpi-change editable ' + (val>=0?'kpi-positive':'kpi-negative');
    }

    // -------- ë¸Œëœë“œ ê¸°ì—¬ë„ ì°¨íŠ¸ (ë“œë¦´ë‹¤ìš´ ê¸°ëŠ¥) --------
    function createBrandContributionChart(labels, sales) {
      // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
      if(charts.brandContribution){ 
        charts.brandContribution.destroy(); 
        delete charts.brandContribution; 
      }
      
      charts.brandContribution = new Chart(document.getElementById('brandContributionChart').getContext('2d'),{
        type:'doughnut',
        data:{ 
          labels, 
          datasets:[{
            data:sales,
            backgroundColor:[
              'rgba(79,70,229,0.8)','rgba(124,58,237,0.8)','rgba(59,130,246,0.8)',
              'rgba(16,185,129,0.8)','rgba(245,158,11,0.8)','rgba(239,68,68,0.8)',
              'rgba(168,85,247,0.8)','rgba(34,197,94,0.8)','rgba(251,146,60,0.8)',
              'rgba(244,63,94,0.8)','rgba(156,163,175,0.8)'
            ],
            borderWidth:2
          }]
        },
        options:{
          responsive:true,
          maintainAspectRatio:false,
          plugins:{
            legend:{position:'bottom',labels:{font:{size:10}}},
            tooltip:{
              callbacks:{
                label: function(context) {
                  const label = context.label || '';
                  const value = context.parsed || 0;
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = ((value / total) * 100).toFixed(1);
                  return `${label}: ${value.toFixed(1)}ì–µì› (${percentage}%)`;
                }
              }
            }
          },
          onClick: function(evt, elements) {
            if (elements.length > 0 && !isDrilledDown) {
              const index = elements[0].index;
              const brandName = labels[index];
              drillDownToChannels(brandName);
            }
          }
        }
      });
    }

    // ì±„ë„ë³„ ë“œë¦´ë‹¤ìš´
    function drillDownToChannels(brandName) {
      // brandDataì—ì„œ í•´ë‹¹ ë¸Œëœë“œì˜ ì±„ë„ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      const brandKey = getBrandKey(brandName);
      if (!brandData[brandKey] || !brandData[brandKey].channels) {
        alert('í•´ë‹¹ ë¸Œëœë“œì˜ ì±„ë„ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      
      const channels = brandData[brandKey].channels;
      // ACC, ë‹¹ì‹œì¦Œ, ê³¼ì‹œì¦Œì€ ì•„ì´í…œ ë¶„ë¥˜ì´ë¯€ë¡œ ì œì™¸
      const itemCategories = ['ACC', 'ë‹¹ì‹œì¦Œ', 'ê³¼ì‹œì¦Œ'];
      const channelNames = Object.keys(channels).filter(ch => !itemCategories.includes(ch));
      const channelSales = channelNames.map(ch => channels[ch].forecast || 0);
      
      // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
      isDrilledDown = true;
      currentDrillBrand = brandName;
      
      if(charts.brandContribution){ 
        charts.brandContribution.destroy(); 
        delete charts.brandContribution; 
      }
      
      charts.brandContribution = new Chart(document.getElementById('brandContributionChart').getContext('2d'),{
        type:'doughnut',
        data:{ 
          labels: channelNames, 
          datasets:[{
            data: channelSales,
            backgroundColor:[
              'rgba(79,70,229,0.8)','rgba(124,58,237,0.8)','rgba(59,130,246,0.8)',
              'rgba(16,185,129,0.8)','rgba(245,158,11,0.8)','rgba(239,68,68,0.8)',
              'rgba(168,85,247,0.8)','rgba(34,197,94,0.8)','rgba(251,146,60,0.8)',
              'rgba(244,63,94,0.8)','rgba(156,163,175,0.8)'
            ],
            borderWidth:2
          }]
        },
        options:{
          responsive:true,
          maintainAspectRatio:false,
          plugins:{
            legend:{position:'bottom',labels:{font:{size:9}}},
            tooltip:{
              callbacks:{
                label: function(context) {
                  const label = context.label || '';
                  const value = context.parsed || 0;
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = ((value / total) * 100).toFixed(1);
                  const achievement = channels[label]?.achievement || '-';
                  return [
                    `${label}: ${value.toFixed(1)}ì–µì›`,
                    `ë¹„ì¤‘: ${percentage}%`,
                    `ë‹¬ì„±ë¥ : ${achievement}%`
                  ];
                }
              }
            }
          }
        }
      });
      
      // íƒ€ì´í‹€ ë° ë²„íŠ¼ ì—…ë°ì´íŠ¸
      document.getElementById('contributionChartTitle').textContent = `${brandName} ì±„ë„ë³„ ë§¤ì¶œ ë¹„ì¤‘`;
      document.getElementById('drillbackBtn').style.display = 'inline-block';
    }

    // ë¸Œëœë“œëª…ì„ brandDataì˜ í‚¤ë¡œ ë³€í™˜
    function getBrandKey(brandName) {
      const mapping = {
        'MLB': 'MLB',
        'MLB KIDS': 'MLB_KIDS',
        'DISCOVERY': 'DISCOVERY',
        'DUVETICA': 'DUVETICA',
        'SERGIO': 'SERGIO',
        'SUPRA': 'SUPRA'
      };
      return mapping[brandName] || brandName;
    }

    // -------- ì „ì²´ í˜„í™© ì°¨íŠ¸ --------
    function initOverviewCharts(){
      // ê¸°ì¡´ ì°¨íŠ¸ ì œê±°
      ['brandRevenue','brandContribution','brandAllRadar','waterfall','cumulativeTrend'].forEach(n=>{
        if(charts[n]){ charts[n].destroy(); delete charts[n]; }
      });

      // ë°ì´í„° ì†ŒìŠ¤: ìš°ì„ ìˆœìœ„ data.js â†’ í´ë°± í•˜ë“œì½”ë”©
      // SUPRA ë¸Œëœë“œëŠ” ë°ì´í„°ì—ëŠ” í¬í•¨í•˜ë˜ ì°¨íŠ¸ì—ì„œëŠ” ì œì™¸
      const rows = Array.isArray(D.by_brand) ? D.by_brand : null;
      const allLabels = rows ? rows.map(r=> (r.BRAND||r.brand||r.name) ) : ['MLB','MLB KIDS','DISCOVERY','DUVETICA','SERGIO','SUPRA'];
      const allSales  = rows ? rows.map(r=> Number(r.SALES||r.sales||r.revenue||0) ) : [349.3,79.5,403.2,38.7,8.4,2.5];
      const allProfit = rows ? rows.map(r=> Number(r.DIRECT_PROFIT||r.profit||0) ) : [51.1,-4.5,26.7,1.9,-8.5,-3.2];
      const allAchieve = rows ? rows.map(r=> Number(r.ACHIEVEMENT||r.achievement||0) ) : [88,93,92,89,108,92];
      const allYoyGrowth = rows ? rows.map(r=> Number(r.YOY_SALES||r.yoy||100)-100 ) : [ -15, 12, -2, -15, 25, -12 ];
      
      // SUPRA ì œì™¸í•œ ë°ì´í„° (ì°¨íŠ¸ í‘œì‹œìš©)
      const labels = allLabels.filter(l => l !== 'SUPRA');
      const sales = allSales.filter((s, idx) => allLabels[idx] !== 'SUPRA');
      const profit = allProfit.filter((p, idx) => allLabels[idx] !== 'SUPRA');
      const achieve = allAchieve.filter((a, idx) => allLabels[idx] !== 'SUPRA');
      const yoyGrowth = allYoyGrowth.filter((y, idx) => allLabels[idx] !== 'SUPRA');

      // ë¸Œëœë“œë³„ ë§¤ì¶œ/ì´ìµ
      charts.brandRevenue = new Chart(document.getElementById('brandRevenueChart').getContext('2d'),{
        type:'bar',
        data:{ labels, datasets:[
          {label:'ë§¤ì¶œ (ì–µì›)',data:sales,backgroundColor:'rgba(79,70,229,0.8)',borderColor:'rgba(79,70,229,1)',borderWidth:1,yAxisID:'y'},
          {label:'ì˜ì—…ì´ìµ (ì–µì›)',data:profit,backgroundColor:'rgba(124,58,237,0.8)',borderColor:'rgba(124,58,237,1)',borderWidth:1,yAxisID:'y1'}
        ]},
        options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'top',labels:{font:{size:11}}}},scales:{
          y:{type:'linear',display:true,position:'left',title:{display:true,text:'ë§¤ì¶œ (ì–µì›)',font:{size:10}},ticks:{font:{size:9}}},
          y1:{type:'linear',display:true,position:'right',title:{display:true,text:'ì˜ì—…ì´ìµ (ì–µì›)',font:{size:10}},grid:{drawOnChartArea:false},ticks:{font:{size:9}}},
          x:{ticks:{font:{size:9}}}
        }}
      });

      // ì „ì²´ ë¸Œëœë“œ ë ˆì´ë” ì°¨íŠ¸
      initAllBrandsRadarChart();
      
      // ì „ì²´í˜„í™© íŠ¸ë¦¬ë§µ ì´ˆê¸°í™”
      initOverviewTreemap();

      // Waterfall ì°¨íŠ¸ (ì†ìµ êµ¬ì¡°) - 7ë‹¨ê³„ (ìœ„ì—ì„œ ì•„ë˜ë¡œ ì°¨ê°)
      // ì†ìµê³„ì‚°ì„œ ë°ì´í„° (ì–µì› ë‹¨ìœ„) - brandPLDataì—ì„œ ì „ì²´ í•©ì‚°
      const plRevenue = 881.6;        // ì‹¤íŒë§¤ì¶œ (ì „ì²´ ë¸Œëœë“œ í•©ê³„)
      const plCogs = 474.3;           // ë§¤ì¶œì›ê°€ (ì „ì²´ ë¸Œëœë“œ í•©ê³„)
      const plGrossProfit = plRevenue - plCogs;  // ë§¤ì¶œì´ì´ìµ (407.3)
      const plDirectCost = 302.3;     // ì§ì ‘ë¹„ (ì „ì²´ ë¸Œëœë“œ í•©ê³„)
      const plDirectProfit = plGrossProfit - plDirectCost;  // ì§ì ‘ì´ìµ (105.0)
      const plOpCost = 57.7;          // ì˜ì—…ë¹„ (ì§ì ‘ì´ìµ - ì˜ì—…ì´ìµ)
      const plOpProfit = 47.3;        // ì˜ì—…ì´ìµ (ì „ì²´ ë¸Œëœë“œ í•©ê³„)
      
      // Waterfall ë°ì´í„° ê³„ì‚° (7ë‹¨ê³„) - ì‹¤íŒë§¤ì¶œ ê¸°ì¤€ ìœ„ì—ì„œ ì°¨ê°
      const waterfallData = [
        {label: 'ì‹¤íŒë§¤ì¶œ', value: plRevenue, base: 0, amount: plRevenue, type: 'total', display: plRevenue.toFixed(1)},
        {label: 'ë§¤ì¶œì›ê°€\n(-)', value: plCogs, base: plGrossProfit, amount: plCogs, type: 'decrease', display: plCogs.toFixed(1), startVal: plRevenue, endVal: plGrossProfit},
        {label: 'ë§¤ì¶œì´ì´ìµ', value: plGrossProfit, base: 0, amount: plGrossProfit, type: 'subtotal', display: plGrossProfit.toFixed(1)},
        {label: 'ì§ì ‘ë¹„\n(-)', value: plDirectCost, base: plDirectProfit, amount: plDirectCost, type: 'decrease', display: plDirectCost.toFixed(1), startVal: plGrossProfit, endVal: plDirectProfit},
        {label: 'ì§ì ‘ì´ìµ', value: plDirectProfit, base: 0, amount: plDirectProfit, type: 'subtotal', display: plDirectProfit.toFixed(1)},
        {label: 'ì˜ì—…ë¹„\n(-)', value: plOpCost, base: plOpProfit, amount: plOpCost, type: 'decrease', display: plOpCost === 0 ? '0.0' : plOpCost.toFixed(1), startVal: plDirectProfit, endVal: plOpProfit},
        {label: 'ì˜ì—…ì´ìµ', value: plOpProfit, base: 0, amount: plOpProfit, type: 'result', display: plOpProfit.toFixed(1)}
      ];
      
      // Chart.js Waterfall êµ¬í˜„ (ì‹¤íŒë§¤ì¶œ ê¸°ì¤€ ìœ„ì—ì„œ ì°¨ê°)
      charts.waterfall = new Chart(document.getElementById('waterfallChart').getContext('2d'),{
        type:'bar',
        data:{
          labels: waterfallData.map(d => d.label),
          datasets: [
            {
              label: 'ê¸°ì¤€ì„  (íˆ¬ëª…)',
              data: waterfallData.map(d => d.base),
              backgroundColor: 'rgba(0,0,0,0)',
              borderWidth: 0
            },
            {
              label: 'ê¸ˆì•¡',
              data: waterfallData.map(d => d.amount),
              backgroundColor: waterfallData.map(d => {
                if (d.type === 'total') return 'rgba(16,185,129,0.85)';
                if (d.type === 'decrease') return 'rgba(239,68,68,0.85)';
                if (d.type === 'subtotal') return 'rgba(59,130,246,0.85)';
                return 'rgba(79,70,229,0.85)';
              }),
              borderColor: waterfallData.map(d => {
                if (d.type === 'total') return 'rgba(16,185,129,1)';
                if (d.type === 'decrease') return 'rgba(239,68,68,1)';
                if (d.type === 'subtotal') return 'rgba(59,130,246,1)';
                return 'rgba(79,70,229,1)';
              }),
              borderWidth: 2,
              barThickness: 50
            }
          ]
        },
        options:{
          responsive:true,
          maintainAspectRatio:false,
          plugins:{
            legend:{display:false},
            tooltip:{
              callbacks:{
                title: function(context) {
                  return waterfallData[context[0].dataIndex].label.replace('\n', ' ');
                },
                label: function(context) {
                  const idx = context.dataIndex;
                  const d = waterfallData[idx];
                  if (d.type === 'decrease') {
                    return [
                      `${d.startVal.toFixed(1)}ì–µì› â†’ ${d.endVal.toFixed(1)}ì–µì›`,
                      `ì°¨ê°: -${d.display}ì–µì›`
                    ];
                  }
                  return `ê¸ˆì•¡: ${d.display}ì–µì›`;
                },
                afterLabel: function(context) {
                  const idx = context.dataIndex;
                  const d = waterfallData[idx];
                  if (d.type === 'decrease') {
                    const rate = ((d.value / plRevenue) * 100).toFixed(1);
                    return `(ë§¤ì¶œ ëŒ€ë¹„ ${rate}%)`;
                  }
                  if (d.type === 'result') {
                    const margin = ((d.value / plRevenue) * 100).toFixed(1);
                    return `ì˜ì—…ì´ìµë¥ : ${margin}%`;
                  }
                  if (d.type === 'subtotal' || d.type === 'total') {
                    const rate = ((d.value / plRevenue) * 100).toFixed(1);
                    return `(ë§¤ì¶œ ëŒ€ë¹„ ${rate}%)`;
                  }
                  return '';
                }
              }
            }
          },
          scales:{
            x:{
              stacked:true,
              ticks:{font:{size:9}, maxRotation: 0, minRotation: 0}
            },
            y:{
              stacked:true,
              beginAtZero:true,
              max: plRevenue,  // ì‹¤íŒë§¤ì¶œê¹Œì§€ë§Œ í‘œì‹œ
              title:{display:true,text:'ê¸ˆì•¡ (ì–µì›)',font:{size:11}},
              ticks:{
                font:{size:9},
                callback: function(value) {
                  return value.toFixed(0);
                }
              },
              grid:{
                color: function(context) {
                  // Yì¶• ì£¼ìš” ë¼ì¸ ê°•ì¡°
                  if (Math.abs(context.tick.value - plRevenue) < 0.1 || 
                      Math.abs(context.tick.value - plGrossProfit) < 0.1 || 
                      Math.abs(context.tick.value - plDirectProfit) < 0.1 ||
                      context.tick.value === 0) {
                    return 'rgba(0,0,0,0.2)';
                  }
                  return 'rgba(0,0,0,0.05)';
                }
              }
            }
          }
        }
      });

      // ì›”ì¤‘ ëˆ„ì  ë§¤ì¶œ ì¶”ì´ (ì£¼ì°¨ë³„) - 10/5 ~ 11/2 (5ê°œ ì£¼ì°¨)
      // realDataì—ì„œ ì „ì²´ ë¸Œëœë“œ í•©ì‚° ê³„ì‚° (10/5=5ì£¼ì°¨ ~ 11/2=9ì£¼ì°¨)
      const weeks = ['10/5', '10/12', '10/19', '10/26', '11/2'];
      
      // realDataê°€ ì•„ì§ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
      let weeklyCurrentTotal, weeklyPrevTotal;
      
      if (realData) {
        // ì „ì²´ ë¸Œëœë“œ ì£¼ì°¨ë³„ ë§¤ì¶œ í•©ì‚° (ë‹¹ë…„)
        const allBrands = ['MLB', 'MLB_KIDS', 'DISCOVERY', 'DUVETICA', 'SERGIO', 'SUPRA'];
        const weekIndices = [4, 5, 6, 7, 8]; // 10/5=4ë²ˆ ì¸ë±ìŠ¤ ~ 11/2=8ë²ˆ ì¸ë±ìŠ¤
        
        weeklyCurrentTotal = weekIndices.map(weekIdx => {
          return allBrands.reduce((sum, brand) => {
            const brandData = realData[brand];
            if (!brandData || !brandData.ë‹¹ë…„) return sum;
          // ëª¨ë“  ì±„ë„ í•©ì‚°
          return sum + Object.values(brandData.ë‹¹ë…„).reduce((channelSum, weekArray) => {
            return channelSum + (weekArray[weekIdx] || 0);
          }, 0);
        }, 0);
        });
        
        // ì „ì²´ ë¸Œëœë“œ ì£¼ì°¨ë³„ ë§¤ì¶œ í•©ì‚° (ì „ë…„)
        weeklyPrevTotal = weekIndices.map(weekIdx => {
          return allBrands.reduce((sum, brand) => {
            const brandData = realData[brand];
            if (!brandData || !brandData.ì „ë…„) return sum;
            // ëª¨ë“  ì±„ë„ í•©ì‚°
            return sum + Object.values(brandData.ì „ë…„).reduce((channelSum, weekArray) => {
              return channelSum + (weekArray[weekIdx] || 0);
            }, 0);
          }, 0);
        });
      } else {
        // realDataê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
        console.warn('realData not initialized yet, using default values for cumulative trend');
        weeklyCurrentTotal = [175.2, 175.2, 175.2, 175.2, 176.4];
        weeklyPrevTotal = [183.3, 183.3, 183.3, 183.3, 183.3];
      }
      
      // ëˆ„ì  ê³„ì‚°
      let cumCurrent = 0;
      const forecastActual = weeklyCurrentTotal.map(weekly => {
        cumCurrent += weekly;
        return cumCurrent;
      });
      
      let cumPrev = 0;
      const prevSales = weeklyPrevTotal.map(weekly => {
        cumPrev += weekly;
        return cumPrev;
      });
      
      // ëª©í‘œëŠ” ì›”ë§ ëª©í‘œ(929.3ì–µì›)ë¥¼ ì£¼ì°¨ë³„ë¡œ ê· ë“± ë¶„ë°°í•œ ëˆ„ì 
      const monthlyTarget = 929.3;
      const weeklyTarget = monthlyTarget / 5;
      const targetSales = weeks.map((_, idx) => weeklyTarget * (idx + 1));
      
      // 11/2ê¹Œì§€ ì‹¤ì ì´ë¯€ë¡œ ì˜ˆìƒì€ null
      const forecastPlan = [null, null, null, null, null];
      
      charts.cumulativeTrend = new Chart(document.getElementById('cumulativeTrendChart').getContext('2d'),{
        type:'line',
        data:{
          labels: weeks,
          datasets:[
            {
              label:'ì›”ë§ì˜ˆìƒ (ì‹¤ì )',
              data: forecastActual,
              borderColor:'rgba(124,58,237,1)',
              backgroundColor:'rgba(124,58,237,0.1)',
              borderWidth:3,
              fill:false,
              tension:0.3,
              pointRadius:5,
              pointHoverRadius:7,
              spanGaps:false
            },
            {
              label:'ì›”ë§ì˜ˆìƒ (ì˜ˆìƒ)',
              data: forecastPlan,
              borderColor:'rgba(124,58,237,1)',
              backgroundColor:'rgba(124,58,237,0.1)',
              borderWidth:3,
              borderDash:[5,5],
              fill:false,
              tension:0.3,
              pointRadius:5,
              pointHoverRadius:7,
              spanGaps:false
            },
            {
              label:'ì „ë…„',
              data: prevSales,
              borderColor:'rgba(220,38,38,1)',
              backgroundColor:'rgba(220,38,38,0.1)',
              borderWidth:2.5,
              fill:false,
              tension:0.3,
              pointRadius:4,
              pointHoverRadius:6
            },
            {
              label:'ëª©í‘œ',
              data: targetSales,
              borderColor:'rgba(16,185,129,1)',
              backgroundColor:'rgba(16,185,129,0.1)',
              borderWidth:2.5,
              borderDash:[5,5],
              fill:false,
              tension:0.3,
              pointRadius:4,
              pointHoverRadius:6
            }
          ]
        },
        options:{
          responsive:true,
          maintainAspectRatio:false,
          plugins:{
            legend:{
              position:'top',
              labels:{font:{size:10}}
            },
            tooltip:{
              callbacks:{
                label: function(context) {
                  const label = context.dataset.label || '';
                  const value = context.parsed.y;
                  if (value === null) return '';
                  return `${label}: ${value.toFixed(1)}ì–µì›`;
                }
              }
            }
          },
          scales:{
            y:{
              type:'linear',
              display:true,
              position:'left',
              title:{display:true,text:'ëˆ„ì  ë§¤ì¶œ (ì–µì›)',font:{size:11}},
              ticks:{font:{size:10}},
              beginAtZero:true
            },
            x:{ticks:{font:{size:10}}}
          }
        },
        plugins:[{
          afterDraw: function(chart) {
            const ctx = chart.ctx;
            const xAxis = chart.scales.x;
            const yAxis = chart.scales.y;
            
            // 8/17 ìœ„ì¹˜ (ì¸ë±ìŠ¤ 2 = ì„¸ ë²ˆì§¸ í¬ì¸íŠ¸)
            const currentWeekPosition = 2; // 0-based index
            const x = xAxis.getPixelForValue(currentWeekPosition);
            
            // ë¹¨ê°„ ìˆ˜ì§ì„  ê·¸ë¦¬ê¸°
            ctx.save();
            ctx.beginPath();
            ctx.moveTo(x, yAxis.top);
            ctx.lineTo(x, yAxis.bottom);
            ctx.strokeStyle = 'rgba(220,38,38,0.8)';
            ctx.lineWidth = 2.5;
            ctx.setLineDash([]);
            ctx.stroke();
            
            // "8/17(í˜„ì¬)" ë¼ë²¨ ì¶”ê°€
            ctx.fillStyle = 'rgba(220,38,38,1)';
            ctx.font = 'bold 11px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('8/17(í˜„ì¬)', x, yAxis.top - 5);
            
            ctx.restore();
          }
        }]
      });

      // ê°œìš” ì„¹ì…˜: ì£¼ì°¨ë³„/ëˆ„ì  í† ê¸€ UI/ë¡œì§ ë³´ê°•
      ensureOverviewToggleUI();
      
      // ë²„ë¸” ì°¨íŠ¸ ì´ˆê¸°í™”
      initOverviewBubbleChart();
      
      // ì „ì²´í˜„í™© íŒë§¤ìœ¨/ì¬ê³ ì£¼ìˆ˜ ë²„íŠ¼ ì´ˆê¸°í™”
      initOverviewModeButtons();
    }
    
    // -------- ì „ì²´í˜„í™© íŒë§¤ìœ¨/ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œ ê´€ë¦¬ --------
    let overviewMode = 'inventory'; // 'sale' | 'inventory' (ê¸°ë³¸ê°’: ì¬ê³ ì£¼ìˆ˜)
    
    function initOverviewModeButtons(){
      const btnSaleRate = document.getElementById('overviewBtnSaleRate');
      const btnInventory = document.getElementById('overviewBtnInventory');
      
      if(btnSaleRate && !btnSaleRate.hasAttribute('data-listener')){
        btnSaleRate.setAttribute('data-listener','true');
        btnSaleRate.addEventListener('click', ()=>{ 
          overviewMode = 'sale'; 
          updateOverviewModeButtons(); 
          updateOverviewModeView(); 
        });
      }
      if(btnInventory && !btnInventory.hasAttribute('data-listener')){
        btnInventory.setAttribute('data-listener','true');
        btnInventory.addEventListener('click', ()=>{ 
          overviewMode = 'inventory'; 
          updateOverviewModeButtons(); 
          updateOverviewModeView(); 
        });
      }
      updateOverviewModeButtons();
      updateOverviewModeView();
    }
    
    function updateOverviewModeButtons(){
      const btnSaleRate = document.getElementById('overviewBtnSaleRate');
      const btnInventory = document.getElementById('overviewBtnInventory');
      
      if(btnSaleRate){
        if(overviewMode==='sale'){ 
          btnSaleRate.style.background='#2563eb'; 
          btnSaleRate.style.color='#fff'; 
        } else { 
          btnSaleRate.style.background='#e5e7eb'; 
          btnSaleRate.style.color='#374151'; 
        }
      }
      if(btnInventory){
        if(overviewMode==='inventory'){ 
          btnInventory.style.background='#2563eb'; 
          btnInventory.style.color='#fff'; 
        } else { 
          btnInventory.style.background='#e5e7eb'; 
          btnInventory.style.color='#374151'; 
        }
      }
    }
    
    function updateOverviewModeView(){
      const heatmapContainer = document.getElementById('overviewHeatmapContainer');
      const bubbleContainer = document.getElementById('overviewBubbleContainer');
      const bubbleControls = document.getElementById('bubbleControlsContainer');
      const kpi4 = document.getElementById('overviewKpi4');
      const kpi9 = document.getElementById('overviewKpi9');
      
      if(overviewMode==='sale'){
        // íŒë§¤ìœ¨ ëª¨ë“œ: íˆíŠ¸ë§µ í‘œì‹œ, ë²„ë¸” ì°¨íŠ¸ ìˆ¨ê¹€
        if(heatmapContainer) heatmapContainer.style.display = 'block';
        if(bubbleContainer) bubbleContainer.style.display = 'none';
        if(bubbleControls) bubbleControls.style.display = 'none';
        if(kpi4) kpi4.style.display = 'none';
        if(kpi9) kpi9.style.display = 'none';
        
        // íˆíŠ¸ë§µ ìƒì„±
        createOverviewHeatmap();
      } else {
        // ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œ: ë²„ë¸” ì°¨íŠ¸ í‘œì‹œ, íˆíŠ¸ë§µ ìˆ¨ê¹€
        if(heatmapContainer) heatmapContainer.style.display = 'none';
        if(bubbleContainer) bubbleContainer.style.display = 'block';
        if(bubbleControls) bubbleControls.style.display = 'block';
        if(kpi4) kpi4.style.display = 'grid';
        if(kpi9) kpi9.style.display = overviewBubbleView === '9quadrant' ? 'grid' : 'none';
      }
    }
    
    function createOverviewHeatmap(){
      const table = document.getElementById('overviewHeatmapTable');
      if(!table) return;
      
      // ë¸Œëœë“œ ëª©ë¡ (SUPRA ì œì™¸)
      const brands = ['MLB', 'MLB KIDS', 'DISCOVERY', 'DUVETICA', 'SERGIO'];
      const brandKeys = ['MLB', 'MLB_KIDS', 'DISCOVERY', 'DUVETICA', 'SERGIO'];
      
      // ì¹´í…Œê³ ë¦¬ ëª©ë¡ (itemTableDataì—ì„œ ê°€ì ¸ì˜¨ ëª¨ë“  ì•„ì´í…œ ì½”ë“œ)
      const categories = ['DJ', 'DV', 'JP', 'PD', 'SS', 'WJ', 'HD', 'MT', 'OP', 'RL', 'RS', 'TL', 'TR', 'ZT', 'LG', 'PT', 'SK', 'SP', 'TP'];
      const categoryNames = {
        'DJ': 'Down Jumper', 'DV': 'Down Vest', 'JP': 'Jumper', 'PD': 'Padded Jumper', 
        'SS': 'Softshell Jacket', 'WJ': 'Windbreaker', 'HD': 'Hoodie', 'MT': 'Sweatshirt', 
        'OP': 'Dress', 'RL': 'Long-sleeve T-shirt', 'RS': 'Short-sleeve T-shirt', 
        'TL': 'Long-sleeve Collar T-shirt', 'TR': 'Training Top', 'ZT': 'Zip-up T-shirt',
        'LG': 'Leggings', 'PT': 'Pants', 'SK': 'Skirt', 'SP': 'SHORTS', 'TP': 'Training Pants'
      };
      
      // ë¸Œëœë“œë³„ íŒë§¤ìœ¨ ë°ì´í„° ìˆ˜ì§‘
      const heatmapData = {};
      brands.forEach((brandName, idx) => {
        const brandKey = brandKeys[idx];
        const computed = getBrandItemTableData(brandKey);
        const allItems = [...(computed.Outer||[]), ...(computed.Inner||[]), ...(computed.Bottom||[])];
        
        const brandRates = {};
        categories.forEach(cat => {
          const item = allItems.find(i => i.code === cat);
          brandRates[cat] = item ? (item.rateNow || 0) : null;
        });
        heatmapData[brandName] = brandRates;
      });
      
      // ìƒ‰ìƒ ê²°ì • í•¨ìˆ˜
      function getCellClass(value) {
        if(value == null || isNaN(value)) return 'cell-empty';
        if (value >= 20) return 'cell-excellent';
        if (value >= 15) return 'cell-good';
        if (value >= 10) return 'cell-average';
        return 'cell-poor';
      }
      
      // í…Œì´ë¸” ìƒì„± - ë¸Œëœë“œë¥¼ í–‰, ì•„ì´í…œì„ ì—´ë¡œ
      let html = '<thead><tr><th style="background:#2d3748;color:white;padding:12px 8px;font-weight:600;text-align:center;position:sticky;top:0;z-index:10;border-radius:8px 0 0 0;">ë¸Œëœë“œ</th>';
      
      // í—¤ë” ìƒì„± (ì•„ì´í…œ/ì¹´í…Œê³ ë¦¬)
      categories.forEach(cat => {
        html += `<th style="background:#2d3748;color:white;padding:12px 8px;font-weight:600;text-align:center;position:sticky;top:0;z-index:10;">${cat}</th>`;
      });
      html += '<th style="background:#2d3748;color:white;padding:12px 8px;font-weight:600;text-align:center;position:sticky;top:0;z-index:10;border-radius:0 8px 0 0;">í‰ê· </th></tr></thead><tbody>';
      
      // ê° ë¸Œëœë“œë³„ í–‰ ìƒì„±
      brands.forEach(brand => {
        html += `<tr><td style="text-align:left;padding-left:15px;font-weight:700;background:#f7fafc;position:sticky;left:0;z-index:5;border-bottom:1px solid #e2e8f0;">${brand}</td>`;
        const rates = heatmapData[brand];
        
        categories.forEach(cat => {
          const value = rates[cat];
          if(value == null || isNaN(value)){
            html += '<td style="padding:15px 8px;text-align:center;font-weight:600;font-size:14px;border-bottom:1px solid #e2e8f0;background:#f9fafb;">-</td>';
          } else {
            const cellClass = getCellClass(value);
            html += `<td style="padding:15px 8px;text-align:center;font-weight:600;font-size:14px;border-bottom:1px solid #e2e8f0;"><span class="cell ${cellClass}" style="display:inline-block;padding:8px 12px;border-radius:6px;min-width:50px;">${value.toFixed(1)}%</span></td>`;
          }
        });
        
        // ë¸Œëœë“œë³„ í‰ê·  ê³„ì‚°
        const validValues = categories.map(cat => rates[cat]).filter(v => v != null && !isNaN(v));
        const avg = validValues.length > 0 ? validValues.reduce((a, b) => a + b, 0) / validValues.length : 0;
        const avgClass = avg > 0 ? getCellClass(avg) : 'cell-empty';
        if(avg > 0){
          html += `<td style="padding:15px 8px;text-align:center;font-weight:600;font-size:14px;border-bottom:1px solid #e2e8f0;"><span class="cell ${avgClass}" style="display:inline-block;padding:8px 12px;border-radius:6px;min-width:50px;">${avg.toFixed(1)}%</span></td>`;
        } else {
          html += '<td style="padding:15px 8px;text-align:center;font-weight:600;font-size:14px;border-bottom:1px solid #e2e8f0;background:#f9fafb;">-</td>';
        }
        html += '</tr>';
      });
      
      // ì¹´í…Œê³ ë¦¬ë³„ í‰ê·  í–‰
      html += '<tr style="background:#edf2f7;font-weight:700;"><td style="text-align:left;padding-left:15px;background:#edf2f7;position:sticky;left:0;z-index:5;border-top:2px solid #cbd5e0;padding-top:15px;">ì¹´í…Œê³ ë¦¬ í‰ê· </td>';
      categories.forEach((cat, idx) => {
        let sum = 0;
        let count = 0;
        brands.forEach(brand => {
          const value = heatmapData[brand][cat];
          if(value != null && !isNaN(value)){
            sum += value;
            count++;
          }
        });
        const avg = count > 0 ? sum / count : 0;
        if(avg > 0){
          const avgClass = getCellClass(avg);
          html += `<td style="padding:15px 8px;text-align:center;font-weight:700;font-size:14px;border-top:2px solid #cbd5e0;padding-top:15px;"><span class="cell ${avgClass}" style="display:inline-block;padding:8px 12px;border-radius:6px;min-width:50px;">${avg.toFixed(1)}%</span></td>`;
        } else {
          html += '<td style="padding:15px 8px;text-align:center;font-weight:700;font-size:14px;border-top:2px solid #cbd5e0;padding-top:15px;background:#f9fafb;">-</td>';
        }
      });
      
      // ì „ì²´ í‰ê· 
      let totalSum = 0;
      let totalCount = 0;
      brands.forEach(brand => {
        categories.forEach(cat => {
          const value = heatmapData[brand][cat];
          if(value != null && !isNaN(value)){
            totalSum += value;
            totalCount++;
          }
        });
      });
      const totalAvg = totalCount > 0 ? totalSum / totalCount : 0;
      if(totalAvg > 0){
        const totalClass = getCellClass(totalAvg);
        html += `<td style="padding:15px 8px;text-align:center;font-weight:700;font-size:14px;border-top:2px solid #cbd5e0;padding-top:15px;"><span class="cell ${totalClass}" style="display:inline-block;padding:8px 12px;border-radius:6px;min-width:50px;">${totalAvg.toFixed(1)}%</span></td>`;
      } else {
        html += '<td style="padding:15px 8px;text-align:center;font-weight:700;font-size:14px;border-top:2px solid #cbd5e0;padding-top:15px;background:#f9fafb;">-</td>';
      }
      html += '</tr></tbody>';
      
      table.innerHTML = html;
    }

    // -------- ë¸Œëœë“œ ì°¨íŠ¸ --------
    function initBrandCharts(){
      const data = brandData[currentBrand];
      if(!data || !data.channels) return;

      ['treemap','radar','heatmap','weeklyTrend','itemHeatmap'].forEach(n=>{
        if(charts[n]){ 
          if(charts[n].type === 'plotly') {
            Plotly.purge(charts[n].container);
          } else {
            charts[n].destroy();
          }
          delete charts[n]; 
        }
      });

      // íŠ¸ë¦¬ë§µ ì´ˆê¸°í™”
      initTreemap();

      // ë ˆì´ë” ì°¨íŠ¸: ê³„íš(ë‹¬ì„±ë¥ ) vs ì „ë…„ë¹„
      const radarCtx = document.getElementById('radarChart');
      if (radarCtx) {
        const type = window.uiStaticMode ? 'channel' : (window.radarChartType || 'channel');
        const channelRadar = window.uiStaticMode ? getStaticRadarData() : ((type === 'channel') ? getChannelRadarData(currentBrand) : getItemRadarData(currentBrand));
        charts.radar = new Chart(radarCtx.getContext('2d'), {
          type: 'radar',
          data: {
            labels: channelRadar.labels,
            datasets: [
              { label: 'ê³„íš', data: channelRadar.plan, borderColor: '#3B82F6', backgroundColor: 'rgba(59,130,246,0.2)', borderWidth: 2, pointRadius: 2 },
              { label: 'ì „ë…„', data: channelRadar.yoy, borderColor: '#10B981', backgroundColor: 'rgba(16,185,129,0.2)', borderWidth: 2, pointRadius: 2 }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { 
              legend: { display: false }, 
              tooltip: { 
                callbacks: { 
                  label: function(context) { 
                    const label = context.label || '';
                    const value = context.parsed.r || 0;
                    const dsetLabel = context.dataset.label || '';
                    const sales = window.uiStaticMode ? getStaticSales(label) : getSalesForLabel(label, currentBrand);
                    return `${label} (${sales}) - ${dsetLabel} ${value}%`;
                  },
                  title: function() { return ''; }
                },
                displayColors: false
              }
            },
            scales: { r: { suggestedMin: 0, suggestedMax: 120, ticks: { stepSize: 30, backdropColor: 'transparent', font: { size: 9 } } } }
          }
        });
      }

      // íˆíŠ¸ë§µ ì°¨íŠ¸ ë¹„í™œì„±í™” (ê³µë€ ìœ ì§€)
      // initHeatmapChart();
      // ì•„ì´í…œ íˆíŠ¸ë§µ ê·¸ë˜í”„ëŠ” ìˆ¨ê¹€ ì²˜ë¦¬(ì´ˆê¸°í™” ìƒëµ)
      // initItemHeatmapChart();
      // ì•„ì´í…œ íŒë§¤ìœ¨ ì°¨ì´ í…Œì´ë¸” ì´ˆê¸°í™”
      initItemDiffTable();

      // ì£¼ì°¨ ì¶”ì„¸ (ì£¼ì°¨ë³„/ëˆ„ì  í† ê¸€)
      initWeeklyTrendChart();
    }

    // -------- íˆíŠ¸ë§µ ì°¨íŠ¸ ì´ˆê¸°í™” ë° í† ê¸€ --------
    let heatmapType = 'apparel'; // 'apparel' or 'acc'
    
    function initHeatmapChart() {
      updateHeatmapChart();
      
      const apparelBtn = document.getElementById('heatmapBtnApparel');
      const accBtn = document.getElementById('heatmapBtnAcc');
      
      if (apparelBtn && !apparelBtn.hasAttribute('data-listener')) {
        apparelBtn.setAttribute('data-listener', 'true');
        apparelBtn.addEventListener('click', () => {
          heatmapType = 'apparel';
          updateHeatmapButtons();
          updateHeatmapChart();
        });
      }
      
      if (accBtn && !accBtn.hasAttribute('data-listener')) {
        accBtn.setAttribute('data-listener', 'true');
        accBtn.addEventListener('click', () => {
          heatmapType = 'acc';
          updateHeatmapButtons();
          updateHeatmapChart();
        });
      }
    }
    
    function updateHeatmapButtons() {
      const apparelBtn = document.getElementById('heatmapBtnApparel');
      const accBtn = document.getElementById('heatmapBtnAcc');
      
      if (apparelBtn && accBtn) {
        if (heatmapType === 'apparel') {
          apparelBtn.style.background = '#2563eb';
          apparelBtn.style.color = '#fff';
          accBtn.style.background = '#e5e7eb';
          accBtn.style.color = '#374151';
        } else {
          apparelBtn.style.background = '#e5e7eb';
          apparelBtn.style.color = '#374151';
          accBtn.style.background = '#2563eb';
          accBtn.style.color = '#fff';
        }
      }
    }
    
    function updateHeatmapChart() {
      const container = document.getElementById('heatmapChart');
      if (!container) return;
      
      // ê¸°ì¡´ Plotly ì°¨íŠ¸ ì‚­ì œ
      if (container.data) {
        Plotly.purge(container);
      }
      
      let labels, data, title;
      
      if (heatmapType === 'apparel') {
        // ì˜ë¥˜: íŒë§¤ìœ¨ íˆíŠ¸ë§µ
        // ì¹´í…Œê³ ë¦¬ë³„ë¡œ ì—¬ëŸ¬ ê°’ë“¤ì„ 2D íˆíŠ¸ë§µìœ¼ë¡œ í‘œì‹œ
        labels = ['ë‹¤ìš´ì í¼', 'íŠ¸ë ˆì´ë‹(ìƒì˜)', 'íŠ¸ë ˆì´ë‹(í•˜ì˜)', 'ë§¨íˆ¬ë§¨', 'í›„ë“œí‹°', 'í›„ë“œì§‘ì—…'];
        // ê° ì¹´í…Œê³ ë¦¬ì˜ íŒë§¤ìœ¨ (ì˜ˆ: ë§¤ì¶œë¥ , ì¬ê³ íšŒì „ìœ¨ ë“±)
        data = [[85], [92], [78], [88], [75], [82]];
        title = 'íŒë§¤ìœ¨ (%)';
      } else {
        // ACC: ì¬ê³ ì£¼ìˆ˜ íˆíŠ¸ë§µ
        labels = ['ì‹ ë°œ', 'ê°€ë°©', 'ëª¨ì', 'ê¸°íƒ€'];
        // ê° ì¹´í…Œê³ ë¦¬ì˜ ì¬ê³ ì£¼ìˆ˜
        data = [[450], [320], [280], [150]];
        title = 'ì¬ê³ ì£¼ìˆ˜ (ê°œ)';
      }
      
      // Plotly íˆíŠ¸ë§µ ìƒì„±
      const heatmapData = [{
        z: data,
        x: [title],
        y: labels,
        type: 'heatmap',
        colorscale: [[0, '#ef4444'], [0.5, '#fbbf24'], [1, '#22c55e']], // ë¹¨ê°• -> ë…¸ë‘ -> ì´ˆë¡
        showscale: true,
        colorbar: {
          title: title,
          titleside: 'right',
          titlefont: { size: 10 },
          tickfont: { size: 9 }
        }
      }];
      
      const layout = {
        margin: { l: 100, r: 20, t: 20, b: 40 },
        paper_bgcolor: 'rgba(0,0,0,0)',
        plot_bgcolor: 'rgba(0,0,0,0)',
        font: { size: 10 },
        yaxis: { 
          automargin: true,
          tickfont: { size: 9 },
          showgrid: false
        },
        xaxis: { 
          tickfont: { size: 9 },
          showgrid: false
        }
      };
      
      const config = {
        responsive: true,
        displayModeBar: false
      };
      
      Plotly.newPlot(container, heatmapData, layout, config);
      
      // Plotly ì°¨íŠ¸ë¥¼ charts ê°ì²´ì— ì €ì¥
      charts.heatmap = { type: 'plotly', container: container };
    }
    
    // -------- ì•„ì´í…œ íˆíŠ¸ë§µ ì°¨íŠ¸ ì´ˆê¸°í™” ë° í† ê¸€ --------
    let itemHeatmapCategory = 'Outer'; // 'Outer', 'Inner', 'Bottom'
    
    function initItemHeatmapChart() {
      updateItemHeatmapChart();
      
      const outerBtn = document.getElementById('itemHeatmapBtnOuter');
      const innerBtn = document.getElementById('itemHeatmapBtnInner');
      const bottomBtn = document.getElementById('itemHeatmapBtnBottom');
      
      if (outerBtn && !outerBtn.hasAttribute('data-listener')) {
        outerBtn.setAttribute('data-listener', 'true');
        outerBtn.addEventListener('click', () => {
          itemHeatmapCategory = 'Outer';
          updateItemHeatmapButtons();
          updateItemHeatmapChart();
          renderItemDiffTable();
        });
      }
      
      if (innerBtn && !innerBtn.hasAttribute('data-listener')) {
        innerBtn.setAttribute('data-listener', 'true');
        innerBtn.addEventListener('click', () => {
          itemHeatmapCategory = 'Inner';
          updateItemHeatmapButtons();
          updateItemHeatmapChart();
          renderItemDiffTable();
        });
      }
      
      if (bottomBtn && !bottomBtn.hasAttribute('data-listener')) {
        bottomBtn.setAttribute('data-listener', 'true');
        bottomBtn.addEventListener('click', () => {
          itemHeatmapCategory = 'Bottom';
          updateItemHeatmapButtons();
          updateItemHeatmapChart();
          renderItemDiffTable();
        });
      }
    }
    
    function updateItemHeatmapButtons() {
      const outerBtn = document.getElementById('itemHeatmapBtnOuter');
      const innerBtn = document.getElementById('itemHeatmapBtnInner');
      const bottomBtn = document.getElementById('itemHeatmapBtnBottom');
      
      const buttons = [outerBtn, innerBtn, bottomBtn];
      const categories = ['Outer', 'Inner', 'Bottom'];
      
      buttons.forEach((btn, idx) => {
        if (btn) {
          if (itemHeatmapCategory === categories[idx]) {
            btn.style.background = '#2563eb';
            btn.style.color = '#fff';
          } else {
            btn.style.background = '#e5e7eb';
            btn.style.color = '#374151';
          }
        }
      });
      
      // ê°œìš” ì„¹ì…˜: ì£¼ì°¨ë³„/ëˆ„ì  í† ê¸€ UI/ë¡œì§ ë³´ê°• í˜¸ì¶œ
      ensureOverviewToggleUI();
    }
    
    function updateItemHeatmapChart() {
      const container = document.getElementById('itemHeatmapChart');
      if (!container) return;
      
      // ê¸°ì¡´ Plotly ì°¨íŠ¸ ì‚­ì œ
      if (container.data) {
        Plotly.purge(container);
      }
      
      // ì´ë¯¸ì§€ ë°ì´í„° ê¸°ë°˜ íˆíŠ¸ë§µ ë°ì´í„° ìƒì„±
      let items, data;
      
      if (itemHeatmapCategory === 'Outer') {
        // ì œê³µ ë°ì´í„° ë°˜ì˜: DJ, DV, JP, PD, SS, WJ
        items = [
          'DJ\nDown Jumper',
          'DV\nDown Vest',
          'JP\nJumper',
          'PD\nPadded Jumper',
          'SS\nSoftshell Jacket',
          'WJ\nWindbreaker'
        ];
        data = [
          [3151, 104, 5586, 74, 0, 3, 55],
          [237, 120, 465, 76, 0, 6, 79],
          [15, 0, 19, 0, 0, 0, 0],
          [103, 0, 308, 0, 0, 11, 0],
          [478, 165, 1171, 116, 0, 15, 43],
          [302, 95, 2540, 76, 0, 24, 40]
        ];
      } else if (itemHeatmapCategory === 'Inner') {
        // ì œê³µ ë°ì´í„° ë°˜ì˜: HD, MT, OP, RL, RS, TL, TR, ZT
        items = [
          'HD\nHoodie',
          'MT\nSweatshirt',
          'OP\nDress',
          'RL\nLong-sleeve T-shirt',
          'RS\nShort-sleeve T-shirt',
          'TL\nLong-sleeve Collar T-shirt',
          'TR\nTraining Top',
          'ZT\nZip-up T-shirt'
        ];
        data = [
          [123, 93, 484, 64, 0, 10, 55],
          [233, 73, 877, 51, 0, 12, 62],
          [3, 73, 64, 43, 0, 14, 30],
          [133, 209, 756, 161, 0, 20, 67],
          [1, 0, 49, 0, 0, 33, 0],
          [50, 152, 321, 78, 0, 32, 57],
          [362, 78, 2290, 76, 0, 19, 42],
          [35, 3076, 133, 1773, 0, 5, 28]
        ];
      } else { // Bottom
        // ì œê³µ ë°ì´í„° ë°˜ì˜: LG, PT, SK, SP, TP
        items = ['LG\nLeggings', 'PT\nPants', 'SK\nSkirt', 'SP\nSHORTS', 'TP\nTraining Pants'];
        data = [
          [3, 43, 7, 21, 0, 2, 19],
          [180, 96, 745, 70, 0, 11, 42],
          [11, 129, 50, 80, 0, 6, 35],
          [0, 0, 0, 0, 0, 0, 19],
          [315, 94, 1649, 73, 0, 15, 43]
        ];
      }
      
      // íˆíŠ¸ë§µ í•„ë“œëª…
      const fields = [
        'ì£¼ê°„íŒë§¤\n(ë°±ë§Œì›)',
        'ì£¼ê°„íŒë§¤\nYOY (%)',
        'ëˆ„ì íŒë§¤\n(ë°±ë§Œì›)',
        'ëˆ„ì íŒë§¤\nYOY (%)',
        'ì „ë…„ëˆ„ì \níŒë§¤ìœ¨ (%)',
        'ë‹¹ë…„ëˆ„ì \níŒë§¤ìœ¨ (%)',
        'ì „ë…„ë§ˆê°\níŒë§¤ìœ¨ (%)'
      ];
      
      // Plotly íˆíŠ¸ë§µ ìƒì„±
      const heatmapData = [{
        z: data,
        x: fields,
        y: items,
        type: 'heatmap',
        colorscale: [[0, '#dc2626'], [0.3, '#f59e0b'], [0.7, '#eab308'], [1, '#22c55e']], // ë¹¨ê°• -> ì£¼í™© -> ë…¸ë‘ -> ì´ˆë¡
        showscale: true,
        colorbar: {
          title: 'ê°’',
          titleside: 'right',
          titlefont: { size: 10 },
          tickfont: { size: 9 }
        },
        text: data.map(row => row.map(val => `${val}`)),
        texttemplate: '%{text}',
        textfont: { size: 10, color: '#000' }
      }];
      
      const layout = {
        margin: { l: 120, r: 100, t: 30, b: 60 },
        paper_bgcolor: 'rgba(0,0,0,0)',
        plot_bgcolor: 'rgba(0,0,0,0)',
        font: { size: 10 },
        yaxis: { 
          automargin: true,
          tickfont: { size: 9 },
          showgrid: false
        },
        xaxis: { 
          tickfont: { size: 9 },
          showgrid: false,
          tickangle: -15
        }
      };
      
      const config = {
        responsive: true,
        displayModeBar: false
      };
      
      Plotly.newPlot(container, heatmapData, layout, config);
      
      // Plotly ì°¨íŠ¸ë¥¼ charts ê°ì²´ì— ì €ì¥
      charts.itemHeatmap = { type: 'plotly', container: container };
    }

    // -------- ì•„ì´í…œë³„ íŒë§¤ìœ¨ ì°¨ì´ í…Œì´ë¸” ë°ì´í„°/ë Œë”ë§ --------
    // ë¸Œëœë“œë³„ ì•„ì´í…œ íŒë§¤ìœ¨ ë°ì´í„° (ê¸°ë³¸ê°’ìœ¼ë¡œ DISCOVERY ì‚¬ìš©)
    const itemTableData = {
      Outer: [
        { category:'Outer', code:'DJ', name:'Down Jumper', poNow:257887, poYoy:115, weekly:3151, yoyWeekly:104, cum:5586, yoyCum:74, rateNow:3.1, rateLast:55.4, diffText:'â–³1.0%p' },
        { category:'Outer', code:'DV', name:'Down Vest', poNow:9362, poYoy:135, weekly:237, yoyWeekly:120, cum:465, yoyCum:76, rateNow:6.3, rateLast:78.7, diffText:'â–³3.1%p' },
        { category:'Outer', code:'JP', name:'Jumper', poNow:9337, poYoy:15, weekly:15, yoyWeekly:null, cum:19, yoyCum:null, rateNow:0.5, rateLast:null, diffText:'+0.0%p' },
        { category:'Outer', code:'PD', name:'Padded Jumper', poNow:5357, poYoy:null, weekly:103, yoyWeekly:null, cum:308, yoyCum:null, rateNow:11.0, rateLast:null, diffText:'+0.0%p' },
        { category:'Outer', code:'SS', name:'Softshell Jacket', poNow:11113, poYoy:124, weekly:478, yoyWeekly:165, cum:1171, yoyCum:116, rateNow:10.5, rateLast:43.3, diffText:'+2.9%p' },
        { category:'Outer', code:'WJ', name:'Windbreaker', poNow:17536, poYoy:141, weekly:302, yoyWeekly:95, cum:2540, yoyCum:76, rateNow:14.6, rateLast:40.5, diffText:'â–³5.7%p' }
      ],
      Inner: [
        { category:'Inner', code:'HD', name:'Hoodie', poNow:6389, poYoy:158, weekly:123, yoyWeekly:93, cum:484, yoyCum:64, rateNow:10.4, rateLast:54.6, diffText:'â–³9.0%p' },
        { category:'Inner', code:'MT', name:'Sweatshirt', poNow:9432, poYoy:105, weekly:233, yoyWeekly:73, cum:877, yoyCum:51, rateNow:12.0, rateLast:62.0, diffText:'â–³7.7%p' },
        { category:'Inner', code:'OP', name:'Dress', poNow:510, poYoy:82, weekly:3, yoyWeekly:73, cum:64, yoyCum:43, rateNow:13.7, rateLast:29.6, diffText:'â–³12.0%p' },
        { category:'Inner', code:'RL', name:'Long-sleeve T-shirt', poNow:8475, poYoy:667, weekly:133, yoyWeekly:209, cum:756, yoyCum:161, rateNow:20.1, rateLast:67.3, diffText:'â–³23.4%p' },
        { category:'Inner', code:'RS', name:'Short-sleeve T-shirt', poNow:217, poYoy:1108, weekly:1, yoyWeekly:null, cum:49, yoyCum:null, rateNow:33.3, rateLast:null, diffText:'+0.0%p' },
        { category:'Inner', code:'TL', name:'Long-sleeve Collar T-shirt', poNow:1213, poYoy:102, weekly:50, yoyWeekly:152, cum:321, yoyCum:78, rateNow:31.8, rateLast:57.0, diffText:'â–³7.9%p' },
        { category:'Inner', code:'TR', name:'Training Top', poNow:15014, poYoy:101, weekly:362, yoyWeekly:78, cum:2290, yoyCum:76, rateNow:18.8, rateLast:41.7, diffText:'â–³3.1%p' },
        { category:'Inner', code:'ZT', name:'Zip-up T-shirt', poNow:4805, poYoy:7188, weekly:35, yoyWeekly:3076, cum:133, yoyCum:1773, rateNow:4.6, rateLast:27.9, diffText:'â–³8.6%p' }
      ],
      Bottom: [
        { category:'Bottom', code:'LG', name:'Leggings', poNow:515, poYoy:383, weekly:3, yoyWeekly:43, cum:7, yoyCum:21, rateNow:1.8, rateLast:19.1, diffText:'â–³1.0%p' },
        { category:'Bottom', code:'PT', name:'Pants', poNow:13786, poYoy:168, weekly:180, yoyWeekly:96, cum:745, yoyCum:70, rateNow:10.8, rateLast:41.7, diffText:'â–³4.4%p' },
        { category:'Bottom', code:'SK', name:'Skirt', poNow:1696, poYoy:343, weekly:11, yoyWeekly:129, cum:50, yoyCum:80, rateNow:5.6, rateLast:35.0, diffText:'â–³9.7%p' },
        { category:'Bottom', code:'SP', name:'SHORTS', poNow:0, poYoy:0, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0.7, rateLast:18.7, diffText:'+0.0%p' },
        { category:'Bottom', code:'TP', name:'Training Pants', poNow:12975, poYoy:97, weekly:315, yoyWeekly:94, cum:1649, yoyCum:73, rateNow:14.9, rateLast:43.2, diffText:'â–³2.7%p' }
      ]
    };

    // ë¸Œëœë“œë³„ ì•„ì´í…œ íŒë§¤ìœ¨ ë°ì´í„° (M=MLB, I=MLB_KIDS, X=DISCOVERY, V=DUVETICA, ST=SERGIO, W=SUPRA)
    const itemTableDataByBrand = {
      'M': { // MLB
        Outer: [
          { category:'Outer', code:'DJ', name:'ë‹¤ìš´ì í¼', poNow:329698, poYoy:127, weekly:2221, yoyWeekly:187, cum:3835, yoyCum:76, rateNow:8.16, rateLast:11.4, closingRate:65.2, diffText:'â–³3.24%p' },
          { category:'Outer', code:'DK', name:'ì§„ìì¼“', poNow:2481, poYoy:35, weekly:2, yoyWeekly:78, cum:37, yoyCum:138, rateNow:24.8, rateLast:9.1, closingRate:15.6, diffText:'+15.7%p' },
          { category:'Outer', code:'DV', name:'ë‹¤ìš´ë² ìŠ¤íŠ¸', poNow:21109, poYoy:88, weekly:104, yoyWeekly:71, cum:280, yoyCum:53, rateNow:11.38, rateLast:13.3, closingRate:50.59, diffText:'â–³1.92%p' },
          { category:'Outer', code:'FD', name:'í´ë¼í´ë¦¬ìŠ¤ì í¼', poNow:2902, poYoy:54, weekly:35, yoyWeekly:338, cum:102, yoyCum:178, rateNow:20.1, rateLast:5.8, closingRate:23.43, diffText:'+14.3%p' },
          { category:'Outer', code:'JK', name:'ë°©ìˆ˜ìì¼“', poNow:248, poYoy:82, weekly:0, yoyWeekly:null, cum:0, yoyCum:null, rateNow:0, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Outer', code:'JP', name:'ì í¼', poNow:14172, poYoy:84, weekly:152, yoyWeekly:93, cum:828, yoyCum:72, rateNow:29.7, rateLast:25.0, closingRate:41.4, diffText:'+4.7%p' },
          { category:'Outer', code:'KC', name:'ë‹ˆíŠ¸ê°€ë””ê±´', poNow:11491, poYoy:69, weekly:50, yoyWeekly:115, cum:529, yoyCum:62, rateNow:43.2, rateLast:37.2, closingRate:50.6, diffText:'+6.0%p' },
          { category:'Outer', code:'PD', name:'íŒ¨ë”©', poNow:2015, poYoy:197, weekly:135, yoyWeekly:677, cum:377, yoyCum:200, rateNow:18.83, rateLast:23.3, closingRate:45.28, diffText:'â–³4.47%p' },
          { category:'Outer', code:'WJ', name:'ë°©í’ìì¼“', poNow:50198, poYoy:117, weekly:47, yoyWeekly:140, cum:1101, yoyCum:109, rateNow:42.7, rateLast:40.8, closingRate:45.7, diffText:'+1.9%p' }
        ],
        Inner: [
          { category:'Inner', code:'DD', name:'ë°ë‹˜ì›í”¼ìŠ¤', poNow:0, poYoy:0, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:14.3, closingRate:20.2, diffText:'â–³14.3%p' },
          { category:'Inner', code:'DR', name:'ë°ë‹˜ì…”ì¸ ', poNow:9840, poYoy:54, weekly:4, yoyWeekly:49, cum:46, yoyCum:24, rateNow:11.4, rateLast:32.0, closingRate:40.4, diffText:'â–³20.6%p' },
          { category:'Inner', code:'HD', name:'í›„ë“œí‹°', poNow:21826, poYoy:86, weekly:128, yoyWeekly:87, cum:792, yoyCum:61, rateNow:21.7, rateLast:26.3, closingRate:52.33, diffText:'â–³4.6%p' },
          { category:'Inner', code:'KP', name:'ë‹ˆíŠ¸í’€ì˜¤ë²„', poNow:9759, poYoy:120, weekly:42, yoyWeekly:130, cum:336, yoyCum:57, rateNow:24.77, rateLast:40.5, closingRate:56.1, diffText:'â–³15.73%p' },
          { category:'Inner', code:'MT', name:'ë§¨íˆ¬ë§¨', poNow:52568, poYoy:68, weekly:202, yoyWeekly:89, cum:1950, yoyCum:66, rateNow:32.12, rateLast:29.8, closingRate:51.4, diffText:'+2.32%p' },
          { category:'Inner', code:'OP', name:'ì›í”¼ìŠ¤', poNow:271, poYoy:23, weekly:5, yoyWeekly:476, cum:53, yoyCum:80, rateNow:20.9, rateLast:6.5, closingRate:8.12, diffText:'+14.4%p' },
          { category:'Inner', code:'TO', name:'TOP', poNow:184, poYoy:null, weekly:0, yoyWeekly:null, cum:0, yoyCum:null, rateNow:0, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Inner', code:'TR', name:'íŠ¸ë ˆì´ë‹(ìƒì˜)', poNow:16175, poYoy:73, weekly:118, yoyWeekly:110, cum:1158, yoyCum:104, rateNow:48.4, rateLast:25.4, closingRate:43.65, diffText:'+23.0%p' },
          { category:'Inner', code:'TS', name:'ë°˜íŒ”ì¹´ë¼í‹°ì…”ì¸ ', poNow:44005, poYoy:155, weekly:39, yoyWeekly:277, cum:1750, yoyCum:217, rateNow:50.55, rateLast:59.8, closingRate:67.15, diffText:'â–³9.25%p' },
          { category:'Inner', code:'WS', name:'ìš°ë¸ì…”ì¸ ', poNow:2435, poYoy:130, weekly:3, yoyWeekly:89, cum:102, yoyCum:215, rateNow:54.82, rateLast:21.4, closingRate:37.09, diffText:'+33.42%p' }
        ],
        Bottom: [
          { category:'Bottom', code:'DP', name:'ì§„ë°”ì§€', poNow:6927, poYoy:123, weekly:14, yoyWeekly:111, cum:172, yoyCum:71, rateNow:25.05, rateLast:23.7, closingRate:39.29, diffText:'+1.35%p' },
          { category:'Bottom', code:'DS', name:'ì§„ìŠ¤ì»¤íŠ¸', poNow:1437, poYoy:60, weekly:5, yoyWeekly:238, cum:83, yoyCum:68, rateNow:21.73, rateLast:50.0, closingRate:54.1, diffText:'â–³28.27%p' },
          { category:'Bottom', code:'LG', name:'ë ˆê¹…ìŠ¤', poNow:93, poYoy:10, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:13.4, closingRate:25.77, diffText:'â–³13.4%p' },
          { category:'Bottom', code:'PT', name:'íŒ¬ì¸ ', poNow:40896, poYoy:97, weekly:245, yoyWeekly:122, cum:1455, yoyCum:84, rateNow:22.76, rateLast:25.6, closingRate:59.86, diffText:'â–³2.84%p' },
          { category:'Bottom', code:'SK', name:'ìŠ¤ì»¤íŠ¸', poNow:2605, poYoy:75, weekly:8, yoyWeekly:175, cum:140, yoyCum:88, rateNow:33.0, rateLast:30.3, closingRate:39.06, diffText:'+2.7%p' },
          { category:'Bottom', code:'SM', name:'ìš°ë¸ë°˜ë°”ì§€', poNow:1505, poYoy:null, weekly:0, yoyWeekly:null, cum:0, yoyCum:null, rateNow:0, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Bottom', code:'SP', name:'ë°˜ë°”ì§€', poNow:1373, poYoy:115, weekly:0, yoyWeekly:null, cum:0, yoyCum:null, rateNow:0, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Bottom', code:'WP', name:'ìš°ë¸íŒ¬ì¸ ', poNow:37058, poYoy:183, weekly:102, yoyWeekly:246, cum:1133, yoyCum:120, rateNow:29.4, rateLast:35.6, closingRate:49.08, diffText:'â–³6.2%p' }
        ]
      },
      'I': { // MLB KIDS
        Outer: [
          { category:'Outer', code:'DJ', name:'ë‹¤ìš´ì í¼', poNow:31520, poYoy:118.26, weekly:610, yoyWeekly:154.61, cum:1748, yoyCum:103.16, rateNow:9.7, rateLast:11.9, closingRate:52.47, diffText:'â–³2.2%p' },
          { category:'Outer', code:'DK', name:'ì§„ìì¼“', poNow:766, poYoy:72.16, weekly:1, yoyWeekly:null, cum:155, yoyCum:null, rateNow:37.91, rateLast:null, closingRate:37.91, diffText:'+0.0%p' },
          { category:'Outer', code:'DV', name:'ë‹¤ìš´ë² ìŠ¤íŠ¸', poNow:1922, poYoy:86.15, weekly:47, yoyWeekly:155.21, cum:195, yoyCum:100.25, rateNow:21.44, rateLast:21.74, closingRate:46.37, diffText:'â–³0.3%p' },
          { category:'Outer', code:'FD', name:'í´ë¼í´ë¦¬ìŠ¤ì í¼', poNow:250, poYoy:16.83, weekly:9, yoyWeekly:44.26, cum:20, yoyCum:23.74, rateNow:9.54, rateLast:11.22, closingRate:35.28, diffText:'â–³1.68%p' },
          { category:'Outer', code:'JP', name:'ì í¼', poNow:2068, poYoy:39.29, weekly:21, yoyWeekly:43.53, cum:557, yoyCum:63.3, rateNow:34.24, rateLast:24.91, closingRate:28.33, diffText:'+9.33%p' },
          { category:'Outer', code:'KC', name:'ë‹ˆíŠ¸ê°€ë””ê±´', poNow:719, poYoy:58.28, weekly:2, yoyWeekly:54.3, cum:49, yoyCum:34.19, rateNow:13.25, rateLast:20.26, closingRate:23.76, diffText:'â–³7.01%p' },
          { category:'Outer', code:'PD', name:'íŒ¨ë”©', poNow:382, poYoy:null, weekly:24, yoyWeekly:null, cum:61, yoyCum:null, rateNow:15.83, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Outer', code:'WJ', name:'ë°©í’ìì¼“', poNow:2672, poYoy:223.62, weekly:1, yoyWeekly:14.14, cum:126, yoyCum:67.21, rateNow:32.59, rateLast:25.38, closingRate:27.6, diffText:'+7.21%p' }
        ],
        Wear_etc: [
          { category:'Wear_etc', code:'S1', name:'ë°˜íŒ”í‹° & ìŠ¤ì›¨íŠ¸íŒ¬ì¸ ', poNow:1249, poYoy:61.66, weekly:10, yoyWeekly:58.11, cum:370, yoyCum:117.75, rateNow:36.15, rateLast:25.6, closingRate:39.29, diffText:'+10.55%p' },
          { category:'Wear_etc', code:'S2', name:'ë§¨íˆ¬ë§¨ì…‹íŠ¸', poNow:7699, poYoy:95.77, weekly:173, yoyWeekly:152.5, cum:1762, yoyCum:123.81, rateNow:27.04, rateLast:27.0, closingRate:46.65, diffText:'+0.04%p' }
        ],
        Inner: [
          { category:'Inner', code:'HD', name:'í›„ë“œí‹°', poNow:2447, poYoy:85.43, weekly:42, yoyWeekly:144.99, cum:400, yoyCum:123.69, rateNow:33.32, rateLast:28.96, closingRate:43.37, diffText:'+4.36%p' },
          { category:'Inner', code:'KP', name:'ë‹ˆíŠ¸í’€ì˜¤ë²„', poNow:195, poYoy:113.36, weekly:null, yoyWeekly:null, cum:null, yoyCum:null, rateNow:null, rateLast:null, closingRate:37.16, diffText:'+0.0%p' },
          { category:'Inner', code:'MT', name:'ë§¨íˆ¬ë§¨', poNow:6266, poYoy:78.33, weekly:122, yoyWeekly:147.02, cum:858, yoyCum:86.36, rateNow:20.15, rateLast:23.27, closingRate:40.78, diffText:'â–³3.12%p' },
          { category:'Inner', code:'OP', name:'ì›í”¼ìŠ¤', poNow:116, poYoy:25.17, weekly:null, yoyWeekly:null, cum:null, yoyCum:null, rateNow:null, rateLast:null, closingRate:22.26, diffText:'+0.0%p' },
          { category:'Inner', code:'PQ', name:'í´ë¡œ í‹°ì…”ì¸ ', poNow:205, poYoy:101.22, weekly:4, yoyWeekly:1239.24, cum:102, yoyCum:176.72, rateNow:49.65, rateLast:60.16, closingRate:62.15, diffText:'â–³10.51%p' },
          { category:'Inner', code:'TR', name:'íŠ¸ë ˆì´ë‹(ìƒì˜)', poNow:212, poYoy:129.2, weekly:null, yoyWeekly:null, cum:null, yoyCum:null, rateNow:null, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Inner', code:'TS', name:'ë°˜íŒ”ì¹´ë¼í‹°ì…”ì¸ ', poNow:1329, poYoy:157.02, weekly:11, yoyWeekly:361.22, cum:343, yoyCum:241.91, rateNow:53.24, rateLast:30.21, closingRate:33.35, diffText:'+23.03%p' },
          { category:'Inner', code:'WS', name:'ìš°ë¸ì…”ì¸ ', poNow:336, poYoy:50.82, weekly:3, yoyWeekly:1396.35, cum:67, yoyCum:86.65, rateNow:35.35, rateLast:40.66, closingRate:41.57, diffText:'â–³5.31%p' }
        ],
        Bottom: [
          { category:'Bottom', code:'DP', name:'ì§„ë°”ì§€', poNow:1532, poYoy:109.58, weekly:27, yoyWeekly:288.06, cum:217, yoyCum:128.21, rateNow:33.19, rateLast:39.29, closingRate:59.54, diffText:'â–³6.1%p' },
          { category:'Bottom', code:'LG', name:'ë ˆê¹…ìŠ¤', poNow:69, poYoy:22.27, weekly:3, yoyWeekly:58.93, cum:8, yoyCum:36.1, rateNow:11.88, rateLast:8.06, closingRate:27.14, diffText:'+3.82%p' },
          { category:'Bottom', code:'PT', name:'íŒ¬ì¸ ', poNow:2741, poYoy:59.53, weekly:58, yoyWeekly:123.31, cum:377, yoyCum:81.49, rateNow:26.56, rateLast:21.47, closingRate:38.12, diffText:'+5.09%p' },
          { category:'Bottom', code:'SK', name:'ìŠ¤ì»¤íŠ¸', poNow:573, poYoy:43.5, weekly:2, yoyWeekly:109.23, cum:45, yoyCum:40.39, rateNow:18.16, rateLast:14.4, closingRate:16.19, diffText:'+3.76%p' },
          { category:'Bottom', code:'SM', name:'ìš°ë¸ë°˜ë°”ì§€', poNow:110, poYoy:null, weekly:null, yoyWeekly:null, cum:12, yoyCum:null, rateNow:10.94, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Bottom', code:'TP', name:'íŠ¸ë ˆì´ë‹(í•˜ì˜)', poNow:null, poYoy:0, weekly:null, yoyWeekly:null, cum:null, yoyCum:null, rateNow:null, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Bottom', code:'WP', name:'ìš°ë¸íŒ¬ì¸ ', poNow:3630, poYoy:146.93, weekly:53, yoyWeekly:172.09, cum:472, yoyCum:138.62, rateNow:25.32, rateLast:19.33, closingRate:35.12, diffText:'+5.99%p' }
        ]
      },
      'X': { // DISCOVERY
        Outer: [
          { category:'Outer', code:'DJ', name:'ë‹¤ìš´ì í¼', poNow:260908, poYoy:117, weekly:5471, yoyWeekly:145, cum:11317, yoyCum:97, rateNow:5.59, rateLast:4.1, closingRate:55.42, diffText:'+1.49%p' },
          { category:'Outer', code:'DV', name:'ë‹¤ìš´ë² ìŠ¤íŠ¸', poNow:9362, poYoy:135, weekly:295, yoyWeekly:134, cum:782, yoyCum:92, rateNow:9.7, rateLast:9.3, closingRate:78.69, diffText:'+0.4%p' },
          { category:'Outer', code:'JP', name:'ì í¼', poNow:9337, poYoy:null, weekly:15, yoyWeekly:null, cum:19, yoyCum:null, rateNow:0.5, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Outer', code:'PD', name:'íŒ¨ë”©', poNow:5357, poYoy:null, weekly:103, yoyWeekly:null, cum:308, yoyCum:null, rateNow:10.5, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Outer', code:'SS', name:'ì†Œí”„íŠ¸ì‰˜', poNow:11113, poYoy:124, weekly:647, yoyWeekly:195, cum:1894, yoyCum:138, rateNow:22.22, rateLast:11.7, closingRate:43.33, diffText:'+10.52%p' },
          { category:'Outer', code:'WJ', name:'ë°©í’ìì¼“', poNow:17536, poYoy:141, weekly:148, yoyWeekly:54, cum:2915, yoyCum:76, rateNow:25.47, rateLast:29.9, closingRate:40.47, diffText:'â–³4.43%p' }
        ],
        Inner: [
          { category:'Inner', code:'HD', name:'í›„ë“œí‹°', poNow:6389, poYoy:158, weekly:129, yoyWeekly:100, cum:648, yoyCum:72, rateNow:13.0, rateLast:19.4, closingRate:54.58, diffText:'â–³6.4%p' },
          { category:'Inner', code:'MT', name:'ë§¨íˆ¬ë§¨', poNow:9432, poYoy:105, weekly:256, yoyWeekly:70, cum:1179, yoyCum:55, rateNow:15.29, rateLast:19.7, closingRate:61.98, diffText:'â–³4.41%p' },
          { category:'Inner', code:'OP', name:'ì›í”¼ìŠ¤', poNow:510, poYoy:82, weekly:3, yoyWeekly:73, cum:64, yoyCum:43, rateNow:13.7, rateLast:25.7, closingRate:29.6, diffText:'â–³12.0%p' },
          { category:'Inner', code:'RL', name:'ê¸´íŒ”í‹°ì…”ì¸ ', poNow:8475, poYoy:667, weekly:99, yoyWeekly:196, cum:897, yoyCum:165, rateNow:22.57, rateLast:43.4, closingRate:67.29, diffText:'â–³20.83%p' },
          { category:'Inner', code:'RS', name:'ë°˜íŒ”í‹°ì…”ì¸ ', poNow:217, poYoy:1108, weekly:1, yoyWeekly:null, cum:49, yoyCum:null, rateNow:33.3, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Inner', code:'TL', name:'ê¸´íŒ”ì¹´ë¼í‹°ì…”ì¸ ', poNow:1213, poYoy:102, weekly:36, yoyWeekly:102, cum:379, yoyCum:79, rateNow:35.14, rateLast:39.7, closingRate:57.04, diffText:'â–³4.56%p' },
          { category:'Inner', code:'TR', name:'íŠ¸ë ˆì´ë‹(ìƒì˜)', poNow:15014, poYoy:101, weekly:307, yoyWeekly:101, cum:2784, yoyCum:79, rateNow:21.11, rateLast:21.9, closingRate:41.68, diffText:'â–³0.79%p' },
          { category:'Inner', code:'ZT', name:'ì§‘ì—…í‹°', poNow:4805, poYoy:7188, weekly:47, yoyWeekly:6100, cum:187, yoyCum:2183, rateNow:6.19, rateLast:13.2, closingRate:27.9, diffText:'â–³7.01%p' }
        ],
        Bottom: [
          { category:'Bottom', code:'LG', name:'ë ˆê¹…ìŠ¤', poNow:515, poYoy:38, weekly:3, yoyWeekly:43, cum:7, yoyCum:21, rateNow:1.8, rateLast:2.8, closingRate:19.1, diffText:'â–³1.0%p' },
          { category:'Bottom', code:'PT', name:'íŒ¬ì¸ ', poNow:13786, poYoy:168, weekly:205, yoyWeekly:110, cum:991, yoyCum:78, rateNow:13.57, rateLast:15.3, closingRate:41.67, diffText:'â–³1.73%p' },
          { category:'Bottom', code:'SK', name:'ìŠ¤ì»¤íŠ¸', poNow:1696, poYoy:343, weekly:18, yoyWeekly:253, cum:71, yoyCum:100, rateNow:7.56, rateLast:15.3, closingRate:34.67, diffText:'â–³7.74%p' },
          { category:'Bottom', code:'SP', name:'ë°˜ë°”ì§€', poNow:0, poYoy:0, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:2.6, closingRate:18.7, diffText:'â–³2.6%p' },
          { category:'Bottom', code:'TP', name:'íŠ¸ë ˆì´ë‹(í•˜ì˜)', poNow:12975, poYoy:97, weekly:315, yoyWeekly:120, cum:2079, yoyCum:80, rateNow:17.59, rateLast:17.6, closingRate:43.23, diffText:'â–³0.01%p' }
        ],
        Wear_etc: [
          { category:'Wear_etc', code:'AZ', name:'ìƒí•˜ì˜ ì„¸íŠ¸', poNow:1127, poYoy:301, weekly:23, yoyWeekly:253, cum:181, yoyCum:179, rateNow:16.3, rateLast:27.4, closingRate:48.91, diffText:'â–³11.1%p' }
        ]
      },
      'V': { // DUVETICA
        Outer: [
          { category:'Outer', code:'DH', name:'ë°˜íŒ”ë‹¤ìš´', poNow:2154, poYoy:403, weekly:245, yoyWeekly:939, cum:529, yoyCum:286, rateNow:24.57, rateLast:35.1, closingRate:84.0, diffText:'â–³10.53%p' },
          { category:'Outer', code:'DJ', name:'ë‹¤ìš´ì í¼', poNow:21494, poYoy:65, weekly:628, yoyWeekly:434, cum:1754, yoyCum:280, rateNow:9.19, rateLast:4.6, closingRate:51.99, diffText:'+4.59%p' },
          { category:'Outer', code:'DV', name:'ë‹¤ìš´ë² ìŠ¤íŠ¸', poNow:294, poYoy:16, weekly:6, yoyWeekly:79, cum:22, yoyCum:59, rateNow:6.39, rateLast:4.3, closingRate:19.19, diffText:'+2.09%p' },
          { category:'Outer', code:'JK', name:'ë°©ìˆ˜ìì¼“', poNow:158, poYoy:5, weekly:0, yoyWeekly:0, cum:1, yoyCum:5, rateNow:1.0, rateLast:3.3, closingRate:5.7, diffText:'â–³2.3%p' },
          { category:'Outer', code:'KC', name:'ë‹ˆíŠ¸ê°€ë””ê±´', poNow:332, poYoy:null, weekly:1, yoyWeekly:null, cum:18, yoyCum:null, rateNow:6.2, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Outer', code:'PD', name:'íŒ¨ë”©', poNow:0, poYoy:0, weekly:0, yoyWeekly:null, cum:0, yoyCum:null, rateNow:0, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Outer', code:'SS', name:'ì†Œí”„íŠ¸ì‰˜', poNow:0, poYoy:0, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:8.1, closingRate:31.3, diffText:'â–³8.1%p' },
          { category:'Outer', code:'VT', name:'ë² ìŠ¤íŠ¸', poNow:250, poYoy:null, weekly:1, yoyWeekly:null, cum:44, yoyCum:null, rateNow:19.4, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Outer', code:'WJ', name:'ë°©í’ìì¼“', poNow:2776, poYoy:204, weekly:2, yoyWeekly:313, cum:349, yoyCum:127, rateNow:13.17, rateLast:31.5, closingRate:44.31, diffText:'â–³18.33%p' }
        ],
        Inner: [
          { category:'Inner', code:'HD', name:'í›„ë“œí‹°', poNow:542, poYoy:156, weekly:9, yoyWeekly:314, cum:43, yoyCum:297, rateNow:7.74, rateLast:5.2, closingRate:22.09, diffText:'+2.54%p' },
          { category:'Inner', code:'KP', name:'ë‹ˆíŠ¸í’€ì˜¤ë²„', poNow:969, poYoy:276, weekly:10, yoyWeekly:325, cum:71, yoyCum:241, rateNow:7.43, rateLast:8.1, closingRate:30.05, diffText:'â–³0.67%p' },
          { category:'Inner', code:'KV', name:'ë‹ˆíŠ¸ë² ìŠ¤íŠ¸', poNow:98, poYoy:null, weekly:0, yoyWeekly:null, cum:5, yoyCum:null, rateNow:6.0, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Inner', code:'MT', name:'ë§¨íˆ¬ë§¨', poNow:252, poYoy:51, weekly:3, yoyWeekly:249, cum:15, yoyCum:156, rateNow:5.91, rateLast:2.9, closingRate:14.36, diffText:'+3.01%p' },
          { category:'Inner', code:'OP', name:'ì›í”¼ìŠ¤', poNow:63, poYoy:71, weekly:0, yoyWeekly:null, cum:14, yoyCum:27, rateNow:20.95, rateLast:65.4, closingRate:69.18, diffText:'â–³44.45%p' },
          { category:'Inner', code:'RL', name:'ê¸´íŒ”í‹°ì…”ì¸ ', poNow:110, poYoy:null, weekly:1, yoyWeekly:null, cum:7, yoyCum:null, rateNow:6.2, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Inner', code:'RS', name:'ë°˜íŒ”í‹°ì…”ì¸ ', poNow:64, poYoy:10, weekly:0, yoyWeekly:0, cum:14, yoyCum:24, rateNow:24.5, rateLast:13.1, closingRate:15.4, diffText:'+11.4%p' },
          { category:'Inner', code:'TS', name:'ë°˜íŒ”ì¹´ë¼í‹°ì…”ì¸ ', poNow:44, poYoy:null, weekly:0, yoyWeekly:null, cum:0, yoyCum:null, rateNow:0, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Inner', code:'WS', name:'ìš°ë¸ì…”ì¸ ', poNow:78, poYoy:170, weekly:1, yoyWeekly:null, cum:4, yoyCum:1448, rateNow:5.6, rateLast:0.7, closingRate:2.9, diffText:'+4.9%p' },
          { category:'Inner', code:'ZT', name:'ì§‘ì—…í‹°', poNow:73, poYoy:14, weekly:1, yoyWeekly:102, cum:3, yoyCum:78, rateNow:5.6, rateLast:2.1, closingRate:13.6, diffText:'+3.5%p' }
        ],
        Bottom: [
          { category:'Bottom', code:'LG', name:'ë ˆê¹…ìŠ¤', poNow:0, poYoy:0, weekly:0, yoyWeekly:null, cum:0, yoyCum:null, rateNow:0, rateLast:2.5, closingRate:10.2, diffText:'â–³2.5%p' },
          { category:'Bottom', code:'PT', name:'íŒ¬ì¸ ', poNow:1708, poYoy:59, weekly:30, yoyWeekly:497, cum:185, yoyCum:360, rateNow:10.58, rateLast:4.8, closingRate:20.87, diffText:'+5.78%p' },
          { category:'Bottom', code:'SK', name:'ìŠ¤ì»¤íŠ¸', poNow:99, poYoy:null, weekly:0, yoyWeekly:null, cum:24, yoyCum:null, rateNow:23.7, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Bottom', code:'SP', name:'ë°˜ë°”ì§€', poNow:91, poYoy:75, weekly:2, yoyWeekly:367, cum:17, yoyCum:464, rateNow:19.13, rateLast:2.7, closingRate:19.09, diffText:'+16.43%p' }
        ]
      },
      'ST': { // SERGIO
        Outer: [
          { category:'Outer', code:'DJ', name:'ë‹¤ìš´ì í¼', poNow:664, poYoy:13, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:1.5, closingRate:28.4, diffText:'â–³1.5%p' },
          { category:'Outer', code:'DV', name:'ë‹¤ìš´ë² ìŠ¤íŠ¸', poNow:0, poYoy:0, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:5.9, closingRate:48.8, diffText:'â–³5.9%p' },
          { category:'Outer', code:'PD', name:'íŒ¨ë”©', poNow:0, poYoy:0, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:6.5, closingRate:19.6, diffText:'â–³6.5%p' },
          { category:'Outer', code:'SS', name:'ì†Œí”„íŠ¸ì‰˜', poNow:0, poYoy:0, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:15.0, closingRate:31.7, diffText:'â–³15.0%p' },
          { category:'Outer', code:'WJ', name:'ë°©í’ìì¼“', poNow:122, poYoy:5, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:11.9, closingRate:16.4, diffText:'â–³11.9%p' }
        ],
        Inner: [
          { category:'Inner', code:'HD', name:'í›„ë“œí‹°', poNow:116, poYoy:12, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:12.4, closingRate:32.7, diffText:'â–³12.4%p' },
          { category:'Inner', code:'MT', name:'ë§¨íˆ¬ë§¨', poNow:238, poYoy:25, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:12.6, closingRate:35.9, diffText:'â–³12.6%p' },
          { category:'Inner', code:'RL', name:'ê¸´íŒ”í‹°ì…”ì¸ ', poNow:153, poYoy:24, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:21.6, closingRate:37.3, diffText:'â–³21.6%p' },
          { category:'Inner', code:'RS', name:'ë°˜íŒ”í‹°ì…”ì¸ ', poNow:308, poYoy:52, weekly:0, yoyWeekly:null, cum:12, yoyCum:7, rateNow:82.1, rateLast:36.4, closingRate:56.6, diffText:'+45.7%p' }
        ],
        Bottom: [
          { category:'Bottom', code:'DP', name:'ì§„ë°”ì§€', poNow:47, poYoy:null, weekly:0, yoyWeekly:null, cum:0, yoyCum:null, rateNow:0, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Bottom', code:'PT', name:'íŒ¬ì¸ ', poNow:30, poYoy:6, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:6.4, closingRate:31.9, diffText:'â–³6.4%p' },
          { category:'Bottom', code:'SK', name:'ìŠ¤ì»¤íŠ¸', poNow:34, poYoy:51, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:12.9, closingRate:23.2, diffText:'â–³12.9%p' },
          { category:'Bottom', code:'WP', name:'ìš°ë¸íŒ¬ì¸ ', poNow:133, poYoy:11, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:10.1, closingRate:16.4, diffText:'â–³10.1%p' }
        ]
      },
      'W': { // SUPRA
        Outer: [
          { category:'Outer', code:'DJ', name:'ë‹¤ìš´ì í¼', poNow:275, poYoy:15, weekly:5, yoyWeekly:59, cum:19, yoyCum:69, rateNow:6.76, rateLast:1.2, closingRate:15.36, diffText:'+5.56%p' },
          { category:'Outer', code:'DV', name:'ë‹¤ìš´ë² ìŠ¤íŠ¸', poNow:0, poYoy:0, weekly:0, yoyWeekly:0, cum:0, yoyCum:0, rateNow:0, rateLast:4.0, closingRate:15.4, diffText:'â–³4.0%p' },
          { category:'Outer', code:'KC', name:'ë‹ˆíŠ¸ê°€ë””ê±´', poNow:322, poYoy:65, weekly:3, yoyWeekly:48, cum:47, yoyCum:110, rateNow:14.65, rateLast:7.5, closingRate:28.03, diffText:'+7.15%p' },
          { category:'Outer', code:'PD', name:'íŒ¨ë”©', poNow:55, poYoy:24, weekly:1, yoyWeekly:45, cum:4, yoyCum:39, rateNow:7.24, rateLast:3.9, closingRate:20.16, diffText:'+3.34%p' },
          { category:'Outer', code:'WJ', name:'ë°©í’ìì¼“', poNow:543, poYoy:85, weekly:2, yoyWeekly:22, cum:29, yoyCum:31, rateNow:5.23, rateLast:13.7, closingRate:20.44, diffText:'â–³8.47%p' }
        ],
        Inner: [
          { category:'Inner', code:'HD', name:'í›„ë“œí‹°', poNow:59, poYoy:34, weekly:0, yoyWeekly:20, cum:6, yoyCum:27, rateNow:9.34, rateLast:10.1, closingRate:25.01, diffText:'â–³0.76%p' },
          { category:'Inner', code:'KP', name:'ë‹ˆíŠ¸í’€ì˜¤ë²„', poNow:341, poYoy:98, weekly:7, yoyWeekly:254, cum:61, yoyCum:311, rateNow:18.52, rateLast:5.0, closingRate:20.43, diffText:'+13.52%p' },
          { category:'Inner', code:'KU', name:'ë‹ˆíŠ¸ë°˜íŒ”í‹°ì…”ì¸ ', poNow:176, poYoy:null, weekly:0, yoyWeekly:null, cum:18, yoyCum:null, rateNow:11.1, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Inner', code:'KV', name:'ë‹ˆíŠ¸ë² ìŠ¤íŠ¸', poNow:78, poYoy:null, weekly:1, yoyWeekly:null, cum:19, yoyCum:null, rateNow:26.5, rateLast:null, closingRate:null, diffText:'+0.0%p' },
          { category:'Inner', code:'MT', name:'ë§¨íˆ¬ë§¨', poNow:1051, poYoy:70, weekly:15, yoyWeekly:79, cum:117, yoyCum:66, rateNow:11.05, rateLast:10.8, closingRate:28.66, diffText:'+0.25%p' },
          { category:'Inner', code:'OP', name:'ì›í”¼ìŠ¤', poNow:65, poYoy:126, weekly:0, yoyWeekly:0, cum:6, yoyCum:134, rateNow:9.05, rateLast:8.7, closingRate:21.29, diffText:'+0.35%p' },
          { category:'Inner', code:'PQ', name:'í´ë¡œ í‹°ì…”ì¸ ', poNow:1016, poYoy:224, weekly:4, yoyWeekly:96, cum:252, yoyCum:344, rateNow:24.53, rateLast:15.2, closingRate:25.68, diffText:'+9.33%p' },
          { category:'Inner', code:'RL', name:'ê¸´íŒ”í‹°ì…”ì¸ ', poNow:76, poYoy:37, weekly:1, yoyWeekly:63, cum:6, yoyCum:23, rateNow:8.7, rateLast:13.2, closingRate:27.5, diffText:'â–³4.5%p' },
          { category:'Inner', code:'RS', name:'ë°˜íŒ”í‹°ì…”ì¸ ', poNow:76, poYoy:173, weekly:0, yoyWeekly:69, cum:53, yoyCum:366, rateNow:70.18, rateLast:31.3, closingRate:40.12, diffText:'+38.88%p' },
          { category:'Inner', code:'TR', name:'íŠ¸ë ˆì´ë‹(ìƒì˜)', poNow:144, poYoy:20, weekly:4, yoyWeekly:61, cum:20, yoyCum:32, rateNow:14.77, rateLast:8.5, closingRate:21.05, diffText:'+6.27%p' },
          { category:'Inner', code:'WT', name:'ìœˆë“œí‹°ì…”ì¸ ', poNow:45, poYoy:null, weekly:1, yoyWeekly:null, cum:4, yoyCum:null, rateNow:11.6, rateLast:null, closingRate:null, diffText:'+0.0%p' }
        ],
        Bottom: [
          { category:'Bottom', code:'LG', name:'ë ˆê¹…ìŠ¤', poNow:7, poYoy:8, weekly:0, yoyWeekly:29, cum:0, yoyCum:4, rateNow:4.21, rateLast:8.0, closingRate:14.73, diffText:'â–³3.79%p' },
          { category:'Bottom', code:'PT', name:'íŒ¬ì¸ ', poNow:235, poYoy:18, weekly:7, yoyWeekly:68, cum:28, yoyCum:29, rateNow:12.58, rateLast:6.8, closingRate:20.33, diffText:'+5.78%p' },
          { category:'Bottom', code:'SK', name:'ìŠ¤ì»¤íŠ¸', poNow:640, poYoy:78, weekly:10, yoyWeekly:86, cum:261, yoyCum:134, rateNow:42.43, rateLast:22.8, closingRate:44.58, diffText:'+19.63%p' },
          { category:'Bottom', code:'SP', name:'ë°˜ë°”ì§€', poNow:139, poYoy:865, weekly:0, yoyWeekly:26, cum:52, yoyCum:594, rateNow:56.05, rateLast:54.5, closingRate:72.47, diffText:'+1.55%p' }
        ]
      }
    };
    // ë¸Œëœë“œë³„ ì•„ì´í…œ ë°ì´í„° ë°˜í™˜: ë¸Œëœë“œë³„ ì‹¤ì œ ë°ì´í„° ì‚¬ìš©
    function getBrandItemTableData(brand){
      try{
        let brandKey = brand || currentBrand || 'MLB';
        // ë¸Œëœë“œëª…ì„ brandCodeMapì˜ í‚¤ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
        if(brandKey === 'MLB KIDS') brandKey = 'MLB_KIDS';
        // brandCodeMapì—ì„œ ì§ì ‘ ì°¾ê¸° (MLB_KIDS ë˜ëŠ” MLB KIDS ëª¨ë‘ ì§€ì›)
        let brandCode = brandCodeMap[brandKey];
        if(!brandCode && brandKey.includes('_')) {
          brandCode = brandCodeMap[brandKey.replace('_', ' ')];
        }
        if(!brandCode) {
          brandCode = 'M'; // ê¸°ë³¸ê°’
        }
        
        console.log('getBrandItemTableData í˜¸ì¶œ:', {
          brand: brand, 
          brandKey: brandKey, 
          brandCode: brandCode, 
          currentBrand: currentBrand,
          brandCodeMapKeys: Object.keys(brandCodeMap),
          brandCodeMapValue: brandCodeMap[brandKey]
        });
        
        // ë¸Œëœë“œë³„ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©
        if(itemTableDataByBrand && itemTableDataByBrand[brandCode]){
          const brandData = itemTableDataByBrand[brandCode];
          const result = {
            Outer: brandData.Outer || [],
            Inner: brandData.Inner || [],
            Bottom: brandData.Bottom || [],
            Wear_etc: brandData.Wear_etc || []
          };
          console.log('ë¸Œëœë“œë³„ ë°ì´í„° ë°˜í™˜:', {
            brandCode: brandCode,
            outerCount: result.Outer.length,
            firstOuter: result.Outer[0]?.name,
            firstOuterPo: result.Outer[0]?.poNow,
            innerCount: result.Inner.length,
            bottomCount: result.Bottom.length
          });
          return result;
        }
        
        console.warn('ë¸Œëœë“œë³„ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ, ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©:', brandCode);
        
        // í´ë°±: ê¸°ë³¸ ë°ì´í„° ì‚¬ìš© (ê°€ì¤‘ì¹˜ ì ìš©)
        const base = itemTableData;
        const baseTotal = (brandData.MLB?.revenue?.forecast) || 236.9;
        const brandTotal = (brandData[brandKey]?.revenue?.forecast) || baseTotal;
        const k = baseTotal ? (brandTotal / baseTotal) : 1;
        const scaleRow = (r)=>({
          ...r,
          weekly: Math.round((r.weekly||0) * k),
          cum: Math.round((r.cum||0) * k)
        });
        return {
          Outer: (base.Outer||[]).map(scaleRow),
          Inner: (base.Inner||[]).map(scaleRow),
          Bottom: (base.Bottom||[]).map(scaleRow),
          Wear_etc: (base.Wear_etc||[]).map(scaleRow)
        };
      }catch(e){ return JSON.parse(JSON.stringify(itemTableData)); }
    }

    let itemTableCategory = 'ALL';
    let itemTableSort = 'cum'; // íŒë§¤ìœ¨ ëª¨ë“œ ê¸°ë³¸ê°’ (ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œì—ì„œëŠ” updateItemModeButtonsì—ì„œ 'sales'ë¡œ ë³€ê²½ë¨)
    let itemTableAlertOnly = false; // ì£¼ì˜ í•­ëª©ë§Œ ë³´ê¸° í† ê¸€
    let itemTableMode = 'sale'; // 'sale' | 'inventory'

    function initItemDiffTable(){
      // ë²„íŠ¼ ë¦¬ìŠ¤ë„ˆ
      const btnSaleRate = document.getElementById('itemTableBtnSaleRate');
      const btnInventory = document.getElementById('itemTableBtnInventory');
      if(btnSaleRate && !btnSaleRate.hasAttribute('data-listener')){
        btnSaleRate.setAttribute('data-listener','true');
        btnSaleRate.addEventListener('click', ()=>{ itemTableMode='sale'; updateItemModeButtons(); renderItemDiffTable(); });
      }
      if(btnInventory && !btnInventory.hasAttribute('data-listener')){
        btnInventory.setAttribute('data-listener','true');
        btnInventory.addEventListener('click', ()=>{ itemTableMode='inventory'; updateItemModeButtons(); renderItemDiffTable(); });
      }
      const btnAll = document.getElementById('itemTableBtnAll');
      const btnOuter = document.getElementById('itemTableBtnOuter');
      const btnInner = document.getElementById('itemTableBtnInner');
      const btnBottom = document.getElementById('itemTableBtnBottom');
      const btnAlert = document.getElementById('itemTableBtnAlert');
      const sortSel = document.getElementById('itemTableSort');
      if(btnAll && !btnAll.hasAttribute('data-listener')){
        btnAll.setAttribute('data-listener','true');
        btnAll.addEventListener('click', ()=>{ itemTableCategory='ALL'; updateItemTableButtons(); renderItemDiffTable(); });
      }
      if(btnOuter && !btnOuter.hasAttribute('data-listener')){
        btnOuter.setAttribute('data-listener','true');
        btnOuter.addEventListener('click', ()=>{ itemTableCategory='Outer'; updateItemTableButtons(); renderItemDiffTable(); });
      }
      if(btnInner && !btnInner.hasAttribute('data-listener')){
        btnInner.setAttribute('data-listener','true');
        btnInner.addEventListener('click', ()=>{ itemTableCategory='Inner'; updateItemTableButtons(); renderItemDiffTable(); });
      }
      if(btnBottom && !btnBottom.hasAttribute('data-listener')){
        btnBottom.setAttribute('data-listener','true');
        btnBottom.addEventListener('click', ()=>{ itemTableCategory='Bottom'; updateItemTableButtons(); renderItemDiffTable(); });
      }
      if(sortSel && !sortSel.hasAttribute('data-listener')){
        sortSel.setAttribute('data-listener','true');
        sortSel.addEventListener('change', (e)=>{ itemTableSort = e.target.value; renderItemDiffTable(); });
      }
      // í‘œ CSV níŠ¼ì€ ì œê±°ë¨
      if(btnAlert && !btnAlert.hasAttribute('data-listener')){
        btnAlert.setAttribute('data-listener','true');
        btnAlert.addEventListener('click', ()=>{ itemTableAlertOnly = !itemTableAlertOnly; updateItemTableButtons(); renderItemDiffTable(); });
      }
      updateItemTableButtons();
      updateItemModeButtons();
      renderItemDiffTable();
      
      // ë™ì ìœ¼ë¡œ ìƒì„±ëœ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¬ë“±ë¡ì„ ìœ„í•´ ì „ì—­ í´ë¦­ í•¸ë“¤ëŸ¬ ì¶”ê°€
      const categoryFiltersContainer = document.getElementById('itemTableCategoryFilters');
      if(categoryFiltersContainer){
        // ë¶€ëª¨ ìš”ì†Œì— ì´ë²¤íŠ¸ ìœ„ì„ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬
        categoryFiltersContainer.addEventListener('click', function(e){
          if(e.target.tagName === 'BUTTON'){
            const btnId = e.target.id;
            if(btnId === 'itemTableBtnAll'){
              itemTableCategory = 'ALL';
            } else if(btnId === 'itemTableBtnOuter'){
              itemTableCategory = 'Outer';
            } else if(btnId === 'itemTableBtnInner'){
              itemTableCategory = 'Inner';
            } else if(btnId === 'itemTableBtnBottom'){
              itemTableCategory = 'Bottom';
            } else if(btnId === 'itemTableBtnShoes'){
              itemTableCategory = 'Shoes';
            } else if(btnId === 'itemTableBtnHeadwear'){
              itemTableCategory = 'Headwear';
            } else if(btnId === 'itemTableBtnBag'){
              itemTableCategory = 'Bag';
            } else if(btnId === 'itemTableBtnAcc'){
              itemTableCategory = 'Acc_etc';
            }
            updateItemTableButtons();
            renderItemDiffTable();
          }
        });
      }
    }

    function exportCurrentItemTableCSV(){
      // í˜„ì¬ í•„í„°/ì •ë ¬/ì£¼ì˜ ìƒíƒœë¥¼ ë°˜ì˜í•˜ì—¬ CSV ìƒì„±
      const computed = getBrandItemTableData(currentBrand);
      const sourceRows = itemTableCategory==='ALL'
        ? [...(computed.Outer||[]), ...(computed.Inner||[]), ...(computed.Bottom||[])]
        : (computed[itemTableCategory]||[]);
      const rows = sourceRows.map(r=>({ ...r }));
      const getDiffValue = (r)=>{
        if (r.diffText && typeof r.diffText === 'string'){
          const m = r.diffText.match(/[+â–³-]?\s*([0-9]+(?:\.[0-9]+)?)%p/);
          if (m){ const n=parseFloat(m[1]); const neg = r.diffText.trim().startsWith('â–³') || r.diffText.trim().startsWith('-'); return neg? -n : +n; }
        }
        if(r.rateNow!=null && r.rateLast!=null && !isNaN(r.rateNow) && !isNaN(r.rateLast)) return Number(r.rateNow) - Number(r.rateLast);
        return NaN;
      };
      const isAlert = (r)=>{ const d=getDiffValue(r); return !isNaN(d) && d <= -5; };
      const filtered = itemTableAlertOnly ? rows.filter(isAlert) : rows;
      const sorters = {
        category: (a,b)=> (a.category===b.category ? (b.weekly - a.weekly) : (a.category > b.category ? 1 : -1)),
        po:       (a,b)=> ((b.poNow??-1) - (a.poNow??-1)),
        weekly:   (a,b)=> (b.weekly - a.weekly),
        cum:      (a,b)=> (b.cum - a.cum),
        rateNow:  (a,b)=> ((b.rateNow??-1) - (a.rateNow??-1))
      };
      filtered.sort(sorters[itemTableSort] || sorters.category);
      const header = ['ì¹´í…Œê³ ë¦¬','ì•„ì´í…œì½”ë“œ','ì•„ì´í…œëª…','ë°œì£¼ ë‹¹ë…„(ë°±ë§Œ)','ë°œì£¼ ì „ë…„ë¹„','ì£¼ê°„ ë‹¹ë…„(ë°±ë§Œ)','ì£¼ê°„ ì „ë…„ë¹„','ëˆ„ì  ë‹¹ë…„(ë°±ë§Œ)','ëˆ„ì  ì „ë…„ë¹„','íŒë§¤ìœ¨ ë‹¹ë…„(%)','íŒë§¤ìœ¨ ì°¨ì´(p)','íŒë§¤ìœ¨ ì „ë…„ë§ˆê°(%)'];
      const percent = (v)=> (v==null || isNaN(v)) ? '' : Number(v).toFixed(1);
      const toRow = (r)=>[
        r.category, r.code, r.name,
        (r.poNow??''), (r.poYoy??''),
        r.weekly, (r.yoyWeekly??''),
        r.cum, (r.yoyCum??''),
        percent(r.rateNow), (r.diffText||''), percent(r.rateLast)
      ];
      const csv = [header, ...filtered.map(toRow)].map(cols=> cols.map(c=>`"${String(c).replace(/"/g,'""')}"`).join(',')).join('\r\n');
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'item_analysis.csv';
      document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url);
    }

    function updateItemTableButtons(){
      let mapping;
      if(itemTableMode==='inventory'){
        // ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œ
        mapping = [
          ['itemTableBtnAll','ALL'],
          ['itemTableBtnShoes','Shoes'],
          ['itemTableBtnHeadwear','Headwear'],
          ['itemTableBtnBag','Bag'],
          ['itemTableBtnAcc','Acc_etc']
        ];
      } else {
        // íŒë§¤ìœ¨ ëª¨ë“œ
        mapping = [
        ['itemTableBtnAll','ALL'],
        ['itemTableBtnOuter','Outer'],
        ['itemTableBtnInner','Inner'],
        ['itemTableBtnBottom','Bottom']
      ];
      }
      mapping.forEach(([id,cat])=>{
        const el = document.getElementById(id);
        if(!el) return;
        if(itemTableCategory===cat){ el.style.background = '#2563eb'; el.style.color = '#fff'; }
        else { el.style.background = '#e5e7eb'; el.style.color = '#374151'; }
      });
      const btnAlert = document.getElementById('itemTableBtnAlert');
      if(btnAlert){ btnAlert.style.background = itemTableAlertOnly ? '#ffedd5' : '#e5e7eb'; btnAlert.style.color = itemTableAlertOnly ? '#b45309' : '#b45309'; }
    }

    function updateItemModeButtons(){
      const saleBtn = document.getElementById('itemTableBtnSaleRate');
      const invBtn = document.getElementById('itemTableBtnInventory');
      const sortSel = document.getElementById('itemTableSort');
      const categoryFiltersContainer = document.getElementById('itemTableCategoryFilters');
      const titleEl = document.querySelector('.chart-container[style*="grid-column: 1 / -1"] .chart-title');
      
      // ì œëª© ë™ì  ë³€ê²½
      if(titleEl){
        if(itemTableMode==='sale'){
          titleEl.textContent = 'ë‹¹ì‹œì¦Œì˜ë¥˜/ACC íŒë§¤ìœ¨ ë¶„ì„';
        } else {
          titleEl.textContent = 'ë‹¹ì‹œì¦Œì˜ë¥˜/ACCì¬ê³ ì£¼ìˆ˜ ë¶„ì„';
        }
      }
      
      if(saleBtn){
        if(itemTableMode==='sale'){ saleBtn.style.background='#2563eb'; saleBtn.style.color='#fff'; }
        else { saleBtn.style.background='#e5e7eb'; saleBtn.style.color='#374151'; }
      }
      if(invBtn){
        if(itemTableMode==='inventory'){ invBtn.style.background='#2563eb'; invBtn.style.color='#fff'; }
        else { invBtn.style.background='#e5e7eb'; invBtn.style.color='#374151'; }
      }
      
      // ì¹´í…Œê³ ë¦¬ í•„í„° ëª¨ë“œë³„ë¡œ ë³€ê²½
      if(categoryFiltersContainer){
        if(itemTableMode==='inventory'){
          // ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œ: ì „ì²´, ì‹ ë°œ, ëª¨ì, ê°€ë°©, ê¸°íƒ€
          categoryFiltersContainer.innerHTML = `
            <span style="font-size:12px;color:#64748b;">ì¹´í…Œê³ ë¦¬</span>
            <button id="itemTableBtnAll" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">ì „ì²´</button>
            <button id="itemTableBtnShoes" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">ì‹ ë°œ</button>
            <button id="itemTableBtnHeadwear" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">ëª¨ì</button>
            <button id="itemTableBtnBag" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">ê°€ë°©</button>
            <button id="itemTableBtnAcc" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">ê¸°íƒ€</button>
          `;
        } else {
          // íŒë§¤ìœ¨ ëª¨ë“œ: ì „ì²´, Outer, Inner, Bottom
          categoryFiltersContainer.innerHTML = `
            <span style="font-size:12px;color:#64748b;">ì¹´í…Œê³ ë¦¬</span>
            <button id="itemTableBtnAll" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">ì „ì²´</button>
            <button id="itemTableBtnOuter" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">Outer</button>
            <button id="itemTableBtnInner" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">Inner</button>
            <button id="itemTableBtnBottom" style="background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;">Bottom</button>
            <button id="itemTableBtnAlert" title="ì£¼ì˜ í•­ëª©ë§Œ ë³´ê¸°" style="background:#e5e7eb;color:#b45309;border:none;border-radius:6px;padding:6px 12px;font-size:12px;cursor:pointer;font-weight:600;display:inline-flex;align-items:center;gap:6px;">âš ï¸ ì£¼ì˜ë§Œ</button>
          `;
        }
        // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
        updateItemTableButtons();
      }
      
      // ì •ë ¬ ì˜µì…˜ ëª¨ë“œë³„ë¡œ ë³€ê²½
      if(sortSel){
        if(itemTableMode==='inventory'){
          // ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œ: ë§¤ì¶œìˆœ, ì¬ê³ ìˆ˜ëŸ‰ìˆœ, ì¬ê³ ì£¼ìˆ˜ìˆœ
          sortSel.innerHTML = `
            <option value="category">ì¹´í…Œê³ ë¦¬ìˆœ</option>
            <option value="sales">ë§¤ì¶œìˆœ</option>
            <option value="stockQty">ì¬ê³ ìˆ˜ëŸ‰ìˆœ</option>
            <option value="stockWeeks">ì¬ê³ ì£¼ìˆ˜ìˆœ</option>
          `;
          // ê¸°ë³¸ê°’ ì¬ì„¤ì •
          if(['category', 'sales', 'stockQty', 'stockWeeks'].indexOf(itemTableSort) === -1){
            itemTableSort = 'sales';
          }
        } else {
          // íŒë§¤ìœ¨ ëª¨ë“œ: ê¸°ì¡´ ì •ë ¬
          sortSel.innerHTML = `
            <option value="category">ì¹´í…Œê³ ë¦¬ìˆœ</option>
            <option value="po">ë°œì£¼ê¸ˆì•¡ìˆœ</option>
            <option value="weekly">ì£¼ê°„íŒë§¤ìˆœ</option>
            <option value="cum">ëˆ„ì íŒë§¤ìˆœ</option>
            <option value="rateNow">íŒë§¤ìœ¨ìˆœ</option>
          `;
          // ê¸°ë³¸ê°’ ì¬ì„¤ì •
          if(['category', 'po', 'weekly', 'cum', 'rateNow'].indexOf(itemTableSort) === -1){
            itemTableSort = 'cum';
          }
        }
        sortSel.value = itemTableSort;
      }
    }

    // ë¸Œëœë“œ ì½”ë“œ ë§¤í•‘: MLB=M, MLB_KIDS=I, DISCOVERY=X, DUVETICA=V, SERGIO=ST, SUPRA=W
    const brandCodeMap = {
      'MLB': 'M',
      'MLB KIDS': 'I',
      'MLB_KIDS': 'I',
      'DISCOVERY': 'X',
      'DUVETICA': 'V',
      'SERGIO': 'ST',
      'SUPRA': 'W'
    };

    // ë¸Œëœë“œë³„ ì¬ê³ ì£¼ìˆ˜ ë°ì´í„°
    const inventoryTableDataByBrand = {
      'I': [
        { category:'Shoes', item:'WB', name:'ë°©í•œí™”', sales:104, yoy:244, weight:22, qty:1329, avg4w:784, stockQty:35233, stockWeeks:44.9, diff:-30.6 },
        { category:'Headwear', item:'CP', name:'ìš´ë™ëª¨', sales:68, yoy:127, weight:15, qty:1830, avg4w:2399, stockQty:117935, stockWeeks:49.2, diff:14.8 },
        { category:'Shoes', item:'SH', name:'ì‹ ë°œ', sales:60, yoy:121, weight:13, qty:657, avg4w:851, stockQty:45723, stockWeeks:53.7, diff:6.1 },
        { category:'Headwear', item:'BN', name:'ë¹„ë‹ˆ', sales:50, yoy:124, weight:11, qty:1276, avg4w:946, stockQty:32254, stockWeeks:34.1, diff:6.5 },
        { category:'Shoes', item:'RN', name:'ëŸ°ë‹í™”', sales:40, yoy:143, weight:9, qty:408, avg4w:528, stockQty:29757, stockWeeks:56.4, diff:21.8 },
        { category:'Bag', item:'CR', name:'í¬ë¡œìŠ¤ë°±', sales:39, yoy:47, weight:8, qty:489, avg4w:1052, stockQty:52299, stockWeeks:49.7, diff:-15.4 },
        { category:'Headwear', item:'WM', name:'ë°©í•œëª¨', sales:38, yoy:150, weight:8, qty:624, avg4w:360, stockQty:17788, stockWeeks:49.4, diff:-12.4 },
        { category:'Bag', item:'BK', name:'ë°±íŒ©', sales:26, yoy:67, weight:6, qty:249, avg4w:237, stockQty:59830, stockWeeks:252.4, diff:-146.3 },
        { category:'Shoes', item:'SX', name:'ìŠ¤ë‹ˆì»¤ì¦ˆ', sales:18, yoy:47, weight:4, qty:222, avg4w:256, stockQty:22504, stockWeeks:87.9, diff:29.7 },
        { category:'Acc_etc', item:'ET', name:'ê¸°íƒ€', sales:8, yoy:553, weight:2, qty:101, avg4w:58, stockQty:9667, stockWeeks:166.7, diff:-271 },
        { category:'Acc_etc', item:'SO', name:'ì–‘ë§', sales:3, yoy:61, weight:1, qty:249, avg4w:328, stockQty:60354, stockWeeks:184, diff:-4 },
        { category:'Acc_etc', item:'MF', name:'ë¨¸í”ŒëŸ¬(ìŠ¤ì¹´í”„)', sales:3, yoy:76, weight:1, qty:48, avg4w:35, stockQty:2423, stockWeeks:69.2, diff:39.9 },
        { category:'Acc_etc', item:'GL', name:'ì¥ê°‘', sales:2, yoy:111, weight:0, qty:39, avg4w:19, stockQty:8590, stockWeeks:452.1, diff:189.5 },
        { category:'Headwear', item:'HT', name:'í–‡', sales:2, yoy:127, weight:0, qty:30, avg4w:41, stockQty:15248, stockWeeks:371.9, diff:-339.3 },
        { category:'Headwear', item:'WR', name:'ì™€ì´ì–´ìº¡', sales:1, yoy:86, weight:0, qty:27, avg4w:41, stockQty:1509, stockWeeks:36.8, diff:-21.6 },
        { category:'Bag', item:'UB', name:'ë³´ì¡°ê°€ë°©', sales:null, yoy:250, weight:0, qty:8, avg4w:6, stockQty:7228, stockWeeks:1204.7, diff:-407.6 },
        { category:'Shoes', item:'SD', name:'ìƒŒë“¤', sales:null, yoy:null, weight:0, qty:4, avg4w:3, stockQty:24218, stockWeeks:8072.7, diff:null },
        { category:'Shoes', item:'MU', name:'ë®¬', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:-2, stockWeeks:null, diff:null },
        { category:'Bag', item:'BM', name:'ë²„í‚·ë°±', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:1, stockWeeks:null, diff:null },
        { category:'Acc_etc', item:'ML', name:'í† ì‹œ', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:884, stockWeeks:null, diff:null },
        { category:'Acc_etc', item:'GG', name:'ê³ ê¸€', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:79, stockWeeks:null, diff:null },
        { category:'Bag', item:'BG', name:'ê°€ë°©', sales:null, yoy:null, weight:0, qty:null, avg4w:2, stockQty:1770, stockWeeks:885, diff:708.8 },
        { category:'Acc_etc', item:'PE', name:'PET', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:16756, stockWeeks:null, diff:null },
        { category:'Bag', item:'HS', name:'í™ìƒ‰', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:2399, stockWeeks:null, diff:null },
        { category:'Shoes', item:'CV', name:'ìº”ë²„ìŠ¤í™”', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:-8, stockWeeks:null, diff:null },
        { category:'Shoes', item:'LP', name:'ìŠ¬ë¦¬í¼', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:645, stockWeeks:null, diff:null },
        { category:'Bag', item:'SG', name:'ìŠ¬ë§ë°±', sales:null, yoy:null, weight:0, qty:null, avg4w:2, stockQty:4174, stockWeeks:2087, diff:1940 },
        { category:'Headwear', item:'SC', name:'ì„ ìº¡', sales:null, yoy:-55, weight:0, qty:-1, avg4w:2, stockQty:8095, stockWeeks:4047.5, diff:1919.5 }
      ],
      'M': [
        { category:'Headwear', item:'CP', name:'ìš´ë™ëª¨', sales:3197, yoy:224, weight:55, qty:90222, avg4w:84157, stockQty:1288773, stockWeeks:15.3, diff:-0.7 },
        { category:'Shoes', item:'SX', name:'ìŠ¤ë‹ˆì»¤ì¦ˆ', sales:749, yoy:99, weight:13, qty:5476, avg4w:5293, stockQty:249557, stockWeeks:47.1, diff:1.6 },
        { category:'Headwear', item:'BN', name:'ë¹„ë‹ˆ', sales:669, yoy:381, weight:11, qty:16065, avg4w:11281, stockQty:119641, stockWeeks:10.6, diff:-16.1 },
        { category:'Shoes', item:'SH', name:'ì‹ ë°œ', sales:338, yoy:86, weight:6, qty:3088, avg4w:4237, stockQty:305413, stockWeeks:72.1, diff:1.2 },
        { category:'Bag', item:'BQ', name:'ìˆ„ë”ë°±', sales:330, yoy:159, weight:6, qty:2675, avg4w:1604, stockQty:91164, stockWeeks:56.8, diff:8.7 },
        { category:'Bag', item:'OR', name:'ì‡¼í¼ë°±', sales:144, yoy:133, weight:2, qty:963, avg4w:829, stockQty:14094, stockWeeks:17, diff:-17.7 },
        { category:'Shoes', item:'RN', name:'ëŸ°ë‹í™”', sales:134, yoy:133, weight:2, qty:991, avg4w:1054, stockQty:112857, stockWeeks:107.1, diff:62.7 },
        { category:'Shoes', item:'WB', name:'ë°©í•œí™”', sales:74, yoy:169, weight:1, qty:733, avg4w:338, stockQty:35985, stockWeeks:106.5, diff:-13.6 },
        { category:'Headwear', item:'HT', name:'í–‡', sales:68, yoy:82, weight:1, qty:1103, avg4w:955, stockQty:46883, stockWeeks:49.1, diff:-15.6 },
        { category:'Headwear', item:'WM', name:'ë°©í•œëª¨', sales:39, yoy:454, weight:1, qty:531, avg4w:260, stockQty:13598, stockWeeks:52.3, diff:-136.7 },
        { category:'Bag', item:'CR', name:'í¬ë¡œìŠ¤ë°±', sales:30, yoy:81, weight:1, qty:282, avg4w:334, stockQty:38800, stockWeeks:116.2, diff:43.2 },
        { category:'Bag', item:'BM', name:'ë²„í‚·ë°±', sales:28, yoy:127, weight:0, qty:226, avg4w:267, stockQty:21226, stockWeeks:79.5, diff:-0.9 },
        { category:'Bag', item:'HS', name:'í™ìƒ‰', sales:17, yoy:68, weight:0, qty:244, avg4w:227, stockQty:15066, stockWeeks:66.4, diff:36.3 },
        { category:'Acc_etc', item:'SO', name:'ì–‘ë§', sales:13, yoy:124, weight:0, qty:800, avg4w:786, stockQty:47387, stockWeeks:60.3, diff:-61.1 },
        { category:'Acc_etc', item:'MF', name:'ë¨¸í”ŒëŸ¬(ìŠ¤ì¹´í”„)', sales:10, yoy:46, weight:0, qty:127, avg4w:59, stockQty:8191, stockWeeks:138.8, diff:74.9 },
        { category:'Bag', item:'BK', name:'ë°±íŒ©', sales:9, yoy:90, weight:0, qty:61, avg4w:85, stockQty:16306, stockWeeks:191.8, diff:77 },
        { category:'Acc_etc', item:'PO', name:'íŒŒìš°ì¹˜', sales:3, yoy:70, weight:0, qty:123, avg4w:120, stockQty:3218, stockWeeks:26.8, diff:-30.8 },
        { category:'Shoes', item:'MU', name:'ë®¬', sales:3, yoy:18, weight:0, qty:60, avg4w:125, stockQty:48267, stockWeeks:386.1, diff:145.6 },
        { category:'Bag', item:'BG', name:'ê°€ë°©', sales:1, yoy:50, weight:0, qty:11, avg4w:36, stockQty:13788, stockWeeks:383, diff:-229.6 },
        { category:'Shoes', item:'LP', name:'ìŠ¬ë¦¬í¼', sales:1, yoy:100, weight:0, qty:25, avg4w:52, stockQty:48762, stockWeeks:937.7, diff:96.5 },
        { category:'Acc_etc', item:'ET', name:'ê¸°íƒ€', sales:1, yoy:59, weight:0, qty:60, avg4w:56, stockQty:3477, stockWeeks:62.1, diff:-179.4 },
        { category:'Acc_etc', item:'HH', name:'ìºë¦¬ì–´(í•˜ë“œì¼€ì´ìŠ¤)', sales:1, yoy:173, weight:0, qty:4, avg4w:3, stockQty:875, stockWeeks:291.7, diff:245.2 },
        { category:'Headwear', item:'MC', name:'ë©”ì‹œìº¡', sales:1, yoy:1413, weight:0, qty:14, avg4w:40, stockQty:6342, stockWeeks:158.6, diff:null },
        { category:'Shoes', item:'SD', name:'ìƒŒë“¤', sales:1, yoy:84, weight:0, qty:11, avg4w:16, stockQty:55405, stockWeeks:3462.8, diff:2586 },
        { category:'Acc_etc', item:'GL', name:'ì¥ê°‘', sales:null, yoy:null, weight:0, qty:10, avg4w:6, stockQty:1965, stockWeeks:327.5, diff:null },
        { category:'Headwear', item:'SC', name:'ì„ ìº¡', sales:null, yoy:null, weight:0, qty:11, avg4w:8, stockQty:2306, stockWeeks:288.3, diff:-5193.8 },
        { category:'Shoes', item:'SQ', name:'ì•„ì¿ ì•„ ìŠˆì¦ˆ', sales:null, yoy:null, weight:0, qty:2, avg4w:6, stockQty:9232, stockWeeks:1538.7, diff:-402.3 },
        { category:'Acc_etc', item:'MK', name:'ë§ˆìŠ¤í¬(íŒ¨ì…˜ìš©)', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:8, stockWeeks:null, diff:null },
        { category:'Acc_etc', item:'TW', name:'íƒ€ì˜¬', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:1, stockWeeks:null, diff:null },
        { category:'Headwear', item:'CB', name:'ì—¬ì„± ë² ë ˆëª¨', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:138, stockWeeks:null, diff:null },
        { category:'Acc_etc', item:'ML', name:'í† ì‹œ', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:897, stockWeeks:null, diff:null },
        { category:'Shoes', item:'CV', name:'ìº”ë²„ìŠ¤í™”', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:12, stockWeeks:null, diff:null },
        { category:'Bag', item:'BW', name:'ë³´ìŠ¤í†¤ë°±', sales:null, yoy:-19, weight:0, qty:-1, avg4w:2, stockQty:2150, stockWeeks:1075, diff:87.8 }
      ],
      'ST': [
        { category:'Shoes', item:'SH', name:'ì‹ ë°œ', sales:7, yoy:120, weight:33, qty:72, avg4w:248, stockQty:10518, stockWeeks:42.4, diff:-300.5 },
        { category:'Acc_etc', item:'SO', name:'ì–‘ë§', sales:4, yoy:99, weight:17, qty:175, avg4w:156, stockQty:10943, stockWeeks:70.1, diff:32 },
        { category:'Headwear', item:'CP', name:'ìš´ë™ëª¨', sales:3, yoy:174, weight:14, qty:56, avg4w:77, stockQty:3941, stockWeeks:51.2, diff:10.7 },
        { category:'Bag', item:'BW', name:'ë³´ìŠ¤í†¤ë°±', sales:2, yoy:61, weight:7, qty:9, avg4w:21, stockQty:658, stockWeeks:31.3, diff:-57.9 },
        { category:'Bag', item:'TG', name:'í† ë“œë°±', sales:1, yoy:102, weight:7, qty:13, avg4w:13, stockQty:1628, stockWeeks:125.2, diff:-105.4 },
        { category:'Bag', item:'RB', name:'ë¼ì¼“ë°±', sales:1, yoy:96, weight:5, qty:7, avg4w:7, stockQty:986, stockWeeks:140.9, diff:29.7 },
        { category:'Headwear', item:'SC', name:'ì„ ìº¡', sales:1, yoy:41, weight:5, qty:19, avg4w:32, stockQty:2948, stockWeeks:92.1, diff:19.1 },
        { category:'Bag', item:'BK', name:'ë°±íŒ©', sales:1, yoy:43, weight:4, qty:8, avg4w:31, stockQty:1589, stockWeeks:51.3, diff:-60.8 },
        { category:'Bag', item:'CR', name:'í¬ë¡œìŠ¤ë°±', sales:null, yoy:null, weight:2, qty:6, avg4w:5, stockQty:699, stockWeeks:139.8, diff:-114.5 },
        { category:'Acc_etc', item:'PR', name:'ë³´í˜¸ëŒ€', sales:null, yoy:24, weight:1, qty:12, avg4w:15, stockQty:2173, stockWeeks:144.9, diff:40.6 },
        { category:'Shoes', item:'LP', name:'ìŠ¬ë¦¬í¼', sales:null, yoy:null, weight:1, qty:3, avg4w:3, stockQty:594, stockWeeks:198, diff:null },
        { category:'Acc_etc', item:'AM', name:'ë¨¸í”ŒëŸ¬', sales:null, yoy:233, weight:1, qty:2, avg4w:1, stockQty:413, stockWeeks:413, diff:135 },
        { category:'Acc_etc', item:'HB', name:'í—¤ë“œë°´ë“œ', sales:null, yoy:152, weight:1, qty:5, avg4w:12, stockQty:869, stockWeeks:72.4, diff:-13.8 },
        { category:'Headwear', item:'BN', name:'ë¹„ë‹ˆ', sales:null, yoy:276, weight:1, qty:2, avg4w:2, stockQty:689, stockWeeks:344.5, diff:144 },
        { category:'Acc_etc', item:'AC', name:'ê¸°íƒ€ì†Œí’ˆë¥˜', sales:null, yoy:40, weight:0, qty:1, avg4w:1, stockQty:1311, stockWeeks:1311, diff:927 },
        { category:'Headwear', item:'HT', name:'í–‡', sales:null, yoy:null, weight:0, qty:null, avg4w:7, stockQty:855, stockWeeks:122.1, diff:-718.5 },
        { category:'Acc_etc', item:'TW', name:'íƒ€ì˜¬', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:8, stockWeeks:null, diff:null },
        { category:'Acc_etc', item:'LL', name:'ë³¼', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:34, stockWeeks:null, diff:null },
        { category:'Acc_etc', item:'RK', name:'ë¼ì¼“', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:513, stockWeeks:null, diff:null }
      ],
      'V': [
        { category:'Shoes', item:'WB', name:'ë°©í•œí™”', sales:18, yoy:172, weight:33, qty:86, avg4w:53, stockQty:5029, stockWeeks:94.9, diff:-11 },
        { category:'Bag', item:'TG', name:'í† ë“œë°±', sales:9, yoy:390, weight:17, qty:30, avg4w:30, stockQty:2061, stockWeeks:68.7, diff:-10.6 },
        { category:'Headwear', item:'HT', name:'í–‡', sales:4, yoy:253, weight:8, qty:32, avg4w:33, stockQty:1598, stockWeeks:48.4, diff:-91.1 },
        { category:'Bag', item:'BK', name:'ë°±íŒ©', sales:3, yoy:286, weight:6, qty:10, avg4w:11, stockQty:528, stockWeeks:48, diff:-27.4 },
        { category:'Shoes', item:'SH', name:'ì‹ ë°œ', sales:3, yoy:49, weight:6, qty:24, avg4w:29, stockQty:1141, stockWeeks:39.3, diff:-194.4 },
        { category:'Acc_etc', item:'MF', name:'ë¨¸í”ŒëŸ¬(ìŠ¤ì¹´í”„)', sales:3, yoy:null, weight:5, qty:10, avg4w:4, stockQty:779, stockWeeks:194.8, diff:null },
        { category:'Headwear', item:'CP', name:'ìš´ë™ëª¨', sales:2, yoy:298, weight:4, qty:23, avg4w:20, stockQty:816, stockWeeks:40.8, diff:-125 },
        { category:'Bag', item:'CR', name:'í¬ë¡œìŠ¤ë°±', sales:2, yoy:124, weight:4, qty:10, avg4w:13, stockQty:1261, stockWeeks:97, diff:-81.7 },
        { category:'Headwear', item:'BN', name:'ë¹„ë‹ˆ', sales:2, yoy:167, weight:3, qty:20, avg4w:17, stockQty:1112, stockWeeks:65.4, diff:-59.8 },
        { category:'Bag', item:'BG', name:'ê°€ë°©', sales:2, yoy:null, weight:3, qty:5, avg4w:2, stockQty:480, stockWeeks:240, diff:null },
        { category:'Acc_etc', item:'ML', name:'í† ì‹œ', sales:1, yoy:null, weight:2, qty:8, avg4w:6, stockQty:293, stockWeeks:48.8, diff:null },
        { category:'Acc_etc', item:'DC', name:'ë‹¤ìš´ ìŠ¤ì¹´í”„', sales:1, yoy:null, weight:2, qty:5, avg4w:4, stockQty:463, stockWeeks:115.8, diff:-60.3 },
        { category:'Headwear', item:'WM', name:'ë°©í•œëª¨', sales:1, yoy:null, weight:2, qty:6, avg4w:3, stockQty:215, stockWeeks:71.7, diff:null },
        { category:'Acc_etc', item:'AG', name:'ì¥ê°‘', sales:1, yoy:256, weight:1, qty:6, avg4w:4, stockQty:493, stockWeeks:123.3, diff:-55.3 },
        { category:'Acc_etc', item:'SO', name:'ì–‘ë§', sales:1, yoy:106, weight:1, qty:29, avg4w:38, stockQty:1351, stockWeeks:35.6, diff:-165.9 },
        { category:'Bag', item:'TA', name:'ë²¨íŠ¸ë°±', sales:null, yoy:126, weight:1, qty:2, avg4w:2, stockQty:37, stockWeeks:18.5, diff:-102.5 },
        { category:'Shoes', item:'MU', name:'ë®¬', sales:null, yoy:null, weight:1, qty:4, avg4w:5, stockQty:121, stockWeeks:24.2, diff:-403.8 },
        { category:'Bag', item:'HS', name:'í™ìƒ‰', sales:null, yoy:null, weight:0, qty:1, avg4w:3, stockQty:130, stockWeeks:43.3, diff:null },
        { category:'Headwear', item:'SC', name:'ì„ ìº¡', sales:null, yoy:115, weight:0, qty:3, avg4w:5, stockQty:215, stockWeeks:43, diff:-153 },
        { category:'Shoes', item:'LP', name:'ìŠ¬ë¦¬í¼', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:405, stockWeeks:null, diff:null },
        { category:'Acc_etc', item:'GL', name:'ì¥ê°‘', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:21, stockWeeks:null, diff:null },
        { category:'Bag', item:'EB', name:'ê¸°íƒ€ê°€ë°©', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:16, stockWeeks:null, diff:null },
        { category:'Acc_etc', item:'PO', name:'íŒŒìš°ì¹˜', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:10, stockWeeks:null, diff:null }
      ],
      'W': [
        { category:'Shoes', item:'SH', name:'ì‹ ë°œ', sales:3, yoy:21, weight:41, qty:51, avg4w:54, stockQty:3238, stockWeeks:60, diff:-74.4 },
        { category:'Headwear', item:'CP', name:'ìš´ë™ëª¨', sales:1, yoy:36, weight:23, qty:97, avg4w:112, stockQty:4821, stockWeeks:43, diff:-156.4 },
        { category:'Bag', item:'BW', name:'ë³´ìŠ¤í†¤ë°±', sales:null, yoy:null, weight:7, qty:11, avg4w:8, stockQty:308, stockWeeks:38.5, diff:null },
        { category:'Shoes', item:'WB', name:'ë°©í•œí™”', sales:null, yoy:null, weight:6, qty:14, avg4w:14, stockQty:245, stockWeeks:17.5, diff:null },
        { category:'Bag', item:'BG', name:'ê°€ë°©', sales:null, yoy:35, weight:6, qty:17, avg4w:35, stockQty:2025, stockWeeks:57.9, diff:-781.7 },
        { category:'Bag', item:'BK', name:'ë°±íŒ©', sales:null, yoy:24, weight:4, qty:5, avg4w:7, stockQty:1414, stockWeeks:202, diff:-84 },
        { category:'Bag', item:'CR', name:'í¬ë¡œìŠ¤ë°±', sales:null, yoy:46, weight:4, qty:6, avg4w:4, stockQty:662, stockWeeks:165.5, diff:114.7 },
        { category:'Headwear', item:'HT', name:'í–‡', sales:null, yoy:113, weight:3, qty:9, avg4w:10, stockQty:2176, stockWeeks:217.6, diff:-741.4 },
        { category:'Shoes', item:'LP', name:'ìŠ¬ë¦¬í¼', sales:null, yoy:60, weight:3, qty:6, avg4w:4, stockQty:608, stockWeeks:152, diff:-76.3 },
        { category:'Headwear', item:'BN', name:'ë¹„ë‹ˆ', sales:null, yoy:5, weight:2, qty:8, avg4w:7, stockQty:296, stockWeeks:42.3, diff:15.1 },
        { category:'Acc_etc', item:'SO', name:'ì–‘ë§', sales:null, yoy:null, weight:1, qty:6, avg4w:5, stockQty:95, stockWeeks:19, diff:-48.4 },
        { category:'Headwear', item:'SC', name:'ì„ ìº¡', sales:null, yoy:null, weight:1, qty:2, avg4w:2, stockQty:169, stockWeeks:84.5, diff:null },
        { category:'Headwear', item:'WM', name:'ë°©í•œëª¨', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:83, stockWeeks:null, diff:null },
        { category:'Bag', item:'TG', name:'í† ë“œë°±', sales:null, yoy:null, weight:0, qty:null, avg4w:1, stockQty:155, stockWeeks:155, diff:null },
        { category:'Bag', item:'HS', name:'í™ìƒ‰', sales:null, yoy:-20, weight:0, qty:-1, avg4w:1, stockQty:305, stockWeeks:305, diff:249.7 }
      ],
      'X': [
        { category:'Shoes', item:'SH', name:'ì‹ ë°œ', sales:701, yoy:86, weight:61, qty:7288, avg4w:7034, stockQty:373703, stockWeeks:53.1, diff:-10.5 },
        { category:'Bag', item:'BK', name:'ë°±íŒ©', sales:129, yoy:114, weight:11, qty:974, avg4w:1053, stockQty:127084, stockWeeks:120.7, diff:28.4 },
        { category:'Acc_etc', item:'DC', name:'ë‹¤ìš´ ìŠ¤ì¹´í”„', sales:66, yoy:159, weight:6, qty:1584, avg4w:609, stockQty:73672, stockWeeks:121, diff:66.4 },
        { category:'Headwear', item:'CP', name:'ìš´ë™ëª¨', sales:51, yoy:128, weight:4, qty:1276, avg4w:1222, stockQty:86466, stockWeeks:70.8, diff:14 },
        { category:'Bag', item:'CR', name:'í¬ë¡œìŠ¤ë°±', sales:42, yoy:94, weight:4, qty:608, avg4w:715, stockQty:45306, stockWeeks:63.4, diff:-1.9 },
        { category:'Bag', item:'SG', name:'ìŠ¬ë§ë°±', sales:28, yoy:67, weight:2, qty:350, avg4w:487, stockQty:23535, stockWeeks:48.3, diff:19.2 },
        { category:'Headwear', item:'BN', name:'ë¹„ë‹ˆ', sales:24, yoy:152, weight:2, qty:639, avg4w:351, stockQty:32696, stockWeeks:93.2, diff:-25.4 },
        { category:'Shoes', item:'LP', name:'ìŠ¬ë¦¬í¼', sales:23, yoy:79, weight:2, qty:500, avg4w:791, stockQty:31651, stockWeeks:40, diff:4.4 },
        { category:'Acc_etc', item:'GL', name:'ì¥ê°‘', sales:16, yoy:287, weight:1, qty:1187, avg4w:596, stockQty:17939, stockWeeks:30.1, diff:-165.4 },
        { category:'Headwear', item:'HT', name:'í–‡', sales:12, yoy:50, weight:1, qty:244, avg4w:305, stockQty:34156, stockWeeks:112, diff:17.3 },
        { category:'Bag', item:'TG', name:'í† ë“œë°±', sales:10, yoy:77, weight:1, qty:170, avg4w:110, stockQty:20877, stockWeeks:189.8, diff:62.1 },
        { category:'Acc_etc', item:'SO', name:'ì–‘ë§', sales:10, yoy:183, weight:1, qty:963, avg4w:820, stockQty:68590, stockWeeks:83.6, diff:-20.6 },
        { category:'Headwear', item:'WM', name:'ë°©í•œëª¨', sales:8, yoy:null, weight:1, qty:119, avg4w:64, stockQty:8625, stockWeeks:134.8, diff:null },
        { category:'Acc_etc', item:'AC', name:'ê¸°íƒ€ì†Œí’ˆë¥˜', sales:7, yoy:122, weight:1, qty:216, avg4w:92, stockQty:15310, stockWeeks:166.4, diff:-2.4 },
        { category:'Bag', item:'MR', name:'ë©”ì‹ ì €ë°±', sales:5, yoy:44, weight:0, qty:70, avg4w:84, stockQty:9750, stockWeeks:116.1, diff:19.3 },
        { category:'Bag', item:'HS', name:'í™ìƒ‰', sales:4, yoy:79, weight:0, qty:64, avg4w:100, stockQty:8054, stockWeeks:80.5, diff:25.7 },
        { category:'Acc_etc', item:'MS', name:'ë©€í‹°ìŠ¤ì¹´í”„', sales:3, yoy:206, weight:0, qty:112, avg4w:48, stockQty:6625, stockWeeks:138, diff:-146.5 },
        { category:'Bag', item:'BG', name:'ê°€ë°©', sales:3, yoy:115, weight:0, qty:41, avg4w:41, stockQty:5001, stockWeeks:122, diff:-154.4 },
        { category:'Bag', item:'BW', name:'ë³´ìŠ¤í†¤ë°±', sales:1, yoy:68, weight:0, qty:22, avg4w:41, stockQty:3074, stockWeeks:75, diff:-77.7 },
        { category:'Acc_etc', item:'MK', name:'ë§ˆìŠ¤í¬(íŒ¨ì…˜ìš©)', sales:1, yoy:453, weight:0, qty:23, avg4w:20, stockQty:3552, stockWeeks:177.6, diff:-73.8 },
        { category:'Bag', item:'BZ', name:'ë°”ë””ë°±', sales:1, yoy:null, weight:0, qty:8, avg4w:16, stockQty:595, stockWeeks:37.2, diff:null },
        { category:'Acc_etc', item:'ML', name:'í† ì‹œ', sales:null, yoy:200, weight:0, qty:19, avg4w:22, stockQty:7517, stockWeeks:341.7, diff:-1341.8 },
        { category:'Acc_etc', item:'PO', name:'íŒŒìš°ì¹˜', sales:null, yoy:null, weight:0, qty:null, avg4w:null, stockQty:23, stockWeeks:null, diff:null }
      ]
    };

    // ê¸°ì¡´ inventoryTableDataëŠ” X ë¸Œëœë“œ ë°ì´í„°ì™€ ë™ì¼í•˜ê²Œ ìœ ì§€ (ê¸°ë³¸ê°’)
    const inventoryTableData = inventoryTableDataByBrand['X'];

    function setInventoryTableHeader(){
      const table = document.getElementById('itemDiffTable');
      if(table) table.classList.add('inventory-mode');
      const thead = document.querySelector('#itemDiffTable thead');
      if(!thead) return;
      thead.innerHTML = `
        <tr>
          <th rowspan="2">ì¹´í…Œê³ ë¦¬</th>
          <th rowspan="2">ì•„ì´í…œ</th>
          <th rowspan="2">ì•„ì´í…œëª…</th>
          <th colspan="5">ì£¼ê°„ë§¤ì¶œ</th>
          <th colspan="4">ì¬ê³ ì£¼ìˆ˜</th>
        </tr>
        <tr>
          <th>íŒë§¤ìˆ˜ëŸ‰</th>
          <th>íŒë§¤ë§¤ì¶œ(ë°±ë§Œ)</th>
          <th>ì „ë…„ë¹„(%)</th>
          <th>ë¹„ì¤‘(%)</th>
          <th>4ì£¼í‰ê· íŒë§¤ëŸ‰</th>
          <th>ì¬ê³ </th>
          <th>ì¬ê³ ì£¼ìˆ˜</th>
          <th>ì „ë…„ëŒ€ë¹„</th>
        </tr>`;
      // ì¬ê³ ì£¼ìˆ˜ ì„¤ëª… í‘œì‹œ
      const noteEl = document.getElementById('inventoryTableNote');
      if(noteEl) noteEl.style.display = 'block';
    }

    function setSaleRateTableHeader(){
      const table = document.getElementById('itemDiffTable');
      if(table) table.classList.remove('inventory-mode');
      const thead = document.querySelector('#itemDiffTable thead');
      if(!thead) return;
      thead.innerHTML = `
        <tr>
          <th rowspan="2">ì¹´í…Œê³ ë¦¬</th>
          <th rowspan="2">ì•„ì´í…œì½”ë“œ</th>
          <th rowspan="2">ì•„ì´í…œëª…</th>
          <th colspan="2">ë°œì£¼ê¸ˆì•¡(TAG)</th>
          <th colspan="2">ì£¼ê°„íŒë§¤ë§¤ì¶œ(TAG)</th>
          <th colspan="2">ëˆ„ì íŒë§¤ë§¤ì¶œ(TAG)</th>
          <th colspan="3">ëˆ„ì íŒë§¤ìœ¨</th>
        </tr>
        <tr>
          <th>ë‹¹ë…„(ë°±ë§Œ)</th><th>ì „ë…„ë¹„</th>
          <th>ë‹¹ë…„(ë°±ë§Œ)</th><th>ì „ë…„ë¹„</th>
          <th>ë‹¹ë…„(ë°±ë§Œ)</th><th>ì „ë…„ë¹„</th>
          <th>ë‹¹ë…„(%)</th><th>ì°¨ì´</th><th>ì „ë…„ë§ˆê°</th>
        </tr>`;
      // ì¬ê³ ì£¼ìˆ˜ ì„¤ëª… ìˆ¨ê¹€
      const noteEl = document.getElementById('inventoryTableNote');
      if(noteEl) noteEl.style.display = 'none';
    }

    function renderInventoryTable(){
      const tbody = document.getElementById('itemDiffTableBody');
      if(!tbody) return;
      setInventoryTableHeader();
      const fmtNum = (v)=> (v==null || v==='') ? '-' : Number(v).toLocaleString('ko-KR');
      const fmtPct = (v)=> (v==null || v==='') ? '-' : `${Number(v).toLocaleString('ko-KR')}`; // ê·¸ëŒ€ë¡œ í‘œì‹œ, % ê¸°í˜¸ëŠ” ì»¬ëŸ¼ëª…ì— í¬í•¨
      const fmtPctSign = (v)=>{
        if(v==null || v==='') return '-';
        const n = Number(v);
        const sign = n>0? '+' : (n<0? 'â–³' : '');
        return `${sign}${Math.abs(n).toLocaleString('ko-KR')}`;
      };
      
      // í˜„ì¬ ë¸Œëœë“œì— ë§ëŠ” ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      const brandCode = brandCodeMap[currentBrand] || 'X';
      const dataToRender = inventoryTableDataByBrand[brandCode] || inventoryTableDataByBrand['X'];
      
      // ì¹´í…Œê³ ë¦¬ í•„í„°ë§
      const filtered = itemTableCategory==='ALL' 
        ? dataToRender 
        : dataToRender.filter(r => {
            const cat = r.category || '';
            if(itemTableCategory==='Shoes') return cat==='Shoes';
            if(itemTableCategory==='Headwear') return cat==='Headwear';
            if(itemTableCategory==='Bag') return cat==='Bag';
            if(itemTableCategory==='Acc_etc') return cat==='Acc_etc';
            return true;
          });
      
      // ì •ë ¬ ì ìš©
      const sorters = {
        category: (a,b)=> (a.category===b.category ? (b.sales||0) - (a.sales||0) : (a.category > b.category ? 1 : -1)),
        sales: (a,b)=> ((b.sales||0) - (a.sales||0)),
        stockQty: (a,b)=> ((b.stockQty||0) - (a.stockQty||0)),
        stockWeeks: (a,b)=> ((b.stockWeeks||0) - (a.stockWeeks||0))
      };
      const sorted = [...filtered].sort(sorters[itemTableSort] || sorters.category);
      
      // íˆíŠ¸ë§µ ìƒ‰ìƒ ì„¤ì • (ìˆœìœ„ ê¸°ë°˜)
      const toRgb = (hex)=>{
        const h = hex.replace('#','');
        const bigint = parseInt(h.length===3? h.split('').map(c=>c+c).join('') : h, 16);
        return { r:(bigint>>16)&255, g:(bigint>>8)&255, b:bigint&255 };
      };
      const mixWithWhite = (hex, t)=>{ // t: 0~1, ë†’ì„ìˆ˜ë¡ ì§„í•˜ê²Œ
        const {r,g,b} = toRgb(hex);
        const rr = Math.round(255 + (r-255)*t);
        const gg = Math.round(255 + (g-255)*t);
        const bb = Math.round(255 + (b-255)*t);
        return `rgb(${rr},${gg},${bb})`;
      };
      const numeric = (v)=> (v==null || isNaN(v)) ? null : Number(v);
      const buildDesc = (arr)=> arr.filter(v=> v!=null).sort((a,b)=> b-a);
      const tByRank = (val, descArr)=>{
        if(val==null || isNaN(val) || !descArr || descArr.length===0) return 0;
        const n = descArr.length;
        if(n===1) return 1;
        const idx = descArr.indexOf(Number(val));
        if(idx<0) return 0;
        return (n-1-idx)/(n-1);
      };
      const valuesYoy = buildDesc(sorted.map(r=> numeric(r.yoy)));
      const valuesStockWeeks = buildDesc(sorted.map(r=> numeric(r.stockWeeks)));
      const cellStyleRanked = (val, baseHex, descArr)=>{
        const t = tByRank(val, descArr);
        if(t<=0) return '';
        const bg = mixWithWhite(baseHex, t);
        return `background:${bg};`;
      };
      
      tbody.innerHTML = sorted.map(r=>{
        const stYoy = cellStyleRanked(r.yoy, '#f59e0b', valuesYoy);
        const stStockWeeks = cellStyleRanked(r.stockWeeks, '#60a5fa', valuesStockWeeks);
        return `
          <tr>
            <td>${r.category||''}</td>
            <td>${r.item||''}</td>
            <td>${r.name||''}</td>
            <td>${fmtNum(r.qty)}</td>
            <td>${fmtNum(r.sales)}</td>
            <td style="${stYoy}">${fmtPct(r.yoy)}%</td>
            <td>${fmtPct(r.weight)}%</td>
            <td>${fmtNum(r.avg4w)}</td>
            <td>${fmtNum(r.stockQty)}</td>
            <td style="${stStockWeeks}">${fmtPct(r.stockWeeks)}</td>
            <td>${fmtPctSign(r.diff)}</td>
          </tr>`;
      }).join('');
    }

    function renderItemDiffTable(){
      const tbody = document.getElementById('itemDiffTableBody');
      if(!tbody) return;
      if(itemTableMode==='inventory'){
        renderInventoryTable();
        // íŒë§¤ìœ¨ ì°¨íŠ¸ê°€ ìˆë‹¤ë©´ ì œê±°
        if(saleRateChartInstance){
          saleRateChartInstance.destroy();
          saleRateChartInstance = null;
        }
        // ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œì¼ ë•Œ ê·¸ë˜í”„ í‘œì‹œ ë° ì—…ë°ì´íŠ¸
        updateInventoryChart();
        return;
      }
      setSaleRateTableHeader();
      // ì¬ê³ ì£¼ìˆ˜ ì°¨íŠ¸ê°€ ìˆë‹¤ë©´ ì œê±°
      if(inventoryChartInstance){
        inventoryChartInstance.destroy();
        inventoryChartInstance = null;
      }
      // íŒë§¤ìœ¨ ëª¨ë“œì¼ ë•Œ ê·¸ë˜í”„ í‘œì‹œ ë° ì—…ë°ì´íŠ¸
      updateSaleRateChart();
      // í•„í„°ë§
      console.log('renderItemDiffTable - currentBrand:', currentBrand);
      const computed = getBrandItemTableData(currentBrand);
      console.log('renderItemDiffTable - computed ë°ì´í„°:', {
        outerCount: computed.Outer?.length,
        firstOuterName: computed.Outer?.[0]?.name,
        firstOuterPo: computed.Outer?.[0]?.poNow
      });
      const sourceRows = itemTableCategory==='ALL'
        ? [...(computed.Outer||[]), ...(computed.Inner||[]), ...(computed.Bottom||[]), ...(computed.Wear_etc||[])]
        : (computed[itemTableCategory]||[]);
      const rows = sourceRows.map(r=>({ ...r }));
      // ì „ë…„ë¹„/íŒë§¤ìœ¨ íˆíŠ¸ë§µ ì»¬ëŸ¬ ì„¤ì • (ìˆœìœ„ ê¸°ë°˜ ë†ë„)
      const yoyBaseColors = { poYoy:'#f59e0b', yoyWeekly:'#60a5fa', yoyCum:'#ec4899' }; // TAG=ì£¼í™©, ì£¼ê°„=ë¸”ë£¨, ëˆ„ì =ë¶„í™
      const toRgb = (hex)=>{
        const h = hex.replace('#','');
        const bigint = parseInt(h.length===3? h.split('').map(c=>c+c).join('') : h, 16);
        return { r:(bigint>>16)&255, g:(bigint>>8)&255, b:bigint&255 };
      };
      const mixWithWhite = (hex, t)=>{ // t: 0~1, ë†’ì„ìˆ˜ë¡ ì§„í•˜ê²Œ
        const {r,g,b} = toRgb(hex);
        const rr = Math.round(255 + (r-255)*t);
        const gg = Math.round(255 + (g-255)*t);
        const bb = Math.round(255 + (b-255)*t);
        return `rgb(${rr},${gg},${bb})`;
      };
      // í‘œì‹œ ëŒ€ìƒ(filtered) ê¸°ì¤€ìœ¼ë¡œ ê° ì „ë…„ë¹„ ì—´ì˜ ê°’ ë°°ì—´ì„ ë‚´ë¦¼ì°¨ìˆœ/ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬í•˜ì—¬ ìˆœìœ„ ì‚°ì¶œ
      const numeric = (v)=> (v==null || isNaN(v)) ? null : Number(v);
      const buildDesc = (arr)=> arr.filter(v=> v!=null).sort((a,b)=> b-a);
      const buildAsc  = (arr)=> arr.filter(v=> v!=null).sort((a,b)=> a-b);
      // ìˆœìœ„â†’ë†ë„: ìµœëŒ“ê°’ rank=1 ê°€ì¥ ì§„í•¨, ìµœì†Ÿê°’ rank=n ê°€ì¥ ì—°í•¨
      const tByRank = (val, descArr)=>{
        if(val==null || isNaN(val) || !descArr || descArr.length===0) return 0;
        const n = descArr.length;
        if(n===1) return 1;
        const idx = descArr.indexOf(Number(val)); // ë™ì¼ê°’ì€ ì²« ë“±ì¥ ì¸ë±ìŠ¤ ì‚¬ìš©
        if(idx<0) return 0;
        return (n-1-idx)/(n-1);
      };
      const valuesPo  = buildDesc(rows.map(r=> numeric(r.poYoy)));
      const valuesYW  = buildDesc(rows.map(r=> numeric(r.yoyWeekly)));
      const valuesYC  = buildDesc(rows.map(r=> numeric(r.yoyCum)));
      const valuesRateDesc = buildDesc(rows.map(r=> numeric(r.rateNow)));
      const cellStyleRanked = (val, baseHex, descArr)=>{
        const t = tByRank(val, descArr);
        if(t<=0) return '';
        const bg = mixWithWhite(baseHex, t);
        return `background:${bg};`;
      };
      // íŒë§¤ìœ¨(ë‹¹ë…„) ì „ìš©: ê°’ì´ í´ìˆ˜ë¡ ì§„í•˜ê²Œ (ë‚´ë¦¼ì°¨ìˆœ ìˆœìœ„ ê¸°ë°˜)
      const cellStyleRateDirect = (val)=>{
        const t = tByRank(val, valuesRateDesc);
        if(t<=0) return '';
        const bg = mixWithWhite('#10b981', t); // ì´ˆë¡ ê¸°ë°˜
        return `background:${bg};`;
      };
      // ì£¼ì˜ ê¸°ì¤€: ì°¨ì´ê°’(í…ìŠ¤íŠ¸ ìš°ì„ ) <= -5%p  (ì „ë…„ ëŒ€ë¹„ 5%p ì´ìƒ ì €ì¡°)
      const getDiffValue = (r)=>{
        if (r.diffText && typeof r.diffText === 'string'){
          const m = r.diffText.match(/[+â–³-]?\s*([0-9]+(?:\.[0-9]+)?)%p/);
          if (m){
            const n = parseFloat(m[1]);
            const neg = r.diffText.trim().startsWith('â–³') || r.diffText.trim().startsWith('-');
            return neg ? -n : +n;
          }
        }
        if(r.rateNow!=null && r.rateLast!=null && !isNaN(r.rateNow) && !isNaN(r.rateLast)){
          return Number(r.rateNow) - Number(r.rateLast);
        }
        return NaN;
      };
      const isAlert = (r)=>{ const d = getDiffValue(r); return !isNaN(d) && d <= -5; };
      const filtered = itemTableAlertOnly ? rows.filter(isAlert) : rows;
      // ì •ë ¬
      const sorters = {
        category: (a,b)=> (a.category===b.category ? (b.weekly - a.weekly) : (a.category > b.category ? 1 : -1)),
        po:       (a,b)=> ((b.poNow??-1) - (a.poNow??-1)),
        weekly:   (a,b)=> (b.weekly - a.weekly),
        cum:      (a,b)=> (b.cum - a.cum),
        rateNow:  (a,b)=> ((b.rateNow??-1) - (a.rateNow??-1))
      };
      filtered.sort(sorters[itemTableSort] || sorters.category);
      // ê°•ì¡° ë¡œì§ ì œê±°: threshold/topN ì‚¬ìš© ì•ˆ í•¨
      tbody.innerHTML = filtered.map((r,idx)=>{
        const percent = (v)=> (v==null || isNaN(v)) ? '-' : `${Number(v).toFixed(1)}%`;
        // diffText ê³„ì‚°: ë‹¹ë…„íŒë§¤ìœ¨ - ì „ë…„íŒë§¤ìœ¨ (ë§ˆê°íŒë§¤ìœ¨ ì‚¬ìš© ì•ˆ í•¨)
        const calculateDiffText = (r) => {
          if (r.diffText) return r.diffText;
          if (r.rateNow != null && r.rateLast != null && !isNaN(r.rateNow) && !isNaN(r.rateLast)) {
            const diff = Number(r.rateNow) - Number(r.rateLast);
            if (diff > 0) return `+${diff.toFixed(1)}%p`;
            return `â–³${Math.abs(diff).toFixed(1)}%p`;
          }
          return '+0.0%p';
        };
        const diffText = calculateDiffText(r);
        const poNow = (r.poNow==null)?'-':r.poNow.toLocaleString('ko-KR');
        const poYoy = (r.poYoy==null)?'-':`${r.poYoy}%`;
        const yoyW = (r.yoyWeekly==null)?'-':`${r.yoyWeekly}%`;
        const yoyC = (r.yoyCum==null)?'-':`${r.yoyCum}%`;
        const weekly = (r.weekly==null)?'-':r.weekly.toLocaleString('ko-KR');
        const cum = (r.cum==null)?'-':r.cum.toLocaleString('ko-KR');
        const rateNow = percent(r.rateNow);
        const closingRate = (r.closingRate != null && !isNaN(r.closingRate)) ? percent(r.closingRate) : '-';
        const rowStyle = isAlert(r) ? 'background:#fff7ed;' : '';
        const diffStyle = 'font-weight:600;';
        const warn = isAlert(r) ? 'âš ï¸ ' : '';
        const stPoY = cellStyleRanked(r.poYoy, yoyBaseColors.poYoy, valuesPo);
        const stYW  = cellStyleRanked(r.yoyWeekly, yoyBaseColors.yoyWeekly, valuesYW);
        const stYC  = cellStyleRanked(r.yoyCum, yoyBaseColors.yoyCum, valuesYC);
        const stRateNow = cellStyleRateDirect(r.rateNow);
        return `
          <tr style="${rowStyle}">
            <td>${warn}${r.category}</td>
            <td>${r.code}</td>
            <td>${r.name}</td>
            <td>${poNow}</td>
            <td style="${stPoY}">${poYoy}</td>
            <td>${weekly}</td>
            <td style="${stYW}">${yoyW}</td>
            <td>${cum}</td>
            <td style="${stYC}">${yoyC}</td>
            <td style="${stRateNow}">${rateNow}</td>
            <td style="${diffStyle}">${diffText}</td>
            <td>${closingRate}</td>
          </tr>`;
      }).join('');
    }
    
    // -------- íŒë§¤ìœ¨ ì°¨íŠ¸ (Dual Axis) --------
    let saleRateChartInstance = null;
    
    function updateSaleRateChart(){
      const chartContainer = document.getElementById('saleRateChartContainer');
      if(!chartContainer) return;
      
      // íŒë§¤ìœ¨ ëª¨ë“œì¼ ë•Œë§Œ í‘œì‹œ
      chartContainer.style.display = 'block';
      
      // í˜„ì¬ í•„í„°ë§ëœ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      const computed = getBrandItemTableData(currentBrand);
      const sourceRows = itemTableCategory==='ALL'
        ? [...(computed.Outer||[]), ...(computed.Inner||[]), ...(computed.Bottom||[]), ...(computed.Wear_etc||[])]
        : (computed[itemTableCategory]||[]);
      const rows = sourceRows.map(r=>({ ...r }));
      
      // ì „ë…„ë¹„ ì°¨ì´ê°’ ê³„ì‚° í•¨ìˆ˜
      const getDiffValue = (r)=>{
        if (r.diffText && typeof r.diffText === 'string'){
          const m = r.diffText.match(/[+â–³-]?\s*([0-9]+(?:\.[0-9]+)?)%p/);
          if (m){
            const n = parseFloat(m[1]);
            const neg = r.diffText.trim().startsWith('â–³') || r.diffText.trim().startsWith('-');
            return neg ? -n : +n;
          }
        }
        if(r.rateNow!=null && r.rateLast!=null && !isNaN(r.rateNow) && !isNaN(r.rateLast)){
          return Number(r.rateNow) - Number(r.rateLast);
        }
        return 0;
      };
      
      // í‘œì™€ ë™ì¼í•œ ì •ë ¬ ë¡œì§ ì ìš©
      const sorters = {
        category: (a,b)=> (a.category===b.category ? (b.weekly - a.weekly) : (a.category > b.category ? 1 : -1)),
        po:       (a,b)=> ((b.poNow??-1) - (a.poNow??-1)),
        weekly:   (a,b)=> (b.weekly - a.weekly),
        cum:      (a,b)=> (b.cum - a.cum),
        rateNow:  (a,b)=> ((b.rateNow??-1) - (a.rateNow??-1))
      };
      // í‘œì˜ ì •ë ¬ ì˜µì…˜ì— ë”°ë¼ ì •ë ¬í•˜ì—¬ ìƒìœ„ 15ê°œ ì„ íƒ
      const sorted = [...rows].sort(sorters[itemTableSort] || sorters.cum).slice(0, 15);
      
      // ë°ì´í„° ì¤€ë¹„
      const labels = sorted.map(d => d.code);
      const salesRates = sorted.map(d => d.rateNow || 0);
      const yearDiffs = sorted.map(d => getDiffValue(d));
      
      // ë°” ìƒ‰ìƒ ê²°ì • (íŒë§¤ìœ¨ ê¸°ì¤€)
      const barColors = salesRates.map(rate => {
        if (rate >= 20) return 'rgba(104, 211, 145, 0.8)'; // ê³ íš¨ìœ¨: ì´ˆë¡
        if (rate >= 10) return 'rgba(102, 126, 234, 0.8)'; // ë³´í†µ: íŒŒë‘
        return 'rgba(252, 129, 129, 0.8)'; // ì €íš¨ìœ¨: ë¹¨ê°•
      });
      
      // ë¼ì¸ ìƒ‰ìƒ ê²°ì • (ì „ë…„ë¹„ íŒë§¤ìœ¨ ì¦ê°)
      const lineColors = yearDiffs.map(diff => {
        if (diff > 0) return 'rgba(104, 211, 145, 1)'; // íš¨ìœ¨ ê°œì„ : ì´ˆë¡
        if (diff >= -5) return 'rgba(246, 173, 85, 1)'; // ì†Œí­ ë‘”í™”: ì£¼í™©
        return 'rgba(252, 129, 129, 1)'; // ê¸‰ê²© ë‘”í™”: ë¹¨ê°•
      });
      
      const ctx = document.getElementById('saleRateChart');
      if(!ctx) return;
      
      // ê¸°ì¡´ ì°¨íŠ¸ê°€ ìˆìœ¼ë©´ ì œê±°
      if(saleRateChartInstance){
        saleRateChartInstance.destroy();
        saleRateChartInstance = null;
      }
      
      // ìƒˆ ì°¨íŠ¸ ìƒì„±
      saleRateChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [
            {
              label: 'ëˆ„ì íŒë§¤ìœ¨',
              data: salesRates,
              backgroundColor: barColors,
              borderColor: barColors.map(c => c.replace('0.8', '1')),
              borderWidth: 2,
              borderRadius: 8,
              yAxisID: 'y',
              order: 2
            },
            {
              label: 'ì „ë…„ì°¨ì´',
              data: yearDiffs,
              type: 'line',
              borderColor: '#f6ad55',
              backgroundColor: 'rgba(246, 173, 85, 0.1)',
              borderWidth: 3,
              pointRadius: 6,
              pointHoverRadius: 8,
              pointBackgroundColor: lineColors,
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              tension: 0.3,
              yAxisID: 'y1',
              order: 1,
              fill: false
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          layout: {
            padding: {
              right: 20
            }
          },
          interaction: {
            mode: 'index',
            intersect: false,
          },
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              },
              bodySpacing: 6,
              callbacks: {
                title: function(context) {
                  const index = context[0].dataIndex;
                  return sorted[index].name;
                },
                label: function(context) {
                  const index = context.dataIndex;
                  const item = sorted[index];
                  
                  if (context.dataset.label === 'ëˆ„ì íŒë§¤ìœ¨') {
                    return `íŒë§¤ìœ¨: ${item.rateNow.toFixed(1)}%`;
                  } else {
                    const diff = getDiffValue(item);
                    const sign = diff > 0 ? '+' : '';
                    return `ì „ë…„ë¹„ íŒë§¤ìœ¨: ${sign}${diff.toFixed(1)}%p`;
                  }
                },
                afterLabel: function(context) {
                  const index = context.dataIndex;
                  const item = sorted[index];
                  
                  if (context.dataset.label === 'ëˆ„ì íŒë§¤ìœ¨') {
                    return `íˆ¬ì…ê¸ˆì•¡: ${((item.poNow || 0) / 100).toFixed(0)}ì–µì›`;
                  }
                }
              }
            }
          },
          scales: {
            y: {
              type: 'linear',
              display: true,
              position: 'left',
              title: {
                display: true,
                text: 'íˆ¬ì… ëŒ€ë¹„ íŒë§¤ìœ¨ (%)',
                font: {
                  size: 14,
                  weight: 'bold'
                }
              },
              beginAtZero: true,
              max: 40,
              grid: {
                drawOnChartArea: true,
                color: 'rgba(0, 0, 0, 0.05)'
              },
              ticks: {
                callback: function(value) {
                  return value + '%';
                },
                font: {
                  size: 12
                }
              }
            },
            y1: {
              type: 'linear',
              display: true,
              position: 'right',
              title: {
                display: true,
                text: 'ì „ë…„ ëŒ€ë¹„ íŒë§¤ìœ¨ ì¦ê° (p)',
                font: {
                  size: 14,
                  weight: 'bold'
                }
              },
              min: -30,
              max: 10,
              grid: {
                drawOnChartArea: false,
              },
              ticks: {
                callback: function(value) {
                  const sign = value > 0 ? '+' : '';
                  return sign + value + 'p';
                },
                font: {
                  size: 12
                }
              }
            },
            x: {
              grid: {
                display: false
              },
              ticks: {
                font: {
                  size: 13,
                  weight: 'bold'
                },
                maxRotation: 0,
                autoSkip: false
              },
              offset: true
            }
          }
        }
      });
    }
    
    // -------- ì¬ê³ ì£¼ìˆ˜ ì°¨íŠ¸ (Dual Axis) --------
    let inventoryChartInstance = null;
    
    function updateInventoryChart(){
      const chartContainer = document.getElementById('saleRateChartContainer');
      if(!chartContainer) return;
      
      // ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œì¼ ë•Œ í‘œì‹œ
      chartContainer.style.display = 'block';
      
      // í˜„ì¬ ë¸Œëœë“œì— ë§ëŠ” ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      const brandCode = brandCodeMap[currentBrand] || 'X';
      const dataToRender = inventoryTableDataByBrand[brandCode] || inventoryTableDataByBrand['X'];
      
      // ì¹´í…Œê³ ë¦¬ í•„í„°ë§
      const filtered = itemTableCategory==='ALL' 
        ? dataToRender 
        : dataToRender.filter(r => {
            const cat = r.category || '';
            if(itemTableCategory==='Shoes') return cat==='Shoes';
            if(itemTableCategory==='Headwear') return cat==='Headwear';
            if(itemTableCategory==='Bag') return cat==='Bag';
            if(itemTableCategory==='Acc_etc') return cat==='Acc_etc';
            return true;
          });
      
      // í‘œì™€ ë™ì¼í•œ ì •ë ¬ ë¡œì§ ì ìš© (ì¬ê³ ì£¼ìˆ˜ ëª¨ë“œ)
      const sorters = {
        category: (a,b)=> (a.category===b.category ? (b.sales||0) - (a.sales||0) : (a.category > b.category ? 1 : -1)),
        sales: (a,b)=> ((b.sales||0) - (a.sales||0)),
        stockQty: (a,b)=> ((b.stockQty||0) - (a.stockQty||0)),
        stockWeeks: (a,b)=> ((b.stockWeeks||0) - (a.stockWeeks||0))
      };
      // í‘œì˜ ì •ë ¬ ì˜µì…˜ì— ë”°ë¼ ì •ë ¬í•˜ì—¬ ìƒìœ„ 15ê°œ ì„ íƒ
      const sorted = [...filtered]
        .filter(r => r.sales != null && !isNaN(r.sales)) // ë§¤ì¶œì´ ìˆëŠ” ê²ƒë§Œ
        .sort(sorters[itemTableSort] || sorters.sales)
        .slice(0, 15);
      
      // ë°ì´í„° ì¤€ë¹„
      const labels = sorted.map(d => d.item);
      const stockWeeksData = sorted.map(d => d.stockWeeks || 0);
      const diffData = sorted.map(d => {
        const diff = d.diff;
        return (diff != null && !isNaN(diff)) ? diff : 0;
      });
      
      // ë°” ìƒ‰ìƒ ê²°ì • (ì¬ê³ ì£¼ìˆ˜ ê¸°ì¤€: ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ)
      const barColors = stockWeeksData.map(weeks => {
        if (weeks <= 30) return 'rgba(104, 211, 145, 0.8)'; // ì–‘í˜¸: ì´ˆë¡
        if (weeks <= 60) return 'rgba(102, 126, 234, 0.8)'; // ë³´í†µ: íŒŒë‘
        return 'rgba(252, 129, 129, 0.8)'; // ë†’ìŒ: ë¹¨ê°•
      });
      
      // ë¼ì¸ ìƒ‰ìƒ ê²°ì • (ì¬ê³ ì£¼ìˆ˜ ì°¨ì´)
      const lineColors = diffData.map(diff => {
        if (diff <= -50) return 'rgba(104, 211, 145, 1)'; // ë§ì´ ê°œì„ : ì´ˆë¡
        if (diff <= 0) return 'rgba(246, 173, 85, 1)'; // ì†Œí­ ê°œì„ /ìœ ì§€: ì£¼í™©
        return 'rgba(252, 129, 129, 1)'; // ì¦ê°€: ë¹¨ê°•
      });
      
      const ctx = document.getElementById('saleRateChart');
      if(!ctx) return;
      
      // ê¸°ì¡´ ì°¨íŠ¸ê°€ ìˆìœ¼ë©´ ì œê±°
      if(inventoryChartInstance){
        inventoryChartInstance.destroy();
        inventoryChartInstance = null;
      }
      
      // ì¬ê³ ì£¼ìˆ˜ ìµœëŒ“ê°’ ê³„ì‚° (Yì¶• ë²”ìœ„ ì„¤ì •)
      const maxStockWeeks = Math.max(...stockWeeksData.filter(w => w != null && !isNaN(w) && w > 0), 100);
      const yAxisMax = Math.ceil(maxStockWeeks * 1.1);
      
      // ìƒˆ ì°¨íŠ¸ ìƒì„±
      inventoryChartInstance = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [
            {
              label: 'ì¬ê³ ì£¼ìˆ˜',
              data: stockWeeksData,
              backgroundColor: barColors,
              borderColor: barColors.map(c => c.replace('0.8', '1')),
              borderWidth: 2,
              borderRadius: 8,
              yAxisID: 'y',
              order: 2
            },
            {
              label: 'ì¬ê³ ì£¼ìˆ˜ì°¨ì´',
              data: diffData,
              type: 'line',
              borderColor: '#60a5fa',
              backgroundColor: 'rgba(96, 165, 250, 0.1)',
              borderWidth: 3,
              pointRadius: 6,
              pointHoverRadius: 8,
              pointBackgroundColor: lineColors,
              pointBorderColor: '#fff',
              pointBorderWidth: 2,
              tension: 0.3,
              yAxisID: 'y1',
              order: 1,
              fill: false
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false,
          },
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              padding: 12,
              titleFont: {
                size: 14,
                weight: 'bold'
              },
              bodyFont: {
                size: 13
              },
              bodySpacing: 6,
              callbacks: {
                title: function(context) {
                  const index = context[0].dataIndex;
                  return sorted[index].name;
                },
                label: function(context) {
                  const index = context.dataIndex;
                  const item = sorted[index];
                  
                  if (context.dataset.label === 'ì¬ê³ ì£¼ìˆ˜') {
                    return `ì¬ê³ ì£¼ìˆ˜: ${(item.stockWeeks || 0).toFixed(1)}ì£¼`;
                  } else {
                    const diff = item.diff;
                    const diffValue = (diff != null && !isNaN(diff)) ? diff : 0;
                    const sign = diffValue > 0 ? '+' : '';
                    return `ì „ë…„ë¹„ ì°¨ì´: ${sign}${diffValue.toFixed(1)}`;
                  }
                },
                afterLabel: function(context) {
                  const index = context.dataIndex;
                  const item = sorted[index];
                  
                  if (context.dataset.label === 'ì¬ê³ ì£¼ìˆ˜') {
                    return `ë§¤ì¶œ: ${((item.sales || 0)).toFixed(1)}ë°±ë§Œì›`;
                  }
                }
              }
            }
          },
          scales: {
            y: {
              type: 'linear',
              display: true,
              position: 'left',
              title: {
                display: true,
                text: 'ì¬ê³ ì£¼ìˆ˜ (ì£¼)',
                font: {
                  size: 14,
                  weight: 'bold'
                }
              },
              beginAtZero: true,
              max: yAxisMax,
              grid: {
                drawOnChartArea: true,
                color: 'rgba(0, 0, 0, 0.05)'
              },
              ticks: {
                callback: function(value) {
                  return value + 'ì£¼';
                },
                font: {
                  size: 12
                }
              }
            },
            y1: {
              type: 'linear',
              display: true,
              position: 'right',
              title: {
                display: true,
                text: 'ì¬ê³ ì£¼ìˆ˜ ì°¨ì´',
                font: {
                  size: 14,
                  weight: 'bold'
                }
              },
              grid: {
                drawOnChartArea: false,
              },
              ticks: {
                callback: function(value) {
                  const sign = value > 0 ? '+' : '';
                  return sign + value;
                },
                font: {
                  size: 12
                }
              }
            },
            x: {
              grid: {
                display: false
              },
              ticks: {
                font: {
                  size: 13,
                  weight: 'bold'
                }
              }
            }
          }
        }
      });
    }
    
    // -------- íŠ¸ë¦¬ë§µ ê´€ë ¨ ë³€ìˆ˜ --------
    let treemapCurrentType = 'channel'; // 'channel' or 'item'
    let treemapCurrentPath = []; // ë“œë¦´ë‹¤ìš´ ê²½ë¡œ
    let treemapChartInstance = null;
    let channelTreemapPath = []; // ì±„ë„ íŠ¸ë¦¬ë§µ ë“œë¦´ë‹¤ìš´ ê²½ë¡œ
    let itemTreemapPath = []; // ì•„ì´í…œ íŠ¸ë¦¬ë§µ ë“œë¦´ë‹¤ìš´ ê²½ë¡œ
    let treemapMetadata = null; // íŠ¸ë¦¬ë§µ ë‚ ì§œ ë©”íƒ€ë°ì´í„°
    
    // íŠ¸ë¦¬ë§µ í¬ê¸° ì €ì¥ í‚¤
    const TREEMAP_SIZE_STORAGE_KEY = 'treemap_sizes';
    
    // íŠ¸ë¦¬ë§µ í¬ê¸° ê°€ì ¸ì˜¤ê¸° (ì €ì¥ëœ í¬ê¸°ê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ í˜„ì¬ í¬ê¸° ê³„ì‚° í›„ ì €ì¥)
    function getTreemapSize(containerId) {
      const container = document.getElementById(containerId);
      if (!container) return null;
      
      const storedSizes = JSON.parse(localStorage.getItem(TREEMAP_SIZE_STORAGE_KEY) || '{}');
      
      // ì €ì¥ëœ í¬ê¸°ê°€ ìˆìœ¼ë©´ ì‚¬ìš©
      if (storedSizes[containerId]) {
        return storedSizes[containerId];
      }
      
      // ì €ì¥ëœ í¬ê¸°ê°€ ì—†ìœ¼ë©´ í˜„ì¬ í¬ê¸° ê³„ì‚°
      const rect = container.getBoundingClientRect();
      const size = {
        width: rect.width,
        height: rect.height
      };
      
      // localStorageì— ì €ì¥
      storedSizes[containerId] = size;
      localStorage.setItem(TREEMAP_SIZE_STORAGE_KEY, JSON.stringify(storedSizes));
      
      return size;
    }
    
    // ì±„ë„ ëª©ë¡ ì •ì˜
    const channelList = ['ë°±í™”ì ', 'ë©´ì„¸ì ', 'ì§ì˜ì (ê°€ë‘)', 'ëŒ€ë¦¬ì ', 'ì•„ìš¸ë ›', 'ì‚¬ì…', 'ì§ì˜ëª°', 'ê¸°íƒ€', 'ì œíœ´ëª°', 'ìì‚¬ëª°'];
    
    // ì•„ì´í…œ ëª©ë¡ ì •ì˜ (í‘œì‹œ ìˆœì„œ)
    const itemList = ['ë‹¹ì‹œì¦Œì˜ë¥˜', 'ê³¼ì‹œì¦Œì˜ë¥˜', 'ì°¨ì‹œì¦Œì˜ë¥˜', 'ëª¨ì', 'ì‹ ë°œ', 'ê°€ë°©', 'ê¸°íƒ€ACC'];
    
    // ì±„ë„ ë§ˆìŠ¤í„° ì •ì˜ (ì±„ë„ë²ˆí˜¸_SF, ì±„ë„ë²ˆí˜¸_SAP, ì±„ë„ëª…, ìµœì¢…ì±„ë„)
    const channelMaster = {
      '1': { sap: '01', name: 'ë°±í™”ì ', final: 'ë°±í™”ì ' },
      '2': { sap: '02', name: 'ë©´ì„¸ì ', final: 'ë©´ì„¸ì ' },
      '3': { sap: '03', name: 'ì§ì˜(ê°€ë‘)', final: 'ì§ì˜ì (ê°€ë‘)' },
      '4': { sap: '04', name: 'ì˜¨ë¼ì¸(ì§)', final: 'ìì‚¬ëª°' },
      '5': { sap: '05', name: 'ì˜¨ë¼ì¸(ëŒ€)', final: 'ì œíœ´ëª°' },
      '6': { sap: '06', name: 'ëŒ€ë¦¬ì ', final: 'ëŒ€ë¦¬ì ' },
      '7': { sap: '07', name: 'ì•„ìš¸ë ›(ì§)', final: 'ì•„ìš¸ë ›' },
      '8': { sap: '08', name: 'ì‚¬ì…', final: 'ì‚¬ì…' },
      '9': { sap: '09', name: 'ìˆ˜ì¶œ', final: 'ìˆ˜ì¶œ' },
      '11': { sap: '11', name: 'ì§ì˜(ê°€ë‘)2', final: 'ì§ì˜ëª°' },
      '12': { sap: '12', name: 'ì•„ìš¸ë ›(ì§)2', final: 'ì•„ìš¸ë ›' },
      '99': { sap: '99', name: 'ê¸°íƒ€', final: 'ê¸°íƒ€' }
    };
    
    // ì±„ë„ëª… â†’ ìµœì¢…ì±„ë„ ë§¤í•‘ (ì›ë³¸ ì±„ë„ëª… â†’ ìµœì¢…ì±„ë„ëª…)
    const channelNameToFinal = {
      'ë°±í™”ì ': 'ë°±í™”ì ',
      'ë©´ì„¸ì ': 'ë©´ì„¸ì ',
      'ì§ì˜(ê°€ë‘)': 'ì§ì˜ì (ê°€ë‘)',
      'ì§ì˜ê°€ë‘': 'ì§ì˜ì (ê°€ë‘)',
      'ì§ì˜ì ': 'ì§ì˜ì (ê°€ë‘)',
      'ì˜¨ë¼ì¸(ì§)': 'ìì‚¬ëª°',
      'ì˜¨ë¼ì¸ìì‚¬': 'ìì‚¬ëª°',
      'ì˜¨ë¼ì¸(ëŒ€)': 'ì œíœ´ëª°',
      'ì˜¨ë¼ì¸ì œíœ´': 'ì œíœ´ëª°',
      'ëŒ€ë¦¬ì ': 'ëŒ€ë¦¬ì ',
      'ì•„ìš¸ë ›(ì§)': 'ì•„ìš¸ë ›',
      'ì•„ìš¸ë ›(ì§)2': 'ì•„ìš¸ë ›',
      'ì‚¬ì…': 'ì‚¬ì…',
      'ìˆ˜ì¶œ': 'ìˆ˜ì¶œ',
      'ì§ì˜(ê°€ë‘)2': 'ì§ì˜ëª°',
      'ê¸°íƒ€': 'ê¸°íƒ€',
      // ìµœì¢…ì±„ë„ëª…ì€ ê·¸ëŒ€ë¡œ ìœ ì§€
      'ìì‚¬ëª°': 'ìì‚¬ëª°',
      'ì œíœ´ëª°': 'ì œíœ´ëª°',
      'ì§ì˜ëª°': 'ì§ì˜ëª°',
      'ì•„ìš¸ë ›': 'ì•„ìš¸ë ›',
      'ì§ì˜ì (ê°€ë‘)': 'ì§ì˜ì (ê°€ë‘)'
    };
    
    // ì±„ë„ í‚¤ ë§¤í•‘ (ë°ì´í„°ì—ì„œ ì‚¬ìš©í•˜ëŠ” í‚¤ â†’ í‘œì‹œëª…) - ìµœì¢…ì±„ë„ëª… ì‚¬ìš©
    const channelKeyMap = {
      'ë°±í™”ì ': 'ë°±í™”ì ',
      'ë©´ì„¸ì ': 'ë©´ì„¸ì ',
      'ì§ì˜ê°€ë‘': 'ì§ì˜ì (ê°€ë‘)',
      'ì§ì˜ì ': 'ì§ì˜ì (ê°€ë‘)',
      'ì§ì˜ì (ê°€ë‘)': 'ì§ì˜ì (ê°€ë‘)',
      'ëŒ€ë¦¬ì ': 'ëŒ€ë¦¬ì ',
      'ì•„ìš¸ë ›': 'ì•„ìš¸ë ›',
      'ì‚¬ì…': 'ì‚¬ì…',
      'ì§ì˜ëª°': 'ì§ì˜ëª°',
      'ê¸°íƒ€': 'ê¸°íƒ€',
      'ì˜¨ë¼ì¸ì œíœ´': 'ì œíœ´ëª°',
      'ì œíœ´ëª°': 'ì œíœ´ëª°',
      'ì˜¨ë¼ì¸ìì‚¬': 'ìì‚¬ëª°',
      'ìì‚¬ëª°': 'ìì‚¬ëª°',
      'ì˜¨ë¼ì¸': 'ìì‚¬ëª°',
      'ìˆ˜ì¶œ': 'ìˆ˜ì¶œ'
    };
    
    // ì•„ì´í…œ í‚¤ ë§¤í•‘ (ë°ì´í„° í‚¤ â†’ í‘œì‹œëª…)
    const itemKeyMap = {
      // ì˜ë¥˜ ì¹´í…Œê³ ë¦¬
      'ë‹¹ì‹œì¦Œ': 'ë‹¹ì‹œì¦Œì˜ë¥˜',
      'ì°¨ì‹œì¦Œ': 'ì°¨ì‹œì¦Œì˜ë¥˜',
      'ê³¼ì‹œì¦Œ': 'ê³¼ì‹œì¦Œì˜ë¥˜',
      // ACC ì¹´í…Œê³ ë¦¬ (ë°ì´í„° í‚¤ â†’ í‘œì‹œëª…)
      'Shoes': 'ì‹ ë°œ',
      'Headwear': 'ê°€ë°©',
      'Cap': 'ëª¨ì',
      'Bag': 'ê°€ë°©', // í˜¹ì‹œ Bag í‚¤ë„ ìˆì„ ìˆ˜ ìˆìœ¼ë‹ˆ
      'ACC_etc': 'ê¸°íƒ€ACC',
      'ACC': 'ê¸°íƒ€ACC',
      'ê¸°íƒ€ACC': 'ê¸°íƒ€ACC',
      // í‘œì‹œëª…ìœ¼ë¡œ ì§ì ‘ ë§¤í•‘
      'ë‹¹ì‹œì¦Œì˜ë¥˜': 'ë‹¹ì‹œì¦Œì˜ë¥˜',
      'ì°¨ì‹œì¦Œì˜ë¥˜': 'ì°¨ì‹œì¦Œì˜ë¥˜',
      'ê³¼ì‹œì¦Œì˜ë¥˜': 'ê³¼ì‹œì¦Œì˜ë¥˜',
      'ì‹ ë°œ': 'ì‹ ë°œ',
      'ê°€ë°©': 'ê°€ë°©',
      'ëª¨ì': 'ëª¨ì'
    };
    
    // ë¸Œëœë“œë³„ ì±„ë„-ì•„ì´í…œ ë§¤ì¶œ ìƒì„¸ ë°ì´í„° (íŠ¸ë¦¬ë§µ ë“œë¦´ë‹¤ìš´ìš©) - ìµœì¢…ì±„ë„ëª… ì‚¬ìš©
    const channelItemSalesData = {
      'I': { // MLB KIDS
        'ê¸°íƒ€': { 'Acc_etc': 71850, 'Bag': 31090, 'Headwear': 187920, 'Shoes': 138500, 'ê³¼ì‹œì¦Œì˜ë¥˜': 640590, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 1740610 },
        'ëŒ€ë¦¬ì ': { 'Acc_etc': 3066380, 'Bag': 52048790, 'Headwear': 70906760, 'Shoes': 122850940, 'ê³¼ì‹œì¦Œì˜ë¥˜': 1737650, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 647585430 },
        'ë©´ì„¸ì ': { 'Acc_etc': 9493440, 'Bag': 71785770, 'Headwear': 208536820, 'Shoes': 49094000, 'ê³¼ì‹œì¦Œì˜ë¥˜': 1373000, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 377373000 },
        'ë°±í™”ì ': { 'Acc_etc': 17704810, 'Bag': 309370570, 'Headwear': 213772050, 'Shoes': 394011940, 'ê³¼ì‹œì¦Œì˜ë¥˜': 164331970, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 1982851910 },
        'ì‚¬ì…': { 'Acc_etc': 6949610, 'Bag': -64950, 'Headwear': 51516960, 'Shoes': 9969050, 'ê³¼ì‹œì¦Œì˜ë¥˜': 1380477890 },
        'ì œíœ´ëª°': { 'Acc_etc': 12714200, 'Bag': 11835000, 'Headwear': 61108000, 'Shoes': 141761940, 'ê³¼ì‹œì¦Œì˜ë¥˜': 75853490, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 699073160 },
        'ìì‚¬ëª°': { 'Acc_etc': 2814110, 'Bag': 4015280, 'Headwear': 17766200, 'Shoes': 44416780, 'ê³¼ì‹œì¦Œì˜ë¥˜': 12390560, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 254329750 },
        'ì§ì˜ì (ê°€ë‘)': { 'Acc_etc': 1400430, 'Bag': 3234000, 'Headwear': 18683340, 'Shoes': 14990960, 'ê³¼ì‹œì¦Œì˜ë¥˜': 1475000, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 81776060 },
        'ì§ì˜ëª°': { 'Acc_etc': 3418660, 'Bag': 5418370, 'Headwear': 55990400, 'Shoes': 58269100, 'ê³¼ì‹œì¦Œì˜ë¥˜': 3130960, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 216290810 }
      },
      'M': { // MLB
        'ê¸°íƒ€': { 'Acc_etc': 273280, 'Bag': 124000, 'Headwear': 1126000, 'Shoes': 1780990, 'ê³¼ì‹œì¦Œì˜ë¥˜': 1352000, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 5494000 },
        'ëŒ€ë¦¬ì ': { 'Acc_etc': 17859300, 'Bag': 152707820, 'Headwear': 2132571080, 'Shoes': 1187845070, 'ê³¼ì‹œì¦Œì˜ë¥˜': 134895010, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 2077764810 },
        'ë©´ì„¸ì ': { 'Acc_etc': 10917700, 'Bag': 353734650, 'Headwear': 7716959750, 'Shoes': 1613206900, 'ê³¼ì‹œì¦Œì˜ë¥˜': 121250580, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 1204148170 },
        'ë°±í™”ì ': { 'Acc_etc': 21562060, 'Bag': 962703160, 'Headwear': 2036653800, 'Shoes': 1601231230, 'ê³¼ì‹œì¦Œì˜ë¥˜': 112463110, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 2586454600 },
        'ì‚¬ì…': { 'Acc_etc': 1859210, 'Bag': 53454740, 'Headwear': 9295780, 'Shoes': 266500490, 'ê³¼ì‹œì¦Œì˜ë¥˜': 2707466670 },
        'ì œíœ´ëª°': { 'Acc_etc': 5886300, 'Bag': 37742000, 'Headwear': 887108220, 'Shoes': 315598480, 'ê³¼ì‹œì¦Œì˜ë¥˜': 34630000, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 587293990 },
        'ìì‚¬ëª°': { 'Acc_etc': 4254632, 'Bag': 39616384, 'Headwear': 368560394, 'Shoes': 173530809, 'ê³¼ì‹œì¦Œì˜ë¥˜': 20698230, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 371457659 },
        'ì§ì˜ì (ê°€ë‘)': { 'Acc_etc': 17653940, 'Bag': 92602910, 'Headwear': 1103128350, 'Shoes': 389390590, 'ê³¼ì‹œì¦Œì˜ë¥˜': 26739700, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 768505630 },
        'ì§ì˜ëª°': { 'Acc_etc': 2074730, 'Bag': 11994950, 'Headwear': 179785180, 'Shoes': 83792830, 'ê³¼ì‹œì¦Œì˜ë¥˜': 13769090, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 283439560 },
        'RF': { 'Acc_etc': 7969260, 'Bag': 107621010, 'Headwear': 802879500, 'Shoes': 407418540, 'ê³¼ì‹œì¦Œì˜ë¥˜': 19394480, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 681523800 }
      },
      'ST': { // SERGIO
        'ê¸°íƒ€': { 'Acc_etc': 15000, 'Bag': 0, 'Headwear': 0, 'Shoes': 58080, 'ê³¼ì‹œì¦Œì˜ë¥˜': 145150, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 0 },
        'ë©´ì„¸ì ': { 'Acc_etc': 2406120, 'Bag': 3221300, 'Headwear': 2255600, 'Shoes': 2182400, 'ê³¼ì‹œì¦Œì˜ë¥˜': 32084640, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 34243090, 'ì°¨ì‹œì¦Œì˜ë¥˜': 824300 },
        'ë°±í™”ì ': { 'Acc_etc': 367600, 'Bag': 1111900, 'Headwear': 525100, 'Shoes': 1405290, 'ê³¼ì‹œì¦Œì˜ë¥˜': 3759240, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 8547200, 'ì°¨ì‹œì¦Œì˜ë¥˜': 634500 },
        'ì•„ìš¸ë ›': { 'Acc_etc': 1765960, 'Bag': 7580620, 'Headwear': 4110660, 'Shoes': 3444640, 'ê³¼ì‹œì¦Œì˜ë¥˜': 125173350, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 5516990 },
        'ì œíœ´ëª°': { 'Acc_etc': 2366000, 'Bag': 5626700, 'Headwear': 3053000, 'Shoes': 28006300, 'ê³¼ì‹œì¦Œì˜ë¥˜': 205958110, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 24053000, 'ì°¨ì‹œì¦Œì˜ë¥˜': 1102000 },
        'ìì‚¬ëª°': { 'Acc_etc': 4862500, 'Bag': 11594940, 'Headwear': 8743870, 'Shoes': 15234110, 'ê³¼ì‹œì¦Œì˜ë¥˜': 88513750, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 102029000, 'ì°¨ì‹œì¦Œì˜ë¥˜': 3240780 },
        'ì§ì˜ì (ê°€ë‘)': { 'Acc_etc': 797700, 'Bag': 1810600, 'Headwear': 2617900, 'Shoes': 1269600, 'ê³¼ì‹œì¦Œì˜ë¥˜': 21580970, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 56290400, 'ì°¨ì‹œì¦Œì˜ë¥˜': 4017100 },
        'ì§ì˜ëª°': { 'Acc_etc': 2317640, 'Bag': 7229700, 'Headwear': 5602580, 'Shoes': 3813000, 'ê³¼ì‹œì¦Œì˜ë¥˜': 88698180, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 51693700, 'ì°¨ì‹œì¦Œì˜ë¥˜': 3840400 }
      },
      'V': { // DUVETICA
        'ê¸°íƒ€': { 'Bag': 0, 'Shoes': 0, 'ê³¼ì‹œì¦Œì˜ë¥˜': 453000, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 229680 },
        'ë°±í™”ì ': { 'Acc_etc': 6115300, 'Bag': 27074010, 'Headwear': 13397750, 'Shoes': 5980000, 'ê³¼ì‹œì¦Œì˜ë¥˜': 291684870, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 988206070 },
        'ì•„ìš¸ë ›': { 'Acc_etc': 429480, 'Bag': 4973300, 'Headwear': 5568640, 'Shoes': 6537900, 'ê³¼ì‹œì¦Œì˜ë¥˜': 907242650, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 25280500 },
        'ì œíœ´ëª°': { 'Acc_etc': 5574500, 'Bag': 22305500, 'Headwear': 11336800, 'Shoes': 36691800, 'ê³¼ì‹œì¦Œì˜ë¥˜': 879062010, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 242398000 },
        'ìì‚¬ëª°': { 'Acc_etc': 629070, 'Bag': 5903170, 'Headwear': 1986710, 'Shoes': 5524600, 'ê³¼ì‹œì¦Œì˜ë¥˜': 81258820, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 118253540 },
        'ì§ì˜ì (ê°€ë‘)': { 'Acc_etc': 910000, 'Bag': 1480000, 'Headwear': 210000, 'ê³¼ì‹œì¦Œì˜ë¥˜': 961000, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 20132000 },
        'ì§ì˜ëª°': { 'Bag': 4438500, 'Headwear': 1267600, 'Shoes': 1768100, 'ê³¼ì‹œì¦Œì˜ë¥˜': 12201200, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 154262000 }
      },
      'W': { // SUPRA
        'ê¸°íƒ€': { 'Shoes': 70580, 'ê³¼ì‹œì¦Œì˜ë¥˜': 380460 },
        'ëŒ€ë¦¬ì ': { 'Bag': 371000, 'Headwear': 257000, 'ê³¼ì‹œì¦Œì˜ë¥˜': 133000 },
        'ì œíœ´ëª°': { 'Acc_etc': 117000, 'Bag': 3995000, 'Headwear': 3473000, 'Shoes': 9452000, 'ê³¼ì‹œì¦Œì˜ë¥˜': 130452990, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 38000 },
        'ìì‚¬ëª°': { 'Acc_etc': 103000, 'Bag': 2308800, 'Headwear': 4349790, 'Shoes': 5201632, 'ê³¼ì‹œì¦Œì˜ë¥˜': 92450170 }
      },
      'X': { // DISCOVERY
        'ê¸°íƒ€': { 'Acc_etc': 40310, 'Bag': 191630, 'Headwear': 82020, 'Shoes': 1973750, 'ê³¼ì‹œì¦Œì˜ë¥˜': 4390350, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 6022050 },
        'ëŒ€ë¦¬ì ': { 'Acc_etc': 44048620, 'Bag': 304235220, 'Headwear': 164147810, 'Shoes': 976777330, 'ê³¼ì‹œì¦Œì˜ë¥˜': 2663278400, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 8202507240 },
        'ë©´ì„¸ì ': { 'Acc_etc': 1921480, 'Bag': 84710930, 'Headwear': 7850290, 'Shoes': 165922970, 'ê³¼ì‹œì¦Œì˜ë¥˜': 15463590, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 961895850 },
        'ë°±í™”ì ': { 'Acc_etc': 31200940, 'Bag': 295956680, 'Headwear': 64365970, 'Shoes': 811087930, 'ê³¼ì‹œì¦Œì˜ë¥˜': 3608324580, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 4289795870 },
        'ì‚¬ì…': { 'Acc_etc': 350, 'Bag': 7950, 'Headwear': 8600, 'Shoes': 4212000, 'ê³¼ì‹œì¦Œì˜ë¥˜': 298130650 },
        'ì•„ìš¸ë ›': { 'Acc_etc': 12970520, 'Bag': 203146330, 'Headwear': 46073020, 'Shoes': 395684220, 'ê³¼ì‹œì¦Œì˜ë¥˜': 9298718550, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 725062240 },
        'ì œíœ´ëª°': { 'Acc_etc': 61454140, 'Bag': 128956890, 'Headwear': 14492800, 'Shoes': 392638120, 'ê³¼ì‹œì¦Œì˜ë¥˜': 2205004150, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 1124906670 },
        'ìì‚¬ëª°': { 'Acc_etc': 8020248, 'Bag': 40610799, 'Headwear': 8832710, 'Shoes': 251932187, 'ê³¼ì‹œì¦Œì˜ë¥˜': 93298259, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 1081913390 },
        'ì§ì˜ì (ê°€ë‘)': { 'Acc_etc': 1668710, 'Bag': 12912480, 'Headwear': 11362590, 'Shoes': 30872010, 'ê³¼ì‹œì¦Œì˜ë¥˜': 8006050, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 281260630 },
        'ì§ì˜ëª°': { 'Acc_etc': 1791870, 'Bag': 21465200, 'Headwear': 7708430, 'Shoes': 80686080, 'ê³¼ì‹œì¦Œì˜ë¥˜': 88766170, 'ë‹¹ì‹œì¦Œì˜ë¥˜': 687550840 }
      }
    };
    
    // -------- íŠ¸ë¦¬ë§µ ì´ˆê¸°í™” (ì±„ë„ë³„/ì•„ì´í…œë³„ ë¶„ë¦¬) --------
    function initTreemap() {
      // ì±„ë„ë³„ íŠ¸ë¦¬ë§µ ì—…ë°ì´íŠ¸ (ë™ì‹œì— ì—…ë°ì´íŠ¸í•˜ì—¬ í¬ê¸° ë™ê¸°í™”)
      setTimeout(() => {
        updateChannelTreemap();
        updateItemTreemap();
      }, 100);
      
      // ë“œë¦´ë°± ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      const drillbackChannelBtn = document.getElementById('treemapDrillbackChannel');
      const drillbackItemBtn = document.getElementById('treemapDrillbackItem');
      
      if (drillbackChannelBtn && !drillbackChannelBtn.hasAttribute('data-listener')) {
        drillbackChannelBtn.setAttribute('data-listener', 'true');
        drillbackChannelBtn.addEventListener('click', () => {
          if (channelTreemapPath.length > 0) {
            channelTreemapPath.pop();
            updateChannelTreemap();
          }
        });
      }
      
      if (drillbackItemBtn && !drillbackItemBtn.hasAttribute('data-listener')) {
        drillbackItemBtn.setAttribute('data-listener', 'true');
        drillbackItemBtn.addEventListener('click', () => {
          if (itemTreemapPath.length > 0) {
            itemTreemapPath.pop();
            updateItemTreemap();
          }
        });
      }
    }
    
    // -------- íŠ¸ë¦¬ë§µ í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ --------
    function attachTreemapClickEvent(container, type) {
      if (!container || !window.Plotly) return;
      
      // ê¸°ì¡´ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì œê±° ì‹œë„
      try {
        if (typeof container.removeAllListeners === 'function') {
          container.removeAllListeners('plotly_click');
        }
      } catch(e) {
        // removeAllListenersê°€ ì—†ìœ¼ë©´ ë¬´ì‹œ
      }
      
      // ìƒˆ í´ë¦­ í•¸ë“¤ëŸ¬ ìƒì„±
      const clickHandler = function(data) {
        if (!data || !data.points || data.points.length === 0) return;
        
        const point = data.points[0];
        if (!point || !point.label) return;
        
        const label = point.label;
        const parent = point.parent || '';
        
        console.log('íŠ¸ë¦¬ë§µ í´ë¦­:', {type, label, parent, pathLength: type === 'channel' ? channelTreemapPath.length : itemTreemapPath.length, pointData: point});
        
        // ë“œë¦´ë‹¤ìš´ ìƒíƒœ í™•ì¸
        const isDrilldown = (type === 'channel' && channelTreemapPath.length > 0) || (type === 'item' && itemTreemapPath.length > 0);
        
        // ë“œë¦´ë‹¤ìš´ ìƒíƒœê°€ ì•„ë‹ ë•Œ: ë¶€ëª¨ê°€ ì—†ëŠ” í•­ëª©(ìµœìƒìœ„ í•­ëª©)ë§Œ í´ë¦­ ê°€ëŠ¥
        if (!isDrilldown) {
          if (parent && parent !== '') {
            console.log('í•˜ìœ„ í•­ëª© í´ë¦­ ë¬´ì‹œ (ë“œë¦´ë‹¤ìš´ ì•„ë‹˜):', label);
            return;
          }
        }
        
        if (type === 'channel') {
          // ì±„ë„ í´ë¦­ ì‹œ: ì•„ì´í…œë³„ë¡œ ë“œë¦´ë‹¤ìš´
          console.log('ì±„ë„ ì²´í¬:', {label, inList: channelList.includes(label), pathLength: channelTreemapPath.length, isDrilldown, parent});
          
          // ìµœìƒìœ„ ë ˆë²¨ì—ì„œ ì±„ë„ í´ë¦­ (ë¶€ëª¨ê°€ ì—†ê³ , ë“œë¦´ë‹¤ìš´ ê²½ë¡œê°€ ë¹„ì–´ìˆì„ ë•Œ)
          if (channelTreemapPath.length === 0 && (!parent || parent === '') && channelList.includes(label)) {
            console.log('ì±„ë„ ë“œë¦´ë‹¤ìš´ ì‹¤í–‰:', label);
            channelTreemapPath.push(label);
            updateChannelTreemap();
          }
        } else if (type === 'item') {
          // ì•„ì´í…œ í´ë¦­ ì‹œ: ì±„ë„ë³„ë¡œ ë“œë¦´ë‹¤ìš´
          console.log('ì•„ì´í…œ ì²´í¬:', {label, inList: itemList.includes(label), pathLength: itemTreemapPath.length, parent});
          
          // ìµœìƒìœ„ ë ˆë²¨ì—ì„œ ì•„ì´í…œ í´ë¦­ (ë¶€ëª¨ê°€ ì—†ê³ , ë“œë¦´ë‹¤ìš´ ê²½ë¡œê°€ ë¹„ì–´ìˆì„ ë•Œ)
          if (itemTreemapPath.length === 0 && (!parent || parent === '') && itemList.includes(label)) {
            console.log('ì•„ì´í…œ ë“œë¦´ë‹¤ìš´ ì‹¤í–‰:', label);
            itemTreemapPath.push(label);
            updateItemTreemap();
          }
        }
      };
      
      // Plotly í´ë¦­ ì´ë²¤íŠ¸ ë“±ë¡
      container.on('plotly_click', clickHandler);
    }
    
    // -------- ì±„ë„ë³„ íŠ¸ë¦¬ë§µ ì—…ë°ì´íŠ¸ --------
    function updateChannelTreemap() {
      const container = document.getElementById('treemapWrapperChannel');
      if (!container) return;
      
      const data = getChannelTreemapData();
      
      // ë°ì´í„°ê°€ ë¹„ì–´ìˆê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ë“œë¦´ë‹¤ìš´ ì·¨ì†Œ
      if (!data || data.length === 0 || !data[0] || !data[0].labels || data[0].labels.length === 0) {
        console.error('ì±„ë„ íŠ¸ë¦¬ë§µ ë°ì´í„° ì—†ìŒ, ë“œë¦´ë‹¤ìš´ ì·¨ì†Œ');
        if (channelTreemapPath.length > 0) {
          channelTreemapPath.pop(); // ê²½ë¡œ ë˜ëŒë¦¬ê¸°
        }
        return;
      }
      
      console.log('ì±„ë„ íŠ¸ë¦¬ë§µ ì—…ë°ì´íŠ¸:', {
        labels: data[0].labels, 
        values: data[0].values,
        parents: data[0].parents,
        ids: data[0].ids
      });
      
      const layout = { 
        margin:{ l:0, r:0, t:0, b:0 }, 
        paper_bgcolor:'rgba(0,0,0,0)', 
        plot_bgcolor:'rgba(0,0,0,0)', 
        font:{ size:14, weight:600 }
      };
      const config = { responsive:true, displayModeBar:false };
      
      // ìì—°ìŠ¤ëŸ¬ìš´ ì „í™˜ íš¨ê³¼: í˜ì´ë“œì•„ì›ƒ + ì¤Œì•„ì›ƒ
      container.style.opacity = '0';
      container.style.transform = 'scale(0.9)';
      container.style.transition = 'opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1), transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
      container.style.filter = 'blur(5px)';
      
      // ê¸°ì¡´ ì°¨íŠ¸ ì™„ì „íˆ ì œê±°í•˜ê³  ìƒˆë¡œ ê·¸ë¦¬ê¸°
      setTimeout(() => {
        try {
          if (window.Plotly) {
            // ê¸°ì¡´ ì°¨íŠ¸ ì •ë¦¬
            window.Plotly.purge(container);
          }
        } catch(e) {
          console.warn('ì°¨íŠ¸ ì •ë¦¬ ì‹¤íŒ¨:', e);
        }
        
        try{
          if (window.Plotly && typeof window.Plotly.newPlot === 'function'){
            window.Plotly.newPlot(container, data, layout, config).then(() => {
              // í˜ì´ë“œì¸ + ì¤Œì¸ íš¨ê³¼ (ë¸”ëŸ¬ ì œê±° í¬í•¨)
              setTimeout(() => {
                container.style.opacity = '1';
                container.style.transform = 'scale(1)';
                container.style.filter = 'blur(0px)';
              }, 50);
              // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
              attachTreemapClickEvent(container, 'channel');
            }).catch(err => {
              console.error('Channel Treemap render failed:', err);
              container.style.opacity = '1';
              container.style.transform = 'scale(1)';
              container.style.filter = 'blur(0px)';
            });
          }
          if (!charts.treemapChannel) {
            charts.treemapChannel = { type:'plotly', container };
          }
        }catch(err){ 
          console.error('Channel Treemap render failed', err);
          container.style.opacity = '1';
          container.style.transform = 'scale(1)';
          container.style.filter = 'blur(0px)';
        }
      }, 200);  // í˜ì´ë“œì•„ì›ƒ í›„ ì°¨íŠ¸ ê·¸ë¦¬ê¸°
      
      // ë“œë¦´ë°± ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€ ë° ì œëª© ì—…ë°ì´íŠ¸
      const drillbackBtn = document.getElementById('treemapDrillbackChannel');
      const titleElement = document.getElementById('treemapTitleChannel');
      
      if (drillbackBtn) {
        drillbackBtn.style.display = channelTreemapPath.length > 0 ? 'block' : 'none';
      }
      
      if (titleElement) {
        if (channelTreemapPath.length > 0) {
          titleElement.textContent = `ì±„ë„ë³„ ë§¤ì¶œêµ¬ì„± > ${channelTreemapPath[0]} (ì•„ì´í…œë³„)`;
        } else {
          titleElement.textContent = 'ì±„ë„ë³„ ë§¤ì¶œêµ¬ì„±';
        }
      }
    }
    
    // -------- ì•„ì´í…œë³„ íŠ¸ë¦¬ë§µ ì—…ë°ì´íŠ¸ --------
    function updateItemTreemap() {
      const container = document.getElementById('treemapWrapperItem');
      if (!container) return;
      
      const data = getItemTreemapData();
      
      // ë°ì´í„°ê°€ ë¹„ì–´ìˆê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šìœ¼ë©´ ë“œë¦´ë‹¤ìš´ ì·¨ì†Œ
      if (!data || data.length === 0 || !data[0] || !data[0].labels || data[0].labels.length === 0) {
        console.error('ì•„ì´í…œ íŠ¸ë¦¬ë§µ ë°ì´í„° ì—†ìŒ, ë“œë¦´ë‹¤ìš´ ì·¨ì†Œ');
        if (itemTreemapPath.length > 0) {
          itemTreemapPath.pop(); // ê²½ë¡œ ë˜ëŒë¦¬ê¸°
        }
        return;
      }
      
      console.log('ì•„ì´í…œ íŠ¸ë¦¬ë§µ ì—…ë°ì´íŠ¸:', {
        labels: data[0].labels, 
        values: data[0].values,
        parents: data[0].parents,
        ids: data[0].ids
      });
      
      const layout = { 
        margin:{ l:0, r:0, t:0, b:0 }, 
        paper_bgcolor:'rgba(0,0,0,0)', 
        plot_bgcolor:'rgba(0,0,0,0)', 
        font:{ size:14, weight:600 }
      };
      const config = { responsive:true, displayModeBar:false };
      
      // ìì—°ìŠ¤ëŸ¬ìš´ ì „í™˜ íš¨ê³¼: í˜ì´ë“œì•„ì›ƒ + ì¤Œì•„ì›ƒ
      container.style.opacity = '0';
      container.style.transform = 'scale(0.9)';
      container.style.transition = 'opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1), transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
      container.style.filter = 'blur(5px)';
      
      // ê¸°ì¡´ ì°¨íŠ¸ ì™„ì „íˆ ì œê±°í•˜ê³  ìƒˆë¡œ ê·¸ë¦¬ê¸°
      setTimeout(() => {
        try {
          if (window.Plotly) {
            // ê¸°ì¡´ ì°¨íŠ¸ ì •ë¦¬
            window.Plotly.purge(container);
          }
        } catch(e) {
          console.warn('ì°¨íŠ¸ ì •ë¦¬ ì‹¤íŒ¨:', e);
        }
        
        try{
          if (window.Plotly && typeof window.Plotly.newPlot === 'function'){
            window.Plotly.newPlot(container, data, layout, config).then(() => {
              // í˜ì´ë“œì¸ + ì¤Œì¸ íš¨ê³¼ (ë¸”ëŸ¬ ì œê±° í¬í•¨)
              setTimeout(() => {
                container.style.opacity = '1';
                container.style.transform = 'scale(1)';
                container.style.filter = 'blur(0px)';
              }, 50);
              // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
              attachTreemapClickEvent(container, 'item');
            }).catch(err => {
              console.error('Item Treemap render failed:', err);
              container.style.opacity = '1';
              container.style.transform = 'scale(1)';
              container.style.filter = 'blur(0px)';
            });
          }
          if (!charts.treemapItem) {
            charts.treemapItem = { type:'plotly', container };
          }
        }catch(err){ 
          console.error('Item Treemap render failed', err);
          container.style.opacity = '1';
          container.style.transform = 'scale(1)';
          container.style.filter = 'blur(0px)';
        }
      }, 200);  // í˜ì´ë“œì•„ì›ƒ í›„ ì°¨íŠ¸ ê·¸ë¦¬ê¸°
      
      // ë“œë¦´ë°± ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€ ë° ì œëª© ì—…ë°ì´íŠ¸
      const drillbackBtn = document.getElementById('treemapDrillbackItem');
      const titleElement = document.getElementById('treemapTitleItem');
      
      if (drillbackBtn) {
        drillbackBtn.style.display = itemTreemapPath.length > 0 ? 'block' : 'none';
      }
      
      if (titleElement) {
        if (itemTreemapPath.length > 0) {
          titleElement.textContent = `ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„± > ${itemTreemapPath[0]} (ì±„ë„ë³„)`;
        } else {
          titleElement.textContent = 'ì•„ì´í…œë³„ ë§¤ì¶œêµ¬ì„±';
        }
      }
    }
    
    // -------- ì „ì²´í˜„í™© íŠ¸ë¦¬ë§µ ë°ì´í„° (ëª¨ë“  ë¸Œëœë“œ í•©ì‚°) --------
    function getOverviewChannelTreemapData() {
      const channelItemSalesData = getChannelItemSalesData();
      if (!channelItemSalesData || Object.keys(channelItemSalesData).length === 0) return [];
      
      const labels = [];
      const values = [];
      const parents = [];
      const ids = [];
      
      // ëª¨ë“  ë¸Œëœë“œì˜ ì±„ë„ë³„ ë§¤ì¶œ í•©ê³„ ê³„ì‚°
      const channelTotals = {};
      Object.keys(channelItemSalesData).forEach(brandCode => {
        const brandSalesData = channelItemSalesData[brandCode];
        if (!brandSalesData) return;
        
        Object.keys(brandSalesData).forEach(channelKey => {
          const channelItems = brandSalesData[channelKey];
          let channelTotal = 0;
          Object.values(channelItems).forEach(value => {
            if (value > 0) channelTotal += value;
          });
          if (channelTotal > 0) {
            const mappedChannel = channelNameToFinal[channelKey] || channelKey;
            if (!channelTotals[mappedChannel]) channelTotals[mappedChannel] = 0;
            channelTotals[mappedChannel] += channelTotal;
          }
        });
      });
      
      // ì±„ë„ì„ ë§¤ì¶œìˆœìœ¼ë¡œ ì •ë ¬ (ë‚´ë¦¼ì°¨ìˆœ)
      const sortedChannels = Object.keys(channelTotals)
        .map(channel => ({ channel, value: channelTotals[channel] || 0 }))
        .filter(item => item.value > 0)
        .sort((a, b) => b.value - a.value);
      
      // ì „ì²´ ë§¤ì¶œ í•©ê³„ ê³„ì‚°
      const totalValue = sortedChannels.reduce((sum, item) => sum + item.value, 0);
      
      // ì •ë ¬ëœ ìˆœì„œëŒ€ë¡œ ë°ì´í„° ì¶”ê°€
      const customText = [];
      const customDataArray = [];
      sortedChannels.forEach((item, index) => {
        const percentage = totalValue > 0 ? ((item.value / totalValue) * 100).toFixed(1) : 0;
        labels.push(item.channel);
        values.push(item.value / 100000000);
        parents.push('');
        ids.push(`overview-channel-${index}`);
        customDataArray.push([percentage, 0]);
        customText.push(`<b style="font-size:15px;color:white;">${item.channel}</b><br><span style="font-size:13px;color:white;">${(item.value / 100000000).toFixed(1)}ì–µì› (${percentage}%)</span>`);
      });
      
      return [{
        type: 'treemap',
        labels: labels,
        values: values,
        parents: parents,
        ids: ids,
        text: customText,
        textinfo: 'text',
        hovertemplate: '%{label}<br>ë§¤ì¶œ : %{value:.1f}ì–µ<br>ë¹„ì¤‘ : %{customdata[0]:.1f}%<extra></extra>',
        customdata: customDataArray,
        textfont: { size: 14 },
        marker: {
          colors: [
            'rgba(79,70,229,0.8)', 'rgba(124,58,237,0.8)', 'rgba(59,130,246,0.8)', 
            'rgba(16,185,129,0.8)', 'rgba(245,158,11,0.8)', 'rgba(239,68,68,0.8)',
            'rgba(168,85,247,0.8)', 'rgba(34,197,94,0.8)', 'rgba(251,146,60,0.8)', 
            'rgba(244,63,94,0.8)'
          ]
        }
      }];
    }
    
    function getOverviewItemTreemapData() {
      const channelItemSalesData = getChannelItemSalesData();
      if (!channelItemSalesData || Object.keys(channelItemSalesData).length === 0) return [];
      
      const labels = [];
      const values = [];
      const parents = [];
      const ids = [];
      
      // ëª¨ë“  ë¸Œëœë“œì˜ ì•„ì´í…œë³„ ë§¤ì¶œ í•©ê³„ ê³„ì‚°
      const itemTotals = {};
      Object.keys(channelItemSalesData).forEach(brandCode => {
        const brandSalesData = channelItemSalesData[brandCode];
        if (!brandSalesData) return;
        
        Object.keys(brandSalesData).forEach(channelKey => {
          const channelItems = brandSalesData[channelKey];
          Object.keys(channelItems).forEach(itemKey => {
            const itemValue = channelItems[itemKey];
            if (itemValue > 0) {
              if (!itemTotals[itemKey]) itemTotals[itemKey] = 0;
              itemTotals[itemKey] += itemValue;
            }
          });
        });
      });
      
      // ì•„ì´í…œì„ ë§¤ì¶œìˆœìœ¼ë¡œ ì •ë ¬ (ë‚´ë¦¼ì°¨ìˆœ)
      const sortedItems = Object.keys(itemTotals)
        .map(item => ({ item, value: itemTotals[item] || 0 }))
        .filter(item => item.value > 0)
        .sort((a, b) => b.value - a.value);
      
      // ì „ì²´ ë§¤ì¶œ í•©ê³„ ê³„ì‚°
      const totalValue = sortedItems.reduce((sum, item) => sum + item.value, 0);
      
      // ì •ë ¬ëœ ìˆœì„œëŒ€ë¡œ ë°ì´í„° ì¶”ê°€
      const customText = [];
      const customDataArray = [];
      sortedItems.forEach((item, index) => {
        const percentage = totalValue > 0 ? ((item.value / totalValue) * 100).toFixed(1) : 0;
        labels.push(item.item);
        values.push(item.value / 100000000);
        parents.push('');
        ids.push(`overview-item-${index}`);
        customDataArray.push([percentage, 0]);
        customText.push(`<b style="font-size:15px;color:white;">${item.item}</b><br><span style="font-size:13px;color:white;">${(item.value / 100000000).toFixed(1)}ì–µì› (${percentage}%)</span>`);
      });
      
      return [{
        type: 'treemap',
        labels: labels,
        values: values,
        parents: parents,
        ids: ids,
        text: customText,
        textinfo: 'text',
        hovertemplate: '%{label}<br>ë§¤ì¶œ : %{value:.1f}ì–µ<br>ë¹„ì¤‘ : %{customdata[0]:.1f}%<extra></extra>',
        customdata: customDataArray,
        textfont: { size: 14 },
        marker: {
          colors: [
            'rgba(79,70,229,0.8)', 'rgba(124,58,237,0.8)', 'rgba(59,130,246,0.8)', 'rgba(16,185,129,0.8)',
            'rgba(245,158,11,0.8)', 'rgba(239,68,68,0.8)', 'rgba(168,85,247,0.8)'
          ]
        }
      }];
    }
    
    // -------- ì „ì²´í˜„í™© íŠ¸ë¦¬ë§µ ì´ˆê¸°í™” --------
    function initOverviewTreemap() {
      const channelWrapper = document.getElementById('overviewTreemapWrapperChannel');
      const itemWrapper = document.getElementById('overviewTreemapWrapperItem');
      const channelContainer = document.getElementById('overviewTreemapContainerChannel');
      const itemContainer = document.getElementById('overviewTreemapContainerItem');
      
      if (!channelWrapper || !itemWrapper || !channelContainer || !itemContainer) {
        console.warn('ì „ì²´í˜„í™© íŠ¸ë¦¬ë§µ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      
      // ë°ì´í„°ê°€ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸
      const channelItemSalesData = getChannelItemSalesData();
      if (!channelItemSalesData || Object.keys(channelItemSalesData).length === 0) {
        console.warn('ì „ì²´í˜„í™© íŠ¸ë¦¬ë§µ ë°ì´í„°ê°€ ì•„ì§ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•©ë‹ˆë‹¤.');
        setTimeout(() => {
          initOverviewTreemap();
        }, 500);
        return;
      }
      
      // ë‘ ì»¨í…Œì´ë„ˆì˜ ë°°ê²½ í¬ê¸°ë¥¼ ë™ì¼í•˜ê²Œ ë§ì¶”ê¸°
      const syncContainerHeights = () => {
        const channelRect = channelContainer.getBoundingClientRect();
        const itemRect = itemContainer.getBoundingClientRect();
        
        // ë‘ ì»¨í…Œì´ë„ˆ ì¤‘ ë” í° ë†’ì´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë™ì¼í•˜ê²Œ ì„¤ì •
        const maxHeight = Math.max(channelRect.height, itemRect.height);
        channelContainer.style.height = `${maxHeight}px`;
        itemContainer.style.height = `${maxHeight}px`;
      };
      
      // wrapper í¬ê¸°ë¥¼ ê°€ì ¸ì™€ì„œ íŠ¸ë¦¬ë§µ í¬ê¸° ì„¤ì • (Dashboard_demo.htmlê³¼ ë™ì¼í•˜ê²Œ)
      const getContainerSize = () => {
        const itemRect = container.getBoundingClientRect();
        const channelRect = channelContainer ? channelContainer.getBoundingClientRect() : null;
        
        // ë‘ ì»¨í…Œì´ë„ˆ ì¤‘ ì‘ì€ í¬ê¸°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë™ì¼í•˜ê²Œ ì„¤ì •
        let width = itemRect.width;
        let height = itemRect.height;
        
        if (channelRect) {
          width = Math.min(width, channelRect.width);
          height = Math.min(height, channelRect.height);
        }
        
        return { width, height };
      };
      
      // DOMì´ ì™„ì „íˆ ë Œë”ë§ëœ í›„ í¬ê¸° ê³„ì‚°
      setTimeout(() => {
        // ë¨¼ì € ì»¨í…Œì´ë„ˆ ë†’ì´ ë™ê¸°í™”
        syncContainerHeights();
        
        // ì™¸ë¶€ ì»¨í…Œì´ë„ˆ í¬ê¸° ê³„ì‚° (íŠ¸ë¦¬ë§µ í¬ê¸°ëŠ” ì™¸ë¶€ ì»¨í…Œì´ë„ˆì— ë§ì¶¤)
        const containerSize = getContainerSize();
        // wrapper ë‚´ë¶€ ì—¬ë°±ì„ ê³ ë ¤í•˜ì—¬ í¬ê¸° ì¡°ì •
        const padding = 28; // padding 14px * 2
        const titleHeight = 40; // ì œëª© ë†’ì´
        const buttonHeight = 0; // ë²„íŠ¼ì´ ì—†ìœ¼ë©´ 0, ìˆìœ¼ë©´ ì¶”ê°€
        const width = containerSize.width - padding;
        const height = containerSize.height - padding - titleHeight - buttonHeight;
        
        // ì±„ë„ë³„ íŠ¸ë¦¬ë§µ
        const channelData = getOverviewChannelTreemapData();
        if (channelData && channelData.length > 0 && channelData[0].labels && channelData[0].labels.length > 0) {
          const channelLayout = { 
            width: width,
            height: height,
            margin:{ l:0, r:0, t:0, b:0 }, 
            paper_bgcolor:'rgba(0,0,0,0)', 
            plot_bgcolor:'rgba(0,0,0,0)', 
            font:{ size:14, weight:600 }
          };
          const channelConfig = { responsive:false, displayModeBar:false };
          
          if (window.Plotly) {
            window.Plotly.purge(channelWrapper);
            window.Plotly.newPlot(channelWrapper, channelData, channelLayout, channelConfig);
          }
        }
        
        // ì•„ì´í…œë³„ íŠ¸ë¦¬ë§µ
        const itemData = getOverviewItemTreemapData();
        if (itemData && itemData.length > 0 && itemData[0].labels && itemData[0].labels.length > 0) {
          const itemLayout = { 
            width: width,
            height: height,
            margin:{ l:0, r:0, t:0, b:0 }, 
            paper_bgcolor:'rgba(0,0,0,0)', 
            plot_bgcolor:'rgba(0,0,0,0)', 
            font:{ size:14, weight:600 }
          };
          const itemConfig = { responsive:false, displayModeBar:false };
          
          if (window.Plotly) {
            window.Plotly.purge(itemWrapper);
            window.Plotly.newPlot(itemWrapper, itemData, itemLayout, itemConfig);
          }
        }
      }, 200);
    }
    
    // -------- íŠ¸ë¦¬ë§µ ë°ì´í„° ìƒì„± --------
    function getTreemapData() {
      // ë“œë¦´ë‹¤ìš´ì´ ì—†ëŠ” ê²½ìš°
      if (treemapCurrentPath.length === 0) {
        if (treemapCurrentType === 'channel') {
          return getChannelTreemapData();
        } else {
          return getItemTreemapData();
        }
      }
      
      // ë“œë¦´ë‹¤ìš´ì´ ìˆëŠ” ê²½ìš°
      const path = treemapCurrentPath[treemapCurrentPath.length - 1];
      return getTreemapDrilldownData(treemapCurrentType, path);
    }
    
    // -------- ì±„ë„ íŠ¸ë¦¬ë§µ ë°ì´í„° --------
    function getChannelTreemapData() {
      // ë“œë¦´ë‹¤ìš´ì´ ìˆëŠ” ê²½ìš° (íŠ¹ì • ì±„ë„ì˜ ì•„ì´í…œë³„ ë°ì´í„°)
      if (channelTreemapPath.length > 0) {
        return getChannelDrilldownData(channelTreemapPath[channelTreemapPath.length - 1]);
      }
      
      // ë¸Œëœë“œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
      const brandCode = brandCodeMap[currentBrand] || brandCodeMap[currentBrand.replace('_', ' ')] || 'M';
      const brandSalesData = channelItemSalesData[brandCode];
      
      if (!brandSalesData) return [];
      
      const labels = [];
      const values = [];
      const parents = [];
      const ids = [];
      
      // ì±„ë„ë³„ ë§¤ì¶œ í•©ê³„ ê³„ì‚°
      const channelTotals = {};
      Object.keys(brandSalesData).forEach(channelKey => {
        const channelItems = brandSalesData[channelKey];
        let channelTotal = 0;
        Object.values(channelItems).forEach(value => {
          if (value > 0) channelTotal += value;
        });
        if (channelTotal > 0) {
          // ì±„ë„ëª…ì€ ì´ë¯¸ ìµœì¢…ì±„ë„ëª…ìœ¼ë¡œ ë˜ì–´ ìˆìŒ
          const mappedChannel = channelNameToFinal[channelKey] || channelKey;
          
          if (!channelTotals[mappedChannel]) channelTotals[mappedChannel] = 0;
          channelTotals[mappedChannel] += channelTotal;
        }
      });
      
      // ì „ì²´ ì±„ë„ ëª©ë¡ (MLBì˜ ê²½ìš° RF í¬í•¨)
      let allChannels = [...channelList];
      if (brandCode === 'M' && brandSalesData['RF']) {
        allChannels.push('RF');
      }
      
      // ì±„ë„ì„ ë§¤ì¶œìˆœìœ¼ë¡œ ì •ë ¬ (ë‚´ë¦¼ì°¨ìˆœ)
      const sortedChannels = allChannels
        .map(channel => ({ channel, value: channelTotals[channel] || 0 }))
        .filter(item => item.value > 0)
        .sort((a, b) => b.value - a.value);
      
      // ì „ì²´ ë§¤ì¶œ í•©ê³„ ê³„ì‚°
      const totalValue = sortedChannels.reduce((sum, item) => sum + item.value, 0);
      
      // ì •ë ¬ëœ ìˆœì„œëŒ€ë¡œ ë°ì´í„° ì¶”ê°€
      const customText = [];
      sortedChannels.forEach((item, index) => {
        const percentage = totalValue > 0 ? ((item.value / totalValue) * 100).toFixed(1) : 0;
        labels.push(item.channel);
        values.push(item.value / 100000000); // ì› ë‹¨ìœ„ë¥¼ ì–µì›ìœ¼ë¡œ ë³€í™˜
          parents.push('');
          ids.push(`channel-${index}`);
        customText.push(`<b style="font-size:15px;color:white;">${item.channel}</b><br><span style="font-size:13px;color:white;">${(item.value / 100000000).toFixed(1)}ì–µì› (${percentage}%)</span>`);
      });
      
      return [{
        type: 'treemap',
        labels: labels,
        values: values,
        parents: parents,
        ids: ids,
        text: customText,
        textinfo: 'text',
        hovertemplate: '<b style="font-size:14px;">%{label}</b><br>ë§¤ì¶œ: %{value:.1f}ì–µì›<br>ë¹„ì¤‘: %{customdata:.1f}%<extra></extra>',
        customdata: sortedChannels.map(item => totalValue > 0 ? ((item.value / totalValue) * 100) : 0),
        textfont: { size: 14 },
        marker: {
          colors: [
            'rgba(79,70,229,0.8)', 'rgba(124,58,237,0.8)', 'rgba(59,130,246,0.8)', 
            'rgba(16,185,129,0.8)', 'rgba(245,158,11,0.8)', 'rgba(239,68,68,0.8)',
            'rgba(168,85,247,0.8)', 'rgba(34,197,94,0.8)', 'rgba(251,146,60,0.8)', 
            'rgba(244,63,94,0.8)'
          ]
        }
      }];
    }
    
    // -------- ì•„ì´í…œ íŠ¸ë¦¬ë§µ ë°ì´í„° --------
    function getItemTreemapData() {
      // ë“œë¦´ë‹¤ìš´ì´ ìˆëŠ” ê²½ìš° (íŠ¹ì • ì•„ì´í…œì˜ ì±„ë„ë³„ ë°ì´í„°)
      if (itemTreemapPath.length > 0) {
        return getItemDrilldownData(itemTreemapPath[itemTreemapPath.length - 1]);
      }
      
      // ë¸Œëœë“œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
      const brandCode = brandCodeMap[currentBrand] || brandCodeMap[currentBrand.replace('_', ' ')] || 'M';
      const brandSalesData = channelItemSalesData[brandCode];
      
      if (!brandSalesData) {
        // í´ë°± ë°ì´í„°
        const labels = ['ë‹¹ì‹œì¦Œì˜ë¥˜', 'ê³¼ì‹œì¦Œì˜ë¥˜', 'ì°¨ì‹œì¦Œì˜ë¥˜', 'ëª¨ì', 'ì‹ ë°œ', 'ê°€ë°©', 'ê¸°íƒ€ACC'];
        const values = [48.3, 27.9, 36.8, 0, 0, 0, 160.7];
        return [{
          type: 'treemap',
          labels: labels,
          values: values,
          parents: ['', '', '', '', '', '', ''],
          ids: labels.map((_, i) => `item-${i}`),
          textinfo: 'label+value',
          texttemplate: '<b style="font-size:15px;">%{label}</b><br><span style="font-size:14px;">%{value:.1f}ì–µì›</span>',
          hovertemplate: '<b style="font-size:14px;">%{label}</b><br>ë§¤ì¶œ: %{value:.1f}ì–µì›<extra></extra>',
          textfont: { size: 14 },
          marker: {
            colors: [
              'rgba(79,70,229,0.8)', 'rgba(124,58,237,0.8)', 'rgba(59,130,246,0.8)', 'rgba(16,185,129,0.8)',
              'rgba(245,158,11,0.8)', 'rgba(239,68,68,0.8)', 'rgba(168,85,247,0.8)'
            ]
          }
        }];
      }
      
      const labels = [];
      const values = [];
      const parents = [];
      const ids = [];
      
      // ì•„ì´í…œë³„ ë§¤ì¶œ í•©ê³„ ê³„ì‚°
      const itemTotals = {};
      Object.keys(brandSalesData).forEach(channelKey => {
        const channelItems = brandSalesData[channelKey];
        Object.entries(channelItems).forEach(([itemKey, value]) => {
          if (value > 0) {
            // ì•„ì´í…œ í‚¤ë¥¼ í‘œì‹œëª…ìœ¼ë¡œ ë§¤í•‘
            let itemDisplayName = itemKey;
            if (itemKey === 'Shoes') itemDisplayName = 'ì‹ ë°œ';
            else if (itemKey === 'Bag') itemDisplayName = 'ê°€ë°©';
            else if (itemKey === 'Headwear') itemDisplayName = 'ëª¨ì'; // HeadwearëŠ” ëª¨ìë¡œ ë§¤í•‘
            else if (itemKey === 'Cap') itemDisplayName = 'ëª¨ì';
            else if (itemKey === 'Acc_etc') itemDisplayName = 'ê¸°íƒ€ACC';
            else if (itemKey === 'ë‹¹ì‹œì¦Œì˜ë¥˜') itemDisplayName = 'ë‹¹ì‹œì¦Œì˜ë¥˜';
            else if (itemKey === 'ì°¨ì‹œì¦Œì˜ë¥˜') itemDisplayName = 'ì°¨ì‹œì¦Œì˜ë¥˜';
            else if (itemKey === 'ê³¼ì‹œì¦Œì˜ë¥˜') itemDisplayName = 'ê³¼ì‹œì¦Œì˜ë¥˜';
            
            if (!itemTotals[itemDisplayName]) itemTotals[itemDisplayName] = 0;
            itemTotals[itemDisplayName] += value;
          }
        });
      });
      
      // ì•„ì´í…œì„ ë§¤ì¶œìˆœìœ¼ë¡œ ì •ë ¬ (ë‚´ë¦¼ì°¨ìˆœ)
      const sortedItems = itemList
        .map(item => ({ item, value: itemTotals[item] || 0 }))
        .filter(obj => obj.value > 0)
        .sort((a, b) => b.value - a.value);
      
      // ì „ì²´ ë§¤ì¶œ í•©ê³„ ê³„ì‚°
      const totalItemValue = sortedItems.reduce((sum, obj) => sum + obj.value, 0);
      
      // ì •ë ¬ëœ ìˆœì„œëŒ€ë¡œ ë°ì´í„° ì¶”ê°€
      const customItemText = [];
      sortedItems.forEach((obj, index) => {
        const percentage = totalItemValue > 0 ? ((obj.value / totalItemValue) * 100).toFixed(1) : 0;
        labels.push(obj.item);
        values.push(obj.value / 100000000); // ì› ë‹¨ìœ„ë¥¼ ì–µì›ìœ¼ë¡œ ë³€í™˜
          parents.push('');
          ids.push(`item-${index}`);
        customItemText.push(`<b style="font-size:15px;color:white;">${obj.item}</b><br><span style="font-size:13px;color:white;">${(obj.value / 100000000).toFixed(1)}ì–µì› (${percentage}%)</span>`);
      });
      
      if (labels.length === 0) {
        // í´ë°± ë°ì´í„°
        const fallbackLabels = ['ë‹¹ì‹œì¦Œì˜ë¥˜', 'ê³¼ì‹œì¦Œì˜ë¥˜', 'ì°¨ì‹œì¦Œì˜ë¥˜', 'ëª¨ì', 'ì‹ ë°œ', 'ê°€ë°©', 'ê¸°íƒ€ACC'];
        const fallbackValues = [48.3, 27.9, 36.8, 0, 0, 0, 160.7];
        const fallbackTotal = fallbackValues.reduce((a, b) => a + b, 0);
        return [{
          type: 'treemap',
          labels: fallbackLabels,
          values: fallbackValues,
          parents: ['', '', '', '', '', '', ''],
          ids: fallbackLabels.map((_, i) => `item-${i}`),
          text: fallbackLabels.map((label, i) => {
            const pct = fallbackTotal > 0 ? ((fallbackValues[i] / fallbackTotal) * 100).toFixed(1) : 0;
            return `<b style="font-size:15px;color:white;">${label}</b><br><span style="font-size:13px;color:white;">${fallbackValues[i].toFixed(1)}ì–µì› (${pct}%)</span>`;
          }),
          textinfo: 'text',
          hovertemplate: '<b style="font-size:14px;">%{label}</b><br>ë§¤ì¶œ: %{value:.1f}ì–µì›<br>ë¹„ì¤‘: %{customdata:.1f}%<extra></extra>',
          customdata: fallbackValues.map(val => fallbackTotal > 0 ? ((val / fallbackTotal) * 100) : 0),
          textfont: { size: 14 },
          marker: {
            colors: [
              'rgba(79,70,229,0.8)', 'rgba(124,58,237,0.8)', 'rgba(59,130,246,0.8)', 'rgba(16,185,129,0.8)',
              'rgba(245,158,11,0.8)', 'rgba(239,68,68,0.8)', 'rgba(168,85,247,0.8)'
            ]
          }
        }];
      }
      
      return [{
        type: 'treemap',
        labels: labels,
        values: values,
        parents: parents,
        ids: ids,
        text: customItemText,
        textinfo: 'text',
        hovertemplate: '<b style="font-size:14px;">%{label}</b><br>ë§¤ì¶œ: %{value:.1f}ì–µì›<br>ë¹„ì¤‘: %{customdata:.1f}%<extra></extra>',
        customdata: sortedItems.map(obj => totalItemValue > 0 ? ((obj.value / totalItemValue) * 100) : 0),
        textfont: { size: 14 },
        marker: {
          colors: [
            'rgba(79,70,229,0.8)', 'rgba(124,58,237,0.8)', 'rgba(59,130,246,0.8)', 'rgba(16,185,129,0.8)',
            'rgba(245,158,11,0.8)', 'rgba(239,68,68,0.8)', 'rgba(168,85,247,0.8)'
          ]
        }
      }];
    }
    
    // -------- ì±„ë„ ë“œë¦´ë‹¤ìš´ ë°ì´í„° (ì±„ë„ ì„ íƒ ì‹œ ì•„ì´í…œë³„ë¡œ ë¶„ë¥˜) --------
    function getChannelDrilldownData(selectedChannel) {
      // ë¸Œëœë“œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
      const brandCode = brandCodeMap[currentBrand] || brandCodeMap[currentBrand.replace('_', ' ')] || 'M';
      const brandSalesData = channelItemSalesData[brandCode];
      
      console.log('ì±„ë„ ë“œë¦´ë‹¤ìš´ ë°ì´í„° ìš”ì²­:', {selectedChannel, brandCode, currentBrand, hasData: !!brandSalesData, availableChannels: brandSalesData ? Object.keys(brandSalesData) : []});
      
      if (!brandSalesData) {
        console.warn('ë¸Œëœë“œ ë°ì´í„° ì—†ìŒ:', brandCode);
        return [];
      }
      
      // ì±„ë„ëª…ì€ ì´ë¯¸ ìµœì¢…ì±„ë„ëª…ìœ¼ë¡œ ë˜ì–´ ìˆìŒ
      const labels = [];
      const values = [];
      const parents = [];
      const ids = [];
      const colors = [];
      
      // ì„ íƒëœ ì±„ë„ì˜ ì•„ì´í…œë³„ ë§¤ì¶œ ê³„ì‚°
      let totalItemValue = 0;
      const itemTotals = {};
      
      // ì±„ë„ í‚¤ëŠ” ìµœì¢…ì±„ë„ëª… ê·¸ëŒ€ë¡œ ì‚¬ìš© (ì•„ìš¸ë ›ì˜ ê²½ìš° ì•„ìš¸ë ›(ì§)ê³¼ ì•„ìš¸ë ›(ì§)2ê°€ í•©ì³ì ¸ ìˆìŒ)
      let channelKeys = [selectedChannel];
      // ì•„ìš¸ë ›ì˜ ê²½ìš° ë°ì´í„°ì—ì„œ ì•„ìš¸ë ›ìœ¼ë¡œ í†µí•©ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ê·¸ëŒ€ë¡œ ì‚¬ìš©
      
      console.log('ì±„ë„ í‚¤ ê²€ìƒ‰:', {selectedChannel, channelKeys, hasChannelData: brandSalesData[selectedChannel] ? 'ìˆìŒ' : 'ì—†ìŒ'});
      
      // í•´ë‹¹ ì±„ë„ë“¤ì˜ ì•„ì´í…œë³„ ë§¤ì¶œ í•©ê³„
      channelKeys.forEach(channelKey => {
        if (brandSalesData[channelKey]) {
          const channelItems = brandSalesData[channelKey];
          console.log('ì±„ë„ ì•„ì´í…œ ë°ì´í„°:', {channelKey, items: Object.keys(channelItems), itemCount: Object.keys(channelItems).length});
          Object.entries(channelItems).forEach(([itemKey, value]) => {
            if (value > 0) {
            // ì•„ì´í…œ í‚¤ë¥¼ í‘œì‹œëª…ìœ¼ë¡œ ë§¤í•‘
            let itemDisplayName = itemKey;
            if (itemKey === 'Shoes') itemDisplayName = 'ì‹ ë°œ';
            else if (itemKey === 'Bag') itemDisplayName = 'ê°€ë°©';
            else if (itemKey === 'Headwear') itemDisplayName = 'ëª¨ì'; // HeadwearëŠ” ëª¨ìë¡œ ë§¤í•‘
            else if (itemKey === 'Cap') itemDisplayName = 'ëª¨ì';
            else if (itemKey === 'Acc_etc') itemDisplayName = 'ê¸°íƒ€ACC';
            else if (itemKey === 'ë‹¹ì‹œì¦Œì˜ë¥˜') itemDisplayName = 'ë‹¹ì‹œì¦Œì˜ë¥˜';
            else if (itemKey === 'ì°¨ì‹œì¦Œì˜ë¥˜') itemDisplayName = 'ì°¨ì‹œì¦Œì˜ë¥˜';
            else if (itemKey === 'ê³¼ì‹œì¦Œì˜ë¥˜') itemDisplayName = 'ê³¼ì‹œì¦Œì˜ë¥˜';
              
              if (!itemTotals[itemDisplayName]) itemTotals[itemDisplayName] = 0;
              itemTotals[itemDisplayName] += value;
            }
          });
        } else {
          console.warn('ì±„ë„ ë°ì´í„° ì—†ìŒ:', {channelKey, availableChannels: Object.keys(brandSalesData)});
        }
      });
      
      console.log('ì•„ì´í…œë³„ í•©ê³„:', itemTotals);
      
      // ì•„ì´í…œì„ ë§¤ì¶œìˆœìœ¼ë¡œ ì •ë ¬ (ë‚´ë¦¼ì°¨ìˆœ)
      const sortedItems = itemList
        .map(item => ({ item, value: itemTotals[item] || 0 }))
        .filter(obj => obj.value > 0)
        .sort((a, b) => b.value - a.value);
      
      // ì •ë ¬ëœ ì•„ì´í…œ ëª©ë¡ìœ¼ë¡œ ë°ì´í„° ì¶”ê°€ (ìì‹ë§Œ)
      const colorPalette = [
        'rgba(79,70,229,0.8)', 'rgba(124,58,237,0.8)', 'rgba(59,130,246,0.8)',
        'rgba(16,185,129,0.8)', 'rgba(245,158,11,0.8)', 'rgba(239,68,68,0.8)',
        'rgba(168,85,247,0.8)', 'rgba(34,197,94,0.8)'
      ];
      let colorIndex = 0;
      
      // ì „ì²´ ì•„ì´í…œ ë§¤ì¶œ í•©ê³„ ê³„ì‚°
      const drilldownTotalValue = sortedItems.reduce((sum, obj) => sum + obj.value, 0);
      const customDrilldownText = [];
      
      sortedItems.forEach((obj, index) => {
        const percentage = drilldownTotalValue > 0 ? ((obj.value / drilldownTotalValue) * 100).toFixed(1) : 0;
        labels.push(obj.item);
        values.push(obj.value / 100000000); // ì› ë‹¨ìœ„ë¥¼ ì–µì›ìœ¼ë¡œ ë³€í™˜
          parents.push('');  // ë¶€ëª¨ë¥¼ ë¹ˆ ë¬¸ìì—´ë¡œ (ìµœìƒìœ„ ë ˆë²¨)
          ids.push(`channel-${selectedChannel}-item-${index}`);
          colors.push(colorPalette[colorIndex % colorPalette.length]);
          colorIndex++;
        totalItemValue += obj.value;
        customDrilldownText.push(`<b style="font-size:15px;color:white;">${obj.item}</b><br><span style="font-size:13px;color:white;">${(obj.value / 100000000).toFixed(1)}ì–µì› (${percentage}%)</span>`);
      });
      
      console.log('ë“œë¦´ë‹¤ìš´ ë°ì´í„° ìƒì„±:', {labels, values, parents, ids, totalItemValue, itemCount: labels.length});
      
      // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ ë°˜í™˜
      if (labels.length === 0) {
        console.warn('ë“œë¦´ë‹¤ìš´ ë°ì´í„° ì—†ìŒ:', {selectedChannel, itemTotals});
        return [];
      }
      
      return [{
        type: 'treemap',
        labels: labels,
        values: values,
        parents: parents,
        ids: ids,
        text: customDrilldownText,
        textinfo: 'text',
        hovertemplate: '<b style="font-size:14px;">%{label}</b><br>ë§¤ì¶œ: %{value:.1f}ì–µì›<br>ë¹„ì¤‘: %{customdata:.1f}%<extra></extra>',
        customdata: sortedItems.map(obj => drilldownTotalValue > 0 ? ((obj.value / drilldownTotalValue) * 100) : 0),
        textfont: { size: 14 },
        marker: {
          colors: colors
        }
      }];
    }
    
    // -------- ì•„ì´í…œ ë“œë¦´ë‹¤ìš´ ë°ì´í„° (ì•„ì´í…œ ì„ íƒ ì‹œ ì±„ë„ë³„ë¡œ ë¶„ë¥˜) --------
    function getItemDrilldownData(selectedItem) {
      // ë¸Œëœë“œ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
      const brandCode = brandCodeMap[currentBrand] || brandCodeMap[currentBrand.replace('_', ' ')] || 'M';
      const brandSalesData = channelItemSalesData[brandCode];
      
      console.log('ì•„ì´í…œ ë“œë¦´ë‹¤ìš´ ë°ì´í„° ìš”ì²­:', {selectedItem, brandCode, currentBrand, hasData: !!brandSalesData});
      
      if (!brandSalesData) {
        console.warn('ë¸Œëœë“œ ë°ì´í„° ì—†ìŒ:', brandCode);
        return [];
      }
      
      // ì„ íƒëœ ì•„ì´í…œì˜ í‘œì‹œëª…ì„ ë°ì´í„° í‚¤ë¡œ ì—­ë§¤í•‘
      const itemKeyMapReverse = {
        'ì‹ ë°œ': ['Shoes'],
        'ê°€ë°©': ['Bag'],
        'ëª¨ì': ['Headwear', 'Cap'], // HeadwearëŠ” ëª¨ìë¡œ ë§¤í•‘
        'ê¸°íƒ€ACC': ['Acc_etc'],
        'ë‹¹ì‹œì¦Œì˜ë¥˜': ['ë‹¹ì‹œì¦Œì˜ë¥˜'],
        'ì°¨ì‹œì¦Œì˜ë¥˜': ['ì°¨ì‹œì¦Œì˜ë¥˜'],
        'ê³¼ì‹œì¦Œì˜ë¥˜': ['ê³¼ì‹œì¦Œì˜ë¥˜']
      };
      
      const labels = [];
      const values = [];
      const parents = [];
      const ids = [];
      const colors = [];
      
      // ì„ íƒëœ ì•„ì´í…œì˜ ì±„ë„ë³„ ë§¤ì¶œ ê³„ì‚°
      let totalChannelValue = 0;
      const channelTotals = {};
      
      // ì•„ì´í…œ í‚¤ ì°¾ê¸°
      const itemKeys = itemKeyMapReverse[selectedItem] || [selectedItem];
      
      console.log('ì•„ì´í…œ í‚¤ ê²€ìƒ‰:', {selectedItem, itemKeys});
      
      // ê° ì±„ë„ì—ì„œ í•´ë‹¹ ì•„ì´í…œì˜ ë§¤ì¶œ í•©ê³„
      Object.keys(brandSalesData).forEach(channelKey => {
        const channelItems = brandSalesData[channelKey];
        let channelItemValue = 0;
        
        itemKeys.forEach(itemKey => {
          if (channelItems[itemKey] && channelItems[itemKey] > 0) {
            channelItemValue += channelItems[itemKey];
          }
        });
        
        if (channelItemValue > 0) {
          // ì±„ë„ëª…ì€ ì´ë¯¸ ìµœì¢…ì±„ë„ëª…ìœ¼ë¡œ ë˜ì–´ ìˆìŒ
          const mappedChannel = channelNameToFinal[channelKey] || channelKey;
          
          if (!channelTotals[mappedChannel]) channelTotals[mappedChannel] = 0;
          channelTotals[mappedChannel] += channelItemValue;
        }
      });
      
      console.log('ì±„ë„ë³„ í•©ê³„:', channelTotals);
      
      // ì „ì²´ ì±„ë„ ëª©ë¡ (MLBì˜ ê²½ìš° RF í¬í•¨)
      let allChannels = [...channelList];
      if (brandCode === 'M' && brandSalesData['RF']) {
        allChannels.push('RF');
      }
      
      // ì±„ë„ì„ ë§¤ì¶œìˆœìœ¼ë¡œ ì •ë ¬ (ë‚´ë¦¼ì°¨ìˆœ)
      const sortedChannels = allChannels
        .map(channel => ({ channel, value: channelTotals[channel] || 0 }))
        .filter(item => item.value > 0)
        .sort((a, b) => b.value - a.value);
      
      // ì •ë ¬ëœ ì±„ë„ ëª©ë¡ìœ¼ë¡œ ë°ì´í„° ì¶”ê°€ (ìì‹ë§Œ)
      const colorPalette = [
        'rgba(79,70,229,0.8)', 'rgba(124,58,237,0.8)', 'rgba(59,130,246,0.8)',
        'rgba(16,185,129,0.8)', 'rgba(245,158,11,0.8)', 'rgba(239,68,68,0.8)',
        'rgba(168,85,247,0.8)', 'rgba(34,197,94,0.8)', 'rgba(251,146,60,0.8)',
        'rgba(244,63,94,0.8)'
      ];
      let colorIndex = 0;
      
      // ì „ì²´ ì±„ë„ ë§¤ì¶œ í•©ê³„ ê³„ì‚°
      const itemDrilldownTotalValue = sortedChannels.reduce((sum, item) => sum + item.value, 0);
      const customItemDrilldownText = [];
      
      sortedChannels.forEach((item, index) => {
        const percentage = itemDrilldownTotalValue > 0 ? ((item.value / itemDrilldownTotalValue) * 100).toFixed(1) : 0;
        labels.push(item.channel);
        values.push(item.value / 100000000); // ì› ë‹¨ìœ„ë¥¼ ì–µì›ìœ¼ë¡œ ë³€í™˜
          parents.push('');  // ë¶€ëª¨ë¥¼ ë¹ˆ ë¬¸ìì—´ë¡œ (ìµœìƒìœ„ ë ˆë²¨)
          ids.push(`item-${selectedItem}-channel-${index}`);
          colors.push(colorPalette[colorIndex % colorPalette.length]);
          colorIndex++;
        totalChannelValue += item.value;
        customItemDrilldownText.push(`<b style="font-size:15px;color:white;">${item.channel}</b><br><span style="font-size:13px;color:white;">${(item.value / 100000000).toFixed(1)}ì–µì› (${percentage}%)</span>`);
      });
      
      console.log('ì•„ì´í…œ ë“œë¦´ë‹¤ìš´ ë°ì´í„° ìƒì„±:', {labels, values, parents, ids, totalChannelValue, channelCount: labels.length});
      
      // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ ë°˜í™˜
      if (labels.length === 0) {
        console.warn('ì•„ì´í…œ ë“œë¦´ë‹¤ìš´ ë°ì´í„° ì—†ìŒ:', {selectedItem, channelTotals});
        return [];
      }
      
      return [{
        type: 'treemap',
        labels: labels,
        values: values,
        parents: parents,
        ids: ids,
        text: customItemDrilldownText,
        textinfo: 'text',
        hovertemplate: '<b style="font-size:14px;">%{label}</b><br>ë§¤ì¶œ: %{value:.1f}ì–µì›<br>ë¹„ì¤‘: %{customdata:.1f}%<extra></extra>',
        customdata: sortedChannels.map(item => itemDrilldownTotalValue > 0 ? ((item.value / itemDrilldownTotalValue) * 100) : 0),
        textfont: { size: 14 },
        marker: {
          colors: colors
        }
      }];
    }
    
    // -------- íŠ¸ë¦¬ë§µ ë“œë¦´ë‹¤ìš´ ë°ì´í„° (ê¸°ì¡´ í•¨ìˆ˜ ìœ ì§€) --------
    function getTreemapDrilldownData(type, path) {
      if (type === 'channel') {
        return getChannelDrilldownData(path);
      } else {
        return getItemDrilldownData(path);
      }
    }

    // -------- ë ˆì´ë” ì°¨íŠ¸ ë°ì´í„°/íˆ´íŒ/í† ê¸€ --------
    function getChannelRadarData(brand){
      const ch = (brandData[brand] && brandData[brand].channels) ? brandData[brand].channels : {};
      const labels = ['ë°±í™”ì ','ë©´ì„¸ì ','ì§ì˜ì ','ìì‚¬ëª°','ì œíœ´ëª°','ëŒ€ë¦¬ì '];
      // prev í´ë°± í…Œì´ë¸”(ì±„ë„ ì†ìµ í…Œì´ë¸” ê¸°ë°˜). ì˜¨ë¼ì¸ì€ ìì‚¬ëª°/ì œíœ´ëª°ë¡œ 1:1 ë¶„í• 
      const baseRows = {
        MLB: { 'ë°±í™”ì ':58.2, 'ë©´ì„¸ì ':95.5, 'ì§ì˜ê°€ë‘':16.1, 'ì˜¨ë¼ì¸':25.5, 'ëŒ€ë¦¬ì ':30.3 },
        MLB_KIDS: { 'ë°±í™”ì ':12.8, 'ë©´ì„¸ì ':8.2, 'ì§ì˜ê°€ë‘':6.1, 'ì˜¨ë¼ì¸':10.5, 'ëŒ€ë¦¬ì ':7.6 },
        DISCOVERY: { 'ë°±í™”ì ':8.9, 'ë©´ì„¸ì ':12.1, 'ì§ì˜ê°€ë‘':4.8, 'ì˜¨ë¼ì¸':8.2, 'ëŒ€ë¦¬ì ':4.7 },
        DUVETICA: { 'ë°±í™”ì ':9.8, 'ë©´ì„¸ì ':8.5, 'ì§ì˜ê°€ë‘':3.9, 'ì˜¨ë¼ì¸':6.8, 'ëŒ€ë¦¬ì ':3.1 },
        SERGIO: { 'ë°±í™”ì ':6.8, 'ë©´ì„¸ì ':8.9, 'ì§ì˜ê°€ë‘':3.2, 'ì˜¨ë¼ì¸':5.1, 'ëŒ€ë¦¬ì ':4.5 },
        SUPRA: { 'ë°±í™”ì ':7.8, 'ë©´ì„¸ì ':8.9, 'ì§ì˜ê°€ë‘':3.6, 'ì˜¨ë¼ì¸':7.8, 'ëŒ€ë¦¬ì ':4.0 }
      };
      const rows = baseRows[brand] || baseRows.MLB;
      const onlinePrev = rows['ì˜¨ë¼ì¸'] || 0;
      const prevMap = {
        'ë°±í™”ì ': rows['ë°±í™”ì ']||0,
        'ë©´ì„¸ì ': rows['ë©´ì„¸ì ']||0,
        'ì§ì˜ì ': rows['ì§ì˜ê°€ë‘']||0,
        'ìì‚¬ëª°': onlinePrev ? onlinePrev/2 : 0,
        'ì œíœ´ëª°': onlinePrev ? onlinePrev/2 : 0,
        'ëŒ€ë¦¬ì ': rows['ëŒ€ë¦¬ì ']||0
      };
      // ì±„ë„ í‚¤ ë§¤í•‘ í•¨ìˆ˜
      const pick = (obj, keys)=> keys.find(k=> obj && obj[k]!=null);
      const keyMap = {
        'ì§ì˜ì ': pick(ch, ['ì§ì˜ê°€ë‘','ì§ì˜ì ']),
        'ìì‚¬ëª°': pick(ch, ['ì˜¨ë¼ì¸ìì‚¬','ì§ì˜ëª°','ìì‚¬ëª°','ì˜¨ë¼ì¸']),
        'ì œíœ´ëª°': pick(ch, ['ì˜¨ë¼ì¸ì œíœ´','ì œíœ´ëª°','ì˜¨ë¼ì¸'])
      };
      const getValue = (name)=>{
        if(name==='ë°±í™”ì ' || name==='ë©´ì„¸ì ' || name==='ëŒ€ë¦¬ì ') return ch[name];
        if(name==='ì§ì˜ì '){ const k=keyMap['ì§ì˜ì ']; return k? ch[k]: undefined; }
        if(name==='ìì‚¬ëª°'){ const k=keyMap['ìì‚¬ëª°']; return k? ch[k]: undefined; }
        if(name==='ì œíœ´ëª°'){ const k=keyMap['ì œíœ´ëª°']; return k? ch[k]: undefined; }
      };
      const plan = labels.map(n=>{
        const v = getValue(n);
        if(!v) {
          // ì˜¨ë¼ì¸ í•˜ë‚˜ë§Œ ìˆì„ ë•Œ ìì‚¬ëª°/ì œíœ´ëª° ë°˜ë¶„
          if((n==='ìì‚¬ëª°' || n==='ì œíœ´ëª°') && ch['ì˜¨ë¼ì¸']){
            const halfForecast = ch['ì˜¨ë¼ì¸'].forecast/2;
            const halfTarget = (ch['ì˜¨ë¼ì¸'].target||0)/2;
            return halfTarget ? Math.round((halfForecast/halfTarget)*100) : 0;
          }
          return 0;
        }
        return v.target ? Math.round((v.forecast / v.target) * 100) : 0;
      });
      const yoy = labels.map(n=>{
        const v = getValue(n);
        const prev = prevMap[n] || (v ? v.forecast : 0);
        // ì˜¨ë¼ì¸ í•˜ë‚˜ë§Œ ìˆì„ ë•Œ ë¶„í•  prev ì ìš©
        if((n==='ìì‚¬ëª°' || n==='ì œíœ´ëª°') && !v && ch['ì˜¨ë¼ì¸']){
          const halfForecast = ch['ì˜¨ë¼ì¸'].forecast/2;
          const halfPrev = prevMap[n] || (rows['ì˜¨ë¼ì¸']? rows['ì˜¨ë¼ì¸']/2 : halfForecast);
          return halfPrev ? Math.round((halfForecast/halfPrev)*100) : 0;
        }
        return prev ? Math.round(((v?v.forecast:0) / prev) * 100) : 0;
      });
      const sales = labels.map(n=>{
        const v = getValue(n);
        if(v) return `${(v.forecast||0).toFixed(1)}ì–µ`;
        if((n==='ìì‚¬ëª°' || n==='ì œíœ´ëª°') && ch['ì˜¨ë¼ì¸']) return `${(ch['ì˜¨ë¼ì¸'].forecast/2).toFixed(1)}ì–µ`;
        return '0ì–µ';
      });
      return { labels, plan, yoy, sales };
    }

    function getItemRadarData(brand){
      // ì•„ì´í…œ ê¸°ì¤€: ACC, ë‹¹ì‹œì¦Œ, ê³¼ì‹œì¦Œ, ì‚¬ì…ì„ ì‚¬ìš©
      const groups = ['ACC','ë‹¹ì‹œì¦Œ','ê³¼ì‹œì¦Œ','ì‚¬ì…'];
      const ch = (brandData[brand] && brandData[brand].channels) ? brandData[brand].channels : {};
      const labels = groups.filter(k=> ch[k]);
      const plan = labels.map(n=>{
        const v = ch[n];
        return v && v.target ? Math.round((v.forecast / v.target) * 100) : 0;
      });
      // ì „ë…„ ë°ì´í„°ê°€ ì—†ìœ¼ë¯€ë¡œ í´ë°±: ë¸Œëœë“œ PLì˜ ì „ë…„ ì´í•© ëŒ€ë¹„ ê°€ì¤‘ì¹˜ë¡œ ê·¼ì‚¬ (ë™ì¼ ë¹„ìœ¨ ê°€ì •)
      const brandPrev = (brandPLData[brand]?.revenue?.prev) || 0;
      const totalForecast = labels.reduce((s,n)=> s + (ch[n]?.forecast || 0), 0);
      const yoy = labels.map(n=>{
        const v = ch[n];
        const prev = (brandPrev && totalForecast) ? (v.forecast/totalForecast) * brandPrev : v.forecast;
        return prev ? Math.round((v.forecast / prev) * 100) : 0;
      });
      const sales = labels.map(n=> `${(ch[n]?.forecast||0).toFixed(1)}ì–µ`);
      return { labels, plan, yoy, sales };
    }

    function customRadarTooltip(context){
      const label = context[0]?.label;
      const brand = currentBrand;
      const type = window.radarChartType || 'channel';
      const data = (type==='channel') ? getChannelRadarData(brand) : getItemRadarData(brand);
      const idx = data.labels.indexOf(label);
      const plan = data.plan[idx];
      const yoy = data.yoy[idx];
      const sales = data.sales[idx];
      return `${label} (${sales})\nê³„íš ${plan}% | ì „ë…„ ${yoy}%`;
    }

    function initRadarToggle(){
      window.radarChartType = window.radarChartType || 'channel';
      const btnCh = document.getElementById('radarBtnChannel');
      const btnIt = document.getElementById('radarBtnItem');
      if(!btnCh || !btnIt) return;
      const applyActive = ()=>{
        if(window.radarChartType==='channel'){
          btnCh.style.background = '#2563eb'; btnCh.style.color = '#fff';
          btnIt.style.background = '#e5e7eb'; btnIt.style.color = '#374151';
        }else{
          btnIt.style.background = '#2563eb'; btnIt.style.color = '#fff';
          btnCh.style.background = '#e5e7eb'; btnCh.style.color = '#374151';
        }
      };
      btnCh.onclick = ()=>{ window.radarChartType='channel'; applyActive(); updateRadarStaticOrDynamic(); };
      btnIt.onclick = ()=>{ window.radarChartType='item'; applyActive(); updateRadarStaticOrDynamic(); };
      applyActive();
    }

    function updateRadarStaticOrDynamic(){
      if(!charts.radar) return;
      if(window.uiStaticMode){
        const type = window.radarChartType;
        const data = (type==='channel') ? getStaticRadarData() : getStaticItemRadarData();
        charts.radar.data.labels = data.labels;
        charts.radar.data.datasets[0].data = data.plan;
        charts.radar.data.datasets[1].data = data.yoy;
        charts.radar.update();
      }else{
        updateBrandCharts();
      }
    }

    // ì „ì²´ ë¸Œëœë“œ ë ˆì´ë” ì°¨íŠ¸ ì´ˆê¸°í™”
    function initAllBrandsRadarChart(){
      const brandAllRadarCtx = document.getElementById('brandAllRadarChart');
      if (!brandAllRadarCtx) return;
      
      if(charts.brandAllRadar){ charts.brandAllRadar.destroy(); delete charts.brandAllRadar; }
      
      // ì „ì²´ ë¸Œëœë“œ ë°ì´í„° ìˆ˜ì§‘ (SUPRA ì œì™¸)
      const brandLabels = ['MLB','MLB KIDS','DISCOVERY','DUVETICA','SERGIO'];
      const brandKeys = ['MLB','MLB_KIDS','DISCOVERY','DUVETICA','SERGIO'];
      
      // ê° ë¸Œëœë“œì˜ ë‹¬ì„±ë¥ (ê³„íš)ê³¼ ì „ë…„ë¹„ë¥¼ ê³„ì‚°
      const plan = brandKeys.map(key => {
        const data = brandData[key];
        if(!data || !data.channels) return 0;
        const totalTarget = Object.values(data.channels).reduce((sum, ch) => sum + (ch.target || 0), 0);
        const totalForecast = Object.values(data.channels).reduce((sum, ch) => sum + (ch.forecast || 0), 0);
        return totalTarget > 0 ? Math.round((totalForecast / totalTarget) * 100) : 0;
      });
      
      const yoy = brandKeys.map(key => {
        const pl = brandPLData[key];
        if(!pl || !pl.revenue) return 100;
        const prev = pl.revenue.prev || 0;
        const forecast = pl.revenue.forecast || 0;
        return prev > 0 ? Math.round((forecast / prev) * 100) : 0;
      });
      
      const sales = brandKeys.map(key => {
        const data = brandData[key];
        if(!data || !data.channels) return '0ì–µ';
        const totalForecast = Object.values(data.channels).reduce((sum, ch) => sum + (ch.forecast || 0), 0);
        return `${totalForecast.toFixed(1)}ì–µ`;
      });
      
      charts.brandAllRadar = new Chart(brandAllRadarCtx.getContext('2d'), {
        type: 'radar',
        data: {
          labels: brandLabels,
          datasets: [
            { label: 'ê³„íš', data: plan, borderColor: '#3B82F6', backgroundColor: 'rgba(59,130,246,0.2)', borderWidth: 2, pointRadius: 2 },
            { label: 'ì „ë…„', data: yoy, borderColor: '#10B981', backgroundColor: 'rgba(16,185,129,0.2)', borderWidth: 2, pointRadius: 2 }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { 
            legend: { display: false }, 
            tooltip: { 
              callbacks: { 
                label: function(context) { 
                  const idx = context.dataIndex;
                  const value = context.parsed.r || 0;
                  const dsetLabel = context.dataset.label || '';
                  return `${brandLabels[idx]} (${sales[idx]}) - ${dsetLabel} ${value}%`;
                },
                title: function() { return ''; }
              },
              displayColors: false
            }
          },
          scales: { r: { suggestedMin: 0, suggestedMax: 120, ticks: { stepSize: 30, backdropColor: 'transparent', font: { size: 9 } } } }
        }
      });
    }

    // ì „ì²´ í˜„í™© ë²„ë¸” ì°¨íŠ¸ ì´ˆê¸°í™”
    let overviewBubbleView = '4quadrant';
    let overviewBubbleBrand = 'all';
    
    function initOverviewBubbleChart(){
      const bubbleCtx = document.getElementById('overviewBubbleChart');
      if (!bubbleCtx) return;
      
      if(charts.overviewBubble){ charts.overviewBubble.destroy(); delete charts.overviewBubble; }
      
      // ë°ì´í„° ì¤€ë¹„ (inventoryTableDataByBrandì—ì„œ ê°€ì ¸ì˜¤ê¸°)
      const rawData = [];
      // ëª¨ë“  ë¸Œëœë“œì˜ ì¬ê³ ì£¼ìˆ˜ ë°ì´í„°ë¥¼ ìˆ˜ì§‘ (SUPRA ì œì™¸)
      Object.keys(inventoryTableDataByBrand).forEach(brandCode => {
        // SUPRA(ST) ë¸Œëœë“œëŠ” ì œì™¸
        if (brandCode === 'ST') return;
        
        const brandData = inventoryTableDataByBrand[brandCode];
        brandData.forEach(item => {
          // stockWeeksê°€ ìˆê³  0ë³´ë‹¤ í° ê²½ìš°ë§Œ í¬í•¨ (yoyëŠ” nullì´ì–´ë„ í¬í•¨)
          if (item.stockWeeks != null && item.stockWeeks > 0) {
            rawData.push({
              brand: brandCode,
              category: item.category,
              item: item.item,
              name: item.name,
              salesQty: item.qty || 0,
              salesAmt: item.sales || 0,
              yoy: item.yoy || 0, // nullì´ë©´ 0ìœ¼ë¡œ ì²˜ë¦¬
              share: item.weight || 0,
              avgSales: item.avg4w || 0,
              inventory: item.stockQty || 0,
              weeks: item.stockWeeks,
              yoyDiff: item.diff || 0
            });
          }
        });
      });
      
      // ê¸°ì¡´ í•˜ë“œì½”ë”© ë°ì´í„°ëŠ” ì œê±°í•˜ê³  ìœ„ ë°ì´í„°ë§Œ ì‚¬ìš©
      /*
      const rawData = [
        {brand: "I", category: "Bag", item: "CR", name: "í¬ë¡œìŠ¤ë°±", salesQty: 2279, salesAmt: 194, yoy: 139, share: 35, avgSales: 1473, inventory: 45768, weeks: 31.1, yoyDiff: -49.9},
        {brand: "I", category: "Headwear", item: "CP", name: "ìš´ë™ëª¨", salesQty: 1948, salesAmt: 73, yoy: 110, share: 13, avgSales: 2601, inventory: 114785, weeks: 44.1, yoyDiff: 15.6},
        {brand: "I", category: "Shoes", item: "SH", name: "ì‹ ë°œ", salesQty: 776, salesAmt: 67, yoy: 109, share: 12, avgSales: 891, inventory: 46827, weeks: 52.6, yoyDiff: 10.7},
        {brand: "I", category: "Shoes", item: "WB", name: "ë°©í•œí™”", salesQty: 795, salesAmt: 56, yoy: 107, share: 10, avgSales: 498, inventory: 29908, weeks: 60.1, yoyDiff: -43.1},
        {brand: "I", category: "Headwear", item: "BN", name: "ë¹„ë‹ˆ", salesQty: 1113, salesAmt: 45, yoy: 80, share: 8, avgSales: 741, inventory: 32135, weeks: 43.4, yoyDiff: 12.5},
        {brand: "I", category: "Shoes", item: "RN", name: "ëŸ°ë‹í™”", salesQty: 468, salesAmt: 45, yoy: 135, share: 8, avgSales: 569, inventory: 30214, weeks: 53.1, yoyDiff: 24.5},
        {brand: "I", category: "Headwear", item: "WM", name: "ë°©í•œëª¨", salesQty: 380, salesAmt: 24, yoy: 92, share: 4, avgSales: 239, inventory: 20646, weeks: 86.4, yoyDiff: 16.2},
        {brand: "I", category: "Shoes", item: "SX", name: "ìŠ¤ë‹ˆì»¤ì¦ˆ", salesQty: 233, salesAmt: 19, yoy: 44, share: 3, avgSales: 264, inventory: 22745, weeks: 86.2, yoyDiff: 34.1},
        {brand: "I", category: "Bag", item: "BK", name: "ë°±íŒ©", salesQty: 183, salesAmt: 17, yoy: 40, share: 3, avgSales: 253, inventory: 47128, weeks: 186.3, yoyDiff: -203.6},
        {brand: "I", category: "Acc_etc", item: "ET", name: "ê¸°íƒ€", salesQty: 43, salesAmt: 3, yoy: 208, share: 1, avgSales: 38, inventory: 9808, weeks: 258.1, yoyDiff: -259.5},
        {brand: "I", category: "Acc_etc", item: "MF", name: "ë¨¸í”ŒëŸ¬(ìŠ¤ì¹´í”„)", salesQty: 44, salesAmt: 3, yoy: 73, share: 0, avgSales: 41, inventory: 2492, weeks: 60.8, yoyDiff: 23.6},
        {brand: "I", category: "Acc_etc", item: "SO", name: "ì–‘ë§", salesQty: 233, salesAmt: 3, yoy: 56, share: 0, avgSales: 375, inventory: 61438, weeks: 163.8, yoyDiff: 4.7},
        {brand: "I", category: "Headwear", item: "WR", name: "ì™€ì´ì–´ìº¡", salesQty: 51, salesAmt: 2, yoy: 159, share: 0, avgSales: 46, inventory: 1536, weeks: 33.4, yoyDiff: -11.6},
        {brand: "I", category: "Acc_etc", item: "GL", name: "ì¥ê°‘", salesQty: 24, salesAmt: 1, yoy: 44, share: 0, avgSales: 11, inventory: 8831, weeks: 802.8, yoyDiff: 483.1},
        {brand: "I", category: "Headwear", item: "HT", name: "í–‡", salesQty: 24, salesAmt: 1, yoy: 70, share: 0, avgSales: 46, inventory: 15278, weeks: 332.1, yoyDiff: -199.5},
        {brand: "I", category: "Shoes", item: "SD", name: "ìƒŒë“¤", salesQty: 5, salesAmt: 0, yoy: 407, share: 0, avgSales: 3, inventory: 24222, weeks: 8074, yoyDiff: 0},
        {brand: "I", category: "Headwear", item: "SC", name: "ì„ ìº¡", salesQty: 8, salesAmt: 0, yoy: 159, share: 0, avgSales: 4, inventory: 8094, weeks: 2023.5, yoyDiff: 503.2},
        {brand: "I", category: "Bag", item: "UB", name: "ë³´ì¡°ê°€ë°©", salesQty: 3, salesAmt: 0, yoy: 33, share: 0, avgSales: 4, inventory: 4836, weeks: 1209, yoyDiff: -941.7},
        {brand: "I", category: "Shoes", item: "LP", name: "ìŠ¬ë¦¬í¼", salesQty: 1, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 645, weeks: 0, yoyDiff: 0},
        {brand: "I", category: "Shoes", item: "MU", name: "ë®¬", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: -2, weeks: 0, yoyDiff: 0},
        {brand: "I", category: "Acc_etc", item: "GG", name: "ê³ ê¸€", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 79, weeks: 0, yoyDiff: 0},
        {brand: "I", category: "Acc_etc", item: "ML", name: "í† ì‹œ", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 884, weeks: 897.5, yoyDiff: 0},
        {brand: "I", category: "Bag", item: "BM", name: "ë²„í‚·ë°±", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 1, weeks: 0, yoyDiff: 0},
        {brand: "I", category: "Shoes", item: "CV", name: "ìº”ë²„ìŠ¤í™”", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: -8, weeks: 0, yoyDiff: 0},
        {brand: "I", category: "Bag", item: "HS", name: "í™ìƒ‰", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 1699, weeks: 151.8, yoyDiff: 0},
        {brand: "I", category: "Bag", item: "BG", name: "ê°€ë°©", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 2, inventory: 1770, weeks: 885, yoyDiff: 699.8},
        {brand: "I", category: "Acc_etc", item: "PE", name: "PET", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 18256, weeks: 269.7, yoyDiff: 0},
        {brand: "I", category: "Bag", item: "SG", name: "ìŠ¬ë§ë°±", salesQty: -1, salesAmt: 0, yoy: -4, share: 0, avgSales: 2, inventory: 2474, weeks: 1237, yoyDiff: 1101.4},
        {brand: "M", category: "Headwear", item: "CP", name: "ìš´ë™ëª¨", salesQty: 95861, salesAmt: 3505, yoy: 190, share: 52, avgSales: 75915, inventory: 1358737, weeks: 17.9, yoyDiff: 3.3},
        {brand: "M", category: "Shoes", item: "SX", name: "ìŠ¤ë‹ˆì»¤ì¦ˆ", salesQty: 6950, salesAmt: 959, yoy: 126, share: 14, avgSales: 4536, inventory: 253642, weeks: 55.9, yoyDiff: 4.5},
        {brand: "M", category: "Headwear", item: "BN", name: "ë¹„ë‹ˆ", salesQty: 18548, salesAmt: 785, yoy: 480, share: 12, avgSales: 8339, inventory: 129038, weeks: 15.5, yoyDiff: -11.9},
        {brand: "M", category: "Shoes", item: "SH", name: "ì‹ ë°œ", salesQty: 5591, salesAmt: 581, yoy: 108, share: 9, avgSales: 4345, inventory: 309281, weeks: 71.2, yoyDiff: 0.2},
        {brand: "M", category: "Bag", item: "OR", name: "ì‡¼í¼ë°±", salesQty: 1954, salesAmt: 334, yoy: 193, share: 5, avgSales: 630, inventory: 16083, weeks: 25.5, yoyDiff: -8.5},
        {brand: "M", category: "Shoes", item: "RN", name: "ëŸ°ë‹í™”", salesQty: 1033, salesAmt: 143, yoy: 131, share: 2, avgSales: 1061, inventory: 106773, weeks: 100.6, yoyDiff: 59.1},
        {brand: "M", category: "Bag", item: "BQ", name: "ìˆ„ë”ë°±", salesQty: 816, salesAmt: 88, yoy: 48, share: 1, avgSales: 1127, inventory: 89903, weeks: 79.8, yoyDiff: 36.3},
        {brand: "M", category: "Headwear", item: "HT", name: "í–‡", salesQty: 1048, salesAmt: 63, yoy: 57, share: 1, avgSales: 862, inventory: 48013, weeks: 55.7, yoyDiff: -4.1},
        {brand: "M", category: "Bag", item: "CR", name: "í¬ë¡œìŠ¤ë°±", salesQty: 451, salesAmt: 52, yoy: 75, share: 1, avgSales: 316, inventory: 40606, weeks: 128.5, yoyDiff: 59.1},
        {brand: "M", category: "Shoes", item: "WB", name: "ë°©í•œí™”", salesQty: 381, salesAmt: 41, yoy: 111, share: 1, avgSales: 168, inventory: 36455, weeks: 217, yoyDiff: 10.1},
        {brand: "M", category: "Bag", item: "BM", name: "ë²„í‚·ë°±", salesQty: 229, salesAmt: 28, yoy: 115, share: 0, avgSales: 264, inventory: 19452, weeks: 73.7, yoyDiff: -0.7},
        {brand: "M", category: "Bag", item: "HS", name: "í™ìƒ‰", salesQty: 431, salesAmt: 25, yoy: 42, share: 0, avgSales: 205, inventory: 15479, weeks: 75.5, yoyDiff: 44.5},
        {brand: "M", category: "Headwear", item: "WM", name: "ë°©í•œëª¨", salesQty: 316, salesAmt: 24, yoy: 245, share: 0, avgSales: 136, inventory: 14129, weeks: 103.9, yoyDiff: -146.6},
        {brand: "M", category: "Bag", item: "BG", name: "ê°€ë°©", salesQty: 109, salesAmt: 15, yoy: 547, share: 0, avgSales: 36, inventory: 13799, weeks: 383.3, yoyDiff: -230.1},
        {brand: "M", category: "Bag", item: "BK", name: "ë°±íŒ©", salesQty: 91, salesAmt: 13, yoy: 158, share: 0, avgSales: 98, inventory: 16367, weeks: 167, yoyDiff: 52.4},
        {brand: "M", category: "Acc_etc", item: "SO", name: "ì–‘ë§", salesQty: 721, salesAmt: 11, yoy: 91, share: 0, avgSales: 829, inventory: 70586, weeks: 85.1, yoyDiff: 22.8},
        {brand: "M", category: "Acc_etc", item: "MF", name: "ë¨¸í”ŒëŸ¬(ìŠ¤ì¹´í”„)", salesQty: 100, salesAmt: 8, yoy: 40, share: 0, avgSales: 28, inventory: 8318, weeks: 297.1, yoyDiff: 219.9},
        {brand: "M", category: "Acc_etc", item: "PO", name: "íŒŒìš°ì¹˜", salesQty: 182, salesAmt: 5, yoy: 117, share: 0, avgSales: 110, inventory: 3341, weeks: 30.4, yoyDiff: 6.5},
        {brand: "M", category: "Shoes", item: "MU", name: "ë®¬", salesQty: 66, salesAmt: 3, yoy: 26, share: 0, avgSales: 147, inventory: 48901, weeks: 332.7, yoyDiff: 107.8},
        {brand: "M", category: "Shoes", item: "LP", name: "ìŠ¬ë¦¬í¼", salesQty: 39, salesAmt: 2, yoy: 76, share: 0, avgSales: 71, inventory: 50157, weeks: 706.4, yoyDiff: 43},
        {brand: "M", category: "Headwear", item: "MC", name: "ë©”ì‹œìº¡", salesQty: 38, salesAmt: 2, yoy: -3399, share: 0, avgSales: 51, inventory: 6356, weeks: 124.6, yoyDiff: 0},
        {brand: "M", category: "Acc_etc", item: "ET", name: "ê¸°íƒ€", salesQty: 56, salesAmt: 1, yoy: 75, share: 0, avgSales: 52, inventory: 3387, weeks: 65.1, yoyDiff: -258.7},
        {brand: "M", category: "Acc_etc", item: "HH", name: "ìºë¦¬ì–´(í•˜ë“œì¼€ì´ìŠ¤)", salesQty: 3, salesAmt: 1, yoy: 74, share: 0, avgSales: 3, inventory: 879, weeks: 293, yoyDiff: 255.4},
        {brand: "M", category: "Acc_etc", item: "GL", name: "ì¥ê°‘", salesQty: 9, salesAmt: 0, yoy: 0, share: 0, avgSales: 3, inventory: 1975, weeks: 658.3, yoyDiff: 0},
        {brand: "M", category: "Shoes", item: "SD", name: "ìƒŒë“¤", salesQty: 7, salesAmt: 0, yoy: 6, share: 0, avgSales: 20, inventory: 56345, weeks: 2817.3, yoyDiff: 2184.4},
        {brand: "M", category: "Bag", item: "BW", name: "ë³´ìŠ¤í†¤ë°±", salesQty: 3, salesAmt: 0, yoy: 79, share: 0, avgSales: 2, inventory: 2870, weeks: 1435, yoyDiff: 644.9},
        {brand: "M", category: "Shoes", item: "SQ", name: "ì•„ì¿ ì•„ ìŠˆì¦ˆ", salesQty: 2, salesAmt: 0, yoy: 33, share: 0, avgSales: 10, inventory: 9235, weeks: 923.5, yoyDiff: -1017.5},
        {brand: "M", category: "Headwear", item: "SC", name: "ì„ ìº¡", salesQty: 2, salesAmt: 0, yoy: 0, share: 0, avgSales: 7, inventory: 2317, weeks: 331, yoyDiff: -5151},
        {brand: "M", category: "Acc_etc", item: "MK", name: "ë§ˆìŠ¤í¬(íŒ¨ì…˜ìš©)", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 8, weeks: 0, yoyDiff: 0},
        {brand: "M", category: "Acc_etc", item: "ML", name: "í† ì‹œ", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 897, weeks: 0, yoyDiff: 0},
        {brand: "M", category: "Shoes", item: "CV", name: "ìº”ë²„ìŠ¤í™”", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 12, weeks: 0, yoyDiff: 0},
        {brand: "M", category: "Acc_etc", item: "TW", name: "íƒ€ì˜¬", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 1, weeks: 0, yoyDiff: 0},
        {brand: "M", category: "Headwear", item: "CB", name: "ì—¬ì„± ë² ë ˆëª¨", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 138, weeks: 24.8, yoyDiff: 0},
        {brand: "ST", category: "Shoes", item: "SH", name: "ì‹ ë°œ", salesQty: 133, salesAmt: 9, yoy: 180, share: 34, avgSales: 266, inventory: 10592, weeks: 39.8, yoyDiff: -281.6},
        {brand: "ST", category: "Bag", item: "BW", name: "ë³´ìŠ¤í†¤ë°±", salesQty: 33, salesAmt: 5, yoy: 268, share: 21, avgSales: 26, inventory: 667, weeks: 25.7, yoyDiff: -48.3},
        {brand: "ST", category: "Headwear", item: "CP", name: "ìš´ë™ëª¨", salesQty: 76, salesAmt: 4, yoy: 209, share: 15, avgSales: 92, inventory: 3993, weeks: 43.4, yoyDiff: 10},
        {brand: "ST", category: "Acc_etc", item: "SO", name: "ì–‘ë§", salesQty: 158, salesAmt: 3, yoy: 82, share: 12, avgSales: 152, inventory: 11135, weeks: 73.3, yoyDiff: 39.6},
        {brand: "ST", category: "Headwear", item: "SC", name: "ì„ ìº¡", salesQty: 27, salesAmt: 2, yoy: 150, share: 6, avgSales: 39, inventory: 2967, weeks: 76.1, yoyDiff: 13.6},
        {brand: "ST", category: "Bag", item: "BK", name: "ë°±íŒ©", salesQty: 7, salesAmt: 1, yoy: 83, share: 5, avgSales: 33, inventory: 1597, weeks: 48.4, yoyDiff: -51.8},
        {brand: "ST", category: "Bag", item: "TG", name: "í† ë“œë°±", salesQty: 9, salesAmt: 1, yoy: 133, share: 3, avgSales: 13, inventory: 1641, weeks: 126.2, yoyDiff: -59.1},
        {brand: "ST", category: "Acc_etc", item: "PR", name: "ë³´í˜¸ëŒ€", salesQty: 19, salesAmt: 0, yoy: 66, share: 2, avgSales: 14, inventory: 2189, weeks: 156.4, yoyDiff: 39.4},
        {brand: "ST", category: "Bag", item: "CR", name: "í¬ë¡œìŠ¤ë°±", salesQty: 2, salesAmt: 0, yoy: 74, share: 1, avgSales: 5, inventory: 705, weeks: 141, yoyDiff: 13.7},
        {brand: "ST", category: "Bag", item: "SG", name: "ìŠ¬ë§ë°±", salesQty: 3, salesAmt: 0, yoy: 0, share: 1, avgSales: 1, inventory: 131, weeks: 131, yoyDiff: 10},
        {brand: "ST", category: "Headwear", item: "BN", name: "ë¹„ë‹ˆ", salesQty: 2, salesAmt: 0, yoy: 54, share: 0, avgSales: 1, inventory: 691, weeks: 691, yoyDiff: 403},
        {brand: "ST", category: "Acc_etc", item: "HB", name: "í—¤ë“œë°´ë“œ", salesQty: 5, salesAmt: 0, yoy: 44, share: 0, avgSales: 14, inventory: 874, weeks: 62.4, yoyDiff: -24.1},
        {brand: "ST", category: "Shoes", item: "LP", name: "ìŠ¬ë¦¬í¼", salesQty: 1, salesAmt: 0, yoy: 0, share: 0, avgSales: 2, inventory: 597, weeks: 298.5, yoyDiff: 0},
        {brand: "ST", category: "Acc_etc", item: "AM", name: "ë¨¸í”ŒëŸ¬", salesQty: 1, salesAmt: 0, yoy: 0, share: 0, avgSales: 1, inventory: 415, weeks: 415, yoyDiff: 0},
        {brand: "ST", category: "Headwear", item: "HT", name: "í–‡", salesQty: 3, salesAmt: 0, yoy: 19, share: 0, avgSales: 7, inventory: 855, weeks: 122.1, yoyDiff: -714.2},
        {brand: "ST", category: "Bag", item: "RB", name: "ë¼ì¼“ë°±", salesQty: 1, salesAmt: 0, yoy: 11, share: 0, avgSales: 9, inventory: 993, weeks: 110.3, yoyDiff: -1.8},
        {brand: "ST", category: "Acc_etc", item: "RK", name: "ë¼ì¼“", salesQty: 1, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 513, weeks: 27.5, yoyDiff: 0},
        {brand: "ST", category: "Acc_etc", item: "AC", name: "ê¸°íƒ€ì†Œí’ˆë¥˜", salesQty: 1, salesAmt: 0, yoy: 160, share: 0, avgSales: 1, inventory: 1312, weeks: 1312, yoyDiff: 1054.3},
        {brand: "ST", category: "Acc_etc", item: "TW", name: "íƒ€ì˜¬", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 8, weeks: 0, yoyDiff: 0},
        {brand: "ST", category: "Acc_etc", item: "LL", name: "ë³¼", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 34, weeks: 41, yoyDiff: 0},
        {brand: "V", category: "Shoes", item: "WB", name: "ë°©í•œí™”", salesQty: 57, salesAmt: 12, yoy: 181, share: 26, avgSales: 33, inventory: 5713, weeks: 173.1, yoyDiff: 53.6},
        {brand: "V", category: "Bag", item: "TG", name: "í† ë“œë°±", salesQty: 27, salesAmt: 8, yoy: 319, share: 19, avgSales: 27, inventory: 2114, weeks: 78.3, yoyDiff: -1.9},
        {brand: "V", category: "Bag", item: "BK", name: "ë°±íŒ©", salesQty: 14, salesAmt: 5, yoy: 179, share: 11, avgSales: 12, inventory: 538, weeks: 44.8, yoyDiff: -21.7},
        {brand: "V", category: "Shoes", item: "SH", name: "ì‹ ë°œ", salesQty: 33, salesAmt: 5, yoy: 133, share: 11, avgSales: 28, inventory: 1165, weeks: 41.6, yoyDiff: -237.5},
        {brand: "V", category: "Headwear", item: "HT", name: "í–‡", salesQty: 29, salesAmt: 4, yoy: 226, share: 9, avgSales: 32, inventory: 1630, weeks: 50.9, yoyDiff: -117.6},
        {brand: "V", category: "Bag", item: "CR", name: "í¬ë¡œìŠ¤ë°±", salesQty: 14, salesAmt: 2, yoy: 183, share: 5, avgSales: 13, inventory: 1271, weeks: 97.8, yoyDiff: -118.2},
        {brand: "V", category: "Headwear", item: "CP", name: "ìš´ë™ëª¨", salesQty: 20, salesAmt: 2, yoy: 686, share: 4, avgSales: 18, inventory: 839, weeks: 46.6, yoyDiff: -120.1},
        {brand: "V", category: "Headwear", item: "BN", name: "ë¹„ë‹ˆ", salesQty: 19, salesAmt: 2, yoy: 475, share: 4, avgSales: 12, inventory: 1132, weeks: 94.3, yoyDiff: -57.5},
        {brand: "V", category: "Acc_etc", item: "SO", name: "ì–‘ë§", salesQty: 52, salesAmt: 1, yoy: 435, share: 2, avgSales: 41, inventory: 1380, weeks: 33.7, yoyDiff: -183.6},
        {brand: "V", category: "Acc_etc", item: "ML", name: "í† ì‹œ", salesQty: 5, salesAmt: 1, yoy: 0, share: 1, avgSales: 4, inventory: 301, weeks: 75.3, yoyDiff: 0},
        {brand: "V", category: "Headwear", item: "WM", name: "ë°©í•œëª¨", salesQty: 4, salesAmt: 1, yoy: 0, share: 1, avgSales: 2, inventory: 221, weeks: 110.5, yoyDiff: 0},
        {brand: "V", category: "Bag", item: "HS", name: "í™ìƒ‰", salesQty: 6, salesAmt: 1, yoy: 0, share: 1, avgSales: 4, inventory: 131, weeks: 32.8, yoyDiff: 0},
        {brand: "V", category: "Acc_etc", item: "DC", name: "ë‹¤ìš´ ìŠ¤ì¹´í”„", salesQty: 5, salesAmt: 1, yoy: 135, share: 1, avgSales: 3, inventory: 468, weeks: 156, yoyDiff: -29},
        {brand: "V", category: "Shoes", item: "MU", name: "ë®¬", salesQty: 4, salesAmt: 0, yoy: -274, share: 1, avgSales: 5, inventory: 125, weeks: 25, yoyDiff: -403},
        {brand: "V", category: "Acc_etc", item: "AG", name: "ì¥ê°‘", salesQty: 3, salesAmt: 0, yoy: 127, share: 1, avgSales: 2, inventory: 499, weeks: 249.5, yoyDiff: -110.5},
        {brand: "V", category: "Bag", item: "BG", name: "ê°€ë°©", salesQty: 1, salesAmt: 0, yoy: 0, share: 1, avgSales: 1, inventory: 485, weeks: 485, yoyDiff: 0},
        {brand: "V", category: "Headwear", item: "SC", name: "ì„ ìº¡", salesQty: 4, salesAmt: 0, yoy: 262, share: 1, avgSales: 5, inventory: 218, weeks: 43.6, yoyDiff: -153.1},
        {brand: "V", category: "Acc_etc", item: "MF", name: "ë¨¸í”ŒëŸ¬(ìŠ¤ì¹´í”„)", salesQty: 1, salesAmt: 0, yoy: 0, share: 0, avgSales: 2, inventory: 789, weeks: 394.5, yoyDiff: 0},
        {brand: "V", category: "Bag", item: "TA", name: "ë²¨íŠ¸ë°±", salesQty: 1, salesAmt: 0, yoy: 46, share: 0, avgSales: 2, inventory: 39, weeks: 19.5, yoyDiff: -103.5},
        {brand: "V", category: "Acc_etc", item: "PO", name: "íŒŒìš°ì¹˜", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 10, weeks: 79, yoyDiff: 0},
        {brand: "V", category: "Bag", item: "EB", name: "ê¸°íƒ€ê°€ë°©", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 16, weeks: 54, yoyDiff: 0},
        {brand: "V", category: "Acc_etc", item: "GL", name: "ì¥ê°‘", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 21, weeks: 59, yoyDiff: 0},
        {brand: "V", category: "Shoes", item: "LP", name: "ìŠ¬ë¦¬í¼", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 405, weeks: 0, yoyDiff: 0},
        {brand: "W", category: "Shoes", item: "SH", name: "ì‹ ë°œ", salesQty: 45, salesAmt: 2, yoy: 22, share: 38, avgSales: 53, inventory: 3289, weeks: 62.1, yoyDiff: -74.9},
        {brand: "W", category: "Headwear", item: "CP", name: "ìš´ë™ëª¨", salesQty: 110, salesAmt: 2, yoy: 54, share: 27, avgSales: 114, inventory: 4918, weeks: 43.1, yoyDiff: -211.7},
        {brand: "W", category: "Bag", item: "BG", name: "ê°€ë°©", salesQty: 20, salesAmt: 0, yoy: 254, share: 8, avgSales: 40, inventory: 2042, weeks: 51.1, yoyDiff: -790.4},
        {brand: "W", category: "Bag", item: "BW", name: "ë³´ìŠ¤í†¤ë°±", salesQty: 8, salesAmt: 0, yoy: 0, share: 6, avgSales: 7, inventory: 319, weeks: 45.6, yoyDiff: 0},
        {brand: "W", category: "Shoes", item: "WB", name: "ë°©í•œí™”", salesQty: 12, salesAmt: 0, yoy: 0, share: 6, avgSales: 14, inventory: 259, weeks: 18.5, yoyDiff: 0},
        {brand: "W", category: "Bag", item: "BK", name: "ë°±íŒ©", salesQty: 6, salesAmt: 0, yoy: 42, share: 5, avgSales: 6, inventory: 1419, weeks: 236.5, yoyDiff: -108.9},
        {brand: "W", category: "Bag", item: "TG", name: "í† ë“œë°±", salesQty: 4, salesAmt: 0, yoy: 0, share: 2, avgSales: 2, inventory: 155, weeks: 77.5, yoyDiff: 0},
        {brand: "W", category: "Headwear", item: "BN", name: "ë¹„ë‹ˆ", salesQty: 6, salesAmt: 0, yoy: 21, share: 2, avgSales: 7, inventory: 304, weeks: 43.4, yoyDiff: -10.6},
        {brand: "W", category: "Headwear", item: "HT", name: "í–‡", salesQty: 6, salesAmt: 0, yoy: 157, share: 1, avgSales: 11, inventory: 2185, weeks: 198.6, yoyDiff: -734.7},
        {brand: "W", category: "Headwear", item: "SC", name: "ì„ ìº¡", salesQty: 3, salesAmt: 0, yoy: 0, share: 1, avgSales: 2, inventory: 171, weeks: 85.5, yoyDiff: 0},
        {brand: "W", category: "Bag", item: "CR", name: "í¬ë¡œìŠ¤ë°±", salesQty: 2, salesAmt: 0, yoy: 37, share: 1, avgSales: 3, inventory: 668, weeks: 222.7, yoyDiff: 156},
        {brand: "W", category: "Acc_etc", item: "SO", name: "ì–‘ë§", salesQty: 4, salesAmt: 0, yoy: 12, share: 1, avgSales: 6, inventory: 101, weeks: 16.8, yoyDiff: -95.7},
        {brand: "W", category: "Shoes", item: "LP", name: "ìŠ¬ë¦¬í¼", salesQty: 1, salesAmt: 0, yoy: 3, share: 1, avgSales: 3, inventory: 614, weeks: 204.7, yoyDiff: -24.3},
        {brand: "W", category: "Bag", item: "HS", name: "í™ìƒ‰", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 2, inventory: 304, weeks: 152, yoyDiff: 96.4},
        {brand: "W", category: "Headwear", item: "WM", name: "ë°©í•œëª¨", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 83, weeks: 0, yoyDiff: 0},
        {brand: "X", category: "Shoes", item: "SH", name: "ì‹ ë°œ", salesQty: 6296, salesAmt: 609, yoy: 72, share: 61, avgSales: 6773, inventory: 381634, weeks: 56.3, yoyDiff: -5.6},
        {brand: "X", category: "Bag", item: "BK", name: "ë°±íŒ©", salesQty: 914, salesAmt: 120, yoy: 97, share: 12, avgSales: 1095, inventory: 115764, weeks: 105.7, yoyDiff: 29.5},
        {brand: "X", category: "Headwear", item: "CP", name: "ìš´ë™ëª¨", salesQty: 1171, salesAmt: 46, yoy: 108, share: 5, avgSales: 1176, inventory: 87747, weeks: 74.6, yoyDiff: 20.1},
        {brand: "X", category: "Bag", item: "CR", name: "í¬ë¡œìŠ¤ë°±", salesQty: 667, salesAmt: 46, yoy: 101, share: 5, avgSales: 704, inventory: 45916, weeks: 65.2, yoyDiff: 10.5},
        {brand: "X", category: "Bag", item: "SG", name: "ìŠ¬ë§ë°±", salesQty: 474, salesAmt: 37, yoy: 44, share: 4, avgSales: 509, inventory: 23885, weeks: 46.9, yoyDiff: 23.3},
        {brand: "X", category: "Shoes", item: "LP", name: "ìŠ¬ë¦¬í¼", salesQty: 695, salesAmt: 33, yoy: 92, share: 3, avgSales: 920, inventory: 21652, weeks: 23.5, yoyDiff: -9.8},
        {brand: "X", category: "Acc_etc", item: "DC", name: "ë‹¤ìš´ ìŠ¤ì¹´í”„", salesQty: 635, salesAmt: 26, yoy: 52, share: 3, avgSales: 221, inventory: 76709, weeks: 347.1, yoyDiff: 278.4},
        {brand: "X", category: "Headwear", item: "BN", name: "ë¹„ë‹ˆ", salesQty: 394, salesAmt: 13, yoy: 105, share: 1, avgSales: 220, inventory: 33335, weeks: 151.5, yoyDiff: -8.5},
        {brand: "X", category: "Headwear", item: "HT", name: "í–‡", salesQty: 278, salesAmt: 13, yoy: 54, share: 1, avgSales: 318, inventory: 34400, weeks: 108.2, yoyDiff: 21.1},
        {brand: "X", category: "Acc_etc", item: "GL", name: "ì¥ê°‘", salesQty: 895, salesAmt: 12, yoy: 213, share: 1, avgSales: 317, inventory: 19258, weeks: 60.8, yoyDiff: -160.4},
        {brand: "X", category: "Acc_etc", item: "SO", name: "ì–‘ë§", salesQty: 842, salesAmt: 8, yoy: 129, share: 1, avgSales: 915, inventory: 69566, weeks: 76, yoyDiff: -26.8},
        {brand: "X", category: "Headwear", item: "WM", name: "ë°©í•œëª¨", salesQty: 99, salesAmt: 7, yoy: 0, share: 1, avgSales: 35, inventory: 9028, weeks: 257.9, yoyDiff: 0},
        {brand: "X", category: "Bag", item: "TG", name: "í† ë“œë°±", salesQty: 110, salesAmt: 6, yoy: 47, share: 1, avgSales: 86, inventory: 21047, weeks: 244.7, yoyDiff: 123.3},
        {brand: "X", category: "Bag", item: "MR", name: "ë©”ì‹ ì €ë°±", salesQty: 70, salesAmt: 5, yoy: 38, share: 1, avgSales: 86, inventory: 9820, weeks: 114.2, yoyDiff: 29.3},
        {brand: "X", category: "Bag", item: "HS", name: "í™ìƒ‰", salesQty: 76, salesAmt: 4, yoy: 35, share: 0, avgSales: 107, inventory: 8118, weeks: 75.9, yoyDiff: 26.4},
        {brand: "X", category: "Bag", item: "BW", name: "ë³´ìŠ¤í†¤ë°±", salesQty: 65, salesAmt: 4, yoy: 141, share: 0, avgSales: 45, inventory: 3096, weeks: 68.8, yoyDiff: -67.5},
        {brand: "X", category: "Bag", item: "BG", name: "ê°€ë°©", salesQty: 42, salesAmt: 3, yoy: 207, share: 0, avgSales: 42, inventory: 5042, weeks: 120, yoyDiff: -142.9},
        {brand: "X", category: "Acc_etc", item: "AC", name: "ê¸°íƒ€ì†Œí’ˆë¥˜", salesQty: 83, salesAmt: 3, yoy: 37, share: 0, avgSales: 42, inventory: 15526, weeks: 369.7, yoyDiff: 162.2},
        {brand: "X", category: "Bag", item: "BZ", name: "ë°”ë””ë°±", salesQty: 15, salesAmt: 1, yoy: 0, share: 0, avgSales: 19, inventory: 603, weeks: 31.7, yoyDiff: 0},
        {brand: "X", category: "Acc_etc", item: "MK", name: "ë§ˆìŠ¤í¬(íŒ¨ì…˜ìš©)", salesQty: 29, salesAmt: 1, yoy: 995, share: 0, avgSales: 18, inventory: 3575, weeks: 198.6, yoyDiff: 40.9},
        {brand: "X", category: "Acc_etc", item: "MS", name: "ë©€í‹°ìŠ¤ì¹´í”„", salesQty: 29, salesAmt: 1, yoy: 69, share: 0, avgSales: 26, inventory: 6737, weeks: 259.1, yoyDiff: -113.8},
        {brand: "X", category: "Acc_etc", item: "ML", name: "í† ì‹œ", salesQty: 20, salesAmt: 0, yoy: 512, share: 0, avgSales: 21, inventory: 7536, weeks: 358.9, yoyDiff: -764},
        {brand: "X", category: "Acc_etc", item: "PO", name: "íŒŒìš°ì¹˜", salesQty: 0, salesAmt: 0, yoy: 0, share: 0, avgSales: 0, inventory: 23, weeks: 0, yoyDiff: 0}
      ];
      */
      
      // ë¸Œëœë“œ ìƒ‰ìƒ ë° ì´ë¦„ ë§¤í•‘ (SUPRA ì œì™¸)
      const brandColors = { 'M': '#dc2626', 'I': '#eab308', 'X': '#3b82f6', 'V': '#1f2937', 'W': '#10b981' };
      const brandNames = { 'I': 'MLB Kids', 'M': 'MLB', 'V': 'DUVETICA', 'W': 'SERGIO', 'X': 'DISCOVERY' };
      
      // ë°ì´í„° ì „ì²˜ë¦¬ (weeks, yoyë¥¼ 80, 250ìœ¼ë¡œ ì œí•œ)
      // KPI ì¹´ë“œ ê³„ì‚°ì„ ìœ„í•´ ëª¨ë“  ë°ì´í„° í¬í•¨ (yoyê°€ 0ì´ì–´ë„ í¬í•¨)
      // ë²„ë¸” ì°¨íŠ¸ í‘œì‹œëŠ” yoy > 0ì¸ í•­ëª©ë§Œ í‘œì‹œ
      const data = rawData.map(d => ({
        ...d,
        weeksOriginal: d.weeks,
        weeks: Math.min(d.weeks, 80),
        yoy: Math.min(Math.max(d.yoy || 0, 0), 250), // nullì´ë©´ 0, ìµœëŒ€ 250
        yoyOriginal: d.yoy || 0
      }));
      
      // 4ë¶„ë©´/9ë¶„ë©´ ë¶„ë¥˜ ê¸°ì¤€ê°’
      const WEEKS_THRESHOLD_4 = 40;
      const YOY_THRESHOLD_4 = 100;
      const WEEKS_THRESHOLD_LOW = 30;
      const WEEKS_THRESHOLD_HIGH = 50;
      const YOY_THRESHOLD_LOW = 100;
      const YOY_THRESHOLD_HIGH = 120;
      
      // 4ë¶„ë©´ ë¶„ë¥˜ (ì°¨íŠ¸ í‘œì‹œìš©ìœ¼ë¡œ ì œí•œëœ weeks ì‚¬ìš©)
      const processedData4 = data.map(d => {
        let quadrant;
        if (d.weeks >= WEEKS_THRESHOLD_4 && d.yoy < YOY_THRESHOLD_4) quadrant = 'critical';
        else if (d.weeks >= WEEKS_THRESHOLD_4 && d.yoy >= YOY_THRESHOLD_4) quadrant = 'caution';
        else if (d.weeks < WEEKS_THRESHOLD_4 && d.yoy >= YOY_THRESHOLD_4) quadrant = 'growth';
        else quadrant = 'review';
        return {...d, quadrant4: quadrant};
      });
      
      // 9ë¶„ë©´ ë¶„ë¥˜ (ì›ë³¸ weeksOriginal ê°’ì„ ì‚¬ìš©í•˜ì—¬ ì •í™•í•œ ë¶„ë¥˜)
      const processedData9 = data.map(d => {
        let quadrant;
        const weeksValue = d.weeksOriginal || d.weeks; // ì›ë³¸ ê°’ ì‚¬ìš©
        const yoyValue = d.yoyOriginal || d.yoy; // ì›ë³¸ ê°’ ì‚¬ìš©
        if (weeksValue < WEEKS_THRESHOLD_LOW) {
          if (yoyValue >= YOY_THRESHOLD_HIGH) quadrant = 'q1';
          else if (yoyValue >= YOY_THRESHOLD_LOW) quadrant = 'q2';
          else quadrant = 'q3';
        } else if (weeksValue >= WEEKS_THRESHOLD_LOW && weeksValue < WEEKS_THRESHOLD_HIGH) {
          if (yoyValue >= YOY_THRESHOLD_HIGH) quadrant = 'q4';
          else if (yoyValue >= YOY_THRESHOLD_LOW) quadrant = 'q5';
          else quadrant = 'q6';
        } else {
          if (yoyValue >= YOY_THRESHOLD_HIGH) quadrant = 'q7';
          else if (yoyValue >= YOY_THRESHOLD_LOW) quadrant = 'q8';
          else quadrant = 'q9';
        }
        return {...d, quadrant9: quadrant};
      });
      
      const processedData = data.map((d, i) => ({
        ...d,
        quadrant4: processedData4[i].quadrant4,
        quadrant9: processedData9[i].quadrant9
      }));
      
      // ë¶„ë©´ë³„ ë°ì´í„° ê·¸ë£¹í™”
      const data4 = {
        critical: processedData.filter(d => d.quadrant4 === 'critical'),
        caution: processedData.filter(d => d.quadrant4 === 'caution'),
        growth: processedData.filter(d => d.quadrant4 === 'growth'),
        review: processedData.filter(d => d.quadrant4 === 'review')
      };
      
      const data9 = {
        q1: processedData.filter(d => d.quadrant9 === 'q1'),
        q2: processedData.filter(d => d.quadrant9 === 'q2'),
        q3: processedData.filter(d => d.quadrant9 === 'q3'),
        q4: processedData.filter(d => d.quadrant9 === 'q4'),
        q5: processedData.filter(d => d.quadrant9 === 'q5'),
        q6: processedData.filter(d => d.quadrant9 === 'q6'),
        q7: processedData.filter(d => d.quadrant9 === 'q7'),
        q8: processedData.filter(d => d.quadrant9 === 'q8'),
        q9: processedData.filter(d => d.quadrant9 === 'q9')
      };
      
      // ì°¨íŠ¸ ë°ì´í„°ì…‹ ìƒì„±
      const datasets = Object.keys(brandColors).map(brand => {
        const brandData = processedData.filter(d => d.brand === brand);
        return {
          label: brandNames[brand],
          clip: false,
          data: brandData.map(d => {
            const bubbleSize = d.share > 0 
              ? Math.max(3, Math.min(35, 3 + d.share * 0.6))
              : 3;
            return {
              x: d.weeks,
              y: d.yoy,
              r: bubbleSize,
              item: d.name,
              salesAmt: d.salesAmt,
              inventory: d.inventory,
              weeksOriginal: d.weeksOriginal,
              share: d.share,
              yoyOriginal: d.yoyOriginal,
              brand: brand,
              quadrant4: d.quadrant4,
              quadrant9: d.quadrant9
            };
          }),
          backgroundColor: brandData.map(d => {
            const alpha = 0.8;
            return brandColors[brand] + Math.round(alpha * 255).toString(16).padStart(2, '0');
          }),
          borderWidth: 0
        };
      });
      
      // 4ë¶„ë©´ ë°°ê²½ í”ŒëŸ¬ê·¸ì¸
      const backgroundPlugin4 = {
        id: 'backgroundQuadrants4',
        beforeDraw: (chart) => {
          const {ctx, chartArea: {left, top, right, bottom}, scales: {x, y}} = chart;
          const xMid = x.getPixelForValue(WEEKS_THRESHOLD_4);
          const yMid = y.getPixelForValue(YOY_THRESHOLD_4);
          
          ctx.fillStyle = 'rgba(219, 234, 254, 0.35)';
          ctx.fillRect(left, top, xMid - left, yMid - top);
          ctx.fillStyle = 'rgba(254, 243, 199, 0.35)';
          ctx.fillRect(xMid, top, right - xMid, yMid - top);
          ctx.fillStyle = 'rgba(243, 244, 246, 0.35)';
          ctx.fillRect(left, yMid, xMid - left, bottom - yMid);
          ctx.fillStyle = 'rgba(254, 226, 226, 0.45)';
          ctx.fillRect(xMid, yMid, right - xMid, bottom - yMid);
          
          ctx.strokeStyle = 'rgba(0, 0, 0, 0.3)';
          ctx.lineWidth = 2;
          ctx.setLineDash([6, 3]);
          ctx.beginPath();
          ctx.moveTo(xMid, top);
          ctx.lineTo(xMid, bottom);
          ctx.stroke();
          ctx.beginPath();
          ctx.moveTo(left, yMid);
          ctx.lineTo(right, yMid);
          ctx.stroke();
          ctx.setLineDash([]);
          
          ctx.font = 'bold 12px "Segoe UI"';
          ctx.textAlign = 'center';
          
          ctx.fillStyle = '#1e40af';
          ctx.fillText('ğŸ”¥ ê³ ì„±ì¥+ì €ì¬ê³ ', left + (xMid - left) / 2, top + 20);
          
          ctx.fillStyle = '#b45309';
          ctx.fillText('âš ï¸ ê³ ì„±ì¥+ê³ ì¬ê³ ', xMid + (right - xMid) / 2, top + 20);
          
          ctx.fillStyle = '#6b7280';
          ctx.fillText('ğŸ“‹ ì €ì„±ì¥+ì €ì¬ê³ ', left + (xMid - left) / 2, bottom - 10);
          
          ctx.fillStyle = '#991b1b';
          ctx.fillText('ğŸš¨ ì €ì„±ì¥+ê³ ì¬ê³ ', xMid + (right - xMid) / 2, bottom - 10);
        }
      };
      
      // 9ë¶„ë©´ ë°°ê²½ í”ŒëŸ¬ê·¸ì¸
      const backgroundPlugin9 = {
        id: 'backgroundQuadrants9',
        beforeDraw: (chart) => {
          const {ctx, chartArea: {left, top, right, bottom}, scales: {x, y}} = chart;
          const xLow = x.getPixelForValue(WEEKS_THRESHOLD_LOW);
          const xHigh = x.getPixelForValue(WEEKS_THRESHOLD_HIGH);
          const yLow = y.getPixelForValue(YOY_THRESHOLD_LOW);
          const yHigh = y.getPixelForValue(YOY_THRESHOLD_HIGH);
          
          const colors = [
            'rgba(219, 234, 254, 0.4)','rgba(209, 250, 229, 0.4)','rgba(243, 244, 246, 0.4)',
            'rgba(209, 250, 229, 0.35)','rgba(224, 231, 255, 0.4)','rgba(254, 243, 199, 0.4)',
            'rgba(255, 247, 237, 0.45)','rgba(254, 215, 170, 0.45)','rgba(254, 226, 226, 0.5)'
          ];
          const rects = [
            [left, top, xLow - left, yHigh - top],
            [left, yHigh, xLow - left, yLow - yHigh],
            [left, yLow, xLow - left, bottom - yLow],
            [xLow, top, xHigh - xLow, yHigh - top],
            [xLow, yHigh, xHigh - xLow, yLow - yHigh],
            [xLow, yLow, xHigh - xLow, bottom - yLow],
            [xHigh, top, right - xHigh, yHigh - top],
            [xHigh, yHigh, right - xHigh, yLow - yHigh],
            [xHigh, yLow, right - xHigh, bottom - yLow]
          ];
          
          rects.forEach((rect, idx) => {
            ctx.fillStyle = colors[idx];
            ctx.fillRect(...rect);
          });
          
          ctx.strokeStyle = 'rgba(0, 0, 0, 0.3)';
          ctx.lineWidth = 2;
          ctx.setLineDash([6, 3]);
          ctx.beginPath();
          ctx.moveTo(xLow, top);
          ctx.lineTo(xLow, bottom);
          ctx.stroke();
          ctx.beginPath();
          ctx.moveTo(xHigh, top);
          ctx.lineTo(xHigh, bottom);
          ctx.stroke();
          ctx.beginPath();
          ctx.moveTo(left, yHigh);
          ctx.lineTo(right, yHigh);
          ctx.stroke();
          ctx.beginPath();
          ctx.moveTo(left, yLow);
          ctx.lineTo(right, yLow);
          ctx.stroke();
          ctx.setLineDash([]);
          
          ctx.font = 'bold 11px "Segoe UI"';
          ctx.textAlign = 'center';
          
          ctx.fillStyle = '#1e40af';
          ctx.fillText('ğŸ”¥ ì ê·¹ë°œì£¼', left + (xLow - left) / 2, top + 18);
          
          ctx.fillStyle = '#059669';
          ctx.fillText('âœ… ë°œì£¼ìœ ì§€', left + (xLow - left) / 2, yHigh + (yLow - yHigh) / 2);
          
          ctx.fillStyle = '#6b7280';
          ctx.fillText('ğŸ“‹ ë‹¨ì¢…ê²€í† ', left + (xLow - left) / 2, bottom - 10);
          
          ctx.fillStyle = '#047857';
          ctx.fillText('ğŸ’š ì•ˆì •ì„±ì¥', xLow + (xHigh - xLow) / 2, top + 18);
          
          ctx.fillStyle = '#4f46e5';
          ctx.fillText('ğŸ”µ í˜„ìƒìœ ì§€', xLow + (xHigh - xLow) / 2, yHigh + (yLow - yHigh) / 2);
          
          ctx.fillStyle = '#d97706';
          ctx.fillText('âš ï¸ ì£¼ì˜ê´€ì°°', xLow + (xHigh - xLow) / 2, bottom - 10);
          
          ctx.fillStyle = '#f97316';
          ctx.fillText('ğŸŸ¡ ë°œì£¼ì¤‘ë‹¨', xHigh + (right - xHigh) / 2, top + 18);
          
          ctx.fillStyle = '#ea580c';
          ctx.fillText('ğŸŸ  ì¬ê³ ê´€ë¦¬', xHigh + (right - xHigh) / 2, yHigh + (yLow - yHigh) / 2);
          
          ctx.fillStyle = '#991b1b';
          ctx.fillText('ğŸš¨ ê¸´ê¸‰ì¡°ì¹˜', xHigh + (right - xHigh) / 2, bottom - 10);
        }
      };
      
      // ì°¨íŠ¸ ìƒì„±
      overviewBubbleView = '4quadrant';
      overviewBubbleBrand = 'all';
      window.overviewBubbleData = { data4, data9, processedData };
      
      charts.overviewBubble = createOverviewBubbleChart();
      updateOverviewBubbleKPIs();
    }
    
    function createOverviewBubbleChart(){
      const bubbleCtx = document.getElementById('overviewBubbleChart');
      if (!bubbleCtx) return null;
      
      // ê¸°ì¡´ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (ì•ˆì „í•˜ê²Œ ì²´í¬)
      if (!window.overviewBubbleData || !window.overviewBubbleData.processedData) {
        console.warn('overviewBubbleData not initialized yet');
        return null;
      }
      const { processedData } = window.overviewBubbleData;
      const brandColors = { 'M': '#dc2626', 'I': '#eab308', 'X': '#3b82f6', 'V': '#1f2937', 'W': '#10b981' };
      const brandNames = { 'I': 'MLB Kids', 'M': 'MLB', 'V': 'DUVETICA', 'W': 'SERGIO', 'X': 'DISCOVERY' };
      
      // ì°¨íŠ¸ ë°ì´í„°ì…‹ ìƒì„± (yoy > 0ì¸ í•­ëª©ë§Œ í‘œì‹œ, KPI ì¹´ë“œëŠ” ëª¨ë“  ë°ì´í„° í¬í•¨)
      const datasets = Object.keys(brandColors).map(brand => {
        const brandData = processedData.filter(d => d.brand === brand && d.yoyOriginal > 0);
        return {
          label: brandNames[brand],
          clip: false,
          data: brandData.map(d => {
            const bubbleSize = d.share > 0 
              ? Math.max(3, Math.min(35, 3 + d.share * 0.6))
              : 3;
            return {
              x: d.weeks,
              y: d.yoy,
              r: bubbleSize,
              item: d.name,
              salesAmt: d.salesAmt,
              inventory: d.inventory,
              weeksOriginal: d.weeksOriginal,
              share: d.share,
              yoyOriginal: d.yoyOriginal,
              brand: brand,
              quadrant4: d.quadrant4,
              quadrant9: d.quadrant9
            };
          }),
          backgroundColor: brandData.map(d => {
            const alpha = 0.8;
            return brandColors[brand] + Math.round(alpha * 255).toString(16).padStart(2, '0');
          }),
          borderWidth: 0
        };
      });
      
      // 4ë¶„ë©´ ë°°ê²½ í”ŒëŸ¬ê·¸ì¸
      const WEEKS_THRESHOLD_4 = 40;
      const YOY_THRESHOLD_4 = 100;
      const WEEKS_THRESHOLD_LOW = 30;
      const WEEKS_THRESHOLD_HIGH = 50;
      const YOY_THRESHOLD_LOW = 100;
      const YOY_THRESHOLD_HIGH = 120;
      
      const backgroundPlugin4 = {
        id: 'backgroundQuadrants4',
        beforeDraw: (chart) => {
          const {ctx, chartArea: {left, top, right, bottom}, scales: {x, y}} = chart;
          const xMid = x.getPixelForValue(WEEKS_THRESHOLD_4);
          const yMid = y.getPixelForValue(YOY_THRESHOLD_4);
          
          ctx.fillStyle = 'rgba(219, 234, 254, 0.35)';
          ctx.fillRect(left, top, xMid - left, yMid - top);
          ctx.fillStyle = 'rgba(254, 243, 199, 0.35)';
          ctx.fillRect(xMid, top, right - xMid, yMid - top);
          ctx.fillStyle = 'rgba(243, 244, 246, 0.35)';
          ctx.fillRect(left, yMid, xMid - left, bottom - yMid);
          ctx.fillStyle = 'rgba(254, 226, 226, 0.45)';
          ctx.fillRect(xMid, yMid, right - xMid, bottom - yMid);
          
          ctx.strokeStyle = 'rgba(0, 0, 0, 0.3)';
          ctx.lineWidth = 2;
          ctx.setLineDash([6, 3]);
          ctx.beginPath();
          ctx.moveTo(xMid, top);
          ctx.lineTo(xMid, bottom);
          ctx.stroke();
          ctx.beginPath();
          ctx.moveTo(left, yMid);
          ctx.lineTo(right, yMid);
          ctx.stroke();
          ctx.setLineDash([]);
          
          ctx.font = 'bold 12px "Segoe UI"';
          ctx.textAlign = 'center';
          
          ctx.fillStyle = '#1e40af';
          ctx.fillText('ğŸ”¥ ê³ ì„±ì¥+ì €ì¬ê³ ', left + (xMid - left) / 2, top + 20);
          
          ctx.fillStyle = '#b45309';
          ctx.fillText('âš ï¸ ê³ ì„±ì¥+ê³ ì¬ê³ ', xMid + (right - xMid) / 2, top + 20);
          
          ctx.fillStyle = '#6b7280';
          ctx.fillText('ğŸ“‹ ì €ì„±ì¥+ì €ì¬ê³ ', left + (xMid - left) / 2, bottom - 10);
          
          ctx.fillStyle = '#991b1b';
          ctx.fillText('ğŸš¨ ì €ì„±ì¥+ê³ ì¬ê³ ', xMid + (right - xMid) / 2, bottom - 10);
        }
      };
      
      const backgroundPlugin9 = {
        id: 'backgroundQuadrants9',
        beforeDraw: (chart) => {
          const {ctx, chartArea: {left, top, right, bottom}, scales: {x, y}} = chart;
          const xLow = x.getPixelForValue(WEEKS_THRESHOLD_LOW);
          const xHigh = x.getPixelForValue(WEEKS_THRESHOLD_HIGH);
          const yLow = y.getPixelForValue(YOY_THRESHOLD_LOW);
          const yHigh = y.getPixelForValue(YOY_THRESHOLD_HIGH);
          
          const colors = [
            'rgba(219, 234, 254, 0.4)','rgba(209, 250, 229, 0.4)','rgba(243, 244, 246, 0.4)',
            'rgba(209, 250, 229, 0.35)','rgba(224, 231, 255, 0.4)','rgba(254, 243, 199, 0.4)',
            'rgba(255, 247, 237, 0.45)','rgba(254, 215, 170, 0.45)','rgba(254, 226, 226, 0.5)'
          ];
          const rects = [
            [left, top, xLow - left, yHigh - top],
            [left, yHigh, xLow - left, yLow - yHigh],
            [left, yLow, xLow - left, bottom - yLow],
            [xLow, top, xHigh - xLow, yHigh - top],
            [xLow, yHigh, xHigh - xLow, yLow - yHigh],
            [xLow, yLow, xHigh - xLow, bottom - yLow],
            [xHigh, top, right - xHigh, yHigh - top],
            [xHigh, yHigh, right - xHigh, yLow - yHigh],
            [xHigh, yLow, right - xHigh, bottom - yLow]
          ];
          
          rects.forEach((rect, idx) => {
            ctx.fillStyle = colors[idx];
            ctx.fillRect(...rect);
          });
          
          ctx.strokeStyle = 'rgba(0, 0, 0, 0.3)';
          ctx.lineWidth = 2;
          ctx.setLineDash([6, 3]);
          ctx.beginPath();
          ctx.moveTo(xLow, top);
          ctx.lineTo(xLow, bottom);
          ctx.stroke();
          ctx.beginPath();
          ctx.moveTo(xHigh, top);
          ctx.lineTo(xHigh, bottom);
          ctx.stroke();
          ctx.beginPath();
          ctx.moveTo(left, yHigh);
          ctx.lineTo(right, yHigh);
          ctx.stroke();
          ctx.beginPath();
          ctx.moveTo(left, yLow);
          ctx.lineTo(right, yLow);
          ctx.stroke();
          ctx.setLineDash([]);
          
          ctx.font = 'bold 11px "Segoe UI"';
          ctx.textAlign = 'center';
          
          ctx.fillStyle = '#1e40af';
          ctx.fillText('ğŸ”¥ ì ê·¹ë°œì£¼', left + (xLow - left) / 2, top + 18);
          
          ctx.fillStyle = '#059669';
          ctx.fillText('âœ… ë°œì£¼ìœ ì§€', left + (xLow - left) / 2, yHigh + (yLow - yHigh) / 2);
          
          ctx.fillStyle = '#6b7280';
          ctx.fillText('ğŸ“‹ ë‹¨ì¢…ê²€í† ', left + (xLow - left) / 2, bottom - 10);
          
          ctx.fillStyle = '#047857';
          ctx.fillText('ğŸ’š ì•ˆì •ì„±ì¥', xLow + (xHigh - xLow) / 2, top + 18);
          
          ctx.fillStyle = '#4f46e5';
          ctx.fillText('ğŸ”µ í˜„ìƒìœ ì§€', xLow + (xHigh - xLow) / 2, yHigh + (yLow - yHigh) / 2);
          
          ctx.fillStyle = '#d97706';
          ctx.fillText('âš ï¸ ì£¼ì˜ê´€ì°°', xLow + (xHigh - xLow) / 2, bottom - 10);
          
          ctx.fillStyle = '#f97316';
          ctx.fillText('ğŸŸ¡ ë°œì£¼ì¤‘ë‹¨', xHigh + (right - xHigh) / 2, top + 18);
          
          ctx.fillStyle = '#ea580c';
          ctx.fillText('ğŸŸ  ì¬ê³ ê´€ë¦¬', xHigh + (right - xHigh) / 2, yHigh + (yLow - yHigh) / 2);
          
          ctx.fillStyle = '#991b1b';
          ctx.fillText('ğŸš¨ ê¸´ê¸‰ì¡°ì¹˜', xHigh + (right - xHigh) / 2, bottom - 10);
        }
      };
      
      const currentPlugin = overviewBubbleView === '4quadrant' ? backgroundPlugin4 : backgroundPlugin9;
      
      return new Chart(bubbleCtx.getContext('2d'), {
        type: 'bubble',
        data: { datasets },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          layout: { padding: { top: 20, right: 20, bottom: 20, left: 20 } },
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.95)',
              padding: 14,
              titleFont: { size: 14, weight: 'bold' },
              bodyFont: { size: 12 },
              bodySpacing: 5,
              callbacks: {
                title: function(context) {
                  const d = context[0].raw;
                  const quadrant = overviewBubbleView === '4quadrant' ? d.quadrant4 : d.quadrant9;
                  const quadrantNames4 = {
                    'critical': 'ğŸš¨ ì €ì„±ì¥+ê³ ì¬ê³ ',
                    'caution': 'âš ï¸ ê³ ì„±ì¥+ê³ ì¬ê³ ',
                    'growth': 'ğŸ”¥ ê³ ì„±ì¥+ì €ì¬ê³ ',
                    'review': 'ğŸ“‹ ì €ì„±ì¥+ì €ì¬ê³ '
                  };
                  const quadrantNames9 = {
                    'q1': 'ğŸ”¥ ì ê·¹ë°œì£¼', 'q2': 'âœ… ë°œì£¼ìœ ì§€', 'q3': 'ğŸ“‹ ë‹¨ì¢…ê²€í† ',
                    'q4': 'ğŸ’š ì•ˆì •ì„±ì¥', 'q5': 'ğŸ”µ í˜„ìƒìœ ì§€', 'q6': 'âš ï¸ ì£¼ì˜ê´€ì°°',
                    'q7': 'ğŸŸ¡ ë°œì£¼ì¤‘ë‹¨', 'q8': 'ğŸŸ  ì¬ê³ ê´€ë¦¬', 'q9': 'ğŸš¨ ê¸´ê¸‰ì¡°ì¹˜'
                  };
                  const quadrantName = overviewBubbleView === '4quadrant' 
                    ? quadrantNames4[quadrant] : quadrantNames9[quadrant];
                  return `${brandNames[d.brand]} ${d.item} (${quadrantName})`;
                },
                label: function(context) {
                  const d = context.raw;
                  const weeksDisplay = d.weeksOriginal > 80 ? `${d.weeksOriginal.toFixed(1)}ì£¼ (80ì£¼+)` : `${d.weeksOriginal.toFixed(1)}ì£¼`;
                  const yoyDisplay = d.yoyOriginal > 250 ? `${d.yoyOriginal}% (250%+)` : `${d.yoyOriginal}%`;
                  return [
                    `ë§¤ì¶œì•¡: ${d.salesAmt.toLocaleString('ko-KR')} ë°±ë§Œì›`,
                    `ì¬ê³ ì£¼ìˆ˜: ${weeksDisplay}`,
                    `ë§¤ì¶œ YOY: ${yoyDisplay}`,
                    `ë§¤ì¶œë¹„ì¤‘: ${d.share}%`,
                    `ì¬ê³ : ${(d.inventory/1000).toFixed(1)}Kê°œ`
                  ];
                }
              }
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'ì¬ê³ ì£¼ìˆ˜ (ì£¼) â†’',
                font: { size: 13, weight: 'bold' },
                color: '#1f2937'
              },
              min: 0,
              max: 80,
              grid: { color: 'rgba(0, 0, 0, 0.06)' },
              ticks: {
                font: { size: 11 },
                stepSize: 10,
                callback: function(value) {
                  if (value === 80) return '80+';
                  return value;
                }
              }
            },
            y: {
              title: {
                display: true,
                text: 'â†‘ ë§¤ì¶œ YOY (%)',
                font: { size: 13, weight: 'bold' },
                color: '#1f2937'
              },
              max: 250,
              grid: { color: 'rgba(0, 0, 0, 0.06)' },
              ticks: {
                font: { size: 11 },
                stepSize: 50,
                callback: function(value) {
                  if (value === 250) return '250%+';
                  return value + '%';
                }
              }
            }
          }
        },
        plugins: [currentPlugin]
      });
    }
    
    // ë²„ë¸” ì°¨íŠ¸ KPI ì—…ë°ì´íŠ¸
    function updateOverviewBubbleKPIs(){
      if (!window.overviewBubbleData) return;
      const { data4, data9 } = window.overviewBubbleData;
      
      let filteredData4, filteredData9;
      if (overviewBubbleBrand === 'all') {
        filteredData4 = data4;
        filteredData9 = data9;
      } else {
        filteredData4 = {
          critical: data4.critical.filter(d => d.brand === overviewBubbleBrand),
          caution: data4.caution.filter(d => d.brand === overviewBubbleBrand),
          growth: data4.growth.filter(d => d.brand === overviewBubbleBrand),
          review: data4.review.filter(d => d.brand === overviewBubbleBrand)
        };
        filteredData9 = {
          q1: data9.q1.filter(d => d.brand === overviewBubbleBrand),
          q2: data9.q2.filter(d => d.brand === overviewBubbleBrand),
          q3: data9.q3.filter(d => d.brand === overviewBubbleBrand),
          q4: data9.q4.filter(d => d.brand === overviewBubbleBrand),
          q5: data9.q5.filter(d => d.brand === overviewBubbleBrand),
          q6: data9.q6.filter(d => d.brand === overviewBubbleBrand),
          q7: data9.q7.filter(d => d.brand === overviewBubbleBrand),
          q8: data9.q8.filter(d => d.brand === overviewBubbleBrand),
          q9: data9.q9.filter(d => d.brand === overviewBubbleBrand)
        };
      }
      
      window.overviewBubbleQuadrantData = { ...filteredData4, ...filteredData9 };
      
      if (overviewBubbleView === '4quadrant') {
        document.getElementById('overviewCriticalCount').textContent = filteredData4.critical.length;
        document.getElementById('overviewCautionCount').textContent = filteredData4.caution.length;
        document.getElementById('overviewGrowthCount').textContent = filteredData4.growth.length;
        document.getElementById('overviewReviewCount').textContent = filteredData4.review.length;
      } else {
        document.getElementById('overviewQ1Count').textContent = filteredData9.q1.length;
        document.getElementById('overviewQ2Count').textContent = filteredData9.q2.length;
        document.getElementById('overviewQ3Count').textContent = filteredData9.q3.length;
        document.getElementById('overviewQ4Count').textContent = filteredData9.q4.length;
        document.getElementById('overviewQ5Count').textContent = filteredData9.q5.length;
        document.getElementById('overviewQ6Count').textContent = filteredData9.q6.length;
        document.getElementById('overviewQ7Count').textContent = filteredData9.q7.length;
        document.getElementById('overviewQ8Count').textContent = filteredData9.q8.length;
        document.getElementById('overviewQ9Count').textContent = filteredData9.q9.length;
      }
    }
    
    // ë²„ë¸” ì°¨íŠ¸ ëª¨ë‹¬ ì—´ê¸°
    function openBubbleModal(type){
      if (!window.overviewBubbleQuadrantData) return;
      
      // ëª¨ë‹¬ì´ ì—†ìœ¼ë©´ ìƒì„±
      let modal = document.getElementById('overviewBubbleModal');
      if (!modal) {
        modal = document.createElement('div');
        modal.id = 'overviewBubbleModal';
        modal.style.cssText = 'display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);animation:fadeIn 0.2s;';
        modal.innerHTML = `
          <div style="background-color:white;margin:3% auto;padding:0;border-radius:10px;width:90%;max-width:1200px;max-height:85vh;box-shadow:0 4px 20px rgba(0,0,0,0.3);animation:slideDown 0.3s;overflow:hidden;">
            <div id="overviewBubbleModalHeader" style="padding:18px 25px;color:white;font-weight:700;font-size:16px;display:flex;justify-content:space-between;align-items:center;">
              <span id="overviewBubbleModalTitle"></span>
              <span class="close-btn" onclick="closeBubbleModal()" style="font-size:28px;font-weight:bold;color:white;cursor:pointer;line-height:1;padding:0 10px;">&times;</span>
            </div>
            <div style="padding:20px 25px;overflow-y:auto;max-height:calc(85vh - 80px);">
              <table style="width:100%;border-collapse:collapse;font-size:13px;">
                <thead style="background:#f9fafb;position:sticky;top:0;z-index:10;">
                  <tr>
                    <th style="padding:12px 10px;text-align:left;font-weight:700;color:#374151;border-bottom:2px solid #e5e7eb;">ë¸Œëœë“œ</th>
                    <th style="padding:12px 10px;text-align:left;font-weight:700;color:#374151;border-bottom:2px solid #e5e7eb;">ì•„ì´í…œëª…</th>
                    <th style="padding:12px 10px;text-align:right;font-weight:700;color:#374151;border-bottom:2px solid #e5e7eb;">ë§¤ì¶œ (ë°±ë§Œ)</th>
                    <th style="padding:12px 10px;text-align:right;font-weight:700;color:#374151;border-bottom:2px solid #e5e7eb;">ë§¤ì¶œ YOY</th>
                    <th style="padding:12px 10px;text-align:right;font-weight:700;color:#374151;border-bottom:2px solid #e5e7eb;">ì¬ê³ ì£¼ìˆ˜</th>
                    <th style="padding:12px 10px;text-align:right;font-weight:700;color:#374151;border-bottom:2px solid #e5e7eb;">ì „ë…„ëŒ€ë¹„</th>
                    <th style="padding:12px 10px;text-align:right;font-weight:700;color:#374151;border-bottom:2px solid #e5e7eb;">ë§¤ì¶œë¹„ì¤‘</th>
                  </tr>
                </thead>
                <tbody id="overviewBubbleModalTableBody"></tbody>
              </table>
            </div>
          </div>
        `;
        document.body.appendChild(modal);
        modal.addEventListener('click', (e)=> { if(e.target===modal) modal.style.display='none'; });
      }
      
      const items = window.overviewBubbleQuadrantData[type];
      if (!items || items.length === 0) return;
      
      const titles = {
        critical: 'ğŸš¨ ì €ì„±ì¥+ê³ ì¬ê³ ',
        caution: 'âš ï¸ ê³ ì„±ì¥+ê³ ì¬ê³ ',
        growth: 'ğŸ”¥ ê³ ì„±ì¥+ì €ì¬ê³ ',
        review: 'ğŸ“‹ ì €ì„±ì¥+ì €ì¬ê³ ',
        q1: 'ğŸ”¥ ì ê·¹ë°œì£¼: ìµœìš°ì„  ì¬ê³  í™•ë³´ í•„ìš”',
        q2: 'âœ… ë°œì£¼ìœ ì§€: ì•ˆì •ì  ë°œì£¼ ìœ ì§€',
        q3: 'ğŸ“‹ ë‹¨ì¢…ê²€í† : ì „ëµ ì¬ê²€í†  í•„ìš”',
        q4: 'ğŸ’š ì•ˆì •ì„±ì¥: ëª¨ë‹ˆí„°ë§ ì§€ì†',
        q5: 'ğŸ”µ í˜„ìƒìœ ì§€: ì ì • ì¬ê³  ìˆ˜ì¤€',
        q6: 'âš ï¸ ì£¼ì˜ê´€ì°°: ë°œì£¼ ì‹ ì¤‘ ê²€í† ',
        q7: 'ğŸŸ¡ ë°œì£¼ì¤‘ë‹¨: ì¬ê³  ì†Œì§„ ìš°ì„ ',
        q8: 'ğŸŸ  ì¬ê³ ê´€ë¦¬: ì†Œì§„ í™œë™ ì§‘ì¤‘',
        q9: 'ğŸš¨ ê¸´ê¸‰ì¡°ì¹˜: í• ì¸/í”„ë¡œëª¨ì…˜ ì¦‰ì‹œ ì‹¤í–‰'
      };
      
      const headerColors = {
        critical: 'linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)',
        caution: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',
        growth: 'linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)',
        review: 'linear-gradient(135deg, #6b7280 0%, #4b5563 100%)',
        q1: 'linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)',
        q2: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',
        q3: 'linear-gradient(135deg, #6b7280 0%, #4b5563 100%)',
        q4: 'linear-gradient(135deg, #059669 0%, #047857 100%)',
        q5: 'linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)',
        q6: 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)',
        q7: 'linear-gradient(135deg, #fb923c 0%, #f97316 100%)',
        q8: 'linear-gradient(135deg, #ea580c 0%, #c2410c 100%)',
        q9: 'linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)'
      };
      
      document.getElementById('overviewBubbleModalTitle').textContent = titles[type];
      document.getElementById('overviewBubbleModalHeader').style.background = headerColors[type];
      
      const brandColorMap = { 'M': '#dc2626', 'I': '#eab308', 'X': '#3b82f6', 'V': '#1f2937', 'ST': '#8b5cf6', 'W': '#10b981' };
      const brandNamesMap = { 'I': 'MLB Kids', 'M': 'MLB', 'ST': 'SUPRA', 'V': 'DUVETICA', 'W': 'SERGIO', 'X': 'DISCOVERY' };
      
      document.getElementById('overviewBubbleModalTableBody').innerHTML = items.map(item => `
        <tr style="border-bottom:1px solid #f3f4f6;">
          <td style="padding:12px 10px;">
            <span style="display:inline-block;padding:3px 8px;border-radius:4px;font-size:11px;font-weight:600;color:white;background:${brandColorMap[item.brand]}">
              ${brandNamesMap[item.brand]}
            </span>
          </td>
          <td style="padding:12px 10px;"><strong>${item.name}</strong></td>
          <td style="padding:12px 10px;text-align:right;">${item.salesAmt.toLocaleString()}</td>
          <td style="padding:12px 10px;text-align:right;">
            <span style="color:${item.yoyOriginal >= 100 ? '#059669' : '#dc2626'};font-weight:600;">
              ${item.yoyOriginal}%
            </span>
          </td>
          <td style="padding:12px 10px;text-align:right;">${item.weeksOriginal.toFixed(1)}ì£¼</td>
          <td style="padding:12px 10px;text-align:right;">
            <span style="color:${item.yoyDiff > 0 ? '#059669' : item.yoyDiff < 0 ? '#dc2626' : '#6b7280'};font-weight:600;">
              ${item.yoyDiff > 0 ? '+' : ''}${item.yoyDiff.toFixed(1)}ì£¼
            </span>
          </td>
          <td style="padding:12px 10px;text-align:right;">${item.share}%</td>
        </tr>
      `).join('');
      
      modal.style.display = 'block';
    }
    
    // ë²„ë¸” ì°¨íŠ¸ ëª¨ë‹¬ ë‹«ê¸°
    function closeBubbleModal(){
      const modal = document.getElementById('overviewBubbleModal');
      if (modal) modal.style.display = 'none';
    }
    
    // ë²„ë¸” ì°¨íŠ¸ ë·° ì „í™˜
    function switchBubbleView(view){
      overviewBubbleView = view;
      
      const btn4 = document.getElementById('bubbleViewBtn4');
      const btn9 = document.getElementById('bubbleViewBtn9');
      const kpi4 = document.getElementById('overviewKpi4');
      const kpi9 = document.getElementById('overviewKpi9');
      
      if (view === '4quadrant') {
        btn4.style.background = 'white';
        btn4.style.color = '#1e293b';
        btn4.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';
        btn9.style.background = 'transparent';
        btn9.style.color = '#6b7280';
        btn9.style.boxShadow = 'none';
      } else {
        btn9.style.background = 'white';
        btn9.style.color = '#1e293b';
        btn9.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';
        btn4.style.background = 'transparent';
        btn4.style.color = '#6b7280';
        btn4.style.boxShadow = 'none';
      }
      
      if(kpi4) kpi4.style.display = view === '4quadrant' ? 'grid' : 'none';
      if(kpi9) kpi9.style.display = view === '9quadrant' ? 'grid' : 'none';
      
      if (charts.overviewBubble) {
        charts.overviewBubble.destroy();
      }
      charts.overviewBubble = createOverviewBubbleChart();
      
      updateOverviewBubbleKPIs();
    }
    
    // ë²„ë¸” ì°¨íŠ¸ ë¸Œëœë“œ í•„í„°
    function filterBubbleBrand(brand){
      overviewBubbleBrand = brand;
      
      document.querySelectorAll('.brand-filter-btn-overview').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      if (!charts.overviewBubble) return;
      
      const brandNames = { 'I': 'MLB Kids', 'M': 'MLB', 'ST': 'SUPRA', 'V': 'DUVETICA', 'W': 'SERGIO', 'X': 'DISCOVERY' };
      
      if (brand === 'all') {
        charts.overviewBubble.data.datasets.forEach(dataset => {
          dataset.hidden = false;
        });
      } else {
        charts.overviewBubble.data.datasets.forEach(dataset => {
          dataset.hidden = dataset.label !== brandNames[brand];
        });
      }
      
      charts.overviewBubble.update();
      updateOverviewBubbleKPIs();
    }

    // ê³ ì • í™”ë©´ìš© ë”ë¯¸ ë°ì´í„°
    function getStaticRadarData(){
      return {
        labels: ['ë°±í™”ì ','ë©´ì„¸ì ','ì§ì˜ì ','ìì‚¬ëª°','ì œíœ´ëª°','ëŒ€ë¦¬ì '],
        plan: [85, 89, 104, 74, 66, 81],
        yoy:  [83, 87, 88, 75, 70, 86],
        sales: ['49.5ì–µ','64.0ì–µ','27.4ì–µ','7.5ì–µ','11.4ì–µ','36.3ì–µ']
      };
    }
    function getStaticItemRadarData(){
      // ì•„ì´í…œ ë”ë¯¸(ë‹¹ì‹œì¦Œ/ê³¼ì‹œì¦Œ/ìŠˆì¦ˆ/ê°€ë°©/ëª¨ìì™¸) -> ì±„ë„ ì‹œë‚˜ë¦¬ì˜¤ì— ë§ì¶° 6ì§€ì  í˜•íƒœë¡œ ë³€í™˜
      return {
        labels: ['ë‹¹ì‹œì¦Œì˜ë¥˜','ê³¼ì‹œì¦Œì˜ë¥˜','ìŠˆì¦ˆ','ê°€ë°©','ëª¨ìì™¸','ACC'],
        plan: [54, 93, 84, 50, 106, 80],
        yoy:  [68, 88, 105, 65, 78, 92],
        sales: ['95ì–µ','54ì–µ','50ì–µ','10ì–µ','5ì–µ','60ì–µ']
      };
    }
    function getSalesForLabel(label, brand){
      // ë™ì‘ ëª¨ë“œì—ì„œ ì‚¬ìš©í•  ë•Œë§Œ ì°¸ì¡°ë¨. ê°„ë‹¨í•œ í•©ë¦¬ì  í´ë°±
      const data = (window.radarChartType==='channel') ? getChannelRadarData(brand) : getItemRadarData(brand);
      const idx = data.labels.indexOf(label);
      return data.sales[idx] || '0ì–µ';
    }
    function getStaticSales(label){
      const m = { 'ë°±í™”ì ':'49.5ì–µ','ë©´ì„¸ì ':'64.0ì–µ','ì§ì˜ê°€ë‘':'27.4ì–µ','ì˜¨ë¼ì¸':'18.9ì–µ','ëŒ€ë¦¬ì ':'36.3ì–µ' };
      return m[label] || '0ì–µ';
    }
    // -------- ë¦¬ì‚¬ì´ì¦ˆ --------
    window.addEventListener('resize',()=>{ 
      // ë¸Œëœë“œë³„ íŠ¸ë¦¬ë§µ í¬ê¸° ì¬ê³„ì‚°
      if (document.getElementById('content-brand')?.classList.contains('active')) {
        setTimeout(() => {
          updateChannelTreemap();
          updateItemTreemap();
        }, 100);
      }
      
      // ì „ì²´í˜„í™© íŠ¸ë¦¬ë§µ í¬ê¸° ì¬ê³„ì‚°
      if (document.getElementById('content-overview')?.classList.contains('active')) {
        setTimeout(() => {
          // ì»¨í…Œì´ë„ˆ ë†’ì´ ë™ê¸°í™”
          const channelContainer = document.getElementById('overviewTreemapContainerChannel');
          const itemContainer = document.getElementById('overviewTreemapContainerItem');
          if (channelContainer && itemContainer) {
            const channelRect = channelContainer.getBoundingClientRect();
            const itemRect = itemContainer.getBoundingClientRect();
            const maxHeight = Math.max(channelRect.height, itemRect.height);
            channelContainer.style.height = `${maxHeight}px`;
            itemContainer.style.height = `${maxHeight}px`;
          }
          initOverviewTreemap();
        }, 100);
      }
      
      Object.values(charts).forEach(c=>{ if(c) c.resize(); }); 
    });

    // -------- ì´ˆê¸°í™” --------
    document.addEventListener('DOMContentLoaded', ()=>{
      setTimeout(()=>{ 
        renderInsights();
        // realDataë¥¼ ë¨¼ì € ì´ˆê¸°í™”í•˜ê¸° ìœ„í•´ initWeeklyTrendChartë¥¼ ë¨¼ì € í˜¸ì¶œ
        initWeeklyTrendChart();
        // ê·¸ ë‹¤ìŒ initOverviewCharts í˜¸ì¶œ (realDataë¥¼ ì‚¬ìš©í•¨)
        initOverviewCharts(); 
        // ì´ˆê¸° ë¡œë“œ í›„ í¸ì§‘ ë‚´ìš© ì ìš© ë° ì›ë³¸ ë°ì´í„° ì €ì¥
        loadEdits();
        saveOriginalData();
        // íŠ¸ë¦¬ë§µ ë©”íƒ€ë°ì´í„° ë¡œë“œ
        loadTreemapMetadata();
      },100);
    });

    // -------- ê°œìš” ì„¹ì…˜: ì£¼ì°¨ë³„/ëˆ„ì  í† ê¸€ ë³´ì¥ --------
    function ensureOverviewToggleUI(){
      try{
        const container = document.getElementById('cumulativeTrendChart')?.parentElement;
        if(!container) return;
        let btnWrap = container.previousElementSibling;
        const needBuild = !(btnWrap && btnWrap.querySelector('#overviewModeBtnWeekly'));
        if(needBuild){
          btnWrap = document.createElement('div');
          btnWrap.style.cssText = 'display:flex;justify-content:flex-end;margin:4px 0 8px 0;gap:6px;';
          const btnW = document.createElement('button');
          btnW.id='overviewModeBtnWeekly';
          btnW.textContent='ì£¼ì°¨ë³„';
          btnW.style.cssText='background:#e5e7eb;color:#374151;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;';
          const btnC = document.createElement('button');
          btnC.id='overviewModeBtnCumulative';
          btnC.textContent='ëˆ„ì ';
          btnC.style.cssText='background:#2563eb;color:#fff;border:none;border-radius:6px;padding:4px 8px;font-size:12px;cursor:pointer;';
          btnWrap.appendChild(btnW); btnWrap.appendChild(btnC);
          container.parentElement.insertBefore(btnWrap, container);
        }
        if(!window.overviewMode) window.overviewMode='weekly';
        const btnWeekly = document.getElementById('overviewModeBtnWeekly');
        const btnCum = document.getElementById('overviewModeBtnCumulative');
        const applyActive=()=>{
          if(window.overviewMode==='weekly'){
            btnWeekly.style.background='#2563eb'; btnWeekly.style.color='#fff';
            btnCum.style.background='#e5e7eb'; btnCum.style.color='#374151';
          }else{
            btnCum.style.background='#2563eb'; btnCum.style.color='#fff';
            btnWeekly.style.background='#e5e7eb'; btnWeekly.style.color='#374151';
          }
        };
        if(btnWeekly && !btnWeekly.hasAttribute('data-listener')){
          btnWeekly.setAttribute('data-listener','true');
          btnWeekly.addEventListener('click',()=>{ window.overviewMode='weekly'; applyActive(); renderOverviewTrendByMode(); });
        }
        if(btnCum && !btnCum.hasAttribute('data-listener')){
          btnCum.setAttribute('data-listener','true');
          btnCum.addEventListener('click',()=>{ window.overviewMode='cumulative'; applyActive(); renderOverviewTrendByMode(); });
        }
        applyActive();
        // ê¸°ë³¸ ëª¨ë“œ(ì£¼ì°¨ë³„) ë°˜ì˜í•˜ì—¬ ì¦‰ì‹œ ë Œë” ê°±ì‹ 
        renderOverviewTrendByMode();
      }catch(e){ console.warn('ensureOverviewToggleUI failed', e); }
    }

    function renderOverviewTrendByMode(){
      try{
        if(charts.cumulativeTrend){ charts.cumulativeTrend.destroy(); charts.cumulativeTrend=null; }
        const ctx = document.getElementById('cumulativeTrendChart');
        if(!ctx) return;
        if(window.overviewMode==='weekly'){
          // ì£¼ì°¨ë³„ ëª¨ë“œ: realDataì—ì„œ 10/5~11/2 ì£¼ì°¨ë³„ í•©ì‚°
          const labels = ['10/5','10/12','10/19','10/26','11/2'];
          const allBrands = ['MLB', 'MLB_KIDS', 'DISCOVERY', 'DUVETICA', 'SERGIO', 'SUPRA'];
          const weekIndices = [4, 5, 6, 7, 8];
          
          const weeklySales = weekIndices.map(weekIdx => {
            return allBrands.reduce((sum, brand) => {
              const brandData = realData[brand];
              if (!brandData || !brandData.ë‹¹ë…„) return sum;
              return sum + Object.values(brandData.ë‹¹ë…„).reduce((channelSum, weekArray) => {
                return channelSum + (weekArray[weekIdx] || 0);
              }, 0);
            }, 0);
          });
          
          const prevYear = weekIndices.map(weekIdx => {
            return allBrands.reduce((sum, brand) => {
              const brandData = realData[brand];
              if (!brandData || !brandData.ì „ë…„) return sum;
              return sum + Object.values(brandData.ì „ë…„).reduce((channelSum, weekArray) => {
                return channelSum + (weekArray[weekIdx] || 0);
              }, 0);
            }, 0);
          });
          
          const monthlyTarget = 929.3;
          const target = Array(5).fill(monthlyTarget / 5);
          
          const dataWeekly = { labels, datasets:[
            { label:'ì£¼ì°¨ë³„ ë§¤ì¶œ', data: weeklySales, type:'bar', backgroundColor:'rgba(79,70,229,0.8)', borderColor:'rgba(79,70,229,1)', borderWidth:1 },
            { label:'ì „ë…„ ë§¤ì¶œ', data: prevYear, type:'line', borderColor:'rgba(16,185,129,1)', backgroundColor:'rgba(16,185,129,0.1)', borderWidth:2, tension:0.4, fill:false, pointRadius:3 },
            { label:'ëª©í‘œ', data: target, type:'line', borderColor:'rgba(239,68,68,1)', backgroundColor:'rgba(239,68,68,0.1)', borderWidth:2, borderDash:[5,5], tension:0, fill:false, pointRadius:3 }
          ]};
          charts.cumulativeTrend = new Chart(ctx.getContext('2d'), { type:'bar', data:dataWeekly, options:{ responsive:true, maintainAspectRatio:false, plugins:{ legend:{ position:'top', labels:{ font:{ size:10 } } } }, scales:{ y:{ beginAtZero:true, title:{ display:true, text:'ë§¤ì¶œ (ì–µì›)', font:{ size:10 } }, ticks:{ font:{ size:9 } } }, x:{ ticks:{ font:{ size:9 } } } } } });
        }else{
          // ëˆ„ì  ëª¨ë“œ: realDataì—ì„œ 10/5~11/2 ëˆ„ì  í•©ì‚°
          const weeks = ['10/5','10/12','10/19','10/26','11/2'];
          const allBrands = ['MLB', 'MLB_KIDS', 'DISCOVERY', 'DUVETICA', 'SERGIO', 'SUPRA'];
          const weekIndices = [4, 5, 6, 7, 8];
          
          const weeklyCurrentTotal = weekIndices.map(weekIdx => {
            return allBrands.reduce((sum, brand) => {
              const brandData = realData[brand];
              if (!brandData || !brandData.ë‹¹ë…„) return sum;
              return sum + Object.values(brandData.ë‹¹ë…„).reduce((channelSum, weekArray) => {
                return channelSum + (weekArray[weekIdx] || 0);
              }, 0);
            }, 0);
          });
          
          const weeklyPrevTotal = weekIndices.map(weekIdx => {
            return allBrands.reduce((sum, brand) => {
              const brandData = realData[brand];
              if (!brandData || !brandData.ì „ë…„) return sum;
              return sum + Object.values(brandData.ì „ë…„).reduce((channelSum, weekArray) => {
                return channelSum + (weekArray[weekIdx] || 0);
              }, 0);
            }, 0);
          });
          
          let cumCurrent = 0;
          const forecastActual = weeklyCurrentTotal.map(weekly => {
            cumCurrent += weekly;
            return cumCurrent;
          });
          
          let cumPrev = 0;
          const prevSales = weeklyPrevTotal.map(weekly => {
            cumPrev += weekly;
            return cumPrev;
          });
          
          const monthlyTarget = 929.3;
          const weeklyTarget = monthlyTarget / 5;
          const targetSales = weeks.map((_, idx) => weeklyTarget * (idx + 1));
          
          const forecastPlan = [null, null, null, null, null];
          
          charts.cumulativeTrend = new Chart(ctx.getContext('2d'),{
            type:'line',
            data:{ labels: weeks, datasets:[
              { label:'ë‹¹ë…„ ëˆ„ì ', data: forecastActual, borderColor:'rgba(124,58,237,1)', backgroundColor:'rgba(124,58,237,0.1)', borderWidth:3, fill:false, tension:0.3, pointRadius:5, pointHoverRadius:7, spanGaps:false },
              { label:'ì „ë…„', data: prevSales, borderColor:'rgba(220,38,38,1)', backgroundColor:'rgba(220,38,38,0.1)', borderWidth:2.5, fill:false, tension:0.3, pointRadius:4, pointHoverRadius:6 },
              { label:'ëª©í‘œ', data: targetSales, borderColor:'rgba(16,185,129,1)', backgroundColor:'rgba(16,185,129,0.1)', borderWidth:2.5, borderDash:[5,5], fill:false, tension:0.3, pointRadius:4, pointHoverRadius:6 }
            ] },
            options:{ responsive:true, maintainAspectRatio:false, plugins:{ legend:{ position:'top', labels:{ font:{ size:10 } } } }, scales:{ y:{ type:'linear', display:true, position:'left', title:{ display:true, text:'ëˆ„ì  ë§¤ì¶œ (ì–µì›)', font:{ size:11 } }, ticks:{ font:{ size:10 } }, beginAtZero:true }, x:{ ticks:{ font:{ size:10 } } } } }
          });
        }
      }catch(e){ console.error('renderOverviewTrendByMode failed', e); }
    }

    // -------- ì£¼ì°¨ë³„ ë§¤ì¶œ ì¶”ì„¸ (ì£¼ì°¨ë³„/ëˆ„ì ) --------
    let weeklyMode = 'weekly'; // 'weekly' or 'cumulative'
    let weeklyChannelFilter = 'all'; // ì„ íƒëœ ì±„ë„ í•„í„°
    
    function initWeeklyTrendChart(){
      updateWeeklyTrendChart();
      
      // ì£¼ì°¨ë³„/ëˆ„ì  ë²„íŠ¼ ì´ë²¤íŠ¸
      const weeklyBtn = document.getElementById('weeklyModeBtnWeekly');
      const cumBtn = document.getElementById('weeklyModeBtnCumulative');
      if(weeklyBtn && !weeklyBtn.hasAttribute('data-listener')){
        weeklyBtn.setAttribute('data-listener','true');
        weeklyBtn.addEventListener('click',()=>{ weeklyMode='weekly'; updateWeeklyButtons(); updateWeeklyTrendChart(); });
      }
      if(cumBtn && !cumBtn.hasAttribute('data-listener')){
        cumBtn.setAttribute('data-listener','true');
        cumBtn.addEventListener('click',()=>{ weeklyMode='cumulative'; updateWeeklyButtons(); updateWeeklyTrendChart(); });
      }
      
      // ì±„ë„ í•„í„° ë²„íŠ¼ ì´ë²¤íŠ¸
      const filterButtons = document.querySelectorAll('.weekly-channel-filter-btn');
      filterButtons.forEach(btn => {
        if(!btn.hasAttribute('data-listener')){
          btn.setAttribute('data-listener','true');
          btn.addEventListener('click',()=>{
            weeklyChannelFilter = btn.dataset.channel || 'all';
            updateWeeklyChannelFilterButtons();
            updateWeeklyTrendChart();
          });
        }
      });
      
      updateWeeklyButtons();
      updateWeeklyChannelFilterButtons();
    }
    
    function updateWeeklyChannelFilterButtons(){
      const filterButtons = document.querySelectorAll('.weekly-channel-filter-btn');
      filterButtons.forEach(btn => {
        const channel = btn.dataset.channel || 'all';
        if(channel === weeklyChannelFilter){
          btn.style.background = '#2563eb';
          btn.style.color = '#fff';
          btn.classList.add('active');
        } else {
          btn.style.background = '#e5e7eb';
          btn.style.color = '#374151';
          btn.classList.remove('active');
        }
      });
    }
    
    function updateWeeklyButtons(){
      const weeklyBtn = document.getElementById('weeklyModeBtnWeekly');
      const cumBtn = document.getElementById('weeklyModeBtnCumulative');
      if(weeklyBtn && cumBtn){
        if(weeklyMode==='weekly'){ weeklyBtn.style.background='#2563eb'; weeklyBtn.style.color='#fff'; cumBtn.style.background='#e5e7eb'; cumBtn.style.color='#374151'; }
        else { cumBtn.style.background='#2563eb'; cumBtn.style.color='#fff'; weeklyBtn.style.background='#e5e7eb'; weeklyBtn.style.color='#374151'; }
      }
    }
    
    function updateWeeklyTrendChart(){
      const ctxEl = document.getElementById('weeklyTrendChart');
      if(!ctxEl) return;
      if(charts.weeklyTrend){ charts.weeklyTrend.destroy(); charts.weeklyTrend=null; }
      
      // Xì¶• ë ˆì´ë¸” (9ì£¼ì°¨ ë°ì´í„°: 9/7 ~ 11/2)
      const labels = ['9/7', '9/14', '9/21', '9/28', '10/5', '10/12', '10/19', '10/26', '11/2'];
      
      // ì‹¤ì œ ë°ì´í„° ê¸°ë°˜ ì£¼ì°¨ë³„ ë§¤ì¶œ (ë‹¨ìœ„: ì–µì›)
      // ì±„ë„ ë²ˆí˜¸ ë§¤í•‘: 1=ë°±í™”ì , 2=ë©´ì„¸ì , 3=ì§ì˜ì (ê°€ë‘), 4=ìì‚¬ëª°, 5=ì œíœ´ëª°, 6=ëŒ€ë¦¬ì , 7=ì•„ìš¸ë ›, 8=ì‚¬ì…, 11=ì§ì˜ëª°, 12=ì•„ìš¸ë ›, RF=RF
      // ì£¼ì°¨: 9/7 ~ 11/2 (9ì£¼ì°¨ ë°ì´í„°)
      realData = {
        MLB: {
          ë‹¹ë…„: { 
            1:[10.45,10.32,12.57,12.38,12.53,15.72,12.98,23.35,21.52], // ë°±í™”ì 
            2:[20.82,25.20,25.53,22.97,14.15,14.09,30.78,32.72,27.81], // ë©´ì„¸ì 
            3:[4.33,5.09,5.17,5.11,4.36,4.39,4.16,5.61,8.31], // ì§ì˜ì (ê°€ë‘)
            4:[1.13,1.17,1.67,1.53,1.18,1.21,1.59,1.99,2.42], // ìì‚¬ëª°
            5:[3.04,3.58,3.95,3.79,2.39,4.03,4.23,4.88,5.17], // ì œíœ´ëª°
            6:[11.15,7.20,10.93,8.53,9.68,11.70,12.00,15.61,17.40], // ëŒ€ë¦¬ì 
            7:[0,0,0,0,0,0,0,0,0], // ì•„ìš¸ë ›
            8:[6.76,8.24,7.11,7.36,10.53,13.84,6.87,10.70,12.52], // ì‚¬ì…
            11:[0.63,0.74,0.86,0.80,1.25,1.83,0.96,1.22,1.37], // ì§ì˜ëª°
            RF:[4.07,1.81,3.36,4.74,2.94,2.06,2.78,5.13,8.67] // RF ì±„ë„ (MLBë§Œ ì¡´ì¬)
          },
          ì „ë…„: { 
            1:[11.56,12.63,10.83,13.84,18.17,17.32,13.92,15.83,16.24], // ë°±í™”ì 
            2:[23.89,27.57,16.79,31.09,18.20,30.37,35.99,22.84,19.52], // ë©´ì„¸ì 
            3:[3.02,2.99,3.10,3.37,3.83,3.51,3.70,3.63,3.80], // ì§ì˜ì (ê°€ë‘)
            4:[1.97,1.49,1.62,1.69,2.23,1.85,1.61,1.62,1.52], // ìì‚¬ëª°
            5:[3.21,2.99,2.92,3.64,3.77,3.36,3.37,3.60,3.58], // ì œíœ´ëª°
            6:[8.21,7.59,7.93,7.96,11.76,11.57,12.76,12.94,9.10], // ëŒ€ë¦¬ì 
            7:[0,0,0,0,0,0,0,0,0], // ì•„ìš¸ë ›
            8:[2.61,6.05,2.48,12.47,5.18,3.05,9.14,3.05,20.92], // ì‚¬ì…
            11:[0.87,1.05,1.67,0.95,1.78,1.36,1.21,1.20,1.14], // ì§ì˜ëª°
            RF:[2.31,1.26,2.54,1.50,2.74,2.28,2.04,2.37,3.12] // RF ì±„ë„
          }
        },
        MLB_KIDS: {
          ë‹¹ë…„: { 
            1:[4.03,5.17,5.76,6.54,7.56,6.38,6.68,8.45,8.26], // ë°±í™”ì 
            2:[1.25,1.13,1.59,2.73,1.22,1.21,1.82,2.02,1.50], // ë©´ì„¸ì 
            3:[0.14,0.17,0.23,0.22,0.24,0.19,0.23,0.36,0.41], // ì§ì˜ì (ê°€ë‘)
            4:[0.41,0.46,0.57,0.76,0.62,0.55,0.78,1.00,0.94], // ìì‚¬ëª°
            5:[1.12,1.45,2.51,1.66,0.88,1.49,2.84,3.04,2.57], // ì œíœ´ëª°
            6:[0.68,0.78,1.15,1.60,2.27,1.93,1.66,2.29,2.51], // ëŒ€ë¦¬ì 
            7:[0,0,0,0,0,0,0,0,0], // ì•„ìš¸ë ›
            8:[1.84,2.53,2.58,2.87,4.29,5.42,2.44,4.24,4.94], // ì‚¬ì…
            11:[0.31,0.50,0.52,0.73,0.84,1.17,0.55,0.66,0.69], // ì§ì˜ëª°
            12:[0,0,0,0,0,0,0,0,0] // ì•„ìš¸ë ›
          },
          ì „ë…„: { 
            1:[5.75,6.02,5.12,5.60,8.65,6.76,5.55,6.36,6.08], // ë°±í™”ì 
            2:[1.40,1.25,1.01,2.30,1.41,1.75,2.18,3.41,2.72], // ë©´ì„¸ì 
            3:[0.26,0.29,0.22,0.33,0.35,0.36,0.41,0.35,0.40], // ì§ì˜ì (ê°€ë‘)
            4:[0.41,0.36,0.46,0.53,0.62,0.62,0.58,0.73,0.67], // ìì‚¬ëª°
            5:[0.71,1.54,0.51,1.13,1.12,1.35,1.08,3.61,0.85], // ì œíœ´ëª°
            6:[0.84,1.30,1.20,1.18,1.97,1.68,1.49,1.55,1.45], // ëŒ€ë¦¬ì 
            7:[0,0,0,0,0,0,0,0,0], // ì•„ìš¸ë ›
            8:[0.98,2.47,1.80,6.22,2.94,1.58,4.27,1.32,7.93], // ì‚¬ì…
            11:[0.49,0.50,0.95,0.51,0.94,0.72,0.58,0.62,0.53], // ì§ì˜ëª°
            12:[0,0,0,0,0,0,0,0,0] // ì•„ìš¸ë ›
          }
        },
        DISCOVERY: {
          ë‹¹ë…„: { 
            1:[9.12,9.82,9.87,11.73,11.87,15.06,17.77,30.25,35.96], // ë°±í™”ì 
            2:[1.49,2.55,1.74,2.33,1.60,0.87,2.64,3.76,4.51], // ë©´ì„¸ì 
            3:[0.36,0.59,0.51,0.49,0.53,0.60,0.64,0.98,1.68], // ì§ì˜ì (ê°€ë‘)
            4:[1.40,1.56,1.80,1.59,1.53,2.57,2.59,4.60,5.98], // ìì‚¬ëª°
            5:[2.39,4.41,3.74,5.79,3.03,7.02,6.73,11.46,14.34], // ì œíœ´ëª°
            6:[10.75,11.31,14.45,15.68,21.48,23.94,23.75,36.63,43.39], // ëŒ€ë¦¬ì 
            7:[7.03,9.14,9.05,10.17,17.06,27.23,18.69,30.19,36.92], // ì•„ìš¸ë ›
            8:[-0.00,0.00,-0.00,3.47,0.00,0.00,0.00,0.03,0.00], // ì‚¬ì…
            11:[0.55,0.66,0.73,0.90,1.32,1.99,1.56,2.77,3.67], // ì§ì˜ëª°
            12:[0.54,0.60,0.61,0.57,0.67,1.23,0.73,1.27,1.31] // ì•„ìš¸ë ›
          },
          ì „ë…„: { 
            1:[11.21,11.05,12.08,16.27,24.78,25.09,20.79,28.38,28.15], // ë°±í™”ì 
            2:[1.52,0.94,0.69,1.40,1.67,3.09,2.88,4.00,3.39], // ë©´ì„¸ì 
            3:[0.07,0.10,0.09,0.05,0.14,0.19,0.18,0.20,0.29], // ì§ì˜ì (ê°€ë‘)
            4:[1.61,1.40,1.79,2.22,3.28,3.10,3.11,4.40,4.60], // ìì‚¬ëª°
            5:[3.75,3.66,3.42,6.72,7.35,9.22,6.62,10.01,7.27], // ì œíœ´ëª°
            6:[13.75,15.41,19.37,18.58,30.39,30.75,31.41,35.73,35.45], // ëŒ€ë¦¬ì 
            7:[8.02,9.17,16.30,13.24,30.70,25.68,22.75,26.91,25.04], // ì•„ìš¸ë ›
            8:[-0.00,-0.00,-0.00,-0.00,0.00,-2.34,5.46,-4.43,-0.00], // ì‚¬ì…
            11:[0.84,1.09,1.60,1.04,2.17,1.99,2.03,2.20,2.02], // ì§ì˜ëª°
            12:[0.53,0.53,0.79,0.76,1.35,1.25,0.77,0.97,0.79] // ì•„ìš¸ë ›
          }
        },
        DUVETICA: {
          ë‹¹ë…„: { 
            1:[2.61,1.34,1.58,2.33,1.24,2.89,2.70,4.17,6.02], // ë°±í™”ì 
            2:[0,0,0,0,0,0,0,0,0], // ë©´ì„¸ì 
            3:[0,0.02,0.03,0.04,0.04,0.01,0.03,0.04,0.15], // ì§ì˜ì (ê°€ë‘)
            4:[0.09,0.22,0.16,0.23,0.29,0.36,0.32,0.63,1.05], // ìì‚¬ëª°
            5:[0.45,0.80,1.77,1.08,0.43,1.84,1.72,4.82,1.49], // ì œíœ´ëª°
            6:[0,0,0,0,0,0,0,0,0], // ëŒ€ë¦¬ì 
            7:[0.90,1.01,1.14,1.55,1.87,2.83,1.43,2.40,3.23], // ì•„ìš¸ë ›
            8:[0,0,0,0,0,0,0,0,0], // ì‚¬ì…
            11:[0.10,0.09,0.18,0.27,0.31,0.34,0.27,0.59,0.59], // ì§ì˜ëª°
            12:[0,0,0,0,0,0,0,0,0] // ì•„ìš¸ë ›
          },
          ì „ë…„: { 
            1:[0.68,1.64,1.72,1.24,1.36,1.59,1.29,2.21,1.53], // ë°±í™”ì 
            2:[0,0,0,0,0,0,0,0,0], // ë©´ì„¸ì 
            3:[0,0,0,0,0,0,0,0,0], // ì§ì˜ì (ê°€ë‘)
            4:[0.17,0.03,0.06,0.09,0.10,0.18,0.30,0.33,0.35], // ìì‚¬ëª°
            5:[0.65,0.58,0.48,0.14,0.53,0.60,0.20,1.46,0.30], // ì œíœ´ëª°
            6:[0,0,0,0,0,0,0,0,0], // ëŒ€ë¦¬ì 
            7:[0.41,0.86,2.57,1.36,1.59,1.76,1.30,1.24,1.83], // ì•„ìš¸ë ›
            8:[0,0,0,0,0,0,0,0,0], // ì‚¬ì…
            11:[0.13,0.17,0.13,0.17,0.17,0.22,0.27,0.22,0.24], // ì§ì˜ëª°
            12:[0,0,0,0,0,0,0,0,0] // ì•„ìš¸ë ›
          }
        },
        SERGIO: {
          ë‹¹ë…„: { 
            1:[0.04,0.02,0.08,0.06,0.03,0.03,0.05,0.04,0.06], // ë°±í™”ì 
            2:[0.26,0.26,0.19,0.15,0.06,0.21,0.19,0.21,0.15], // ë©´ì„¸ì 
            3:[0.01,0.13,0.18,0.21,0.35,0.19,0.17,0.16,0.20], // ì§ì˜ì (ê°€ë‘)
            4:[0.19,0.29,0.35,0.29,0.34,0.21,1.35,0.39,0.18], // ìì‚¬ëª°
            5:[0.40,0.45,0.42,0.48,1.28,0.51,0.46,0.50,0.62], // ì œíœ´ëª°
            6:[0,0,0,0,0,0,0,0,0], // ëŒ€ë¦¬ì 
            7:[0.16,0.19,0.50,0.39,0.33,0.29,0.41,0.38,0.29], // ì•„ìš¸ë ›
            8:[0,0,0,0,0,0,0,0,0], // ì‚¬ì…
            11:[0.11,0.16,0.23,0.34,0.36,0.33,0.53,0.33,0.40], // ì§ì˜ëª°
            12:[0,0,0,0,0,0,0,0,0] // ì•„ìš¸ë ›
          },
          ì „ë…„: { 
            1:[0.16,0.23,0.33,0.22,0.43,0.41,0.20,0.30,0.29], // ë°±í™”ì 
            2:[0.18,0.19,0.14,0.18,0.08,0.26,0.24,0.24,0.42], // ë©´ì„¸ì 
            3:[0,0,0,0,0,0,0,0,0], // ì§ì˜ì (ê°€ë‘)
            4:[0.38,0.28,0.31,0.42,1.00,1.95,0.89,0.05,-0.16], // ìì‚¬ëª°
            5:[0.20,0.23,0.18,0.22,0.23,0.30,0.28,0.28,0.20], // ì œíœ´ëª°
            6:[0,0,0,0,0,0,0,0,0], // ëŒ€ë¦¬ì 
            7:[0.10,0.05,0.57,0.27,0.19,0.14,0.07,0.10,0.13], // ì•„ìš¸ë ›
            8:[0,0,0,0,0,0,0,0,0], // ì‚¬ì…
            11:[0.22,0.17,0.38,0.24,1.02,0.74,0.28,0.20,0.20], // ì§ì˜ëª°
            12:[0,0,0,0,0,0,0,0,0] // ì•„ìš¸ë ›
          }
        },
        SUPRA: {
          ë‹¹ë…„: { 
            1:[0,0,0,0,0.01,0,0,0,0.01], // ë°±í™”ì 
            2:[0,0,0,0,0,0,0,0,0], // ë©´ì„¸ì 
            3:[0,0,0,0,0,0,0,0,0], // ì§ì˜ì (ê°€ë‘)
            4:[0.15,0.22,0.25,0.31,0.24,0.17,0.20,0.33,0.25], // ìì‚¬ëª°
            5:[0.31,0.46,0.21,0.34,0.21,0.37,0.44,0.25,0.32], // ì œíœ´ëª°
            6:[0.00,0.01,0.01,0.00,0.00,0.00,0.00,0.00,0.00], // ëŒ€ë¦¬ì 
            7:[0,0,0,0,0,0,0,0,0], // ì•„ìš¸ë ›
            8:[0,0,0,0,0,0,0,0,0], // ì‚¬ì…
            11:[0,0,0,0,0,0,0,0,0], // ì§ì˜ëª°
            12:[0,0,0,0,0,0,0,0,0] // ì•„ìš¸ë ›
          },
          ì „ë…„: { 
            1:[0,0,0,0,0,0,0,0,0], // ë°±í™”ì 
            2:[0.17,0.26,0.73,0.14,0.25,0.08,0.63,0.13,0.10], // ë©´ì„¸ì 
            3:[0.16,0.17,0.17,0.48,0.26,0.29,0.26,0.25,0.65], // ì§ì˜ì (ê°€ë‘)
            4:[0.10,0.02,0.02,0.20,0.09,0.08,0.08,0.05,0.06], // ìì‚¬ëª°
            5:[0.06,0.02,0.03,0.18,0.11,0.09,0.06,0.09,0.04], // ì œíœ´ëª°
            6:[0,0,0,0,0,0,0,0,0], // ëŒ€ë¦¬ì 
            7:[0,0,0,0,0,0,0,0,0], // ì•„ìš¸ë ›
            8:[0,0,0,0,0,0,0,0,0], // ì‚¬ì…
            11:[0.03,0.03,0.06,0.04,0.05,0.04,0.06,0.04,0.01], // ì§ì˜ëª°
            12:[0,0,0,0,0,0,0,0,0] // ì•„ìš¸ë ›
          }
        }
      };
      
      // ë¸Œëœë“œë³„, ì±„ë„ë³„ ì£¼ì°¨ë³„ ë§¤ì¶œ ë°ì´í„° êµ¬ì¡°
      const getWeeklyDataByChannel = (brand, channel) => {
        const channelMap = {
          'ë°±í™”ì ': '1',
          'ë©´ì„¸ì ': '2',
          'ì§ì˜ì ': '3',
          'ì§ì˜ê°€ë‘': '3',
          'ëŒ€ë¦¬ì ': '6',
          'ì•„ìš¸ë ›': '7',
          'ì§ì˜ëª°': '11',
          'ìì‚¬ëª°': '4',
          'ì˜¨ë¼ì¸ìì‚¬': '4',
          'ì œíœ´ëª°': '5',
          'ì˜¨ë¼ì¸ì œíœ´': '5',
          'ì‚¬ì…': '8',
          'RF': 'RF'
        };
        const channelKey = channelMap[channel] || 'all';
        
        const brandData = realData[brand] || realData.MLB;
        
        if (channelKey === 'all') {
          // ì „ì²´ í•©ê³„ ê³„ì‚° (9ì£¼ì°¨ ë°ì´í„°)
          const weekly = Array(9).fill(0);
          const prevYear = Array(9).fill(0);
          
          Object.keys(brandData.ë‹¹ë…„).forEach(ch => {
            brandData.ë‹¹ë…„[ch].forEach((v, i) => {
              weekly[i] += v;
            });
          });
          
          Object.keys(brandData.ì „ë…„).forEach(ch => {
            if (brandData.ì „ë…„[ch]) {
              brandData.ì „ë…„[ch].forEach((v, i) => {
                prevYear[i] += v;
              });
            }
          });
          
          // ëª©í‘œëŠ” ë‹¹ë…„ í‰ê· ì˜ 120% ì •ë„ë¡œ ì„¤ì •
          const avgWeekly = weekly.reduce((a,b)=>a+b,0) / 9;
          const target = Array(9).fill(avgWeekly * 1.2);
          
          return { weekly, prevYear, target };
        } else {
          // íŠ¹ì • ì±„ë„ ë°ì´í„°
          const weekly = brandData.ë‹¹ë…„[channelKey] || Array(9).fill(0);
          const prevYear = brandData.ì „ë…„[channelKey] || Array(9).fill(0);
          const avgWeekly = weekly.reduce((a,b)=>a+b,0) / 9;
          const target = Array(9).fill(avgWeekly * 1.2);
          
          return { weekly, prevYear, target };
        }
      };
      
      // ì„ íƒëœ ì±„ë„ì— ë”°ë¥¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      let weeklySales, prevYear, target;
      if(weeklyChannelFilter === 'all'){
        const allData = getWeeklyDataByChannel(currentBrand, 'all');
        weeklySales = allData.weekly;
        prevYear = allData.prevYear;
        target = allData.target || Array(9).fill(50);
      } else {
        const channelData = getWeeklyDataByChannel(currentBrand, weeklyChannelFilter);
        weeklySales = channelData.weekly;
        prevYear = channelData.prevYear;
        target = channelData.target || Array(9).fill(channelData.weekly[0] * 1.3);
      }
      
      const cumulative = weeklySales.reduce((arr,v,i)=>{ arr.push((arr[i-1]||0)+v); return arr; },[]);
      const cumulativePrev = prevYear.reduce((arr,v,i)=>{ arr.push((arr[i-1]||0)+v); return arr; },[]);
      
      const dataWeekly = {
        labels,
        datasets:[
          { label:'ì£¼ì°¨ë³„ ë§¤ì¶œ', data: weeklySales, type:'bar', backgroundColor:'rgba(79,70,229,0.8)', borderColor:'rgba(79,70,229,1)', borderWidth:1 },
          { label:'ì „ë…„ ë§¤ì¶œ', data: prevYear, type:'line', borderColor:'rgba(16,185,129,1)', backgroundColor:'rgba(16,185,129,0.1)', borderWidth:2, tension:0.4, fill:false, pointRadius:3 }
        ]
      };
      const dataCum = {
        labels,
        datasets:[
          { label:'ëˆ„ì  ë§¤ì¶œ', data: cumulative, type:'line', borderColor:'rgba(79,70,229,1)', backgroundColor:'rgba(79,70,229,0.1)', borderWidth:3, tension:0.3, fill:true, pointRadius:3 },
          { label:'ì „ë…„ ëˆ„ì ', data: cumulativePrev, type:'line', borderColor:'rgba(16,185,129,1)', backgroundColor:'rgba(16,185,129,0.1)', borderWidth:2, tension:0.3, fill:false, pointRadius:3 },
          { label:'ëª©í‘œ ëˆ„ì ', data: target.map((v,i)=>v*(i+1)), type:'line', borderColor:'rgba(239,68,68,1)', backgroundColor:'rgba(239,68,68,0.1)', borderWidth:2, borderDash:[5,5], tension:0, fill:false, pointRadius:3 }
        ]
      };
      const chartData = weeklyMode==='weekly' ? dataWeekly : dataCum;
      
      // ì°¨íŠ¸ ì˜µì…˜ (íˆ´íŒì— ë°±ë§Œì› ë‹¨ìœ„ í‘œì‹œ)
      const chartOptions = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'top',
            labels: { font: { size: 10 } }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const label = context.dataset.label || '';
                const value = context.parsed.y;
                // ì–µì›ì„ ë°±ë§Œì›ìœ¼ë¡œ ë³€í™˜ (1ì–µ = 100ë°±ë§Œ)
                const millionValue = Math.round(value * 100);
                return label + ': ' + millionValue.toLocaleString() + 'ë°±ë§Œ';
              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            title: { display: true, text: 'ë§¤ì¶œ (ì–µì›)', font: { size: 10 } },
            ticks: { font: { size: 9 } }
          },
          x: {
            ticks: { font: { size: 12, weight: 'bold' } }
          }
        }
      };
      
      charts.weeklyTrend = new Chart(ctxEl.getContext('2d'), { 
        type: 'bar', 
        data: chartData, 
        options: chartOptions 
      });
      
      // ì£¼ì°¨ë³„ ë§¤ì¶œ ë°ì´í„° í‘œ ì—…ë°ì´íŠ¸
      updateWeeklyDataTable(weeklySales, prevYear);
    }
    
    // ì£¼ì°¨ë³„ ë§¤ì¶œ ë°ì´í„° í‘œ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateWeeklyDataTable(weeklySales, prevYear) {
      const tbody = document.getElementById('weeklyDataTableBody');
      if (!tbody) return;
      
      // YOY ê³„ì‚°
      const yoyData = weeklySales.map((current, idx) => {
        const prev = prevYear[idx];
        if (prev === 0 || prev === null) return 0;
        return Math.round((current / prev) * 100);
      });
      
      // ì–µì›ì„ ë°±ë§Œì›ìœ¼ë¡œ ë³€í™˜
      const currentMillion = weeklySales.map(v => Math.round(v * 100));
      const prevMillion = prevYear.map(v => Math.round(v * 100));
      
      // í‘œ HTML ìƒì„±
      let html = '';
      
      // ë‹¹ë…„(ë°±ë§Œ) í–‰
      html += '<tr style="background:#fff;">';
      html += '<td style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#1e293b;font-size:14px;">ë‹¹ë…„(ë°±ë§Œ)</td>';
      currentMillion.forEach(val => {
        html += `<td style="padding:10px;border:1px solid #e2e8f0;color:#1e293b;font-size:13px;">${val.toLocaleString()}</td>`;
      });
      html += '</tr>';
      
      // ì „ë…„(ë°±ë§Œ) í–‰
      html += '<tr style="background:#fff;">';
      html += '<td style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#1e293b;font-size:14px;">ì „ë…„(ë°±ë§Œ)</td>';
      prevMillion.forEach(val => {
        html += `<td style="padding:10px;border:1px solid #e2e8f0;color:#1e293b;font-size:13px;">${val.toLocaleString()}</td>`;
      });
      html += '</tr>';
      
      // YOY í–‰
      html += '<tr style="background:#fff;">';
      html += '<td style="padding:10px;border:1px solid #e2e8f0;font-weight:700;color:#4f46e5;font-size:14px;">YOY</td>';
      yoyData.forEach(val => {
        const color = val >= 100 ? '#059669' : '#dc2626';
        html += `<td style="padding:10px;border:1px solid #e2e8f0;color:${color};font-weight:700;font-size:13px;">${val}%</td>`;
      });
      html += '</tr>';
      
      tbody.innerHTML = html;
    }
  </script>
</body>
</html>



